
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 acu[K[Kccumulated_training.py [K; pytho3[Kn cross_validation.py 
[?2004l--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-48-49/figs
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-48-49/training
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-48-49/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])

Training on dataset 1/10 with 180 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0751282, Val Loss: 0.079246, Train MAE: 0.219934, Val MAE: 0.221341, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0460419, Val Loss: 0.0502141, Train MAE: 0.17103, Val MAE: 0.173939, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0424853, Val Loss: 0.0484656, Train MAE: 0.164068, Val MAE: 0.169766, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0317669, Val Loss: 0.0401069, Train MAE: 0.13696, Val MAE: 0.152479, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0253234, Val Loss: 0.0324343, Train MAE: 0.121743, Val MAE: 0.135894, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0196893, Val Loss: 0.0288897, Train MAE: 0.105917, Val MAE: 0.122253, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0151916, Val Loss: 0.0282597, Train MAE: 0.0936722, Val MAE: 0.120182, lr: [0.001]
Epoch [80/600], Train Loss: 0.0128621, Val Loss: 0.0272405, Train MAE: 0.0856128, Val MAE: 0.115237, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.0122267, Val Loss: 0.0270549, Train MAE: 0.083112, Val MAE: 0.11623, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.0103873, Val Loss: 0.0282488, Train MAE: 0.0757974, Val MAE: 0.119516, lr: [0.0005714286142857141]
^CTraceback (most recent call last):
  File "/home/aribra/jnps/thesis/lattice_error_net/accumulated_training.py", line 129, in <module>
    sample_sizes, accuracies_val, accuracies_train = train_accumulated_datasets(
  File "/home/aribra/jnps/thesis/lattice_error_net/accumulated_training.py", line 72, in train_accumulated_datasets
    training_results = train_model(
  File "/home/aribra/jnps/thesis/lattice_error_net/models/net.py", line 697, in train_model
    for batch_inputs, batch_targets in train_loader:
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 673, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/dataset.py", line 211, in __getitem__
    return tuple(tensor[index] for tensor in self.tensors)
  File "/home/aribra/.conda/envs/py310/lib/python3.10/site-packages/torch/utils/data/dataset.py", line 211, in <genexpr>
    return tuple(tensor[index] for tensor in self.tensors)
KeyboardInterrupt
^C
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 accumulated_training.py; python cross_validation.py 
[?2004l--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-49-48/figs
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-49-48/training
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_08-49-48/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])

Training on dataset 1/10 with 180 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0706128, Val Loss: 0.0759928, Train MAE: 0.211666, Val MAE: 0.217898, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0389277, Val Loss: 0.0472406, Train MAE: 0.156238, Val MAE: 0.171071, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0367197, Val Loss: 0.0457102, Train MAE: 0.151871, Val MAE: 0.16841, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0315486, Val Loss: 0.044739, Train MAE: 0.138748, Val MAE: 0.164551, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0245356, Val Loss: 0.0313621, Train MAE: 0.118136, Val MAE: 0.129527, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0208806, Val Loss: 0.0285097, Train MAE: 0.107339, Val MAE: 0.125658, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0133178, Val Loss: 0.0219144, Train MAE: 0.0849744, Val MAE: 0.109087, lr: [0.001]
Epoch [80/600], Train Loss: 0.011972, Val Loss: 0.0206714, Train MAE: 0.0808994, Val MAE: 0.102958, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.0110859, Val Loss: 0.0198086, Train MAE: 0.0777482, Val MAE: 0.101517, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.00944906, Val Loss: 0.0198942, Train MAE: 0.0704938, Val MAE: 0.101285, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.00903519, Val Loss: 0.0204252, Train MAE: 0.069352, Val MAE: 0.101606, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 0.00904684, Val Loss: 0.019162, Train MAE: 0.0686543, Val MAE: 0.0998853, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 0.00746927, Val Loss: 0.0201929, Train MAE: 0.0624124, Val MAE: 0.101196, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 0.00670535, Val Loss: 0.0211663, Train MAE: 0.0590677, Val MAE: 0.102949, lr: [1e-10]
Epoch [150/600], Train Loss: 0.00657059, Val Loss: 0.0213534, Train MAE: 0.0586235, Val MAE: 0.103139, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 0.00623622, Val Loss: 0.0208396, Train MAE: 0.0569923, Val MAE: 0.102498, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 0.00520439, Val Loss: 0.0189987, Train MAE: 0.0520568, Val MAE: 0.0962442, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.00554984, Val Loss: 0.0162772, Train MAE: 0.0549316, Val MAE: 0.0896446, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.00577075, Val Loss: 0.0170779, Train MAE: 0.0572306, Val MAE: 0.0915886, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.00519898, Val Loss: 0.0140221, Train MAE: 0.052098, Val MAE: 0.0827731, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.0044296, Val Loss: 0.0163066, Train MAE: 0.0475035, Val MAE: 0.0859363, lr: [0.00050000005]
Epoch [220/600], Train Loss: 0.00496827, Val Loss: 0.0148441, Train MAE: 0.0528467, Val MAE: 0.0841108, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 0.00282106, Val Loss: 0.0127403, Train MAE: 0.0397846, Val MAE: 0.0772077, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 0.00268291, Val Loss: 0.0123227, Train MAE: 0.038205, Val MAE: 0.0764691, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 0.00144332, Val Loss: 0.00954745, Train MAE: 0.0276983, Val MAE: 0.063134, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 0.00107775, Val Loss: 0.00825894, Train MAE: 0.0240258, Val MAE: 0.0587485, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 0.000821572, Val Loss: 0.00766439, Train MAE: 0.0212745, Val MAE: 0.0561571, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 0.00066738, Val Loss: 0.00710799, Train MAE: 0.0187853, Val MAE: 0.0532805, lr: [1e-10]
Epoch [290/600], Train Loss: 0.000676664, Val Loss: 0.00703891, Train MAE: 0.0190393, Val MAE: 0.052931, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 0.000668023, Val Loss: 0.00673274, Train MAE: 0.0189796, Val MAE: 0.051319, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 0.000713823, Val Loss: 0.00673536, Train MAE: 0.0195374, Val MAE: 0.0522192, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 0.000803757, Val Loss: 0.00589085, Train MAE: 0.0212591, Val MAE: 0.0484848, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 0.000989628, Val Loss: 0.00640378, Train MAE: 0.0241392, Val MAE: 0.0540559, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 0.000729988, Val Loss: 0.00544962, Train MAE: 0.0203175, Val MAE: 0.0458482, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 0.0010332, Val Loss: 0.00563338, Train MAE: 0.0243743, Val MAE: 0.0486954, lr: [0.000250000075]
Epoch [360/600], Train Loss: 0.000702965, Val Loss: 0.00510176, Train MAE: 0.0203033, Val MAE: 0.0441516, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 0.000372719, Val Loss: 0.00395951, Train MAE: 0.0147144, Val MAE: 0.0376025, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 0.000389309, Val Loss: 0.00380028, Train MAE: 0.015119, Val MAE: 0.0373213, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 0.000371919, Val Loss: 0.00338011, Train MAE: 0.0146306, Val MAE: 0.0344512, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 0.000291914, Val Loss: 0.00337103, Train MAE: 0.0132028, Val MAE: 0.0344224, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 0.000212627, Val Loss: 0.00314812, Train MAE: 0.0110227, Val MAE: 0.0332369, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 0.000194308, Val Loss: 0.00315953, Train MAE: 0.0105911, Val MAE: 0.0331611, lr: [1e-10]
Epoch [430/600], Train Loss: 0.000198222, Val Loss: 0.0031435, Train MAE: 0.0107155, Val MAE: 0.0331045, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 0.000199439, Val Loss: 0.00309534, Train MAE: 0.0106308, Val MAE: 0.0329636, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 0.000215785, Val Loss: 0.00306595, Train MAE: 0.011238, Val MAE: 0.0326968, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 0.000215551, Val Loss: 0.00300408, Train MAE: 0.01129, Val MAE: 0.0324757, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 0.000215241, Val Loss: 0.00294446, Train MAE: 0.0113866, Val MAE: 0.0319874, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 0.000285167, Val Loss: 0.00267917, Train MAE: 0.0128418, Val MAE: 0.0309697, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 0.000320253, Val Loss: 0.00259825, Train MAE: 0.0136482, Val MAE: 0.0302684, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 0.000212945, Val Loss: 0.00245848, Train MAE: 0.0114353, Val MAE: 0.0291987, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 0.000192877, Val Loss: 0.00244377, Train MAE: 0.0109617, Val MAE: 0.0288593, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 0.000159261, Val Loss: 0.00230223, Train MAE: 0.00984873, Val MAE: 0.027788, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 0.000129531, Val Loss: 0.00223962, Train MAE: 0.00892389, Val MAE: 0.0275933, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 0.000136689, Val Loss: 0.00221826, Train MAE: 0.00920088, Val MAE: 0.0274327, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 0.000123865, Val Loss: 0.00217656, Train MAE: 0.00857471, Val MAE: 0.0272326, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 0.000112174, Val Loss: 0.0021639, Train MAE: 0.00823066, Val MAE: 0.0270666, lr: [1e-10]
Epoch [570/600], Train Loss: 0.00011343, Val Loss: 0.00215209, Train MAE: 0.00824987, Val MAE: 0.0270147, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 0.000114063, Val Loss: 0.00215333, Train MAE: 0.0082143, Val MAE: 0.0269223, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 0.000125022, Val Loss: 0.00212307, Train MAE: 0.00870622, Val MAE: 0.0266729, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 0.000117385, Val Loss: 0.0020979, Train MAE: 0.00842148, Val MAE: 0.0267222, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:263: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:275: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:288: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:300: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
Dataset 1 Validation MAE: 0.069514

Training on dataset 2/10 with 360 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0497467, Val Loss: 0.046508, Train MAE: 0.177228, Val MAE: 0.169055, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0390716, Val Loss: 0.045196, Train MAE: 0.155189, Val MAE: 0.166395, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0284756, Val Loss: 0.0308407, Train MAE: 0.124639, Val MAE: 0.127512, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0180547, Val Loss: 0.0216539, Train MAE: 0.0991243, Val MAE: 0.108192, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0159455, Val Loss: 0.0177616, Train MAE: 0.0928217, Val MAE: 0.0965562, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0150131, Val Loss: 0.0187186, Train MAE: 0.0899122, Val MAE: 0.0986467, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0143502, Val Loss: 0.0181632, Train MAE: 0.0885456, Val MAE: 0.0968976, lr: [0.001]
Epoch [80/600], Train Loss: 0.0116318, Val Loss: 0.0164328, Train MAE: 0.0784086, Val MAE: 0.0921431, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.0105844, Val Loss: 0.0146702, Train MAE: 0.074484, Val MAE: 0.0862249, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.00669595, Val Loss: 0.0111123, Train MAE: 0.0596144, Val MAE: 0.0776952, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.00209758, Val Loss: 0.00421294, Train MAE: 0.0337311, Val MAE: 0.045664, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 0.000752006, Val Loss: 0.00135958, Train MAE: 0.0201501, Val MAE: 0.0224305, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 0.000313225, Val Loss: 0.00105017, Train MAE: 0.0130766, Val MAE: 0.0200815, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 0.000259372, Val Loss: 0.000952899, Train MAE: 0.0117017, Val MAE: 0.0182591, lr: [1e-10]
Epoch [150/600], Train Loss: 0.000266558, Val Loss: 0.000899054, Train MAE: 0.0119445, Val MAE: 0.0181298, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 0.00027835, Val Loss: 0.000878188, Train MAE: 0.0122311, Val MAE: 0.0185443, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 0.000297385, Val Loss: 0.000875814, Train MAE: 0.0128429, Val MAE: 0.0184049, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000359974, Val Loss: 0.000981987, Train MAE: 0.01438, Val MAE: 0.0206068, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.000427972, Val Loss: 0.000759331, Train MAE: 0.0157159, Val MAE: 0.019126, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.000757506, Val Loss: 0.000719569, Train MAE: 0.0203654, Val MAE: 0.0173515, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000737154, Val Loss: 0.000966579, Train MAE: 0.0201335, Val MAE: 0.0223971, lr: [0.00050000005]
Epoch [220/600], Train Loss: 0.000371214, Val Loss: 0.000827848, Train MAE: 0.0146164, Val MAE: 0.0185403, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 0.000203216, Val Loss: 0.000388418, Train MAE: 0.0109056, Val MAE: 0.012542, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 0.000140265, Val Loss: 0.000381499, Train MAE: 0.00905887, Val MAE: 0.0126571, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 8.93815e-05, Val Loss: 0.000284338, Train MAE: 0.00716811, Val MAE: 0.0101727, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 6.76653e-05, Val Loss: 0.000223158, Train MAE: 0.00618518, Val MAE: 0.00893914, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 5.73775e-05, Val Loss: 0.000207205, Train MAE: 0.00561753, Val MAE: 0.00855817, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 5.20796e-05, Val Loss: 0.000201199, Train MAE: 0.0053477, Val MAE: 0.0084014, lr: [1e-10]
Epoch [290/600], Train Loss: 5.25921e-05, Val Loss: 0.000195157, Train MAE: 0.00534985, Val MAE: 0.00830413, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 5.53066e-05, Val Loss: 0.000196115, Train MAE: 0.00558654, Val MAE: 0.00839354, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 5.69321e-05, Val Loss: 0.000208537, Train MAE: 0.00565635, Val MAE: 0.00878949, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 7.54051e-05, Val Loss: 0.00021516, Train MAE: 0.00660992, Val MAE: 0.00902033, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 0.000272584, Val Loss: 0.000677612, Train MAE: 0.0121275, Val MAE: 0.0195348, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 6.17023e-05, Val Loss: 0.000194172, Train MAE: 0.00595572, Val MAE: 0.00881709, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 6.58355e-05, Val Loss: 0.000158566, Train MAE: 0.00625721, Val MAE: 0.00807651, lr: [0.000250000075]
Epoch [360/600], Train Loss: 0.000117193, Val Loss: 0.000266519, Train MAE: 0.0082286, Val MAE: 0.0121255, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 4.93153e-05, Val Loss: 0.000141053, Train MAE: 0.00535065, Val MAE: 0.00738377, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 4.83835e-05, Val Loss: 0.000117854, Train MAE: 0.00537044, Val MAE: 0.00734338, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 3.28013e-05, Val Loss: 0.000118604, Train MAE: 0.00435994, Val MAE: 0.00652187, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 2.97495e-05, Val Loss: 0.00010325, Train MAE: 0.0041438, Val MAE: 0.00626445, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 2.59709e-05, Val Loss: 0.000100696, Train MAE: 0.00380252, Val MAE: 0.00614908, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 2.3794e-05, Val Loss: 9.87319e-05, Train MAE: 0.00363944, Val MAE: 0.00596059, lr: [1e-10]
Epoch [430/600], Train Loss: 2.42031e-05, Val Loss: 9.86813e-05, Train MAE: 0.00366904, Val MAE: 0.00601444, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 2.56116e-05, Val Loss: 9.82364e-05, Train MAE: 0.00381419, Val MAE: 0.00599309, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 2.67664e-05, Val Loss: 9.58125e-05, Train MAE: 0.00393876, Val MAE: 0.00600039, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 3.43949e-05, Val Loss: 8.93906e-05, Train MAE: 0.00456263, Val MAE: 0.00613479, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 3.27859e-05, Val Loss: 0.000102706, Train MAE: 0.00448009, Val MAE: 0.00637385, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 4.81547e-05, Val Loss: 0.000154552, Train MAE: 0.00521879, Val MAE: 0.00864275, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 0.000194835, Val Loss: 0.000171503, Train MAE: 0.0101833, Val MAE: 0.00924584, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.6606e-05, Val Loss: 9.61386e-05, Train MAE: 0.00394906, Val MAE: 0.0063498, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 2.05438e-05, Val Loss: 7.68488e-05, Train MAE: 0.00350904, Val MAE: 0.00558948, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.65685e-05, Val Loss: 6.90674e-05, Train MAE: 0.00311949, Val MAE: 0.0050052, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 1.70921e-05, Val Loss: 7.59906e-05, Train MAE: 0.00321943, Val MAE: 0.00537109, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 1.41582e-05, Val Loss: 6.56568e-05, Train MAE: 0.00287465, Val MAE: 0.00476728, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 1.29119e-05, Val Loss: 6.38178e-05, Train MAE: 0.00273879, Val MAE: 0.00467064, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.17156e-05, Val Loss: 6.16656e-05, Train MAE: 0.00258754, Val MAE: 0.00458552, lr: [1e-10]
Epoch [570/600], Train Loss: 1.18933e-05, Val Loss: 6.25605e-05, Train MAE: 0.00261725, Val MAE: 0.00460316, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 1.23556e-05, Val Loss: 6.34637e-05, Train MAE: 0.00267025, Val MAE: 0.00461782, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 1.26272e-05, Val Loss: 5.99362e-05, Train MAE: 0.00271668, Val MAE: 0.00459444, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 1.53291e-05, Val Loss: 5.86299e-05, Train MAE: 0.00302377, Val MAE: 0.00465097, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 2 Validation MAE: 0.030059

Training on dataset 3/10 with 540 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0474102, Val Loss: 0.0457319, Train MAE: 0.173463, Val MAE: 0.166545, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0360621, Val Loss: 0.0334656, Train MAE: 0.145688, Val MAE: 0.136638, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0165969, Val Loss: 0.0174602, Train MAE: 0.0939636, Val MAE: 0.0957309, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0244978, Val Loss: 0.0256756, Train MAE: 0.115973, Val MAE: 0.116667, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0140838, Val Loss: 0.017338, Train MAE: 0.0863187, Val MAE: 0.0953787, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0137379, Val Loss: 0.0164932, Train MAE: 0.0861429, Val MAE: 0.0947038, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0117474, Val Loss: 0.014477, Train MAE: 0.079475, Val MAE: 0.0887792, lr: [0.001]
Epoch [80/600], Train Loss: 0.00726317, Val Loss: 0.00865036, Train MAE: 0.0625934, Val MAE: 0.065925, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.00325522, Val Loss: 0.00360722, Train MAE: 0.0416301, Val MAE: 0.0442923, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.000474589, Val Loss: 0.000836122, Train MAE: 0.0164103, Val MAE: 0.02026, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.000267198, Val Loss: 0.000449497, Train MAE: 0.0122809, Val MAE: 0.015459, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 0.000248842, Val Loss: 0.000307472, Train MAE: 0.011884, Val MAE: 0.0127752, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 0.000137568, Val Loss: 0.000225356, Train MAE: 0.00859959, Val MAE: 0.0103054, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 0.000120532, Val Loss: 0.000203977, Train MAE: 0.00802763, Val MAE: 0.009828, lr: [1e-10]
Epoch [150/600], Train Loss: 0.000119656, Val Loss: 0.000205234, Train MAE: 0.00802808, Val MAE: 0.00984312, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 0.00012194, Val Loss: 0.000200694, Train MAE: 0.00820965, Val MAE: 0.00997776, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 0.000139812, Val Loss: 0.000244204, Train MAE: 0.00892353, Val MAE: 0.0115635, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000344009, Val Loss: 0.000384161, Train MAE: 0.0140169, Val MAE: 0.0145786, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.00112079, Val Loss: 0.00213467, Train MAE: 0.0243945, Val MAE: 0.0352222, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.000521743, Val Loss: 0.000487335, Train MAE: 0.0172728, Val MAE: 0.016227, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.00025084, Val Loss: 0.000240858, Train MAE: 0.0120561, Val MAE: 0.0120277, lr: [0.00050000005]
Epoch [220/600], Train Loss: 0.000200233, Val Loss: 0.000290079, Train MAE: 0.0107348, Val MAE: 0.0134413, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 0.000251668, Val Loss: 0.000223003, Train MAE: 0.0115627, Val MAE: 0.0116611, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 0.000110712, Val Loss: 0.00014032, Train MAE: 0.0081228, Val MAE: 0.00903661, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 4.6899e-05, Val Loss: 5.97202e-05, Train MAE: 0.00518372, Val MAE: 0.00577346, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 3.2048e-05, Val Loss: 5.14831e-05, Train MAE: 0.00419435, Val MAE: 0.00516551, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 2.5476e-05, Val Loss: 3.98456e-05, Train MAE: 0.0036659, Val MAE: 0.00448072, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 2.23288e-05, Val Loss: 3.66662e-05, Train MAE: 0.0033871, Val MAE: 0.00423337, lr: [1e-10]
Epoch [290/600], Train Loss: 2.32639e-05, Val Loss: 3.68689e-05, Train MAE: 0.00348116, Val MAE: 0.00427726, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.47435e-05, Val Loss: 3.65341e-05, Train MAE: 0.00365282, Val MAE: 0.00432302, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 2.66029e-05, Val Loss: 4.23042e-05, Train MAE: 0.00388544, Val MAE: 0.00471679, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 5.17597e-05, Val Loss: 7.44847e-05, Train MAE: 0.00550232, Val MAE: 0.00655677, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 4.57805e-05, Val Loss: 4.0362e-05, Train MAE: 0.00512357, Val MAE: 0.00474484, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 5.54942e-05, Val Loss: 4.53705e-05, Train MAE: 0.0056075, Val MAE: 0.00515701, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 0.000124458, Val Loss: 0.000124297, Train MAE: 0.0081355, Val MAE: 0.00798094, lr: [0.000250000075]
Epoch [360/600], Train Loss: 7.08867e-05, Val Loss: 0.000104991, Train MAE: 0.00621194, Val MAE: 0.00775266, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 1.35401e-05, Val Loss: 2.00102e-05, Train MAE: 0.00279376, Val MAE: 0.00336947, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.14141e-05, Val Loss: 1.70061e-05, Train MAE: 0.00259359, Val MAE: 0.00303628, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 8.8145e-06, Val Loss: 1.53782e-05, Train MAE: 0.00223406, Val MAE: 0.00285856, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 6.99924e-06, Val Loss: 1.14982e-05, Train MAE: 0.00201104, Val MAE: 0.00246353, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 6.29146e-06, Val Loss: 1.08681e-05, Train MAE: 0.00190666, Val MAE: 0.00238678, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 4.8775e-06, Val Loss: 1.00525e-05, Train MAE: 0.00164747, Val MAE: 0.00225554, lr: [1e-10]
Epoch [430/600], Train Loss: 5.05858e-06, Val Loss: 9.84614e-06, Train MAE: 0.00169189, Val MAE: 0.00223837, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 5.39412e-06, Val Loss: 1.02699e-05, Train MAE: 0.00175053, Val MAE: 0.00231994, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 6.10467e-06, Val Loss: 1.03678e-05, Train MAE: 0.00189226, Val MAE: 0.0024011, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 1.35998e-05, Val Loss: 1.34327e-05, Train MAE: 0.0028193, Val MAE: 0.00282252, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 7.82821e-05, Val Loss: 6.87468e-05, Train MAE: 0.00629654, Val MAE: 0.00596887, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 9.15694e-06, Val Loss: 2.19305e-05, Train MAE: 0.00228361, Val MAE: 0.00345662, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 2.03867e-05, Val Loss: 2.01697e-05, Train MAE: 0.00328372, Val MAE: 0.00336999, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 5.08327e-06, Val Loss: 7.32714e-06, Train MAE: 0.00174505, Val MAE: 0.00198845, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 5.46684e-06, Val Loss: 6.87774e-06, Train MAE: 0.00175845, Val MAE: 0.00197051, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 2.82076e-06, Val Loss: 6.93883e-06, Train MAE: 0.00130272, Val MAE: 0.00195927, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 2.28378e-06, Val Loss: 4.66611e-06, Train MAE: 0.00117878, Val MAE: 0.00155085, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 1.9874e-06, Val Loss: 3.87887e-06, Train MAE: 0.001069, Val MAE: 0.00142064, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 1.70943e-06, Val Loss: 3.95593e-06, Train MAE: 0.000997876, Val MAE: 0.00139331, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.28795e-06, Val Loss: 3.50554e-06, Train MAE: 0.000868166, Val MAE: 0.00130877, lr: [1e-10]
Epoch [570/600], Train Loss: 1.36929e-06, Val Loss: 3.54185e-06, Train MAE: 0.000901707, Val MAE: 0.00132445, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 1.59066e-06, Val Loss: 3.98531e-06, Train MAE: 0.000968502, Val MAE: 0.00139052, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 1.85125e-06, Val Loss: 3.66515e-06, Train MAE: 0.00104958, Val MAE: 0.00136062, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 2.53401e-06, Val Loss: 4.5884e-06, Train MAE: 0.00122093, Val MAE: 0.00155513, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 3 Validation MAE: 0.022461

Training on dataset 4/10 with 720 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0460303, Val Loss: 0.0451059, Train MAE: 0.170642, Val MAE: 0.166011, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0303072, Val Loss: 0.0328013, Train MAE: 0.12978, Val MAE: 0.134355, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0169665, Val Loss: 0.017513, Train MAE: 0.0960916, Val MAE: 0.0962624, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.014474, Val Loss: 0.0165094, Train MAE: 0.0872355, Val MAE: 0.0943928, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0144712, Val Loss: 0.0159019, Train MAE: 0.0894216, Val MAE: 0.0928227, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0123593, Val Loss: 0.0150891, Train MAE: 0.0817445, Val MAE: 0.0903364, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.00977789, Val Loss: 0.0108492, Train MAE: 0.0716324, Val MAE: 0.0751452, lr: [0.001]
Epoch [80/600], Train Loss: 0.00385441, Val Loss: 0.00373502, Train MAE: 0.0442531, Val MAE: 0.0443274, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000776403, Val Loss: 0.000390917, Train MAE: 0.0203355, Val MAE: 0.014686, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.00031888, Val Loss: 0.000262692, Train MAE: 0.0132561, Val MAE: 0.0124121, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.000169565, Val Loss: 0.000180224, Train MAE: 0.00979031, Val MAE: 0.010082, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 0.000114308, Val Loss: 0.000141977, Train MAE: 0.00812564, Val MAE: 0.00893088, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 7.32236e-05, Val Loss: 7.61694e-05, Train MAE: 0.00632324, Val MAE: 0.00626878, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 5.19044e-05, Val Loss: 6.79054e-05, Train MAE: 0.00518604, Val MAE: 0.00590103, lr: [1e-10]
Epoch [150/600], Train Loss: 5.41944e-05, Val Loss: 6.67649e-05, Train MAE: 0.005376, Val MAE: 0.00587109, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 6.28749e-05, Val Loss: 6.60802e-05, Train MAE: 0.00593887, Val MAE: 0.00600638, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 8.54007e-05, Val Loss: 0.000147789, Train MAE: 0.00701263, Val MAE: 0.009333, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000119086, Val Loss: 0.00011581, Train MAE: 0.00813726, Val MAE: 0.00829144, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.000156744, Val Loss: 0.00018578, Train MAE: 0.00915739, Val MAE: 0.0101487, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.00014146, Val Loss: 0.000119163, Train MAE: 0.00885298, Val MAE: 0.00840261, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000347725, Val Loss: 0.000201318, Train MAE: 0.0132085, Val MAE: 0.0106666, lr: [0.00050000005]
Epoch [220/600], Train Loss: 0.000192946, Val Loss: 0.000200228, Train MAE: 0.010459, Val MAE: 0.0107306, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 3.82174e-05, Val Loss: 3.64707e-05, Train MAE: 0.00472035, Val MAE: 0.00462704, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 2.07667e-05, Val Loss: 4.30827e-05, Train MAE: 0.00345046, Val MAE: 0.00494661, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.42727e-05, Val Loss: 1.30709e-05, Train MAE: 0.00284405, Val MAE: 0.00271059, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.15823e-05, Val Loss: 1.05339e-05, Train MAE: 0.00255748, Val MAE: 0.00240417, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 6.27575e-06, Val Loss: 8.54352e-06, Train MAE: 0.00191642, Val MAE: 0.00215318, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.66335e-06, Val Loss: 7.41234e-06, Train MAE: 0.00163836, Val MAE: 0.00199064, lr: [1e-10]
Epoch [290/600], Train Loss: 4.85362e-06, Val Loss: 7.59225e-06, Train MAE: 0.00167244, Val MAE: 0.00203435, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 6.02187e-06, Val Loss: 9.30122e-06, Train MAE: 0.00189423, Val MAE: 0.00232862, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 1.19077e-05, Val Loss: 1.47689e-05, Train MAE: 0.00263979, Val MAE: 0.00277576, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.23065e-05, Val Loss: 1.40412e-05, Train MAE: 0.00271523, Val MAE: 0.00281407, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.21243e-05, Val Loss: 1.18039e-05, Train MAE: 0.00263689, Val MAE: 0.00257205, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 2.26024e-05, Val Loss: 1.55223e-05, Train MAE: 0.00349076, Val MAE: 0.00306916, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 2.92078e-05, Val Loss: 5.60984e-05, Train MAE: 0.00402813, Val MAE: 0.00607065, lr: [0.000250000075]
Epoch [360/600], Train Loss: 5.94011e-06, Val Loss: 4.87509e-06, Train MAE: 0.00181806, Val MAE: 0.00163062, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 1.06883e-05, Val Loss: 5.09911e-06, Train MAE: 0.00251378, Val MAE: 0.00167825, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.01408e-05, Val Loss: 5.99221e-06, Train MAE: 0.00240641, Val MAE: 0.00178617, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 2.26819e-06, Val Loss: 3.46104e-06, Train MAE: 0.00116026, Val MAE: 0.00137812, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 1.97564e-06, Val Loss: 2.56774e-06, Train MAE: 0.00106241, Val MAE: 0.00115279, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 1.30142e-06, Val Loss: 1.96875e-06, Train MAE: 0.000852961, Val MAE: 0.000991673, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 8.97496e-07, Val Loss: 1.68571e-06, Train MAE: 0.000706584, Val MAE: 0.000880537, lr: [1e-10]
Epoch [430/600], Train Loss: 1.04862e-06, Val Loss: 1.64103e-06, Train MAE: 0.000758551, Val MAE: 0.00087308, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.56458e-06, Val Loss: 2.39539e-06, Train MAE: 0.000947509, Val MAE: 0.00106245, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 8.21656e-06, Val Loss: 4.32244e-06, Train MAE: 0.00207365, Val MAE: 0.00157394, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.55475e-06, Val Loss: 2.12911e-06, Train MAE: 0.00117715, Val MAE: 0.00102391, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 6.18483e-06, Val Loss: 6.18163e-06, Train MAE: 0.00184979, Val MAE: 0.0018594, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 2.58278e-05, Val Loss: 3.31849e-05, Train MAE: 0.00388729, Val MAE: 0.0045842, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 1.96675e-05, Val Loss: 2.83571e-05, Train MAE: 0.00321402, Val MAE: 0.00396878, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 8.03572e-06, Val Loss: 7.47013e-06, Train MAE: 0.00209124, Val MAE: 0.00197516, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 3.74404e-06, Val Loss: 4.87583e-06, Train MAE: 0.00147154, Val MAE: 0.00159939, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.93543e-06, Val Loss: 1.86382e-06, Train MAE: 0.00104592, Val MAE: 0.000970579, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 1.50843e-06, Val Loss: 2.46431e-06, Train MAE: 0.000893596, Val MAE: 0.00111585, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 1.24308e-06, Val Loss: 1.53353e-06, Train MAE: 0.000839916, Val MAE: 0.000863334, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 7.26267e-07, Val Loss: 1.26624e-06, Train MAE: 0.00063244, Val MAE: 0.00076311, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 5.41279e-07, Val Loss: 1.11157e-06, Train MAE: 0.000545594, Val MAE: 0.000691892, lr: [1e-10]
Epoch [570/600], Train Loss: 6.22068e-07, Val Loss: 1.14628e-06, Train MAE: 0.000586758, Val MAE: 0.000712283, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 9.05005e-07, Val Loss: 1.27499e-06, Train MAE: 0.000721856, Val MAE: 0.000764527, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 2.01149e-06, Val Loss: 3.62819e-06, Train MAE: 0.00106056, Val MAE: 0.00146855, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 1.3294e-06, Val Loss: 1.69726e-06, Train MAE: 0.000880159, Val MAE: 0.000940588, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 4 Validation MAE: 0.018906

Training on dataset 5/10 with 900 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0456876, Val Loss: 0.0446397, Train MAE: 0.169784, Val MAE: 0.165118, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0286022, Val Loss: 0.0297505, Train MAE: 0.126403, Val MAE: 0.126678, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0160431, Val Loss: 0.0188788, Train MAE: 0.0923479, Val MAE: 0.100206, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.014796, Val Loss: 0.0161835, Train MAE: 0.0891, Val MAE: 0.0924146, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0136981, Val Loss: 0.0147806, Train MAE: 0.0859071, Val MAE: 0.0879661, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.0113163, Val Loss: 0.012134, Train MAE: 0.0758741, Val MAE: 0.0767577, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0016083, Val Loss: 0.00439414, Train MAE: 0.0296499, Val MAE: 0.0497845, lr: [0.001]
Epoch [80/600], Train Loss: 0.00055438, Val Loss: 0.000600165, Train MAE: 0.0171646, Val MAE: 0.0180976, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.00019719, Val Loss: 0.000199916, Train MAE: 0.0104644, Val MAE: 0.0105736, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.000195815, Val Loss: 0.000170585, Train MAE: 0.0104007, Val MAE: 0.00993509, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 7.5216e-05, Val Loss: 0.000111203, Train MAE: 0.00640392, Val MAE: 0.0080874, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 5.39979e-05, Val Loss: 7.05162e-05, Train MAE: 0.00546074, Val MAE: 0.006399, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 3.9217e-05, Val Loss: 3.93233e-05, Train MAE: 0.00465626, Val MAE: 0.00452852, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 2.6359e-05, Val Loss: 3.46171e-05, Train MAE: 0.00364621, Val MAE: 0.00413953, lr: [1e-10]
Epoch [150/600], Train Loss: 2.9391e-05, Val Loss: 3.54085e-05, Train MAE: 0.00398866, Val MAE: 0.00427567, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 4.56941e-05, Val Loss: 4.13928e-05, Train MAE: 0.00509972, Val MAE: 0.00490953, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 5.78677e-05, Val Loss: 8.55852e-05, Train MAE: 0.00575214, Val MAE: 0.00714936, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000176511, Val Loss: 7.2797e-05, Train MAE: 0.00978527, Val MAE: 0.00644657, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 6.54122e-05, Val Loss: 0.000108718, Train MAE: 0.00596696, Val MAE: 0.00809733, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 4.45032e-05, Val Loss: 0.000196791, Train MAE: 0.00504014, Val MAE: 0.010308, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.00011434, Val Loss: 8.9362e-05, Train MAE: 0.00800753, Val MAE: 0.00734677, lr: [0.00050000005]
Epoch [220/600], Train Loss: 6.82227e-05, Val Loss: 3.63954e-05, Train MAE: 0.00581962, Val MAE: 0.00448294, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.2643e-05, Val Loss: 1.46031e-05, Train MAE: 0.0027144, Val MAE: 0.00291871, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 4.48228e-06, Val Loss: 4.83581e-06, Train MAE: 0.00159629, Val MAE: 0.00165292, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 3.5681e-06, Val Loss: 7.73899e-06, Train MAE: 0.00141763, Val MAE: 0.00223411, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 2.90767e-06, Val Loss: 2.15615e-06, Train MAE: 0.00128109, Val MAE: 0.00106549, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 1.19702e-06, Val Loss: 1.54973e-06, Train MAE: 0.000812082, Val MAE: 0.000903614, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 7.07173e-07, Val Loss: 1.15852e-06, Train MAE: 0.000618991, Val MAE: 0.000722338, lr: [1e-10]
Epoch [290/600], Train Loss: 8.38213e-07, Val Loss: 1.29059e-06, Train MAE: 0.000680747, Val MAE: 0.000775556, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 4.51119e-06, Val Loss: 4.87495e-06, Train MAE: 0.00157107, Val MAE: 0.00158955, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 6.55131e-06, Val Loss: 5.17005e-06, Train MAE: 0.00180303, Val MAE: 0.00164125, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 2.3546e-05, Val Loss: 1.08174e-05, Train MAE: 0.00367831, Val MAE: 0.00256143, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 4.04739e-05, Val Loss: 4.75384e-05, Train MAE: 0.00469566, Val MAE: 0.00512282, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 1.65328e-06, Val Loss: 1.66173e-06, Train MAE: 0.000962276, Val MAE: 0.000925116, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 9.17822e-06, Val Loss: 1.27215e-05, Train MAE: 0.00220947, Val MAE: 0.00246732, lr: [0.000250000075]
Epoch [360/600], Train Loss: 7.37109e-06, Val Loss: 1.15798e-05, Train MAE: 0.00200475, Val MAE: 0.00249785, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 9.73798e-06, Val Loss: 4.90779e-06, Train MAE: 0.00225261, Val MAE: 0.00165914, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 2.8693e-06, Val Loss: 3.0807e-06, Train MAE: 0.00125043, Val MAE: 0.0013218, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 2.29047e-06, Val Loss: 3.12213e-06, Train MAE: 0.00114062, Val MAE: 0.00134933, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 2.68713e-06, Val Loss: 2.29823e-06, Train MAE: 0.00121233, Val MAE: 0.00106983, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 6.23473e-07, Val Loss: 7.31717e-07, Train MAE: 0.000587905, Val MAE: 0.000594698, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 3.63742e-07, Val Loss: 6.42731e-07, Train MAE: 0.000444522, Val MAE: 0.000536542, lr: [1e-10]
Epoch [430/600], Train Loss: 4.41472e-07, Val Loss: 7.01842e-07, Train MAE: 0.000492874, Val MAE: 0.00055918, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 8.48845e-07, Val Loss: 1.33503e-06, Train MAE: 0.000689215, Val MAE: 0.000869746, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.84587e-06, Val Loss: 2.35929e-06, Train MAE: 0.00101377, Val MAE: 0.00109662, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 1.0233e-05, Val Loss: 6.51985e-06, Train MAE: 0.00222375, Val MAE: 0.00191342, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 1.29132e-05, Val Loss: 4.14787e-05, Train MAE: 0.00258581, Val MAE: 0.00482492, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 5.21386e-06, Val Loss: 9.58484e-06, Train MAE: 0.00165807, Val MAE: 0.00234924, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 4.63965e-06, Val Loss: 4.83772e-06, Train MAE: 0.00158753, Val MAE: 0.00170941, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.51706e-06, Val Loss: 5.95052e-06, Train MAE: 0.00121074, Val MAE: 0.0019903, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 1.76969e-06, Val Loss: 1.0967e-06, Train MAE: 0.00100592, Val MAE: 0.000763335, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.05739e-06, Val Loss: 9.91618e-07, Train MAE: 0.000751449, Val MAE: 0.000713457, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 7.92083e-07, Val Loss: 8.69206e-07, Train MAE: 0.000675805, Val MAE: 0.000686403, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 5.35247e-07, Val Loss: 7.39403e-07, Train MAE: 0.000552122, Val MAE: 0.000619979, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 3.29087e-07, Val Loss: 5.09719e-07, Train MAE: 0.000429739, Val MAE: 0.000496128, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 2.45906e-07, Val Loss: 4.52716e-07, Train MAE: 0.000365773, Val MAE: 0.000452608, lr: [1e-10]
Epoch [570/600], Train Loss: 2.91489e-07, Val Loss: 4.92974e-07, Train MAE: 0.000402708, Val MAE: 0.000490733, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 5.26189e-07, Val Loss: 8.80945e-07, Train MAE: 0.000551809, Val MAE: 0.000688628, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 5.58971e-07, Val Loss: 8.37156e-07, Train MAE: 0.000574406, Val MAE: 0.000681526, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 9.80609e-07, Val Loss: 7.40382e-07, Train MAE: 0.000746443, Val MAE: 0.000626857, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 5 Validation MAE: 0.016188

Training on dataset 6/10 with 1080 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0455092, Val Loss: 0.0441264, Train MAE: 0.16954, Val MAE: 0.164196, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0205836, Val Loss: 0.0178217, Train MAE: 0.108053, Val MAE: 0.0967733, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0153644, Val Loss: 0.0163009, Train MAE: 0.0906562, Val MAE: 0.0926961, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0142103, Val Loss: 0.0162292, Train MAE: 0.0877858, Val MAE: 0.0944228, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.0113974, Val Loss: 0.0125454, Train MAE: 0.078679, Val MAE: 0.0818204, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.00154614, Val Loss: 0.00115301, Train MAE: 0.0287159, Val MAE: 0.0251298, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000813434, Val Loss: 0.000729475, Train MAE: 0.021074, Val MAE: 0.0207313, lr: [0.001]
Epoch [80/600], Train Loss: 0.00061685, Val Loss: 0.000281998, Train MAE: 0.0182558, Val MAE: 0.0125253, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000105056, Val Loss: 0.000120769, Train MAE: 0.00776432, Val MAE: 0.00803594, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.000124445, Val Loss: 0.000109616, Train MAE: 0.00838675, Val MAE: 0.00805757, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 8.54642e-05, Val Loss: 9.39848e-05, Train MAE: 0.00707453, Val MAE: 0.00725057, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 5.46444e-05, Val Loss: 5.15367e-05, Train MAE: 0.00557249, Val MAE: 0.00547077, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 2.2159e-05, Val Loss: 2.7223e-05, Train MAE: 0.00349787, Val MAE: 0.00380054, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 1.50865e-05, Val Loss: 2.03451e-05, Train MAE: 0.00281985, Val MAE: 0.0032178, lr: [1e-10]
Epoch [150/600], Train Loss: 1.60443e-05, Val Loss: 2.16104e-05, Train MAE: 0.00295479, Val MAE: 0.00337389, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 3.86818e-05, Val Loss: 5.38611e-05, Train MAE: 0.00467305, Val MAE: 0.00538562, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 2.54241e-05, Val Loss: 4.04694e-05, Train MAE: 0.00388701, Val MAE: 0.00485563, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 9.1914e-05, Val Loss: 7.58934e-05, Train MAE: 0.00718404, Val MAE: 0.00658337, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.000247808, Val Loss: 0.000269836, Train MAE: 0.0114189, Val MAE: 0.0119999, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 2.86431e-05, Val Loss: 0.00016882, Train MAE: 0.00394524, Val MAE: 0.00958957, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 2.0573e-05, Val Loss: 5.25259e-05, Train MAE: 0.00334806, Val MAE: 0.00521005, lr: [0.00050000005]
Epoch [220/600], Train Loss: 0.00033402, Val Loss: 0.00019964, Train MAE: 0.0129623, Val MAE: 0.0105904, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.80782e-05, Val Loss: 2.89882e-05, Train MAE: 0.00312011, Val MAE: 0.00388479, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 3.03546e-05, Val Loss: 7.08911e-05, Train MAE: 0.00403677, Val MAE: 0.0064307, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 5.13369e-06, Val Loss: 4.53756e-06, Train MAE: 0.0017118, Val MAE: 0.00157551, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.72039e-06, Val Loss: 2.2148e-06, Train MAE: 0.000990303, Val MAE: 0.00100005, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 1.05862e-06, Val Loss: 1.42103e-06, Train MAE: 0.000772863, Val MAE: 0.000846964, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 6.26505e-07, Val Loss: 1.06444e-06, Train MAE: 0.000586053, Val MAE: 0.000692566, lr: [1e-10]
Epoch [290/600], Train Loss: 7.80718e-07, Val Loss: 1.32491e-06, Train MAE: 0.000656577, Val MAE: 0.000763069, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.06817e-06, Val Loss: 1.85683e-06, Train MAE: 0.0010698, Val MAE: 0.001043, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 9.0961e-06, Val Loss: 2.44417e-05, Train MAE: 0.00218833, Val MAE: 0.00365284, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 2.56198e-05, Val Loss: 3.08942e-05, Train MAE: 0.00358138, Val MAE: 0.00402698, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.02861e-05, Val Loss: 1.27039e-05, Train MAE: 0.0023252, Val MAE: 0.0027055, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 2.73408e-05, Val Loss: 4.23486e-05, Train MAE: 0.0038127, Val MAE: 0.00467329, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 1.82586e-05, Val Loss: 1.63789e-05, Train MAE: 0.00319221, Val MAE: 0.0029993, lr: [0.000250000075]
Epoch [360/600], Train Loss: 5.07337e-06, Val Loss: 9.38127e-06, Train MAE: 0.00167656, Val MAE: 0.00228442, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 5.03539e-06, Val Loss: 6.42586e-06, Train MAE: 0.00165759, Val MAE: 0.00184509, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.25676e-06, Val Loss: 1.32678e-06, Train MAE: 0.00084735, Val MAE: 0.000848487, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 2.41147e-06, Val Loss: 3.00914e-06, Train MAE: 0.00119215, Val MAE: 0.00132842, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 1.17364e-06, Val Loss: 2.59052e-06, Train MAE: 0.000807348, Val MAE: 0.00121996, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 6.61194e-07, Val Loss: 7.81132e-07, Train MAE: 0.000616672, Val MAE: 0.000621447, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 3.97248e-07, Val Loss: 6.94708e-07, Train MAE: 0.000462734, Val MAE: 0.000557482, lr: [1e-10]
Epoch [430/600], Train Loss: 5.19545e-07, Val Loss: 7.61297e-07, Train MAE: 0.000538319, Val MAE: 0.000599479, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 2.73372e-06, Val Loss: 3.18676e-06, Train MAE: 0.00120564, Val MAE: 0.00139279, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.62924e-06, Val Loss: 1.09925e-06, Train MAE: 0.000959798, Val MAE: 0.000764397, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 3.16075e-06, Val Loss: 3.22084e-06, Train MAE: 0.00133046, Val MAE: 0.00131117, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 1.77534e-06, Val Loss: 2.21084e-06, Train MAE: 0.00100062, Val MAE: 0.00113669, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 4.58957e-06, Val Loss: 3.57266e-06, Train MAE: 0.00153147, Val MAE: 0.00133378, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 1.76984e-05, Val Loss: 1.14264e-05, Train MAE: 0.00297825, Val MAE: 0.00244387, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.05325e-06, Val Loss: 1.37009e-06, Train MAE: 0.00109232, Val MAE: 0.000876856, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 2.43724e-06, Val Loss: 2.1532e-06, Train MAE: 0.00116426, Val MAE: 0.00112077, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 6.29238e-07, Val Loss: 9.03823e-07, Train MAE: 0.000605404, Val MAE: 0.000710316, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 5.75591e-07, Val Loss: 7.84383e-07, Train MAE: 0.000572366, Val MAE: 0.000669062, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 4.48624e-07, Val Loss: 5.73069e-07, Train MAE: 0.000507674, Val MAE: 0.000520313, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 3.57733e-07, Val Loss: 5.34436e-07, Train MAE: 0.000446896, Val MAE: 0.000503538, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 2.6708e-07, Val Loss: 4.72153e-07, Train MAE: 0.000382238, Val MAE: 0.000456723, lr: [1e-10]
Epoch [570/600], Train Loss: 3.13114e-07, Val Loss: 5.03343e-07, Train MAE: 0.000413818, Val MAE: 0.000480154, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 5.91067e-07, Val Loss: 1.32745e-06, Train MAE: 0.000570754, Val MAE: 0.000807099, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 6.68571e-07, Val Loss: 8.55181e-07, Train MAE: 0.000624986, Val MAE: 0.000677192, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 6.01416e-07, Val Loss: 7.65877e-07, Train MAE: 0.000587858, Val MAE: 0.000651158, lr: [3.571438214285713e-05]
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:254: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=(10,5))
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 6 Validation MAE: 0.014378

Training on dataset 7/10 with 1260 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0456826, Val Loss: 0.0443801, Train MAE: 0.169694, Val MAE: 0.164515, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0166309, Val Loss: 0.0166111, Train MAE: 0.0944472, Val MAE: 0.0936032, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.01592, Val Loss: 0.0159853, Train MAE: 0.0931506, Val MAE: 0.0921779, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0132565, Val Loss: 0.0125933, Train MAE: 0.0867303, Val MAE: 0.0836483, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.00461306, Val Loss: 0.00401931, Train MAE: 0.0490769, Val MAE: 0.0433393, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.000880193, Val Loss: 0.000327007, Train MAE: 0.0214904, Val MAE: 0.0134086, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.00161251, Val Loss: 0.000524206, Train MAE: 0.0281195, Val MAE: 0.0171443, lr: [0.001]
Epoch [80/600], Train Loss: 0.000194828, Val Loss: 0.00058046, Train MAE: 0.0105055, Val MAE: 0.0182771, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000128291, Val Loss: 0.000160686, Train MAE: 0.00863403, Val MAE: 0.00943244, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.000116056, Val Loss: 8.54183e-05, Train MAE: 0.00805431, Val MAE: 0.0070373, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 7.94082e-05, Val Loss: 7.47736e-05, Train MAE: 0.00651929, Val MAE: 0.00686268, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 3.98851e-05, Val Loss: 2.28699e-05, Train MAE: 0.00466171, Val MAE: 0.00345018, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 1.0696e-05, Val Loss: 1.74684e-05, Train MAE: 0.00244479, Val MAE: 0.00289341, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 6.4581e-06, Val Loss: 9.58824e-06, Train MAE: 0.00183446, Val MAE: 0.00208976, lr: [1e-10]
Epoch [150/600], Train Loss: 7.4496e-06, Val Loss: 9.50016e-06, Train MAE: 0.00203057, Val MAE: 0.0022247, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 4.47817e-05, Val Loss: 1.93531e-05, Train MAE: 0.00482718, Val MAE: 0.00327045, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 0.000213145, Val Loss: 0.000667302, Train MAE: 0.00970025, Val MAE: 0.0184591, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 9.90736e-05, Val Loss: 4.6792e-05, Train MAE: 0.00713796, Val MAE: 0.00507611, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 4.03054e-05, Val Loss: 3.07843e-05, Train MAE: 0.0047769, Val MAE: 0.00419951, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 6.16176e-05, Val Loss: 8.21647e-05, Train MAE: 0.00532019, Val MAE: 0.00611497, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000127643, Val Loss: 4.95563e-05, Train MAE: 0.00806866, Val MAE: 0.00507755, lr: [0.00050000005]
Epoch [220/600], Train Loss: 2.7917e-05, Val Loss: 2.61114e-05, Train MAE: 0.00385271, Val MAE: 0.00402113, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.89232e-05, Val Loss: 9.54017e-06, Train MAE: 0.00312075, Val MAE: 0.00222684, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 3.63085e-05, Val Loss: 7.83708e-05, Train MAE: 0.00419909, Val MAE: 0.00589802, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 3.43154e-06, Val Loss: 2.71426e-06, Train MAE: 0.00135692, Val MAE: 0.00113478, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.61628e-06, Val Loss: 1.82874e-06, Train MAE: 0.000947649, Val MAE: 0.000933344, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 9.85109e-07, Val Loss: 1.24968e-06, Train MAE: 0.000742337, Val MAE: 0.000794586, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 5.58716e-07, Val Loss: 9.13165e-07, Train MAE: 0.000540472, Val MAE: 0.000631064, lr: [1e-10]
Epoch [290/600], Train Loss: 9.02828e-07, Val Loss: 1.45926e-06, Train MAE: 0.000702885, Val MAE: 0.000828213, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 5.21506e-06, Val Loss: 5.19808e-06, Train MAE: 0.00165434, Val MAE: 0.00161455, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 1.83432e-05, Val Loss: 1.61981e-05, Train MAE: 0.00298949, Val MAE: 0.00311261, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 4.87209e-05, Val Loss: 4.34508e-06, Train MAE: 0.00477025, Val MAE: 0.00151075, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 6.57157e-06, Val Loss: 3.20602e-06, Train MAE: 0.00187112, Val MAE: 0.00129292, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 8.3136e-06, Val Loss: 6.53677e-06, Train MAE: 0.00213554, Val MAE: 0.00186751, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 3.84914e-06, Val Loss: 5.72704e-06, Train MAE: 0.00147154, Val MAE: 0.00183351, lr: [0.000250000075]
Epoch [360/600], Train Loss: 2.05128e-06, Val Loss: 1.99822e-06, Train MAE: 0.00106684, Val MAE: 0.00102225, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 2.02667e-06, Val Loss: 3.2846e-06, Train MAE: 0.00108574, Val MAE: 0.00143354, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 6.07258e-06, Val Loss: 6.37623e-06, Train MAE: 0.00182339, Val MAE: 0.00181015, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 3.79536e-06, Val Loss: 5.15745e-06, Train MAE: 0.00140272, Val MAE: 0.00161487, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 1.13353e-06, Val Loss: 1.16244e-06, Train MAE: 0.000796241, Val MAE: 0.000735297, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 6.93883e-07, Val Loss: 1.07306e-06, Train MAE: 0.00061265, Val MAE: 0.00073804, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 3.38635e-07, Val Loss: 5.74415e-07, Train MAE: 0.000422146, Val MAE: 0.000509689, lr: [1e-10]
Epoch [430/600], Train Loss: 4.42291e-07, Val Loss: 6.76689e-07, Train MAE: 0.00049011, Val MAE: 0.000554283, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.59457e-06, Val Loss: 3.38026e-06, Train MAE: 0.000941663, Val MAE: 0.00135152, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.35998e-06, Val Loss: 2.48891e-06, Train MAE: 0.00087146, Val MAE: 0.00108696, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.42418e-06, Val Loss: 2.30385e-06, Train MAE: 0.00119073, Val MAE: 0.00113794, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 8.01709e-06, Val Loss: 2.55544e-06, Train MAE: 0.00203849, Val MAE: 0.00118038, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 3.18801e-06, Val Loss: 3.02262e-06, Train MAE: 0.00131186, Val MAE: 0.00129832, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 1.83953e-06, Val Loss: 3.02046e-06, Train MAE: 0.00100887, Val MAE: 0.00128032, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.28624e-06, Val Loss: 3.57345e-06, Train MAE: 0.00110422, Val MAE: 0.00133858, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 1.41186e-06, Val Loss: 1.8272e-06, Train MAE: 0.000869769, Val MAE: 0.0010026, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 4.8166e-06, Val Loss: 3.08728e-06, Train MAE: 0.00160629, Val MAE: 0.00134498, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 5.93725e-07, Val Loss: 5.59822e-07, Train MAE: 0.000587066, Val MAE: 0.000563113, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 6.5308e-07, Val Loss: 6.05443e-07, Train MAE: 0.000606192, Val MAE: 0.000589071, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.4852e-07, Val Loss: 3.73803e-07, Train MAE: 0.00037363, Val MAE: 0.000426753, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.74982e-07, Val Loss: 2.9415e-07, Train MAE: 0.00030932, Val MAE: 0.000362615, lr: [1e-10]
Epoch [570/600], Train Loss: 2.14779e-07, Val Loss: 3.30752e-07, Train MAE: 0.000347343, Val MAE: 0.000394514, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 4.23561e-07, Val Loss: 4.57364e-07, Train MAE: 0.000491177, Val MAE: 0.000499543, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 5.89496e-07, Val Loss: 5.54738e-07, Train MAE: 0.000581101, Val MAE: 0.000540323, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 6.60422e-07, Val Loss: 5.8886e-07, Train MAE: 0.000614169, Val MAE: 0.000555273, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 7 Validation MAE: 0.013005

Training on dataset 8/10 with 1440 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.045097, Val Loss: 0.044168, Train MAE: 0.16868, Val MAE: 0.164468, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0183903, Val Loss: 0.0169567, Train MAE: 0.10007, Val MAE: 0.0942071, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0157455, Val Loss: 0.0164556, Train MAE: 0.0915879, Val MAE: 0.0945355, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.012365, Val Loss: 0.0120976, Train MAE: 0.0821776, Val MAE: 0.0818964, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.000702175, Val Loss: 0.000869122, Train MAE: 0.0193694, Val MAE: 0.02236, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.00206679, Val Loss: 0.00216328, Train MAE: 0.0333426, Val MAE: 0.0343102, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.0011638, Val Loss: 0.00129472, Train MAE: 0.0253321, Val MAE: 0.0266003, lr: [0.001]
Epoch [80/600], Train Loss: 0.000324157, Val Loss: 0.000289741, Train MAE: 0.013319, Val MAE: 0.0127272, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000176655, Val Loss: 0.000146713, Train MAE: 0.0099293, Val MAE: 0.00978265, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 8.35189e-05, Val Loss: 9.48471e-05, Train MAE: 0.00675312, Val MAE: 0.00717392, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 3.50329e-05, Val Loss: 5.64335e-05, Train MAE: 0.00459178, Val MAE: 0.0055378, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 3.28891e-05, Val Loss: 1.96466e-05, Train MAE: 0.00428144, Val MAE: 0.0031585, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 8.16277e-06, Val Loss: 6.97871e-06, Train MAE: 0.00214093, Val MAE: 0.00192711, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 2.87322e-06, Val Loss: 4.82493e-06, Train MAE: 0.00126383, Val MAE: 0.00144926, lr: [1e-10]
Epoch [150/600], Train Loss: 3.94156e-06, Val Loss: 5.29888e-06, Train MAE: 0.00149203, Val MAE: 0.00166911, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 1.72831e-05, Val Loss: 2.04367e-05, Train MAE: 0.00302508, Val MAE: 0.00331184, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 1.45146e-05, Val Loss: 4.44478e-05, Train MAE: 0.00286909, Val MAE: 0.00533384, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 1.86769e-05, Val Loss: 2.92539e-05, Train MAE: 0.00310951, Val MAE: 0.00385658, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 3.6162e-05, Val Loss: 4.76326e-05, Train MAE: 0.00431685, Val MAE: 0.00482244, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 3.46155e-05, Val Loss: 3.50988e-05, Train MAE: 0.00424186, Val MAE: 0.00448051, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 1.2995e-05, Val Loss: 9.07431e-06, Train MAE: 0.00268147, Val MAE: 0.00216377, lr: [0.00050000005]
Epoch [220/600], Train Loss: 2.52356e-06, Val Loss: 2.46046e-06, Train MAE: 0.00118518, Val MAE: 0.00107288, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.61245e-05, Val Loss: 1.18194e-05, Train MAE: 0.00291039, Val MAE: 0.00239359, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 4.54925e-06, Val Loss: 4.10366e-06, Train MAE: 0.00151847, Val MAE: 0.00154459, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.02271e-05, Val Loss: 1.47279e-05, Train MAE: 0.00229535, Val MAE: 0.00297307, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.88457e-06, Val Loss: 2.09445e-06, Train MAE: 0.00102207, Val MAE: 0.00103644, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 8.87783e-07, Val Loss: 1.47074e-06, Train MAE: 0.000695784, Val MAE: 0.000877951, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.87963e-07, Val Loss: 8.18311e-07, Train MAE: 0.000496676, Val MAE: 0.00059508, lr: [1e-10]
Epoch [290/600], Train Loss: 7.65924e-07, Val Loss: 1.13408e-06, Train MAE: 0.000644531, Val MAE: 0.000770784, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.01781e-06, Val Loss: 3.26145e-06, Train MAE: 0.00104783, Val MAE: 0.00135222, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 3.44712e-06, Val Loss: 3.73025e-06, Train MAE: 0.00138576, Val MAE: 0.00141986, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.36267e-05, Val Loss: 4.85441e-05, Train MAE: 0.00267449, Val MAE: 0.00521025, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.15648e-05, Val Loss: 4.21997e-06, Train MAE: 0.00246894, Val MAE: 0.00153244, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 2.76403e-05, Val Loss: 1.5426e-05, Train MAE: 0.00392527, Val MAE: 0.00282798, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 4.89927e-06, Val Loss: 1.22795e-05, Train MAE: 0.00166262, Val MAE: 0.00268058, lr: [0.000250000075]
Epoch [360/600], Train Loss: 9.109e-07, Val Loss: 1.13928e-06, Train MAE: 0.000716183, Val MAE: 0.000765076, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 4.66393e-06, Val Loss: 6.4449e-06, Train MAE: 0.00162269, Val MAE: 0.00191676, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.87485e-06, Val Loss: 2.22881e-06, Train MAE: 0.00100854, Val MAE: 0.00108302, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 7.25673e-07, Val Loss: 7.79831e-07, Train MAE: 0.000644594, Val MAE: 0.000656181, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 9.75777e-07, Val Loss: 7.33996e-07, Train MAE: 0.000740744, Val MAE: 0.000646702, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 4.51426e-07, Val Loss: 5.02462e-07, Train MAE: 0.000502644, Val MAE: 0.000520952, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 2.59242e-07, Val Loss: 3.75139e-07, Train MAE: 0.000366576, Val MAE: 0.000423691, lr: [1e-10]
Epoch [430/600], Train Loss: 4.00349e-07, Val Loss: 4.43096e-07, Train MAE: 0.000469272, Val MAE: 0.00047439, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 7.38706e-07, Val Loss: 9.74264e-07, Train MAE: 0.00065156, Val MAE: 0.00076611, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.86482e-06, Val Loss: 3.01312e-06, Train MAE: 0.00101302, Val MAE: 0.00134596, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 1.22189e-06, Val Loss: 2.97449e-06, Train MAE: 0.000811727, Val MAE: 0.00124889, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 2.15936e-06, Val Loss: 3.78953e-06, Train MAE: 0.00107117, Val MAE: 0.00152436, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 2.24355e-05, Val Loss: 4.54484e-05, Train MAE: 0.00322198, Val MAE: 0.0052242, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 2.20234e-05, Val Loss: 9.65245e-06, Train MAE: 0.00333865, Val MAE: 0.00229291, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 1.25048e-06, Val Loss: 1.16571e-06, Train MAE: 0.000839031, Val MAE: 0.000782802, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 1.24567e-06, Val Loss: 7.52875e-07, Train MAE: 0.000818123, Val MAE: 0.00062377, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 4.23704e-07, Val Loss: 4.74639e-07, Train MAE: 0.000490635, Val MAE: 0.000512571, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 5.66364e-07, Val Loss: 4.28409e-07, Train MAE: 0.000572069, Val MAE: 0.000490717, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 3.76445e-07, Val Loss: 4.43623e-07, Train MAE: 0.00045919, Val MAE: 0.000510809, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.25345e-07, Val Loss: 2.89686e-07, Train MAE: 0.000354486, Val MAE: 0.000392684, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.51835e-07, Val Loss: 2.18357e-07, Train MAE: 0.000288646, Val MAE: 0.00033231, lr: [1e-10]
Epoch [570/600], Train Loss: 1.95096e-07, Val Loss: 2.81633e-07, Train MAE: 0.000334008, Val MAE: 0.00038847, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 5.33341e-07, Val Loss: 7.23506e-07, Train MAE: 0.000549314, Val MAE: 0.000638364, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 4.49473e-07, Val Loss: 4.66941e-07, Train MAE: 0.00051049, Val MAE: 0.000496109, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 5.76983e-07, Val Loss: 6.26743e-07, Train MAE: 0.00057619, Val MAE: 0.000614346, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 8 Validation MAE: 0.012183

Training on dataset 9/10 with 1620 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0429212, Val Loss: 0.0359096, Train MAE: 0.163923, Val MAE: 0.143013, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0161607, Val Loss: 0.016879, Train MAE: 0.0916517, Val MAE: 0.0948671, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0156949, Val Loss: 0.0170096, Train MAE: 0.0912656, Val MAE: 0.095323, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.010801, Val Loss: 0.00923418, Train MAE: 0.0760105, Val MAE: 0.0707327, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.000678945, Val Loss: 0.000721495, Train MAE: 0.0185508, Val MAE: 0.0196186, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.000788108, Val Loss: 0.000390257, Train MAE: 0.020466, Val MAE: 0.01512, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000524599, Val Loss: 0.000974788, Train MAE: 0.0164103, Val MAE: 0.0226143, lr: [0.001]
Epoch [80/600], Train Loss: 0.000728714, Val Loss: 0.000639247, Train MAE: 0.0204824, Val MAE: 0.0194671, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000131645, Val Loss: 0.0002032, Train MAE: 0.00869013, Val MAE: 0.0114133, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 6.89241e-05, Val Loss: 7.9247e-05, Train MAE: 0.00614805, Val MAE: 0.00678247, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 3.356e-05, Val Loss: 3.39955e-05, Train MAE: 0.00431144, Val MAE: 0.0046998, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 7.19082e-06, Val Loss: 1.14596e-05, Train MAE: 0.00199484, Val MAE: 0.00247277, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 2.81461e-06, Val Loss: 3.581e-06, Train MAE: 0.00126498, Val MAE: 0.00141554, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 1.04735e-06, Val Loss: 1.45746e-06, Train MAE: 0.000745572, Val MAE: 0.000835674, lr: [1e-10]
Epoch [150/600], Train Loss: 2.43084e-06, Val Loss: 3.15723e-06, Train MAE: 0.00115142, Val MAE: 0.00133905, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 1.51567e-05, Val Loss: 7.76527e-06, Train MAE: 0.00284755, Val MAE: 0.00200204, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 3.28695e-05, Val Loss: 2.98004e-05, Train MAE: 0.00408087, Val MAE: 0.00420203, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 2.43192e-05, Val Loss: 9.76501e-06, Train MAE: 0.00345194, Val MAE: 0.00241233, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 2.08578e-05, Val Loss: 1.22911e-05, Train MAE: 0.00338283, Val MAE: 0.00256844, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.000521431, Val Loss: 0.000270899, Train MAE: 0.0164254, Val MAE: 0.0124649, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000124617, Val Loss: 4.44177e-05, Train MAE: 0.00829242, Val MAE: 0.00502899, lr: [0.00050000005]
Epoch [220/600], Train Loss: 6.13708e-05, Val Loss: 0.000133195, Train MAE: 0.0054424, Val MAE: 0.00833903, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.48712e-05, Val Loss: 1.96603e-05, Train MAE: 0.00277521, Val MAE: 0.00345685, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 8.17903e-06, Val Loss: 4.05809e-06, Train MAE: 0.002027, Val MAE: 0.0014518, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.78662e-06, Val Loss: 4.26632e-06, Train MAE: 0.000969387, Val MAE: 0.00161825, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 3.48803e-06, Val Loss: 1.69238e-06, Train MAE: 0.00129394, Val MAE: 0.000947642, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 7.8091e-07, Val Loss: 8.44666e-07, Train MAE: 0.000654263, Val MAE: 0.00066733, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 3.78996e-07, Val Loss: 4.77902e-07, Train MAE: 0.000436658, Val MAE: 0.000472922, lr: [1e-10]
Epoch [290/600], Train Loss: 7.02276e-07, Val Loss: 7.61134e-07, Train MAE: 0.000622519, Val MAE: 0.000608573, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.34381e-06, Val Loss: 1.71962e-06, Train MAE: 0.00111444, Val MAE: 0.00100421, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 2.81433e-06, Val Loss: 2.29733e-06, Train MAE: 0.00120215, Val MAE: 0.00118787, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.93211e-05, Val Loss: 9.85112e-06, Train MAE: 0.00310832, Val MAE: 0.00236004, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 6.56144e-06, Val Loss: 7.75226e-06, Train MAE: 0.00193081, Val MAE: 0.00197797, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 7.51042e-05, Val Loss: 0.000120255, Train MAE: 0.00618652, Val MAE: 0.00797, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 3.74848e-05, Val Loss: 6.34011e-05, Train MAE: 0.00437173, Val MAE: 0.00624939, lr: [0.000250000075]
Epoch [360/600], Train Loss: 3.69592e-06, Val Loss: 1.01238e-05, Train MAE: 0.00144465, Val MAE: 0.00230296, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 3.22537e-06, Val Loss: 2.84408e-06, Train MAE: 0.00133271, Val MAE: 0.00125581, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.68951e-06, Val Loss: 4.72641e-06, Train MAE: 0.000978786, Val MAE: 0.00168955, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 1.96163e-06, Val Loss: 8.56126e-07, Train MAE: 0.00104936, Val MAE: 0.000681989, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 4.72714e-07, Val Loss: 6.20799e-07, Train MAE: 0.000520694, Val MAE: 0.000601352, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.84158e-07, Val Loss: 3.52875e-07, Train MAE: 0.000466438, Val MAE: 0.000425155, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 1.9321e-07, Val Loss: 2.55415e-07, Train MAE: 0.000317837, Val MAE: 0.000351983, lr: [1e-10]
Epoch [430/600], Train Loss: 2.74212e-07, Val Loss: 3.60842e-07, Train MAE: 0.000389952, Val MAE: 0.000450516, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.28707e-06, Val Loss: 1.80621e-06, Train MAE: 0.000858911, Val MAE: 0.00102567, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 5.23705e-06, Val Loss: 2.05164e-06, Train MAE: 0.00155631, Val MAE: 0.00109961, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.14982e-06, Val Loss: 4.22312e-06, Train MAE: 0.00106647, Val MAE: 0.00153814, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 1.53445e-06, Val Loss: 2.07396e-06, Train MAE: 0.000916736, Val MAE: 0.0010589, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 4.65442e-06, Val Loss: 8.62965e-06, Train MAE: 0.00159072, Val MAE: 0.00213178, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 2.61715e-06, Val Loss: 3.12563e-06, Train MAE: 0.00121311, Val MAE: 0.00133154, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 1.06843e-06, Val Loss: 1.80671e-06, Train MAE: 0.000767429, Val MAE: 0.00106366, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 8.60604e-07, Val Loss: 5.50982e-07, Train MAE: 0.000691454, Val MAE: 0.000577843, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 6.06653e-07, Val Loss: 6.67176e-07, Train MAE: 0.000590221, Val MAE: 0.00061284, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 3.80654e-07, Val Loss: 4.01561e-07, Train MAE: 0.000472601, Val MAE: 0.000490193, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 2.94893e-07, Val Loss: 6.67756e-07, Train MAE: 0.000411118, Val MAE: 0.000630256, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.45399e-07, Val Loss: 2.31171e-07, Train MAE: 0.000375803, Val MAE: 0.000360952, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.1968e-07, Val Loss: 1.52359e-07, Train MAE: 0.000253678, Val MAE: 0.000275223, lr: [1e-10]
Epoch [570/600], Train Loss: 1.64732e-07, Val Loss: 1.82978e-07, Train MAE: 0.000303171, Val MAE: 0.00031714, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 2.50229e-07, Val Loss: 2.86799e-07, Train MAE: 0.000378155, Val MAE: 0.000400607, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 1.41869e-06, Val Loss: 2.57656e-06, Train MAE: 0.000897854, Val MAE: 0.00124795, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 1.31725e-06, Val Loss: 4.72465e-07, Train MAE: 0.000840831, Val MAE: 0.000518388, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 9 Validation MAE: 0.011782

Training on dataset 10/10 with 1800 samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0357909, Val Loss: 0.0317263, Train MAE: 0.14489, Val MAE: 0.131703, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0171195, Val Loss: 0.0165159, Train MAE: 0.0961721, Val MAE: 0.0936938, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0154375, Val Loss: 0.015892, Train MAE: 0.0928233, Val MAE: 0.0943104, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.00141369, Val Loss: 0.00297086, Train MAE: 0.0271567, Val MAE: 0.041002, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.000674656, Val Loss: 0.00058653, Train MAE: 0.0194756, Val MAE: 0.017986, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.000833731, Val Loss: 0.00211823, Train MAE: 0.0211019, Val MAE: 0.0369268, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000240694, Val Loss: 0.00125483, Train MAE: 0.0115874, Val MAE: 0.0284729, lr: [0.001]
Epoch [80/600], Train Loss: 0.000205449, Val Loss: 0.000209759, Train MAE: 0.010666, Val MAE: 0.0114759, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 7.97539e-05, Val Loss: 6.3294e-05, Train MAE: 0.00663261, Val MAE: 0.0061197, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 9.35386e-05, Val Loss: 5.00387e-05, Train MAE: 0.00702133, Val MAE: 0.00535246, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 4.89399e-05, Val Loss: 0.000220756, Train MAE: 0.00490033, Val MAE: 0.0108352, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 1.13154e-05, Val Loss: 1.57294e-05, Train MAE: 0.00245441, Val MAE: 0.0030013, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 1.70507e-06, Val Loss: 1.74551e-06, Train MAE: 0.000966594, Val MAE: 0.000927305, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 7.46941e-07, Val Loss: 9.28074e-07, Train MAE: 0.000611557, Val MAE: 0.000664614, lr: [1e-10]
Epoch [150/600], Train Loss: 1.65838e-06, Val Loss: 1.27713e-06, Train MAE: 0.000940365, Val MAE: 0.000804079, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 7.14612e-06, Val Loss: 6.83378e-06, Train MAE: 0.0019007, Val MAE: 0.00183052, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 5.45786e-05, Val Loss: 1.25453e-05, Train MAE: 0.00498592, Val MAE: 0.0027306, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.00035193, Val Loss: 2.62741e-05, Train MAE: 0.0126523, Val MAE: 0.00406401, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 5.2302e-06, Val Loss: 4.11747e-06, Train MAE: 0.00167735, Val MAE: 0.00156374, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 1.35352e-05, Val Loss: 6.67803e-05, Train MAE: 0.00269514, Val MAE: 0.00595665, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 2.70016e-05, Val Loss: 6.69544e-06, Train MAE: 0.00368338, Val MAE: 0.00195414, lr: [0.00050000005]
Epoch [220/600], Train Loss: 6.6212e-06, Val Loss: 3.74097e-06, Train MAE: 0.00191942, Val MAE: 0.00146752, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 2.31261e-05, Val Loss: 0.000137506, Train MAE: 0.00329145, Val MAE: 0.00892937, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 3.94931e-06, Val Loss: 7.52962e-06, Train MAE: 0.00143087, Val MAE: 0.0020199, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.25225e-05, Val Loss: 4.97109e-06, Train MAE: 0.00262628, Val MAE: 0.00169331, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 9.92957e-07, Val Loss: 1.07117e-06, Train MAE: 0.000735182, Val MAE: 0.000777085, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 7.15644e-07, Val Loss: 6.5097e-07, Train MAE: 0.000623126, Val MAE: 0.000617468, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 3.1738e-07, Val Loss: 4.54259e-07, Train MAE: 0.000411662, Val MAE: 0.000464455, lr: [1e-10]
Epoch [290/600], Train Loss: 7.20893e-07, Val Loss: 7.20685e-07, Train MAE: 0.000639639, Val MAE: 0.000602998, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 3.30537e-06, Val Loss: 1.69226e-06, Train MAE: 0.0012862, Val MAE: 0.000995222, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 4.00713e-06, Val Loss: 9.99544e-06, Train MAE: 0.00135628, Val MAE: 0.00237823, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 2.69649e-06, Val Loss: 9.95852e-07, Train MAE: 0.00116048, Val MAE: 0.000743459, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 2.42538e-06, Val Loss: 2.86605e-06, Train MAE: 0.0011684, Val MAE: 0.00123647, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 4.14558e-05, Val Loss: 0.00012131, Train MAE: 0.004272, Val MAE: 0.00855826, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 2.78972e-05, Val Loss: 9.6542e-06, Train MAE: 0.00366029, Val MAE: 0.00227508, lr: [0.000250000075]
Epoch [360/600], Train Loss: 4.11526e-06, Val Loss: 6.22894e-06, Train MAE: 0.00143009, Val MAE: 0.00187274, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 2.85451e-06, Val Loss: 1.73277e-06, Train MAE: 0.0012659, Val MAE: 0.00102829, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 2.05162e-06, Val Loss: 5.52342e-06, Train MAE: 0.00106278, Val MAE: 0.00182853, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 9.35543e-07, Val Loss: 1.20744e-06, Train MAE: 0.000726915, Val MAE: 0.000873831, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 5.69756e-07, Val Loss: 4.01588e-07, Train MAE: 0.000566893, Val MAE: 0.000480093, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.64968e-07, Val Loss: 3.32727e-07, Train MAE: 0.000450157, Val MAE: 0.000430302, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 1.5542e-07, Val Loss: 2.11359e-07, Train MAE: 0.000287191, Val MAE: 0.000320133, lr: [1e-10]
Epoch [430/600], Train Loss: 3.3926e-07, Val Loss: 4.05348e-07, Train MAE: 0.000435801, Val MAE: 0.000466244, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 6.63259e-07, Val Loss: 6.53321e-07, Train MAE: 0.000612513, Val MAE: 0.000594112, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 6.40742e-06, Val Loss: 5.05171e-06, Train MAE: 0.00179444, Val MAE: 0.0016696, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 5.33819e-06, Val Loss: 2.22598e-05, Train MAE: 0.001484, Val MAE: 0.00338831, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 3.25707e-06, Val Loss: 6.52433e-06, Train MAE: 0.00129931, Val MAE: 0.00184219, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 6.82121e-07, Val Loss: 1.3396e-06, Train MAE: 0.000627161, Val MAE: 0.000854644, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 7.57881e-07, Val Loss: 5.97343e-07, Train MAE: 0.000664163, Val MAE: 0.000583726, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 1.22747e-06, Val Loss: 2.84672e-06, Train MAE: 0.000829153, Val MAE: 0.00130284, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 1.1439e-05, Val Loss: 1.86583e-06, Train MAE: 0.00232884, Val MAE: 0.00102899, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 6.86494e-07, Val Loss: 1.67411e-06, Train MAE: 0.000614639, Val MAE: 0.00101805, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 8.8356e-07, Val Loss: 1.60613e-06, Train MAE: 0.000688784, Val MAE: 0.000972261, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 5.7911e-07, Val Loss: 1.17332e-06, Train MAE: 0.000574269, Val MAE: 0.000797872, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 1.60168e-07, Val Loss: 1.46467e-07, Train MAE: 0.000301196, Val MAE: 0.000280937, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 9.45635e-08, Val Loss: 1.2122e-07, Train MAE: 0.000223584, Val MAE: 0.000244775, lr: [1e-10]
Epoch [570/600], Train Loss: 1.41013e-07, Val Loss: 1.77711e-07, Train MAE: 0.000278289, Val MAE: 0.000315547, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 1.98183e-07, Val Loss: 2.42275e-07, Train MAE: 0.000339419, Val MAE: 0.000368926, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 7.55641e-07, Val Loss: 6.28109e-07, Train MAE: 0.000642581, Val MAE: 0.000636267, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 3.63156e-07, Val Loss: 3.9718e-07, Train MAE: 0.00045291, Val MAE: 0.000491273, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Dataset 10 Validation MAE: 0.011010
0.0000226 22.62
0.0000098 9.78
0.0000073 7.31
0.0000062 6.15
0.0000053 5.27
0.0000047 4.68
0.0000042 4.23
0.0000040 3.97
0.0000038 3.83
0.0000036 3.58
0.0000141 14.09
0.0000086 8.57
0.0000069 6.89
0.0000060 5.96
0.0000051 5.08
0.0000046 4.61
0.0000043 4.27
0.0000040 3.99
0.0000038 3.78
0.0000035 3.55

Generating Validation MAE Across Folds Plot

/home/aribra/jnps/thesis/lattice_error_net/visualization.py:427: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:451: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_10-28-36/figs
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_10-28-36/training
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_10-28-36/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])
(1999, 101, 16)
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.

Starting Fold 1/5
Training on Fold 1: 1599 training samples, 400 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0455621, Val Loss: 0.047092, Train MAE: 0.168443, Val MAE: 0.170854, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0164328, Val Loss: 0.0164628, Train MAE: 0.0925784, Val MAE: 0.0921074, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0157855, Val Loss: 0.0160488, Train MAE: 0.0916121, Val MAE: 0.0906967, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0121112, Val Loss: 0.0111069, Train MAE: 0.0797827, Val MAE: 0.0751953, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.00149734, Val Loss: 0.00145162, Train MAE: 0.0278029, Val MAE: 0.0271023, lr: [0.000714285742857143]
^CTraceback (most recent call last):
  File "/home/aribra/jnps/thesis/lattice_error_net/cross_validation.py", line 118, in <module>
    cv_results = perform_cross_validation(
  File "/home/aribra/jnps/thesis/lattice_error_net/cross_validation.py", line 72, in perform_cross_validation
    training_results = train_model(
  File "/home/aribra/jnps/thesis/lattice_error_net/models/net.py", line 707, in train_model
    train_loss += loss.item() * batch_inputs.size(0)
KeyboardInterrupt
^C
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 accumulated_training.py; python cross_validation.py [4P[9P[12P[8P
[?2004l--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_11-59-18/figs
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_11-59-18/training
--->Creating save directory: exps/exp_LSTM_1000_mix/run_2025-01-17_11-59-18/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])
(1999, 101, 16)
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:541: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

Starting Fold 1/5
Training on Fold 1: 1599 training samples, 400 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0434987, Val Loss: 0.0408051, Train MAE: 0.164598, Val MAE: 0.1556, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0163594, Val Loss: 0.0173669, Train MAE: 0.0928784, Val MAE: 0.0962526, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0152543, Val Loss: 0.0165359, Train MAE: 0.0900028, Val MAE: 0.0950446, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.00684661, Val Loss: 0.00566267, Train MAE: 0.0608597, Val MAE: 0.0557944, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.000390687, Val Loss: 0.000315442, Train MAE: 0.0146247, Val MAE: 0.0129492, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.00155833, Val Loss: 0.000133346, Train MAE: 0.0251119, Val MAE: 0.00838274, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.00171769, Val Loss: 0.00111499, Train MAE: 0.0298799, Val MAE: 0.0263444, lr: [0.001]
Epoch [80/600], Train Loss: 9.02753e-05, Val Loss: 9.16377e-05, Train MAE: 0.00708358, Val MAE: 0.00732372, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 8.54475e-05, Val Loss: 0.000171971, Train MAE: 0.00683447, Val MAE: 0.00980028, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 7.81939e-05, Val Loss: 6.41059e-05, Train MAE: 0.00652248, Val MAE: 0.00610941, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 7.69632e-05, Val Loss: 0.000105099, Train MAE: 0.00624941, Val MAE: 0.00785057, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 6.2099e-06, Val Loss: 6.7888e-06, Train MAE: 0.00187179, Val MAE: 0.00194532, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 3.81853e-06, Val Loss: 4.3418e-06, Train MAE: 0.00144694, Val MAE: 0.00148824, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 9.54354e-07, Val Loss: 1.10329e-06, Train MAE: 0.00069955, Val MAE: 0.000713296, lr: [1e-10]
Epoch [150/600], Train Loss: 3.13457e-06, Val Loss: 3.05422e-06, Train MAE: 0.00129013, Val MAE: 0.00128572, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 1.6161e-05, Val Loss: 1.16081e-05, Train MAE: 0.00297445, Val MAE: 0.00260099, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 1.90766e-05, Val Loss: 9.45154e-06, Train MAE: 0.00310351, Val MAE: 0.0022244, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 4.5443e-05, Val Loss: 9.13776e-05, Train MAE: 0.0044259, Val MAE: 0.00714095, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 2.80474e-05, Val Loss: 5.51699e-05, Train MAE: 0.00398727, Val MAE: 0.00585516, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.000101805, Val Loss: 2.77192e-05, Train MAE: 0.00698094, Val MAE: 0.00372239, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 7.68204e-05, Val Loss: 1.03269e-05, Train MAE: 0.00564738, Val MAE: 0.00248999, lr: [0.00050000005]
Epoch [220/600], Train Loss: 3.22553e-05, Val Loss: 1.93359e-05, Train MAE: 0.00393877, Val MAE: 0.00307273, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 3.27243e-05, Val Loss: 3.82915e-05, Train MAE: 0.00402065, Val MAE: 0.00493588, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 4.17501e-06, Val Loss: 8.14238e-06, Train MAE: 0.00150238, Val MAE: 0.00214048, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 2.64491e-06, Val Loss: 1.87621e-06, Train MAE: 0.00121342, Val MAE: 0.00102421, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 4.56474e-06, Val Loss: 2.97122e-06, Train MAE: 0.00160015, Val MAE: 0.00130105, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 1.75305e-06, Val Loss: 1.52026e-06, Train MAE: 0.000965584, Val MAE: 0.000907989, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 3.42209e-07, Val Loss: 3.71955e-07, Train MAE: 0.000427986, Val MAE: 0.000430896, lr: [1e-10]
Epoch [290/600], Train Loss: 7.1727e-07, Val Loss: 6.97385e-07, Train MAE: 0.000634642, Val MAE: 0.000641068, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.93467e-06, Val Loss: 1.95196e-06, Train MAE: 0.00128573, Val MAE: 0.00104586, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 3.4229e-06, Val Loss: 3.48387e-06, Train MAE: 0.00136586, Val MAE: 0.00139899, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.21617e-05, Val Loss: 1.19069e-05, Train MAE: 0.00259353, Val MAE: 0.00265401, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.05061e-05, Val Loss: 3.48241e-05, Train MAE: 0.00225535, Val MAE: 0.00425596, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 2.1635e-05, Val Loss: 7.00597e-05, Train MAE: 0.00317165, Val MAE: 0.00612487, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 3.82134e-05, Val Loss: 6.43742e-05, Train MAE: 0.00459207, Val MAE: 0.00653051, lr: [0.000250000075]
Epoch [360/600], Train Loss: 3.27571e-05, Val Loss: 1.0761e-05, Train MAE: 0.00399228, Val MAE: 0.00259597, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 3.94255e-05, Val Loss: 6.24609e-05, Train MAE: 0.00411384, Val MAE: 0.00584198, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 2.63259e-05, Val Loss: 6.79336e-06, Train MAE: 0.00338508, Val MAE: 0.00201498, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 3.37145e-06, Val Loss: 1.61426e-06, Train MAE: 0.00131645, Val MAE: 0.000918904, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 6.11029e-07, Val Loss: 6.35668e-07, Train MAE: 0.000596553, Val MAE: 0.000614374, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.44052e-07, Val Loss: 6.31914e-07, Train MAE: 0.000444465, Val MAE: 0.000601886, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 1.84664e-07, Val Loss: 2.15407e-07, Train MAE: 0.000317126, Val MAE: 0.000328359, lr: [1e-10]
Epoch [430/600], Train Loss: 3.08886e-07, Val Loss: 3.62027e-07, Train MAE: 0.00041949, Val MAE: 0.000455827, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.10035e-06, Val Loss: 9.34923e-07, Train MAE: 0.000773707, Val MAE: 0.000742317, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 8.94331e-07, Val Loss: 9.44229e-07, Train MAE: 0.000717579, Val MAE: 0.000748814, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.53345e-06, Val Loss: 2.67043e-06, Train MAE: 0.00120894, Val MAE: 0.00119978, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 3.64856e-06, Val Loss: 3.2678e-06, Train MAE: 0.00140721, Val MAE: 0.00137271, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 4.3465e-06, Val Loss: 9.5491e-06, Train MAE: 0.00151977, Val MAE: 0.00225324, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 3.3672e-06, Val Loss: 7.78175e-06, Train MAE: 0.00138354, Val MAE: 0.002181, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 1.24123e-05, Val Loss: 1.58146e-05, Train MAE: 0.00242258, Val MAE: 0.00302985, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 2.86167e-06, Val Loss: 9.52251e-07, Train MAE: 0.00114883, Val MAE: 0.000732001, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 5.4453e-07, Val Loss: 6.03005e-07, Train MAE: 0.000563938, Val MAE: 0.000586288, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 6.65899e-07, Val Loss: 7.94968e-07, Train MAE: 0.000617001, Val MAE: 0.000678779, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 3.22971e-07, Val Loss: 4.44919e-07, Train MAE: 0.000431444, Val MAE: 0.000507171, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.46101e-07, Val Loss: 2.34686e-07, Train MAE: 0.000374867, Val MAE: 0.000356301, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.16851e-07, Val Loss: 1.4774e-07, Train MAE: 0.000249753, Val MAE: 0.000278268, lr: [1e-10]
Epoch [570/600], Train Loss: 1.59587e-07, Val Loss: 1.57355e-07, Train MAE: 0.000298965, Val MAE: 0.000291919, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 3.25211e-07, Val Loss: 2.6338e-07, Train MAE: 0.00043701, Val MAE: 0.000375663, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 6.40243e-07, Val Loss: 9.68901e-07, Train MAE: 0.000570604, Val MAE: 0.000758254, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 3.39541e-07, Val Loss: 3.62201e-07, Train MAE: 0.000440815, Val MAE: 0.00046486, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:263: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:275: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:288: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:300: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
Fold 1 Validation MAE: 0.011353

Starting Fold 2/5
Training on Fold 2: 1599 training samples, 400 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0433499, Val Loss: 0.046093, Train MAE: 0.164845, Val MAE: 0.168164, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0169328, Val Loss: 0.0156329, Train MAE: 0.094528, Val MAE: 0.0912362, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0159042, Val Loss: 0.0150961, Train MAE: 0.0933139, Val MAE: 0.0927706, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.00396998, Val Loss: 0.00327846, Train MAE: 0.043388, Val MAE: 0.0408708, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.00267526, Val Loss: 0.00113128, Train MAE: 0.035666, Val MAE: 0.0250272, lr: [0.000714285742857143]
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[AEpoch [60/600], Train Loss: 0.000178382, Val Loss: 0.000199062, Train MAE: 0.00999275, Val MAE: 0.0107001, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.00106578, Val Loss: 0.00167034, Train MAE: 0.0234344, Val MAE: 0.0301702, lr: [0.001]
Epoch [80/600], Train Loss: 0.000179898, Val Loss: 0.000139216, Train MAE: 0.0100642, Val MAE: 0.00881249, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000260818, Val Loss: 0.000302511, Train MAE: 0.011765, Val MAE: 0.0133971, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 8.96891e-05, Val Loss: 0.000140757, Train MAE: 0.00702999, Val MAE: 0.00943634, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.000132916, Val Loss: 0.000189876, Train MAE: 0.00809875, Val MAE: 0.011051, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 1.355e-05, Val Loss: 8.20699e-06, Train MAE: 0.00263084, Val MAE: 0.00211768, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 3.39076e-06, Val Loss: 2.6249e-06, Train MAE: 0.00136041, Val MAE: 0.00113456, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 9.52865e-07, Val Loss: 1.38681e-06, Train MAE: 0.000702939, Val MAE: 0.000743431, lr: [1e-10]
Epoch [150/600], Train Loss: 1.48119e-06, Val Loss: 1.52731e-06, Train MAE: 0.000900894, Val MAE: 0.000854315, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 4.69878e-05, Val Loss: 4.36268e-05, Train MAE: 0.00487707, Val MAE: 0.00485979, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 5.83485e-05, Val Loss: 4.46074e-05, Train MAE: 0.00550449, Val MAE: 0.00494665, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 6.74965e-05, Val Loss: 2.04452e-05, Train MAE: 0.00547022, Val MAE: 0.00344144, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 0.000143166, Val Loss: 0.000137108, Train MAE: 0.00871067, Val MAE: 0.00835585, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 8.63473e-05, Val Loss: 5.05956e-05, Train MAE: 0.00638927, Val MAE: 0.00549479, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 7.02253e-05, Val Loss: 5.31067e-05, Train MAE: 0.00586509, Val MAE: 0.00543915, lr: [0.00050000005]
Epoch [220/600], Train Loss: 2.5088e-06, Val Loss: 4.06067e-06, Train MAE: 0.0011962, Val MAE: 0.00147179, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 7.39429e-05, Val Loss: 0.000261243, Train MAE: 0.00558632, Val MAE: 0.0124539, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 9.17496e-06, Val Loss: 5.55787e-06, Train MAE: 0.00217993, Val MAE: 0.00176569, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 3.68976e-05, Val Loss: 1.73686e-05, Train MAE: 0.00364638, Val MAE: 0.00299938, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.26579e-06, Val Loss: 1.12795e-06, Train MAE: 0.00084508, Val MAE: 0.000782768, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 9.425e-07, Val Loss: 9.86024e-07, Train MAE: 0.000728588, Val MAE: 0.000722551, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.02579e-07, Val Loss: 4.70201e-07, Train MAE: 0.000446791, Val MAE: 0.000459671, lr: [1e-10]
Epoch [290/600], Train Loss: 7.70147e-07, Val Loss: 9.43299e-07, Train MAE: 0.000646383, Val MAE: 0.000705396, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 2.04748e-06, Val Loss: 9.2375e-07, Train MAE: 0.00106147, Val MAE: 0.000688548, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 2.38374e-06, Val Loss: 2.24255e-06, Train MAE: 0.00116256, Val MAE: 0.00114321, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.03282e-05, Val Loss: 1.77362e-05, Train MAE: 0.00225313, Val MAE: 0.00305366, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.65606e-06, Val Loss: 3.58517e-06, Train MAE: 0.000952224, Val MAE: 0.00137014, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 1.85953e-05, Val Loss: 2.31585e-05, Train MAE: 0.00323954, Val MAE: 0.00380576, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 9.38112e-06, Val Loss: 4.90461e-06, Train MAE: 0.00217963, Val MAE: 0.00161152, lr: [0.000250000075]
Epoch [360/600], Train Loss: 5.05279e-06, Val Loss: 3.88673e-06, Train MAE: 0.00165459, Val MAE: 0.00151001, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 1.84747e-05, Val Loss: 6.072e-06, Train MAE: 0.00318532, Val MAE: 0.00182968, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 3.50994e-05, Val Loss: 8.1031e-06, Train MAE: 0.00412415, Val MAE: 0.00211429, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 1.23732e-06, Val Loss: 1.09398e-06, Train MAE: 0.000838835, Val MAE: 0.000797905, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 2.01256e-06, Val Loss: 9.31874e-07, Train MAE: 0.0010069, Val MAE: 0.000738126, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.59388e-07, Val Loss: 4.13011e-07, Train MAE: 0.000445113, Val MAE: 0.000490511, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 2.21191e-07, Val Loss: 2.69997e-07, Train MAE: 0.000328209, Val MAE: 0.000369071, lr: [1e-10]
Epoch [430/600], Train Loss: 3.16542e-07, Val Loss: 4.66178e-07, Train MAE: 0.000414553, Val MAE: 0.000513639, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.42012e-06, Val Loss: 2.32969e-06, Train MAE: 0.000883785, Val MAE: 0.00118174, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.2444e-06, Val Loss: 1.18944e-06, Train MAE: 0.000822172, Val MAE: 0.000807128, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.8615e-06, Val Loss: 6.14972e-06, Train MAE: 0.0012243, Val MAE: 0.00176073, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 5.13897e-06, Val Loss: 4.25631e-06, Train MAE: 0.00164518, Val MAE: 0.00157575, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 1.75721e-06, Val Loss: 1.89039e-06, Train MAE: 0.000992093, Val MAE: 0.00107224, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 2.91795e-06, Val Loss: 1.31074e-06, Train MAE: 0.00117159, Val MAE: 0.000827749, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.83084e-06, Val Loss: 7.81462e-07, Train MAE: 0.00123488, Val MAE: 0.000679501, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 6.79627e-07, Val Loss: 9.0627e-07, Train MAE: 0.000624604, Val MAE: 0.0007515, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.33273e-06, Val Loss: 7.95044e-07, Train MAE: 0.000856981, Val MAE: 0.000663725, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 5.71542e-07, Val Loss: 6.31066e-07, Train MAE: 0.00056764, Val MAE: 0.000592869, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 3.39588e-07, Val Loss: 4.13589e-07, Train MAE: 0.000437886, Val MAE: 0.000469477, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.08496e-07, Val Loss: 2.48239e-07, Train MAE: 0.00033245, Val MAE: 0.000353174, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.5161e-07, Val Loss: 1.87118e-07, Train MAE: 0.000277708, Val MAE: 0.000299291, lr: [1e-10]
Epoch [570/600], Train Loss: 1.94284e-07, Val Loss: 2.13703e-07, Train MAE: 0.000322957, Val MAE: 0.000331128, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 3.55414e-07, Val Loss: 2.86399e-07, Train MAE: 0.000444756, Val MAE: 0.000393339, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 5.84307e-07, Val Loss: 3.03752e-07, Train MAE: 0.000548228, Val MAE: 0.000391524, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 1.02278e-06, Val Loss: 1.50315e-06, Train MAE: 0.000751808, Val MAE: 0.000920799, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Fold 2 Validation MAE: 0.011178

Starting Fold 3/5
Training on Fold 3: 1599 training samples, 400 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0441569, Val Loss: 0.0403077, Train MAE: 0.16601, Val MAE: 0.158108, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0161232, Val Loss: 0.0163702, Train MAE: 0.0921801, Val MAE: 0.0919481, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0156191, Val Loss: 0.0157606, Train MAE: 0.0924058, Val MAE: 0.0916039, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0100842, Val Loss: 0.00981321, Train MAE: 0.0725758, Val MAE: 0.0694751, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.00138145, Val Loss: 0.00110785, Train MAE: 0.0269378, Val MAE: 0.0246296, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.000678061, Val Loss: 0.000611915, Train MAE: 0.0187177, Val MAE: 0.0189752, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000729453, Val Loss: 0.000615989, Train MAE: 0.0200183, Val MAE: 0.0189258, lr: [0.001]
Epoch [80/600], Train Loss: 0.000211998, Val Loss: 0.000219789, Train MAE: 0.010921, Val MAE: 0.0114685, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.00042294, Val Loss: 0.000469706, Train MAE: 0.01528, Val MAE: 0.016851, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 9.68126e-05, Val Loss: 6.66522e-05, Train MAE: 0.00750201, Val MAE: 0.00626007, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.000201331, Val Loss: 0.000108658, Train MAE: 0.0101608, Val MAE: 0.00792396, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 2.08167e-05, Val Loss: 1.78244e-05, Train MAE: 0.00327791, Val MAE: 0.00322075, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 4.36792e-06, Val Loss: 4.26139e-06, Train MAE: 0.00157465, Val MAE: 0.00150836, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 1.34239e-06, Val Loss: 2.03479e-06, Train MAE: 0.000854398, Val MAE: 0.000962443, lr: [1e-10]
Epoch [150/600], Train Loss: 2.57615e-06, Val Loss: 2.92525e-06, Train MAE: 0.00120313, Val MAE: 0.00124101, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 1.36721e-05, Val Loss: 1.68676e-05, Train MAE: 0.00265832, Val MAE: 0.00313524, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 1.26351e-05, Val Loss: 1.92972e-05, Train MAE: 0.00252578, Val MAE: 0.00306182, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 1.26409e-05, Val Loss: 6.08237e-06, Train MAE: 0.00252464, Val MAE: 0.00188943, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 1.04087e-05, Val Loss: 1.03854e-05, Train MAE: 0.00230046, Val MAE: 0.00254887, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 1.202e-05, Val Loss: 8.70545e-06, Train MAE: 0.00254911, Val MAE: 0.00220864, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.0003264, Val Loss: 0.000274498, Train MAE: 0.0132102, Val MAE: 0.0123239, lr: [0.00050000005]
Epoch [220/600], Train Loss: 2.33241e-06, Val Loss: 2.73748e-06, Train MAE: 0.00113262, Val MAE: 0.00116704, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 0.000114132, Val Loss: 0.000557906, Train MAE: 0.00625932, Val MAE: 0.0182441, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 5.73005e-06, Val Loss: 8.56248e-06, Train MAE: 0.00176556, Val MAE: 0.00222823, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.84117e-06, Val Loss: 1.76619e-06, Train MAE: 0.00100845, Val MAE: 0.000964524, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 2.95202e-06, Val Loss: 9.5355e-06, Train MAE: 0.00120022, Val MAE: 0.00223324, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 8.36192e-07, Val Loss: 8.41833e-07, Train MAE: 0.000677083, Val MAE: 0.000623982, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.20033e-07, Val Loss: 6.38171e-07, Train MAE: 0.000470222, Val MAE: 0.000523423, lr: [1e-10]
Epoch [290/600], Train Loss: 6.27462e-07, Val Loss: 7.44021e-07, Train MAE: 0.000590554, Val MAE: 0.000601277, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 1.24268e-05, Val Loss: 4.08178e-06, Train MAE: 0.00245812, Val MAE: 0.00156875, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 2.28344e-05, Val Loss: 1.43233e-05, Train MAE: 0.00346163, Val MAE: 0.00286462, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.49709e-05, Val Loss: 5.21114e-05, Train MAE: 0.00253836, Val MAE: 0.00526442, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.96215e-05, Val Loss: 3.2504e-05, Train MAE: 0.00315113, Val MAE: 0.00440913, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 0.000104569, Val Loss: 6.47493e-05, Train MAE: 0.00733248, Val MAE: 0.00612965, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 0.000202602, Val Loss: 1.15759e-05, Train MAE: 0.00966926, Val MAE: 0.00249107, lr: [0.000250000075]
Epoch [360/600], Train Loss: 4.06677e-06, Val Loss: 1.61864e-06, Train MAE: 0.00147204, Val MAE: 0.000979091, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 2.90541e-06, Val Loss: 3.76006e-06, Train MAE: 0.0012784, Val MAE: 0.00145189, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 2.2081e-05, Val Loss: 4.00708e-06, Train MAE: 0.00344845, Val MAE: 0.00152523, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 9.27062e-07, Val Loss: 1.43135e-06, Train MAE: 0.000723498, Val MAE: 0.000886471, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 1.19905e-06, Val Loss: 6.10188e-07, Train MAE: 0.000812837, Val MAE: 0.000531964, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.85862e-07, Val Loss: 5.17017e-07, Train MAE: 0.000469581, Val MAE: 0.000521221, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 1.98918e-07, Val Loss: 3.1995e-07, Train MAE: 0.000325034, Val MAE: 0.000364974, lr: [1e-10]
Epoch [430/600], Train Loss: 3.38754e-07, Val Loss: 4.60673e-07, Train MAE: 0.000436294, Val MAE: 0.000462719, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 8.9802e-07, Val Loss: 5.4221e-07, Train MAE: 0.000707204, Val MAE: 0.000529605, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 2.5875e-06, Val Loss: 1.50679e-06, Train MAE: 0.00115497, Val MAE: 0.000916157, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.05489e-06, Val Loss: 1.38439e-06, Train MAE: 0.00105186, Val MAE: 0.000903981, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 3.21772e-06, Val Loss: 2.1836e-06, Train MAE: 0.00130329, Val MAE: 0.00109686, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 1.01361e-06, Val Loss: 2.01107e-06, Train MAE: 0.000751957, Val MAE: 0.00107905, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 2.43714e-06, Val Loss: 6.49623e-06, Train MAE: 0.0011288, Val MAE: 0.00179677, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 1.30747e-06, Val Loss: 2.29247e-06, Train MAE: 0.00086638, Val MAE: 0.00115833, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 3.07232e-06, Val Loss: 3.22603e-06, Train MAE: 0.00125611, Val MAE: 0.00137938, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.98266e-06, Val Loss: 2.39018e-06, Train MAE: 0.00102983, Val MAE: 0.00119634, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 1.07572e-06, Val Loss: 3.60063e-07, Train MAE: 0.0007588, Val MAE: 0.000441946, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 3.08575e-07, Val Loss: 3.70442e-07, Train MAE: 0.000419858, Val MAE: 0.000452188, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 1.91232e-07, Val Loss: 2.30329e-07, Train MAE: 0.000328014, Val MAE: 0.000322593, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.2137e-07, Val Loss: 1.90527e-07, Train MAE: 0.000254035, Val MAE: 0.000285437, lr: [1e-10]
Epoch [570/600], Train Loss: 1.68139e-07, Val Loss: 2.85974e-07, Train MAE: 0.000307877, Val MAE: 0.00038862, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 3.5309e-07, Val Loss: 7.83491e-07, Train MAE: 0.000446064, Val MAE: 0.000645352, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 3.72149e-07, Val Loss: 3.54345e-07, Train MAE: 0.000462901, Val MAE: 0.000428466, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 6.4213e-07, Val Loss: 5.07024e-07, Train MAE: 0.000605305, Val MAE: 0.000518608, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Fold 3 Validation MAE: 0.011443

Starting Fold 4/5
Training on Fold 4: 1599 training samples, 400 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.0435266, Val Loss: 0.0464084, Train MAE: 0.164031, Val MAE: 0.171999, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0168387, Val Loss: 0.017225, Train MAE: 0.0941183, Val MAE: 0.0958759, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0158022, Val Loss: 0.015322, Train MAE: 0.0920996, Val MAE: 0.0909322, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0120518, Val Loss: 0.0104302, Train MAE: 0.0801415, Val MAE: 0.0751191, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.000899641, Val Loss: 0.000376844, Train MAE: 0.0218137, Val MAE: 0.0150923, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.00102158, Val Loss: 0.000757387, Train MAE: 0.0231328, Val MAE: 0.0211706, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000645039, Val Loss: 0.000302898, Train MAE: 0.0188643, Val MAE: 0.0135493, lr: [0.001]
Epoch [80/600], Train Loss: 0.000310514, Val Loss: 0.000322838, Train MAE: 0.0132372, Val MAE: 0.013733, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000105394, Val Loss: 9.48676e-05, Train MAE: 0.00776266, Val MAE: 0.00757864, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 5.4493e-05, Val Loss: 3.33895e-05, Train MAE: 0.0056005, Val MAE: 0.00425516, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 4.56784e-05, Val Loss: 3.8931e-05, Train MAE: 0.00488457, Val MAE: 0.00469846, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 2.22075e-05, Val Loss: 9.80178e-06, Train MAE: 0.00343537, Val MAE: 0.00230527, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 2.95831e-06, Val Loss: 2.92919e-06, Train MAE: 0.0012843, Val MAE: 0.00125472, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 1.00045e-06, Val Loss: 1.36998e-06, Train MAE: 0.000711612, Val MAE: 0.000789696, lr: [1e-10]
Epoch [150/600], Train Loss: 1.86725e-06, Val Loss: 2.91091e-06, Train MAE: 0.00101517, Val MAE: 0.00121118, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 9.14547e-06, Val Loss: 2.92381e-06, Train MAE: 0.00211564, Val MAE: 0.00122639, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 2.01164e-05, Val Loss: 6.02142e-05, Train MAE: 0.00321905, Val MAE: 0.00587682, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000175324, Val Loss: 0.000203881, Train MAE: 0.00844664, Val MAE: 0.010629, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 6.80893e-05, Val Loss: 0.000120959, Train MAE: 0.00606428, Val MAE: 0.00808685, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 5.73892e-06, Val Loss: 4.15202e-06, Train MAE: 0.00177591, Val MAE: 0.00157206, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000126028, Val Loss: 0.000101558, Train MAE: 0.00799815, Val MAE: 0.00782598, lr: [0.00050000005]
Epoch [220/600], Train Loss: 2.77071e-05, Val Loss: 6.53278e-05, Train MAE: 0.00378078, Val MAE: 0.00600709, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 1.28542e-05, Val Loss: 4.76815e-06, Train MAE: 0.0025341, Val MAE: 0.00161278, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 5.40329e-06, Val Loss: 4.17479e-06, Train MAE: 0.0017014, Val MAE: 0.00152066, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.46072e-05, Val Loss: 8.78845e-06, Train MAE: 0.00275429, Val MAE: 0.0020932, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 1.05061e-06, Val Loss: 1.2158e-06, Train MAE: 0.000764483, Val MAE: 0.000829596, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 6.80847e-07, Val Loss: 8.58722e-07, Train MAE: 0.000609712, Val MAE: 0.000660222, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.49951e-07, Val Loss: 6.30349e-07, Train MAE: 0.000479579, Val MAE: 0.000543686, lr: [1e-10]
Epoch [290/600], Train Loss: 6.35605e-07, Val Loss: 8.48723e-07, Train MAE: 0.000590832, Val MAE: 0.000663641, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 3.3557e-06, Val Loss: 3.18744e-06, Train MAE: 0.00135053, Val MAE: 0.00131625, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 3.7238e-06, Val Loss: 2.88028e-06, Train MAE: 0.00142611, Val MAE: 0.00127244, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 1.85282e-06, Val Loss: 1.58414e-06, Train MAE: 0.00103829, Val MAE: 0.000951991, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 1.89158e-05, Val Loss: 1.21693e-05, Train MAE: 0.00322, Val MAE: 0.00258436, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 1.41811e-05, Val Loss: 2.07318e-05, Train MAE: 0.0027252, Val MAE: 0.00332623, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 6.83278e-06, Val Loss: 5.59406e-06, Train MAE: 0.00196323, Val MAE: 0.00177554, lr: [0.000250000075]
Epoch [360/600], Train Loss: 1.16196e-05, Val Loss: 3.44646e-06, Train MAE: 0.00245282, Val MAE: 0.00135845, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 1.05079e-05, Val Loss: 3.84782e-05, Train MAE: 0.00229713, Val MAE: 0.00466389, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.43505e-06, Val Loss: 9.1849e-07, Train MAE: 0.000902916, Val MAE: 0.000676109, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 2.50186e-06, Val Loss: 2.63901e-06, Train MAE: 0.00122435, Val MAE: 0.00125566, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 4.36557e-06, Val Loss: 4.88733e-06, Train MAE: 0.00148964, Val MAE: 0.00169945, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 3.84755e-07, Val Loss: 5.58229e-07, Train MAE: 0.000464732, Val MAE: 0.000510899, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 2.50609e-07, Val Loss: 3.94994e-07, Train MAE: 0.000362853, Val MAE: 0.00042072, lr: [1e-10]
^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[AEpoch [430/600], Train Loss: 3.43469e-07, Val Loss: 5.59615e-07, Train MAE: 0.00043465, Val MAE: 0.000523491, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 7.76921e-07, Val Loss: 6.67699e-07, Train MAE: 0.000662657, Val MAE: 0.000620449, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.23737e-06, Val Loss: 1.71178e-06, Train MAE: 0.000846043, Val MAE: 0.000993078, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 1.65633e-05, Val Loss: 5.83702e-06, Train MAE: 0.00285758, Val MAE: 0.00188545, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 4.46841e-06, Val Loss: 2.95036e-06, Train MAE: 0.00153991, Val MAE: 0.00128771, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 1.31635e-06, Val Loss: 3.43208e-06, Train MAE: 0.000862402, Val MAE: 0.00152139, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 9.38115e-06, Val Loss: 1.49913e-05, Train MAE: 0.00215388, Val MAE: 0.00298857, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 4.06061e-07, Val Loss: 5.59306e-07, Train MAE: 0.000480317, Val MAE: 0.000546365, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 7.24604e-06, Val Loss: 1.74237e-06, Train MAE: 0.00181338, Val MAE: 0.00099245, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 1.62798e-06, Val Loss: 5.75959e-06, Train MAE: 0.000888047, Val MAE: 0.00182252, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 6.50698e-07, Val Loss: 6.78672e-07, Train MAE: 0.000592236, Val MAE: 0.000599931, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 5.8818e-07, Val Loss: 3.86331e-07, Train MAE: 0.000562646, Val MAE: 0.000430301, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.32399e-07, Val Loss: 4.34947e-07, Train MAE: 0.000363925, Val MAE: 0.000473142, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.49451e-07, Val Loss: 2.63897e-07, Train MAE: 0.000283336, Val MAE: 0.000338687, lr: [1e-10]
Epoch [570/600], Train Loss: 2.02945e-07, Val Loss: 3.36914e-07, Train MAE: 0.000336348, Val MAE: 0.000395285, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 4.69653e-07, Val Loss: 4.72722e-07, Train MAE: 0.000505761, Val MAE: 0.000497275, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 4.64779e-07, Val Loss: 5.16472e-07, Train MAE: 0.000514266, Val MAE: 0.000521591, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 1.82963e-06, Val Loss: 1.38169e-06, Train MAE: 0.000905145, Val MAE: 0.000853922, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Fold 4 Validation MAE: 0.011953

Starting Fold 5/5
Training on Fold 5: 1600 training samples, 399 validation samples
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
Epoch [10/600], Train Loss: 0.044719, Val Loss: 0.0458542, Train MAE: 0.167171, Val MAE: 0.170247, lr: [0.00014285722857142853]
Epoch [20/600], Train Loss: 0.0165695, Val Loss: 0.0165713, Train MAE: 0.0934114, Val MAE: 0.0919872, lr: [0.000285714357142857]
Epoch [30/600], Train Loss: 0.0153246, Val Loss: 0.0162372, Train MAE: 0.091055, Val MAE: 0.0926463, lr: [0.0004285714857142855]
Epoch [40/600], Train Loss: 0.0121054, Val Loss: 0.0120719, Train MAE: 0.081414, Val MAE: 0.0792184, lr: [0.0005714286142857141]
Epoch [50/600], Train Loss: 0.00135279, Val Loss: 0.00156651, Train MAE: 0.0262055, Val MAE: 0.0302242, lr: [0.000714285742857143]
Epoch [60/600], Train Loss: 0.000622319, Val Loss: 0.000261157, Train MAE: 0.0182893, Val MAE: 0.0122859, lr: [0.0008571428714285715]
Epoch [70/600], Train Loss: 0.000664657, Val Loss: 0.00254946, Train MAE: 0.0181044, Val MAE: 0.036648, lr: [0.001]
Epoch [80/600], Train Loss: 0.000569536, Val Loss: 0.000220457, Train MAE: 0.0176763, Val MAE: 0.0113788, lr: [0.0008571428714285715]
Epoch [90/600], Train Loss: 0.000226002, Val Loss: 0.00016889, Train MAE: 0.011004, Val MAE: 0.00946668, lr: [0.000714285742857143]
Epoch [100/600], Train Loss: 0.000178782, Val Loss: 0.000163831, Train MAE: 0.00980726, Val MAE: 0.00933476, lr: [0.0005714286142857141]
Epoch [110/600], Train Loss: 0.000213032, Val Loss: 0.000129501, Train MAE: 0.0100336, Val MAE: 0.00833084, lr: [0.00042857148571428594]
Epoch [120/600], Train Loss: 1.22231e-05, Val Loss: 1.78216e-05, Train MAE: 0.00263239, Val MAE: 0.00317876, lr: [0.000285714357142857]
Epoch [130/600], Train Loss: 3.31754e-06, Val Loss: 3.45803e-06, Train MAE: 0.0013755, Val MAE: 0.00135749, lr: [0.00014285722857142853]
Epoch [140/600], Train Loss: 1.26662e-06, Val Loss: 1.76046e-06, Train MAE: 0.000831948, Val MAE: 0.00091838, lr: [1e-10]
Epoch [150/600], Train Loss: 2.72604e-06, Val Loss: 4.04379e-06, Train MAE: 0.00123202, Val MAE: 0.00147271, lr: [7.142866428571402e-05]
Epoch [160/600], Train Loss: 1.27684e-05, Val Loss: 6.49922e-06, Train MAE: 0.0025496, Val MAE: 0.00198029, lr: [0.00014285722857142853]
Epoch [170/600], Train Loss: 1.65696e-05, Val Loss: 2.74947e-05, Train MAE: 0.00300184, Val MAE: 0.00376046, lr: [0.000214285792857143]
Epoch [180/600], Train Loss: 0.000144608, Val Loss: 6.95415e-05, Train MAE: 0.00840826, Val MAE: 0.00597665, lr: [0.000285714357142857]
Epoch [190/600], Train Loss: 1.97592e-05, Val Loss: 3.62157e-05, Train MAE: 0.00313026, Val MAE: 0.00438968, lr: [0.0003571429214285715]
Epoch [200/600], Train Loss: 0.000197765, Val Loss: 5.32806e-05, Train MAE: 0.0099815, Val MAE: 0.00560234, lr: [0.00042857148571428594]
Epoch [210/600], Train Loss: 0.000616062, Val Loss: 0.000332098, Train MAE: 0.017941, Val MAE: 0.0136349, lr: [0.00050000005]
Epoch [220/600], Train Loss: 1.71077e-05, Val Loss: 7.51699e-06, Train MAE: 0.00289861, Val MAE: 0.00206904, lr: [0.00042857148571428594]
Epoch [230/600], Train Loss: 4.21973e-06, Val Loss: 1.07089e-05, Train MAE: 0.0015503, Val MAE: 0.00252926, lr: [0.0003571429214285715]
Epoch [240/600], Train Loss: 3.95816e-05, Val Loss: 4.0436e-05, Train MAE: 0.00462683, Val MAE: 0.00488275, lr: [0.000285714357142857]
Epoch [250/600], Train Loss: 1.73614e-06, Val Loss: 1.49322e-06, Train MAE: 0.000992863, Val MAE: 0.000901211, lr: [0.000214285792857143]
Epoch [260/600], Train Loss: 2.1667e-06, Val Loss: 1.18326e-06, Train MAE: 0.00108939, Val MAE: 0.00081187, lr: [0.00014285722857142853]
Epoch [270/600], Train Loss: 1.02463e-06, Val Loss: 1.24881e-06, Train MAE: 0.000763752, Val MAE: 0.000785891, lr: [7.142866428571402e-05]
Epoch [280/600], Train Loss: 4.28872e-07, Val Loss: 6.86765e-07, Train MAE: 0.000466956, Val MAE: 0.000551925, lr: [1e-10]
Epoch [290/600], Train Loss: 8.14092e-07, Val Loss: 1.12785e-06, Train MAE: 0.000669533, Val MAE: 0.000744285, lr: [3.571438214285724e-05]
Epoch [300/600], Train Loss: 4.87779e-06, Val Loss: 4.8469e-06, Train MAE: 0.00156226, Val MAE: 0.00166366, lr: [7.142866428571425e-05]
Epoch [310/600], Train Loss: 2.0354e-05, Val Loss: 4.8511e-06, Train MAE: 0.00304606, Val MAE: 0.00159449, lr: [0.00010714294642857148]
Epoch [320/600], Train Loss: 4.9115e-06, Val Loss: 1.14251e-05, Train MAE: 0.00159582, Val MAE: 0.00250999, lr: [0.00014285722857142853]
Epoch [330/600], Train Loss: 5.92089e-06, Val Loss: 8.70355e-06, Train MAE: 0.00178989, Val MAE: 0.0022851, lr: [0.00017857151071428576]
Epoch [340/600], Train Loss: 2.16058e-05, Val Loss: 1.99208e-05, Train MAE: 0.00319854, Val MAE: 0.00321393, lr: [0.00021428579285714277]
Epoch [350/600], Train Loss: 2.50416e-05, Val Loss: 1.09379e-05, Train MAE: 0.0035505, Val MAE: 0.00247402, lr: [0.000250000075]
Epoch [360/600], Train Loss: 5.33405e-06, Val Loss: 8.49036e-06, Train MAE: 0.0017097, Val MAE: 0.00224376, lr: [0.00021428579285714277]
Epoch [370/600], Train Loss: 1.19784e-06, Val Loss: 2.44797e-06, Train MAE: 0.000824974, Val MAE: 0.00113332, lr: [0.00017857151071428576]
Epoch [380/600], Train Loss: 1.08317e-06, Val Loss: 1.35058e-06, Train MAE: 0.000784772, Val MAE: 0.000902794, lr: [0.00014285722857142853]
Epoch [390/600], Train Loss: 2.34219e-06, Val Loss: 2.99223e-06, Train MAE: 0.00111954, Val MAE: 0.00125169, lr: [0.00010714294642857148]
Epoch [400/600], Train Loss: 1.0531e-06, Val Loss: 8.24823e-07, Train MAE: 0.000768365, Val MAE: 0.000682473, lr: [7.142866428571425e-05]
Epoch [410/600], Train Loss: 4.39442e-07, Val Loss: 5.72349e-07, Train MAE: 0.000498062, Val MAE: 0.000534241, lr: [3.571438214285724e-05]
Epoch [420/600], Train Loss: 2.54718e-07, Val Loss: 3.78547e-07, Train MAE: 0.000367955, Val MAE: 0.000423011, lr: [1e-10]
Epoch [430/600], Train Loss: 3.29503e-07, Val Loss: 5.4295e-07, Train MAE: 0.000430144, Val MAE: 0.000537858, lr: [1.7857241071428508e-05]
Epoch [440/600], Train Loss: 1.30403e-06, Val Loss: 1.06139e-06, Train MAE: 0.000856405, Val MAE: 0.000793168, lr: [3.5714382142857015e-05]
Epoch [450/600], Train Loss: 1.85721e-06, Val Loss: 1.58178e-06, Train MAE: 0.00103033, Val MAE: 0.000959106, lr: [5.3571523214285746e-05]
Epoch [460/600], Train Loss: 2.29474e-06, Val Loss: 1.98198e-06, Train MAE: 0.00111422, Val MAE: 0.00110203, lr: [7.142866428571425e-05]
Epoch [470/600], Train Loss: 1.34346e-06, Val Loss: 9.47292e-07, Train MAE: 0.000871814, Val MAE: 0.000732313, lr: [8.928580535714298e-05]
Epoch [480/600], Train Loss: 6.90368e-07, Val Loss: 1.41569e-06, Train MAE: 0.000632687, Val MAE: 0.000889203, lr: [0.00010714294642857148]
Epoch [490/600], Train Loss: 7.07142e-06, Val Loss: 2.7743e-05, Train MAE: 0.00193668, Val MAE: 0.00404351, lr: [0.0001250000875]
Epoch [500/600], Train Loss: 2.30339e-06, Val Loss: 3.62384e-06, Train MAE: 0.00114057, Val MAE: 0.00143979, lr: [0.00010714294642857148]
Epoch [510/600], Train Loss: 7.16802e-07, Val Loss: 6.9755e-07, Train MAE: 0.000644477, Val MAE: 0.000629368, lr: [8.928580535714298e-05]
Epoch [520/600], Train Loss: 9.97695e-07, Val Loss: 2.9885e-06, Train MAE: 0.000756621, Val MAE: 0.00132313, lr: [7.142866428571425e-05]
Epoch [530/600], Train Loss: 1.11156e-06, Val Loss: 7.90436e-07, Train MAE: 0.000791033, Val MAE: 0.000663192, lr: [5.3571523214285746e-05]
Epoch [540/600], Train Loss: 4.20355e-07, Val Loss: 6.70995e-07, Train MAE: 0.000488778, Val MAE: 0.00061054, lr: [3.5714382142857015e-05]
Epoch [550/600], Train Loss: 2.15464e-07, Val Loss: 2.79905e-07, Train MAE: 0.000348403, Val MAE: 0.000384101, lr: [1.7857241071428508e-05]
Epoch [560/600], Train Loss: 1.42227e-07, Val Loss: 2.1761e-07, Train MAE: 0.000277712, Val MAE: 0.000323248, lr: [1e-10]
Epoch [570/600], Train Loss: 1.95155e-07, Val Loss: 2.69111e-07, Train MAE: 0.00033112, Val MAE: 0.000381595, lr: [8.928670535714254e-06]
Epoch [580/600], Train Loss: 3.44815e-07, Val Loss: 3.17118e-07, Train MAE: 0.000443423, Val MAE: 0.000417206, lr: [1.785724107142862e-05]
Epoch [590/600], Train Loss: 3.64767e-07, Val Loss: 3.14784e-07, Train MAE: 0.00046237, Val MAE: 0.000421238, lr: [2.6785811607142873e-05]
Epoch [600/600], Train Loss: 7.10571e-07, Val Loss: 7.20008e-07, Train MAE: 0.000628197, Val MAE: 0.000652275, lr: [3.571438214285713e-05]
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:291: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=(10,5))
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Fold 5 Validation MAE: 0.011993
Fold 1 Unscaled Validation MAE: 0.0000037, 3.69
Fold 2 Unscaled Validation MAE: 0.0000036, 3.64
Fold 3 Unscaled Validation MAE: 0.0000037, 3.72
Fold 4 Unscaled Validation MAE: 0.0000039, 3.89
Fold 5 Unscaled Validation MAE: 0.0000039, 3.90
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:481: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python cross_validation.py [33@3 accumulated_training.py; python[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cexit[Kpython3 main.py jnp[Kipython3/bin/python3 /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aipython3[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[5Pjnpsnx -dpython /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aecho $'\n dsf d'[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C'[K[1P'\n'"\n"[2P\nendli endline[Kll /home/exdata/repos/dr_system/install/system_launch/share/system_launch[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[47Pros2 launch system_launch [1Psource install/setup.bashros2 launch system_launch[7Pcat run_dr_app.sh [58@vim /home/aribra/.ros/log/2025-01-16-11-46-48-341188-scar3-39824/launch.log[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cbash run_dr_app.sh online[Kecho $DR_PERCEPTION_PROJECT_ROOT=[8Pbash run_dr_app.sh online[4Pbuild_dr_app.sh [2Prun[C[C[C[C[C[C[C[C[C[C[Conline[K[2@build[C[C[C[C[C[C[C[C[C[C[Cconda activate openmmlab[3Pbash build_dr_app.sh conda activate openmmlabd /home/exdata/repos/dr_systemCD[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Claunch[Ktree -ifP launch_*.py | grep launch_*.py.py[Klaunch | xargs -I '{}' sh -c $'echo "\n\nFILE {}"; cat {}'[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1Psetup.py | grep setup.py[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cclear[Ktree -ifP setup.py | grep setup.py | xargs -I '{}' sh -c $'echo "\n\nFILE {}"; cat {}'[K[K | grep .py
[?2004l
^C
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ tree -ifP setup.py | grep .py[Ktree -ifP setup.py | grep .py[2Ppython cross_validation.py [33@3 accumulated_training.py; python[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cexit[Kpython3 main.py jnp[Kipython3/bin/python3 /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aipython3[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[5Pjnpsnx -dpython /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aecho $'\n dsf d'[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C'[K[1P'\n'"\n"[2P\nendli endline[Kll /home/exdata/repos/dr_system/install/system_launch/share/system_launch[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[47Pros2 launch system_launch [1Psource install/setup.bashros2 launch system_launch[7Pcat run_dr_app.sh ros2 launch system_launchsource install/setup.bashros2 launch system_launch ll /home/exdata/repos/dr_system/install/system_launch/share/system_launch[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cechi endl[Kine[3Po endl[2P\n"\n"'\n'^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 main.py 
[?2004l--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-12-25/figs
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-12-25/training
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-12-25/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])
merged_config:  {'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': (0.0, 0.05), 'xp0_mean_std': (0.0, 0.0), 'y0_mean_std': (0.0, 0.05), 'yp0_mean_std': (0.0, 0.0), 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': (4.71238898038469, 6.283185307179586), 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_2000_mix/run_2025-01-17_14-12-25/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': (0, 5e-05), 'quad_tilt_angle_range': (0, 0.01), 'dipole_tilt_angle_range': (0, 0.05), 'com_delta_range': (-5e-05, 5e-05), 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 15, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}], 'dipole_tilt_errors': None}
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:79: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:176: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
/home/aribra/jnps/thesis/lattice_error_net/models/net.py:434: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  chkpnt_state_dict = torch.load(model_load_path)
Checkpoint Loaded.
QuadErrorCorrectionLSTM(
  (lstm): LSTM(16, 256, batch_first=True, bidirectional=True)
  (fc): Linear(in_features=512, out_features=6, bias=True)
)
[1, 2, 3, 4, 5, 7]
torch.Size([16, 101, 16])
/home/aribra/jnps/thesis/lattice_error_net/eval.py:156: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/eval.py:162: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.68147807e-03 -4.95974362e-04  2.03256603e-04 -2.61176289e-04]
 [-8.39132038e-04  3.05811696e-05 -1.02186805e-03 -7.83511572e-05]
 [-3.51662448e-03  6.96978429e-04  3.94359030e-03  2.01823707e-04]
 [-2.95582900e-03  4.06057878e-05 -2.55952825e-03 -7.07162253e-04]
 [ 2.38323509e-03 -1.25322237e-04  4.59683762e-03  3.70790443e-04]
 [-9.12262923e-04 -4.80108649e-04  2.22705082e-04 -8.01973962e-04]
 [-2.79011843e-03 -4.30828402e-04  3.92322963e-04 -9.26847062e-05]
 [-1.01554735e-04  8.40406318e-04 -8.59329364e-04  3.96244939e-04]
 [-1.64536762e-04  8.16070469e-05 -1.57173058e-03  1.89470015e-04]
 [ 2.73260673e-03  5.47628631e-04 -4.86956769e-03  4.19442457e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5519885065881803e-06, theta_kick=1.8608926150690773e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3832573217454206e-05, theta_kick=-1.6585775757032192e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.2999742258524386e-05, theta_kick=1.5587180100882374e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.3674814175398915e-05, theta_kick=6.435812178389334e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.655255075599029e-05, theta_kick=7.979901248630513e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.031932990671888e-05, theta_kick=1.237326483692201e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.43979475e-07 -1.74433492e-07], y_co=[-4.60782478e-05 -1.08264485e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5519885065881803e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.3832573217454206e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.2999742258524386e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.3674814175398915e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.655255075599029e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.031932990671888e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.68147807e-03 -4.95974362e-04  2.03256603e-04 -2.61176289e-04]
 [-8.39132038e-04  3.05811696e-05 -1.02186805e-03 -7.83511572e-05]
 [-3.51662448e-03  6.96978429e-04  3.94359030e-03  2.01823707e-04]
 [-2.95582900e-03  4.06057878e-05 -2.55952825e-03 -7.07162253e-04]
 [ 2.38323509e-03 -1.25322237e-04  4.59683762e-03  3.70790443e-04]
 [-9.12262923e-04 -4.80108649e-04  2.22705082e-04 -8.01973962e-04]
 [-2.79011843e-03 -4.30828402e-04  3.92322963e-04 -9.26847062e-05]
 [-1.01554735e-04  8.40406318e-04 -8.59329364e-04  3.96244939e-04]
 [-1.64536762e-04  8.16070469e-05 -1.57173058e-03  1.89470015e-04]
 [ 2.73260673e-03  5.47628631e-04 -4.86956769e-03  4.19442457e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.060086809940344e-09, theta_kick=9.664347356802707e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.983963133736696e-08, theta_kick=2.3788464466506374e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.1736221844000713e-08, theta_kick=-2.6062547845747132e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0093295198038892e-08, theta_kick=-1.2102240716352607e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.184031338981981e-09, theta_kick=7.414886257995274e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.502372304730179e-08, theta_kick=6.59755142758284e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 3.01668026e-10 -2.87758155e-11], y_co=[ 2.07266184e-08 -1.92801077e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.60709428e-04 -2.45280965e-05  4.23431362e-04 -2.77002683e-05]
 [-9.57847345e-04 -1.79245545e-05  1.10686340e-04 -4.02643023e-04]
 [ 4.25246294e-03 -6.95466473e-04 -2.40069727e-03  4.31304853e-04]
 [-8.92425982e-04  4.65557905e-04  6.23861750e-04 -3.43482747e-04]
 [ 2.35492899e-03 -1.34643541e-04 -3.40648901e-03 -6.67224124e-04]
 [-1.88800738e-03  6.56849726e-05 -1.63688047e-03  6.69861245e-04]
 [-1.05482988e-03 -2.31275909e-04 -5.81969276e-03 -3.01846501e-04]
 [ 7.04787732e-04 -2.98520826e-05  1.77740714e-03  3.83750322e-05]
 [-4.33604360e-03  5.86743361e-04 -1.32545850e-04 -5.95495817e-04]
 [-5.24005780e-03  1.77123613e-04 -2.23437808e-03 -1.88452361e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.97878801707811e-05, theta_kick=1.1964942297892839e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6992120935746724e-05, theta_kick=-2.0374192353527674e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.5744938126842176e-05, theta_kick=3.0869149502254305e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.387261468824325e-06, theta_kick=-2.862416325066861e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4468893256941247e-05, theta_kick=2.933912369032636e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.923584287111722e-06, theta_kick=9.500675695838866e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[1.20793129e-07 7.56071644e-10], y_co=[-1.53001435e-05  5.80201093e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.97878801707811e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.6992120935746724e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.5744938126842176e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.387261468824325e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.4468893256941247e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.923584287111722e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.60709428e-04 -2.45280965e-05  4.23431362e-04 -2.77002683e-05]
 [-9.57847345e-04 -1.79245545e-05  1.10686340e-04 -4.02643023e-04]
 [ 4.25246294e-03 -6.95466473e-04 -2.40069727e-03  4.31304853e-04]
 [-8.92425982e-04  4.65557905e-04  6.23861750e-04 -3.43482747e-04]
 [ 2.35492899e-03 -1.34643541e-04 -3.40648901e-03 -6.67224124e-04]
 [-1.88800738e-03  6.56849726e-05 -1.63688047e-03  6.69861245e-04]
 [-1.05482988e-03 -2.31275909e-04 -5.81969276e-03 -3.01846501e-04]
 [ 7.04787732e-04 -2.98520826e-05  1.77740714e-03  3.83750322e-05]
 [-4.33604360e-03  5.86743361e-04 -1.32545850e-04 -5.95495817e-04]
 [-5.24005780e-03  1.77123613e-04 -2.23437808e-03 -1.88452361e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9631978757087736e-09, theta_kick=2.353948120954197e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.1801695779642236e-08, theta_kick=5.012180608521839e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.5213764126097524e-08, theta_kick=3.0232251889220174e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1063315027020565e-08, theta_kick=-1.3265330989611667e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.936585860889836e-09, theta_kick=-7.118189819291495e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.985068351363776e-08, theta_kick=2.3801716441708166e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-4.46792723e-11 -5.66248862e-12], y_co=[-1.31262272e-08  2.43028110e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.80598469e-04 -8.63438661e-04 -2.67125501e-03  6.73692649e-05]
 [ 2.95806121e-04  2.90573727e-04  2.31550408e-03  4.18855636e-04]
 [-4.76323237e-04 -1.93445300e-04  1.62570257e-03 -5.21675818e-04]
 [-2.96615564e-03 -3.73128856e-04  4.17090716e-03 -3.57447800e-04]
 [ 3.76305929e-04 -2.44930327e-04  1.00322458e-03 -2.82091611e-04]
 [ 1.68899990e-03  8.00884060e-05 -2.31284807e-03 -5.83261156e-04]
 [-5.70274608e-03  5.89159151e-04  2.41773375e-03 -5.84287251e-04]
 [-7.04336041e-04 -3.46031567e-04 -8.04367856e-04 -6.39210894e-05]
 [-6.48389980e-04 -2.03947885e-04 -3.55381779e-03 -3.53020160e-04]
 [-6.22082737e-04  8.54164557e-04  4.08142652e-05  1.56515050e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.702955689387179e-05, theta_kick=-1.043517133207187e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.048861138530063e-05, theta_kick=6.053774475336957e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.9491738058673405e-05, theta_kick=-7.133283238958004e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.003520284464652e-06, theta_kick=5.999409085301477e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.4475866724172472e-05, theta_kick=1.7357108876376974e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.4103790194871375e-05, theta_kick=2.8901351381407314e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.68091624e-07 -6.35151040e-08], y_co=[ 1.51508255e-05 -8.75020474e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 8.702955689387179e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.048861138530063e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.9491738058673405e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.003520284464652e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.4475866724172472e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.4103790194871375e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.80598469e-04 -8.63438661e-04 -2.67125501e-03  6.73692649e-05]
 [ 2.95806121e-04  2.90573727e-04  2.31550408e-03  4.18855636e-04]
 [-4.76323237e-04 -1.93445300e-04  1.62570257e-03 -5.21675818e-04]
 [-2.96615564e-03 -3.73128856e-04  4.17090716e-03 -3.57447800e-04]
 [ 3.76305929e-04 -2.44930327e-04  1.00322458e-03 -2.82091611e-04]
 [ 1.68899990e-03  8.00884060e-05 -2.31284807e-03 -5.83261156e-04]
 [-5.70274608e-03  5.89159151e-04  2.41773375e-03 -5.84287251e-04]
 [-7.04336041e-04 -3.46031567e-04 -8.04367856e-04 -6.39210894e-05]
 [-6.48389980e-04 -2.03947885e-04 -3.55381779e-03 -3.53020160e-04]
 [-6.22082737e-04  8.54164557e-04  4.08142652e-05  1.56515050e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.19750016949387e-08, theta_kick=7.431035892562023e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.9663922647139304e-08, theta_kick=-2.3577783135645932e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.8004371058008386e-08, theta_kick=4.556867086449298e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.440840564271423e-09, theta_kick=2.9266596764939746e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.775940207657843e-08, theta_kick=3.3284567574922927e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.859473525034802e-08, theta_kick=7.025729227145218e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 2.79908845e-10 -7.94538630e-11], y_co=[-9.52858795e-09 -2.09177413e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.01951669e-04 -5.55512065e-04  5.77980948e-04  2.90026929e-04]
 [ 2.88070815e-03 -6.80137048e-04 -1.09346367e-04  3.33033095e-04]
 [-3.94656314e-03 -4.13612434e-05 -1.66337801e-03 -3.94942447e-04]
 [ 2.44087651e-03  8.68731437e-04 -1.57571905e-03  1.60153799e-04]
 [ 4.98058170e-04 -1.80247751e-05  1.11378528e-04 -7.70473603e-05]
 [-2.60317242e-03  5.49948690e-04 -1.86583229e-03  6.36219945e-04]
 [-9.20065459e-04  2.27950271e-04 -4.34023589e-04  3.16262803e-05]
 [ 5.08544323e-03 -6.88530992e-04 -1.27578224e-03 -7.74835256e-05]
 [ 1.13227308e-03  6.26399002e-05  2.29093518e-03  4.50837248e-04]
 [ 6.99876184e-04 -8.70053698e-05  2.93425708e-03  3.07801570e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.580540021003189e-07, theta_kick=1.0288390339624121e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-0.0001439668808131919, theta_kick=1.72621707043922e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00011067929421977759, theta_kick=-1.3270863822788202e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.6101005845871188e-05, theta_kick=1.9305711831354566e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.121542580317449e-05, theta_kick=-4.941884632423154e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.962712028447578e-05, theta_kick=8.34855370358025e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[3.50083747e-07 3.97755425e-08], y_co=[3.07967875e-05 6.55681384e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.580540021003189e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -0.0001439668808131919, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00011067929421977759, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.6101005845871188e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.121542580317449e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.962712028447578e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.01951669e-04 -5.55512065e-04  5.77980948e-04  2.90026929e-04]
 [ 2.88070815e-03 -6.80137048e-04 -1.09346367e-04  3.33033095e-04]
 [-3.94656314e-03 -4.13612434e-05 -1.66337801e-03 -3.94942447e-04]
 [ 2.44087651e-03  8.68731437e-04 -1.57571905e-03  1.60153799e-04]
 [ 4.98058170e-04 -1.80247751e-05  1.11378528e-04 -7.70473603e-05]
 [-2.60317242e-03  5.49948690e-04 -1.86583229e-03  6.36219945e-04]
 [-9.20065459e-04  2.27950271e-04 -4.34023589e-04  3.16262803e-05]
 [ 5.08544323e-03 -6.88530992e-04 -1.27578224e-03 -7.74835256e-05]
 [ 1.13227308e-03  6.26399002e-05  2.29093518e-03  4.50837248e-04]
 [ 6.99876184e-04 -8.70053698e-05  2.93425708e-03  3.07801570e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.305879153261163e-09, theta_kick=3.9638734929413457e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.106743282384422e-08, theta_kick=8.521252596421556e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.2439205705522434e-08, theta_kick=1.4915075682885936e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.3404160333231563e-08, theta_kick=2.806246885277993e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.2901379398295e-08, theta_kick=-8.741149691170615e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.179801735987369e-08, theta_kick=-7.409814804860192e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-5.55480213e-10  1.28737047e-10], y_co=[-3.23754147e-08  1.43496328e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.34698995e-04 -1.44337047e-04  2.59495566e-03  2.43953702e-05]
 [ 1.10724373e-03 -3.45128142e-04 -1.93886738e-03 -6.69115321e-04]
 [-1.70604057e-03  2.95131159e-04  3.89578043e-03  4.27150500e-04]
 [ 5.54592210e-04  8.27907152e-04 -2.55921593e-03 -1.02883610e-04]
 [ 2.29662075e-04  3.47568089e-04  4.46150075e-03  1.21833698e-04]
 [ 1.60046227e-03  3.07009926e-04  4.50567315e-04  2.93749507e-04]
 [-4.31022200e-03  1.37234914e-04 -2.80269728e-03 -4.62332791e-04]
 [ 3.64075128e-03  6.45623026e-05  1.84379489e-03 -9.60849214e-04]
 [-1.55495767e-03  2.42845135e-05  4.20935186e-03  5.43202853e-05]
 [ 4.68735592e-04 -5.57202873e-05 -6.57691568e-04 -2.93289408e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.1637322983519264e-05, theta_kick=6.191509318146361e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.30432125069815e-05, theta_kick=-2.7629678827955213e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.857524176956044e-05, theta_kick=3.4262790063881927e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.189801181161417e-05, theta_kick=5.023729263157391e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.573095167537043e-06, theta_kick=-1.8862002957134723e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.488699223591402e-05, theta_kick=5.38211926247467e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.62128275e-07 -7.25129604e-08], y_co=[-1.67845782e-05 -1.79773249e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.1637322983519264e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.30432125069815e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.857524176956044e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.189801181161417e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.573095167537043e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.488699223591402e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.34698995e-04 -1.44337047e-04  2.59495566e-03  2.43953702e-05]
 [ 1.10724373e-03 -3.45128142e-04 -1.93886738e-03 -6.69115321e-04]
 [-1.70604057e-03  2.95131159e-04  3.89578043e-03  4.27150500e-04]
 [ 5.54592210e-04  8.27907152e-04 -2.55921593e-03 -1.02883610e-04]
 [ 2.29662075e-04  3.47568089e-04  4.46150075e-03  1.21833698e-04]
 [ 1.60046227e-03  3.07009926e-04  4.50567315e-04  2.93749507e-04]
 [-4.31022200e-03  1.37234914e-04 -2.80269728e-03 -4.62332791e-04]
 [ 3.64075128e-03  6.45623026e-05  1.84379489e-03 -9.60849214e-04]
 [-1.55495767e-03  2.42845135e-05  4.20935186e-03  5.43202853e-05]
 [ 4.68735592e-04 -5.57202873e-05 -6.57691568e-04 -2.93289408e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.2469109903179227e-08, theta_kick=2.694130820460815e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.229678881288493e-09, theta_kick=-6.270581752416816e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.7663729399269942e-08, theta_kick=3.316985243501597e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.991505308435843e-08, theta_kick=-2.387889797899454e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.9107281609843606e-08, theta_kick=-2.2910349587555348e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.85667399465443e-10, theta_kick=8.221410111237607e-11
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-8.33600067e-11  4.88225842e-11], y_co=[3.24550217e-09 4.77326309e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.07961280e-03  3.29331280e-04  5.88253051e-03  3.45642204e-04]
 [-1.08308002e-03 -1.97001826e-04 -1.72833293e-04 -2.21462312e-04]
 [-8.69330462e-04  7.46284945e-04 -1.57161142e-03  9.98996309e-05]
 [ 9.36452853e-04  6.46455089e-04  2.08687010e-03 -3.07639936e-04]
 [ 1.80199553e-03 -1.86398109e-04 -2.00894358e-04  1.55627966e-04]
 [ 2.79833943e-03  4.42523924e-05 -1.24472787e-03 -5.83935895e-05]
 [-4.35380402e-03 -3.41214270e-04 -2.10801301e-03 -1.59511408e-04]
 [ 1.86004525e-04  2.34858952e-04  4.04902707e-04  2.92778533e-04]
 [-8.69137980e-05 -8.93356520e-04 -4.46259235e-03  6.40653531e-04]
 [-8.76076720e-03  4.60183687e-04  8.84787988e-04  1.23855177e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5471820610604215e-07, theta_kick=1.855129506032271e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.2373098107613353e-05, theta_kick=2.6826186449150804e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.2541103970886178e-05, theta_kick=1.503725553711733e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4796788295716925e-05, theta_kick=2.973228217931339e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.955568516233482e-05, theta_kick=-4.742875484587491e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.716547719544378e-06, theta_kick=9.25243106129432e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-1.26670648e-07  1.61147199e-08], y_co=[-1.06312055e-05  3.11752170e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5471820610604215e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.2373098107613353e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.2541103970886178e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.4796788295716925e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.955568516233482e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.716547719544378e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.07961280e-03  3.29331280e-04  5.88253051e-03  3.45642204e-04]
 [-1.08308002e-03 -1.97001826e-04 -1.72833293e-04 -2.21462312e-04]
 [-8.69330462e-04  7.46284945e-04 -1.57161142e-03  9.98996309e-05]
 [ 9.36452853e-04  6.46455089e-04  2.08687010e-03 -3.07639936e-04]
 [ 1.80199553e-03 -1.86398109e-04 -2.00894358e-04  1.55627966e-04]
 [ 2.79833943e-03  4.42523924e-05 -1.24472787e-03 -5.83935895e-05]
 [-4.35380402e-03 -3.41214270e-04 -2.10801301e-03 -1.59511408e-04]
 [ 1.86004525e-04  2.34858952e-04  4.04902707e-04  2.92778533e-04]
 [-8.69137980e-05 -8.93356520e-04 -4.46259235e-03  6.40653531e-04]
 [-8.76076720e-03  4.60183687e-04  8.84787988e-04  1.23855177e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.4511364062954593e-09, theta_kick=-4.138042404830374e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.012311377589616e-08, theta_kick=-1.2137994313167855e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.3198004001315546e-08, theta_kick=-1.5824903390355608e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.7207997962298396e-09, theta_kick=4.4613789558120223e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.380066060915376e-08, theta_kick=4.0528263866016395e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2646472830438418e-08, theta_kick=1.5163596764366535e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.73444417e-10 -5.98764275e-11], y_co=[ 4.47321675e-10 -5.24118828e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.31122419e-03 -3.50112213e-04  3.81320292e-04 -1.03237994e-04]
 [ 3.70255917e-03 -5.48259191e-04  3.98039309e-03 -6.07245890e-05]
 [-1.71459598e-03  5.55765632e-04 -1.72544190e-03 -4.51295723e-04]
 [ 3.61193261e-04 -3.80104148e-04  3.37815558e-04  9.18959952e-04]
 [ 3.22497085e-03 -5.31811303e-04  2.88772371e-04 -5.52555286e-04]
 [-6.74688300e-04  3.54089430e-04  3.76070529e-03 -5.57064530e-05]
 [-7.25911070e-04  1.53790627e-04 -9.81421662e-04  6.55257418e-04]
 [ 2.11595755e-03 -1.90185339e-04  2.01077911e-04 -3.84362776e-04]
 [ 3.21183602e-03  8.17451331e-05  2.18925150e-03  4.47538702e-04]
 [-1.24349152e-03 -3.19410674e-04  2.74703738e-03  6.70315433e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.987113266080243e-05, theta_kick=3.5816612002131243e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.9629749717388075e-05, theta_kick=4.7517561034162986e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.36375737133807e-05, theta_kick=-2.8342340278073353e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.2932579540421093e-05, theta_kick=5.147777826542561e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.858189798134278e-05, theta_kick=3.427077111225794e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.323032562667359e-06, theta_kick=8.780591581657949e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.19333089e-07 -6.96057866e-08], y_co=[-2.99508999e-05 -5.73417351e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.987113266080243e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.9629749717388075e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.36375737133807e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.2932579540421093e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.858189798134278e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.323032562667359e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.31122419e-03 -3.50112213e-04  3.81320292e-04 -1.03237994e-04]
 [ 3.70255917e-03 -5.48259191e-04  3.98039309e-03 -6.07245890e-05]
 [-1.71459598e-03  5.55765632e-04 -1.72544190e-03 -4.51295723e-04]
 [ 3.61193261e-04 -3.80104148e-04  3.37815558e-04  9.18959952e-04]
 [ 3.22497085e-03 -5.31811303e-04  2.88772371e-04 -5.52555286e-04]
 [-6.74688300e-04  3.54089430e-04  3.76070529e-03 -5.57064530e-05]
 [-7.25911070e-04  1.53790627e-04 -9.81421662e-04  6.55257418e-04]
 [ 2.11595755e-03 -1.90185339e-04  2.01077911e-04 -3.84362776e-04]
 [ 3.21183602e-03  8.17451331e-05  2.18925150e-03  4.47538702e-04]
 [-1.24349152e-03 -3.19410674e-04  2.74703738e-03  6.70315433e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.4592459696321656e-08, theta_kick=2.948728450049813e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.522496954374375e-08, theta_kick=-5.422644013368857e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.7521870988563575e-08, theta_kick=5.698051139005573e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.689701876898616e-08, theta_kick=-3.2250537540779687e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6831859835502334e-08, theta_kick=-2.018203326429367e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.548331206678957e-08, theta_kick=-6.652657880285365e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-3.24954254e-10  9.22269950e-11], y_co=[-5.36068675e-09  6.76588683e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.35947284e-03 -6.61543500e-04  2.29236228e-04 -3.67326469e-04]
 [ 1.61484517e-03 -8.58105870e-05 -9.88221767e-04  4.82506026e-04]
 [ 2.58482415e-03 -6.90728907e-06  3.77074365e-03  3.67994919e-04]
 [-1.74033066e-04  2.78130575e-05 -7.66665222e-04 -5.09803657e-04]
 [-7.96247028e-05 -6.08998532e-04  1.07944285e-03 -2.77597488e-04]
 [-2.50871092e-03 -1.63753880e-04 -2.59547374e-04 -7.49139895e-05]
 [ 2.55299004e-03 -2.52786296e-04  1.03408506e-03  2.27599987e-04]
 [-1.32921299e-03  2.67349106e-04  5.72892381e-04 -1.13534247e-04]
 [ 7.12494373e-04  4.29493863e-04  2.91553390e-03  6.24469506e-04]
 [ 2.41077023e-03 -9.11726738e-05 -2.07927126e-03 -4.40482294e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.209393082886036e-05, theta_kick=-5.04722069049705e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.973658594792746e-06, theta_kick=1.0759754301216648e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.7833644957806878e-05, theta_kick=2.1383211319459037e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4002338558264416e-05, theta_kick=2.8779707051860315e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.78236592558375e-05, theta_kick=5.7342366877709515e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.598020866875562e-05, theta_kick=1.9160871470835583e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 6.17587629e-08 -1.42343722e-07], y_co=[-3.23534587e-05 -1.05691195e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.209393082886036e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.973658594792746e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.7833644957806878e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.4002338558264416e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.78236592558375e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.598020866875562e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.35947284e-03 -6.61543500e-04  2.29236228e-04 -3.67326469e-04]
 [ 1.61484517e-03 -8.58105870e-05 -9.88221767e-04  4.82506026e-04]
 [ 2.58482415e-03 -6.90728907e-06  3.77074365e-03  3.67994919e-04]
 [-1.74033066e-04  2.78130575e-05 -7.66665222e-04 -5.09803657e-04]
 [-7.96247028e-05 -6.08998532e-04  1.07944285e-03 -2.77597488e-04]
 [-2.50871092e-03 -1.63753880e-04 -2.59547374e-04 -7.49139895e-05]
 [ 2.55299004e-03 -2.52786296e-04  1.03408506e-03  2.27599987e-04]
 [-1.32921299e-03  2.67349106e-04  5.72892381e-04 -1.13534247e-04]
 [ 7.12494373e-04  4.29493863e-04  2.91553390e-03  6.24469506e-04]
 [ 2.41077023e-03 -9.11726738e-05 -2.07927126e-03 -4.40482294e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.852684235167324e-08, theta_kick=3.4204757340741515e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.904302856322351e-08, theta_kick=-2.283330776704994e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.6609189276546262e-08, theta_kick=1.9915042885823935e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.2558587094429815e-08, theta_kick=-5.102934725070968e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.1192756036816685e-08, theta_kick=-1.3420535630750548e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5913205439902823e-08, theta_kick=-1.908053207835383e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-7.35804368e-11  8.65106820e-11], y_co=[1.68971715e-08 6.26147383e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.86774255e-03  4.22133138e-04  4.55616303e-03  5.93465089e-04]
 [-2.00959157e-03 -6.06440991e-04 -3.62082144e-03 -6.57196835e-04]
 [ 1.97773115e-03 -1.29735915e-04  2.11170206e-03  6.59216362e-04]
 [ 3.22933454e-03 -6.42576952e-05 -1.22891966e-03  3.25262298e-04]
 [-3.06145356e-03  3.58261858e-04 -2.23612394e-04 -3.95044555e-04]
 [-2.56250589e-03 -5.03747197e-04  9.77429380e-04  6.98999930e-04]
 [-1.36872691e-03  5.07902967e-04 -1.96961849e-04  9.60197247e-05]
 [ 1.34176066e-04 -6.63864789e-04  7.08396260e-04 -7.12404064e-04]
 [-2.49494602e-03  3.68045692e-04  3.38709462e-03 -5.67494950e-04]
 [ 9.08546803e-04 -2.78768410e-04  2.14071620e-03  3.51949290e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.865715211779197e-05, theta_kick=4.635137991694511e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.40656193665278e-05, theta_kick=4.084595938554002e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.439789909784852e-05, theta_kick=1.7263622758777004e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.321905622023872e-05, theta_kick=6.381165084714585e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.503193635712294e-05, theta_kick=8.996611487043241e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2412696444971542e-06, theta_kick=-1.488329008203858e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 8.15776790e-08 -1.55895469e-07], y_co=[-6.85164705e-05 -4.48573483e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.865715211779197e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.40656193665278e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.439789909784852e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.321905622023872e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.503193635712294e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.2412696444971542e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.86774255e-03  4.22133138e-04  4.55616303e-03  5.93465089e-04]
 [-2.00959157e-03 -6.06440991e-04 -3.62082144e-03 -6.57196835e-04]
 [ 1.97773115e-03 -1.29735915e-04  2.11170206e-03  6.59216362e-04]
 [ 3.22933454e-03 -6.42576952e-05 -1.22891966e-03  3.25262298e-04]
 [-3.06145356e-03  3.58261858e-04 -2.23612394e-04 -3.95044555e-04]
 [-2.56250589e-03 -5.03747197e-04  9.77429380e-04  6.98999930e-04]
 [-1.36872691e-03  5.07902967e-04 -1.96961849e-04  9.60197247e-05]
 [ 1.34176066e-04 -6.63864789e-04  7.08396260e-04 -7.12404064e-04]
 [-2.49494602e-03  3.68045692e-04  3.38709462e-03 -5.67494950e-04]
 [ 9.08546803e-04 -2.78768410e-04  2.14071620e-03  3.51949290e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.1373353063511085e-08, theta_kick=2.562745452451067e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6861485265863042e-08, theta_kick=-2.0217555269993105e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.081544430702293e-10, theta_kick=-1.0889113477822909e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0314458070634358e-08, theta_kick=-1.2367423322147236e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.754787662155884e-09, theta_kick=9.298282191315154e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.620490831053497e-08, theta_kick=4.341104732304896e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 2.19989832e-10 -1.87345713e-11], y_co=[ 1.65921260e-08 -1.60343149e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.28677257e-03  7.32892942e-04 -4.34158665e-03  1.02081932e-04]
 [ 1.88529796e-03 -4.19793714e-04  2.96254533e-03 -1.09875867e-04]
 [-1.72498112e-03 -2.42723838e-04  1.82625222e-03  4.34481124e-04]
 [-7.64752604e-04  7.39242789e-04 -1.49984729e-03  7.27249461e-04]
 [ 2.24618196e-04 -7.59953865e-04  2.22548552e-03 -4.39796309e-04]
 [-3.56739066e-03  3.30548596e-04 -1.03447564e-05 -8.22818795e-05]
 [ 1.19624790e-03 -2.79114475e-04  7.04905653e-04 -3.22340981e-04]
 [ 5.79072022e-05  5.50539834e-04 -4.95936213e-03 -5.72981521e-04]
 [ 1.14432943e-03  2.12888354e-04  8.02191971e-04 -2.69036622e-04]
 [-9.36984798e-05  8.99424383e-05  3.07058211e-03  3.16869927e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.483896096158859e-06, theta_kick=1.0172510637377185e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.243479812492715e-05, theta_kick=6.28712958820941e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.395907274231152e-05, theta_kick=1.126604635554183e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.8641914924636936e-05, theta_kick=3.434273368548642e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.0001051046748472982, theta_kick=1.260244598476741e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9698751883726068e-06, theta_kick=3.560992096435644e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-1.03937890e-07 -2.29009467e-07], y_co=[-1.07984225e-04 -8.04599190e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.483896096158859e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.243479812492715e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.395907274231152e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.8641914924636936e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.0001051046748472982, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9698751883726068e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.28677257e-03  7.32892942e-04 -4.34158665e-03  1.02081932e-04]
 [ 1.88529796e-03 -4.19793714e-04  2.96254533e-03 -1.09875867e-04]
 [-1.72498112e-03 -2.42723838e-04  1.82625222e-03  4.34481124e-04]
 [-7.64752604e-04  7.39242789e-04 -1.49984729e-03  7.27249461e-04]
 [ 2.24618196e-04 -7.59953865e-04  2.22548552e-03 -4.39796309e-04]
 [-3.56739066e-03  3.30548596e-04 -1.03447564e-05 -8.22818795e-05]
 [ 1.19624790e-03 -2.79114475e-04  7.04905653e-04 -3.22340981e-04]
 [ 5.79072022e-05  5.50539834e-04 -4.95936213e-03 -5.72981521e-04]
 [ 1.14432943e-03  2.12888354e-04  8.02191971e-04 -2.69036622e-04]
 [-9.36984798e-05  8.99424383e-05  3.07058211e-03  3.16869927e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
^CTraceback (most recent call last):
  File "/home/aribra/jnps/thesis/lattice_error_net/main.py", line 146, in <module>
    main_evaluation_block(model, data_sub_cfg, run_benchmark=RUN_BENCHMARK)
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 573, in main_evaluation_block
    stats = benchmark_evaluation(
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 457, in benchmark_evaluation
    actual_deltas, predicted_deltas = _run_evaluation(
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 355, in _run_evaluation
    runner_corrected.run_configurations(draw_plots=False, verbose=False, initial_states=initial_states)
  File "/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py", line 3218, in run_configurations
    simulator_no_error.simulate(initial_states)
  File "/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py", line 1597, in simulate
    states_x.append([x, xp])
KeyboardInterrupt
^C
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 main.py tree -ifP setup.py | grep .py[2Ppython cross_validation.py [33@3 accumulated_training.py; python[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Cexit[Kpython3 main.py jnp[Kipython3/bin/python3 /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aipython3[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[5Pjnpsnx -dpython /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/printEnvVariablesToFile.py /home/aribra/.vscode/extensions/ms-python.python-2024.22.2-linux-x64/python_files/deactivate/bash/envVars.txt[Aecho $'\n dsf d'[K
[K[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C'[K[1P'\n'"\n"[2P\nendli endline[Kll /home/exdata/repos/dr_system/install/system_launch/share/system_launch[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[47Pros2 launch system_launch [1Psource install/setup.bashros2 launch system_launch^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 main.py 
[?2004l--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-17-42/figs
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-17-42/training
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-17-42/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])
merged_config:  {'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': (0.0, 0.05), 'xp0_mean_std': (0.0, 0.0), 'y0_mean_std': (0.0, 0.05), 'yp0_mean_std': (0.0, 0.0), 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': (4.71238898038469, 6.283185307179586), 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_2000_mix/run_2025-01-17_14-17-42/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': (0, 5e-05), 'quad_tilt_angle_range': (0, 0.01), 'dipole_tilt_angle_range': (0, 0.05), 'com_delta_range': (-5e-05, 5e-05), 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 15, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}], 'dipole_tilt_errors': None}
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:79: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:176: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
/home/aribra/jnps/thesis/lattice_error_net/models/net.py:434: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  chkpnt_state_dict = torch.load(model_load_path)
Checkpoint Loaded.
QuadErrorCorrectionLSTM(
  (lstm): LSTM(16, 256, batch_first=True, bidirectional=True)
  (fc): Linear(in_features=512, out_features=6, bias=True)
)
[1, 2, 3, 4, 5, 7]
torch.Size([16, 101, 16])
/home/aribra/jnps/thesis/lattice_error_net/eval.py:156: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/eval.py:162: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[A^[[ARunning benchmark...
Running evaluation for noise_level= 0.0
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.47464832e-03 -9.54179230e-04  3.70558431e-03 -3.73063079e-05]
 [-2.76742273e-03 -3.82174636e-04  6.35931118e-03  1.08826803e-04]
 [-1.40016254e-03  1.24891254e-04  2.08659769e-04 -3.63817661e-05]
 [-8.77695782e-04 -6.92791024e-04 -2.88420905e-03  2.04437325e-04]
 [-1.84957772e-03 -7.08162089e-04  4.86941913e-03  1.50319253e-03]
 [ 1.58650247e-03 -3.17006988e-04  3.64768014e-03 -6.32724732e-04]
 [-1.06848813e-04 -5.68556506e-05 -1.91581613e-03 -5.30832651e-04]
 [-3.81820555e-03 -1.58390474e-04  2.16306448e-03  3.40389888e-04]
 [ 1.82666073e-03  7.51418384e-05 -2.96067720e-04 -4.06498037e-04]
 [-2.47857097e-03  8.88314480e-04 -2.30077734e-03 -9.10719297e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4800614670534868e-05, theta_kick=-1.7746493883146866e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1854255130899758e-05, theta_kick=-1.4213697934355618e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.228165202725727e-05, theta_kick=-9.865879673929587e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.9605964359998104e-05, theta_kick=5.947941775924189e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.305015274204729e-05, theta_kick=5.161875295802639e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9569186532659437e-05, theta_kick=3.5454567233355707e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 4.38377943e-07 -1.13902323e-07], y_co=[ 1.39387104e-05 -1.11443626e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.4800614670534868e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.1854255130899758e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.228165202725727e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.9605964359998104e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.305015274204729e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9569186532659437e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.47464832e-03 -9.54179230e-04  3.70558431e-03 -3.73063079e-05]
 [-2.76742273e-03 -3.82174636e-04  6.35931118e-03  1.08826803e-04]
 [-1.40016254e-03  1.24891254e-04  2.08659769e-04 -3.63817661e-05]
 [-8.77695782e-04 -6.92791024e-04 -2.88420905e-03  2.04437325e-04]
 [-1.84957772e-03 -7.08162089e-04  4.86941913e-03  1.50319253e-03]
 [ 1.58650247e-03 -3.17006988e-04  3.64768014e-03 -6.32724732e-04]
 [-1.06848813e-04 -5.68556506e-05 -1.91581613e-03 -5.30832651e-04]
 [-3.81820555e-03 -1.58390474e-04  2.16306448e-03  3.40389888e-04]
 [ 1.82666073e-03  7.51418384e-05 -2.96067720e-04 -4.06498037e-04]
 [-2.47857097e-03  8.88314480e-04 -2.30077734e-03 -9.10719297e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.31784317630642e-08, theta_kick=3.978218806735182e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.667072627336246e-08, theta_kick=-9.193108564169408e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.913509733926936e-08, theta_kick=8.28955830114702e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.30894753119382e-08, theta_kick=-5.166590219889055e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.7364437677394697e-08, theta_kick=3.2810990399231107e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.902957150693232e-09, theta_kick=1.1874018235858303e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 4.38693158e-11 -1.57762707e-11], y_co=[ 4.20059576e-09 -2.07745521e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.85796737e-04  2.87644139e-05 -1.31595613e-03 -1.24919192e-03]
 [-2.25828385e-03  4.68471911e-04 -4.06024623e-04  3.76455220e-04]
 [-1.39861513e-03  1.23928174e-04  4.01528059e-03  2.13903192e-04]
 [-3.31486034e-03  1.19821072e-03  1.50935597e-03 -5.96814712e-05]
 [-5.92932778e-03 -5.01995441e-05 -8.54951777e-04 -6.57720171e-04]
 [-1.52399457e-03  2.75140293e-04  2.15612987e-03  5.94813347e-04]
 [-5.11355042e-04  8.46210846e-05 -5.94076818e-04 -1.19623868e-04]
 [ 5.79762416e-04 -5.17009722e-04 -2.33880940e-03  4.93449469e-04]
 [ 3.45998689e-03 -1.06327719e-04 -1.63466193e-03 -5.53534752e-04]
 [ 5.61757316e-04  1.17017376e-04  3.18223904e-03  3.54199743e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.586734712722946e-05, theta_kick=-1.0295818008079778e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.8642128618881555e-05, theta_kick=3.4342989912926255e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.0001446055791912794, theta_kick=1.7338753043114054e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.885842614747213e-05, theta_kick=-5.8583091315285414e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.4194872538726014e-05, theta_kick=-6.498169132942292e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.6556979314297253e-05, theta_kick=3.1842817440162596e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-5.08523545e-07 -2.95347270e-09], y_co=[-2.81512676e-05 -3.91859707e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 8.586734712722946e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.8642128618881555e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.0001446055791912794, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.885842614747213e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.4194872538726014e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.6556979314297253e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.85796737e-04  2.87644139e-05 -1.31595613e-03 -1.24919192e-03]
 [-2.25828385e-03  4.68471911e-04 -4.06024623e-04  3.76455220e-04]
 [-1.39861513e-03  1.23928174e-04  4.01528059e-03  2.13903192e-04]
 [-3.31486034e-03  1.19821072e-03  1.50935597e-03 -5.96814712e-05]
 [-5.92932778e-03 -5.01995441e-05 -8.54951777e-04 -6.57720171e-04]
 [-1.52399457e-03  2.75140293e-04  2.15612987e-03  5.94813347e-04]
 [-5.11355042e-04  8.46210846e-05 -5.94076818e-04 -1.19623868e-04]
 [ 5.79762416e-04 -5.17009722e-04 -2.33880940e-03  4.93449469e-04]
 [ 3.45998689e-03 -1.06327719e-04 -1.63466193e-03 -5.53534752e-04]
 [ 5.61757316e-04  1.17017376e-04  3.18223904e-03  3.54199743e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.0009590876515415e-09, theta_kick=-5.996338113954059e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.42937204898161e-08, theta_kick=5.3109837478522216e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.061375601290375e-08, theta_kick=9.665892666123916e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.657574079369991e-08, theta_kick=3.186531315989246e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.443030633887382e-08, theta_kick=-4.128323278722423e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.71894255688428e-08, theta_kick=8.056264935019283e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-8.79439391e-11 -8.00646601e-11], y_co=[-3.75321543e-08 -8.41421751e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.20296878e-03  5.10618122e-04 -4.70715317e-04  3.79548282e-04]
 [-1.77661566e-03  6.43509756e-04 -4.10724574e-05 -6.24576613e-05]
 [-2.37050972e-03 -2.92502676e-04 -2.52345697e-03 -4.70621491e-04]
 [ 2.77293651e-03 -3.78918264e-04 -2.80299644e-03 -4.67724807e-04]
 [ 2.80511084e-03  9.00481376e-05  3.03468952e-03  6.05133165e-04]
 [ 2.11387309e-03 -4.34706232e-04 -5.83092891e-04 -4.62973210e-04]
 [-6.49561461e-04  1.72888260e-04 -5.61688471e-03 -5.87070603e-04]
 [-3.20470357e-03 -7.29713913e-05 -2.18675190e-03 -4.97777677e-04]
 [ 1.98340750e-03 -2.01968260e-04  1.97448019e-03  5.68327258e-04]
 [ 3.61980561e-03 -4.89862972e-04 -6.05635127e-04  4.00181100e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.685717713350948e-05, theta_kick=8.016427097493074e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.3188861741805609e-05, theta_kick=1.5813941477213295e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.878571000148536e-05, theta_kick=-5.849590192020378e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.992165868848835e-05, theta_kick=8.383869966461999e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0419658192998435e-05, theta_kick=-1.249356222715887e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.240465468479981e-05, theta_kick=-9.880628155383098e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-2.27565839e-07  6.36346637e-08], y_co=[-3.43102225e-05  9.85173570e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.685717713350948e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.3188861741805609e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.878571000148536e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.992165868848835e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.0419658192998435e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.240465468479981e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.20296878e-03  5.10618122e-04 -4.70715317e-04  3.79548282e-04]
 [-1.77661566e-03  6.43509756e-04 -4.10724574e-05 -6.24576613e-05]
 [-2.37050972e-03 -2.92502676e-04 -2.52345697e-03 -4.70621491e-04]
 [ 2.77293651e-03 -3.78918264e-04 -2.80299644e-03 -4.67724807e-04]
 [ 2.80511084e-03  9.00481376e-05  3.03468952e-03  6.05133165e-04]
 [ 2.11387309e-03 -4.34706232e-04 -5.83092891e-04 -4.62973210e-04]
 [-6.49561461e-04  1.72888260e-04 -5.61688471e-03 -5.87070603e-04]
 [-3.20470357e-03 -7.29713913e-05 -2.18675190e-03 -4.97777677e-04]
 [ 1.98340750e-03 -2.01968260e-04  1.97448019e-03  5.68327258e-04]
 [ 3.61980561e-03 -4.89862972e-04 -6.05635127e-04  4.00181100e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.801576426770603e-08, theta_kick=3.3591955488059627e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.864236058361388e-09, theta_kick=1.1827590189218873e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.0931430757107465e-08, theta_kick=4.907832557829889e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8579850236821608e-08, theta_kick=2.2277939525982118e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.377088177312175e-09, theta_kick=5.248293418469074e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.365209969962305e-08, theta_kick=5.234051000922939e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 8.33461263e-11 -7.05181508e-11], y_co=[-2.31337743e-08 -1.28461498e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.36349526e-03  1.64251840e-04  1.43525561e-03  4.80415937e-05]
 [ 2.60060163e-03  7.42561947e-05 -9.19552706e-04  5.16409942e-04]
 [-1.27595332e-03  5.92748987e-04  4.53978314e-03  2.11341876e-04]
 [ 2.61206665e-03  4.50988537e-04  3.24169097e-03  4.56866367e-04]
 [-1.12088590e-03 -1.12413805e-04  1.79896263e-03  2.26212374e-04]
 [ 1.13109434e-03 -2.28592462e-04 -3.01110837e-03 -4.75398035e-04]
 [-1.54586545e-03 -1.20144773e-04 -9.69561778e-04 -4.95339743e-04]
 [-7.98304422e-04  1.32464714e-04 -2.66319225e-04  2.40058154e-04]
 [ 1.22534263e-03 -5.10070686e-04 -2.36240132e-03 -3.53187666e-05]
 [ 2.91562083e-03 -6.25014639e-04 -2.58548104e-03  5.71561539e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5281789379373606e-05, theta_kick=1.8323440463894718e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.413073374229063e-05, theta_kick=2.893365770855047e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.68921530298791e-05, theta_kick=-8.02062083906934e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.147426653726485e-05, theta_kick=1.09681087421368e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0451447543616247e-05, theta_kick=1.2531678854667003e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.5397036607222197e-05, theta_kick=5.4432755017055564e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 3.54964743e-07 -1.19956769e-07], y_co=[-1.17983457e-05 -6.59516104e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5281789379373606e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.413073374229063e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.68921530298791e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.147426653726485e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0451447543616247e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.5397036607222197e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.36349526e-03  1.64251840e-04  1.43525561e-03  4.80415937e-05]
 [ 2.60060163e-03  7.42561947e-05 -9.19552706e-04  5.16409942e-04]
 [-1.27595332e-03  5.92748987e-04  4.53978314e-03  2.11341876e-04]
 [ 2.61206665e-03  4.50988537e-04  3.24169097e-03  4.56866367e-04]
 [-1.12088590e-03 -1.12413805e-04  1.79896263e-03  2.26212374e-04]
 [ 1.13109434e-03 -2.28592462e-04 -3.01110837e-03 -4.75398035e-04]
 [-1.54586545e-03 -1.20144773e-04 -9.69561778e-04 -4.95339743e-04]
 [-7.98304422e-04  1.32464714e-04 -2.66319225e-04  2.40058154e-04]
 [ 1.22534263e-03 -5.10070686e-04 -2.36240132e-03 -3.53187666e-05]
 [ 2.91562083e-03 -6.25014639e-04 -2.58548104e-03  5.71561539e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3888788230304418e-08, theta_kick=-1.6653179672605603e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8828857088938046e-08, theta_kick=-3.456688437443561e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.933013129093371e-08, theta_kick=4.715830726729506e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.753330019775779e-08, theta_kick=-4.500383917837329e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.3583907399590395e-09, theta_kick=5.225874487566258e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.0616563443529455e-08, theta_kick=-4.870078782200967e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-2.40026251e-10  4.51240888e-11], y_co=[-2.91357443e-09  1.59131081e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.90857064e-03 -3.12323671e-04  2.60371409e-03  1.81019297e-04]
 [ 1.24152587e-03 -6.67953263e-04  1.16243279e-03 -2.38155476e-04]
 [-1.23890785e-03 -6.77888858e-05 -1.05601205e-03  4.17116082e-04]
 [ 1.82978693e-03 -2.40587009e-04  2.24061054e-03  2.84829594e-04]
 [ 7.15787091e-04 -3.52327938e-04 -5.50316694e-04 -1.84044802e-03]
 [ 4.95023196e-03 -1.71369745e-05  1.77033863e-03 -1.75206112e-04]
 [-1.17066041e-03 -1.09916336e-04  4.84895460e-03  7.48078107e-04]
 [-4.38359975e-04  5.70273389e-04  5.63817790e-04  2.94301598e-04]
 [-1.05774233e-03 -6.19945039e-04 -2.44365277e-03 -3.00566307e-04]
 [ 3.14042737e-03  3.04658494e-05  3.24079611e-04 -2.35319879e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.706113097996677e-05, theta_kick=-6.8418443047327e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.3065140732878e-05, theta_kick=5.163672412297587e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4609447560200096e-05, theta_kick=-1.7517277324933996e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.057465955633399e-05, theta_kick=8.462167227520912e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.39526722841397e-05, theta_kick=1.006624129016986e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.875850978429454e-05, theta_kick=-5.846328783634697e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-1.22792558e-07 -1.85170474e-07], y_co=[-7.69556653e-05 -1.16534388e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.706113097996677e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.3065140732878e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.4609447560200096e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.057465955633399e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.39526722841397e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.875850978429454e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.90857064e-03 -3.12323671e-04  2.60371409e-03  1.81019297e-04]
 [ 1.24152587e-03 -6.67953263e-04  1.16243279e-03 -2.38155476e-04]
 [-1.23890785e-03 -6.77888858e-05 -1.05601205e-03  4.17116082e-04]
 [ 1.82978693e-03 -2.40587009e-04  2.24061054e-03  2.84829594e-04]
 [ 7.15787091e-04 -3.52327938e-04 -5.50316694e-04 -1.84044802e-03]
 [ 4.95023196e-03 -1.71369745e-05  1.77033863e-03 -1.75206112e-04]
 [-1.17066041e-03 -1.09916336e-04  4.84895460e-03  7.48078107e-04]
 [-4.38359975e-04  5.70273389e-04  5.63817790e-04  2.94301598e-04]
 [-1.05774233e-03 -6.19945039e-04 -2.44365277e-03 -3.00566307e-04]
 [ 3.14042737e-03  3.04658494e-05  3.24079611e-04 -2.35319879e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.6984807623153303e-08, theta_kick=2.0365423416554868e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.717780691839373e-08, theta_kick=-1.0452947067822849e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.087510065259302e-08, theta_kick=3.7020407399943803e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.606474828245874e-08, theta_kick=-1.0319487149340353e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.536376723422267e-08, theta_kick=-1.842173499638658e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.3704650755723656e-08, theta_kick=2.8422768175707134e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[1.41153526e-10 9.47896339e-11], y_co=[6.40729595e-08 1.36419782e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.40279451e-03  5.49222908e-04  1.06916022e-03 -4.92247021e-05]
 [ 1.06658780e-03  3.32966920e-04  2.39321406e-03 -6.23896343e-04]
 [ 6.50430492e-04  2.18501649e-04  3.39240835e-03  1.19010070e-04]
 [-5.65461914e-04  1.51991244e-04  1.68286798e-03  1.85339325e-04]
 [-5.65250754e-03  1.04228683e-03 -1.11579746e-03 -2.94524777e-04]
 [-1.03307066e-04  2.96039531e-06 -8.57015141e-04 -6.28824964e-04]
 [-8.85565219e-05 -3.47202606e-04 -1.23071880e-03 -9.11584653e-04]
 [ 8.32252649e-04  7.87742222e-04 -1.94943844e-03 -6.83078612e-05]
 [-1.58102078e-03  1.36066240e-04 -1.85249445e-03 -2.20866002e-06]
 [-1.78201565e-03 -5.04751713e-04 -4.15904610e-03 -1.24242406e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.942854362268429e-05, theta_kick=1.1921856493723594e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.58789144161621e-05, theta_kick=4.302016837773403e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.404636519079956e-05, theta_kick=1.007747542221063e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.4688733489692063e-05, theta_kick=4.159309666472691e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.3319504843573866e-05, theta_kick=1.5970587471857106e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.787937356750353e-06, theta_kick=-3.3428417906631984e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-2.00866697e-07 -4.49585275e-08], y_co=[-7.69659817e-05  8.50218440e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.942854362268429e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.58789144161621e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.404636519079956e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.4688733489692063e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.3319504843573866e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.787937356750353e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.40279451e-03  5.49222908e-04  1.06916022e-03 -4.92247021e-05]
 [ 1.06658780e-03  3.32966920e-04  2.39321406e-03 -6.23896343e-04]
 [ 6.50430492e-04  2.18501649e-04  3.39240835e-03  1.19010070e-04]
 [-5.65461914e-04  1.51991244e-04  1.68286798e-03  1.85339325e-04]
 [-5.65250754e-03  1.04228683e-03 -1.11579746e-03 -2.94524777e-04]
 [-1.03307066e-04  2.96039531e-06 -8.57015141e-04 -6.28824964e-04]
 [-8.85565219e-05 -3.47202606e-04 -1.23071880e-03 -9.11584653e-04]
 [ 8.32252649e-04  7.87742222e-04 -1.94943844e-03 -6.83078612e-05]
 [-1.58102078e-03  1.36066240e-04 -1.85249445e-03 -2.20866002e-06]
 [-1.78201565e-03 -5.04751713e-04 -4.15904610e-03 -1.24242406e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.994360644923433e-09, theta_kick=4.789388706493132e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3941909102922316e-08, theta_kick=-2.8707249861165027e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.6742964480793363e-08, theta_kick=-3.206582065273525e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.771851216271388e-08, theta_kick=-6.920666782029826e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5882007326779152e-08, theta_kick=1.9043124366847285e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.130524072401432e-08, theta_kick=6.1516914057272334e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[3.92937179e-10 1.54889830e-11], y_co=[ 5.59561151e-08 -2.76693038e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.48137307e-05 -4.85046516e-04  7.57282960e-04  1.02028986e-03]
 [-1.90937105e-03 -5.14905322e-05 -4.37038615e-03 -1.21609954e-03]
 [ 2.38991874e-03 -4.71439085e-04  1.58541382e-03  2.12916888e-05]
 [-2.26483001e-03 -4.53269475e-04 -1.21313381e-03  5.57695365e-04]
 [-1.30672249e-03  3.56115924e-04 -5.36756363e-03 -3.67214980e-04]
 [-7.96994593e-04 -7.04493162e-04  1.86707434e-04  5.14661144e-04]
 [-1.26441946e-03  6.31161722e-05  7.16564936e-04  4.81032833e-04]
 [-1.56150885e-03  4.92866918e-04  6.93060454e-04  1.42338569e-04]
 [ 4.09733764e-03 -1.29639020e-04  7.67109989e-04  3.74028138e-04]
 [ 7.47815299e-04 -4.57349754e-04  2.60647447e-03  6.10497736e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.072625799455158e-05, theta_kick=-1.2861186925453938e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.447560052038284e-05, theta_kick=-4.133754221510848e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.5924280744403456e-05, theta_kick=-5.506494057581075e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.695497643559719e-06, theta_kick=-6.829115975441936e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.322353310061237e-05, theta_kick=-6.381701879516255e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.188898776122409e-05, theta_kick=5.022647245561408e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[2.35813750e-07 6.39455442e-08], y_co=[ 6.33165396e-05 -5.33486521e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.072625799455158e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.447560052038284e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.5924280744403456e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.695497643559719e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.322353310061237e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.188898776122409e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.48137307e-05 -4.85046516e-04  7.57282960e-04  1.02028986e-03]
 [-1.90937105e-03 -5.14905322e-05 -4.37038615e-03 -1.21609954e-03]
 [ 2.38991874e-03 -4.71439085e-04  1.58541382e-03  2.12916888e-05]
 [-2.26483001e-03 -4.53269475e-04 -1.21313381e-03  5.57695365e-04]
 [-1.30672249e-03  3.56115924e-04 -5.36756363e-03 -3.67214980e-04]
 [-7.96994593e-04 -7.04493162e-04  1.86707434e-04  5.14661144e-04]
 [-1.26441946e-03  6.31161722e-05  7.16564936e-04  4.81032833e-04]
 [-1.56150885e-03  4.92866918e-04  6.93060454e-04  1.42338569e-04]
 [ 4.09733764e-03 -1.29639020e-04  7.67109989e-04  3.74028138e-04]
 [ 7.47815299e-04 -4.57349754e-04  2.60647447e-03  6.10497736e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.0408504073876713e-08, theta_kick=-2.4470564282188862e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.13815264951233e-08, theta_kick=3.762763104009593e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4370630852733265e-08, theta_kick=-1.7230927106879152e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.745921957561291e-08, theta_kick=2.093426119794628e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2506956784114195e-10, theta_kick=-1.4996311775343562e-11
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.7890561837304172e-08, theta_kick=-2.145145679955098e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-1.00280258e-10 -8.03459859e-12], y_co=[-1.50453056e-08  1.16461625e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.54835640e-03  4.94842613e-04 -3.30317894e-03  1.59315483e-04]
 [-3.46328100e-03  6.06230312e-04 -1.98777867e-03  8.77807226e-05]
 [ 4.40279628e-05  4.42122967e-04  1.19061394e-03  1.30721108e-04]
 [-6.37714466e-04 -9.63760385e-05 -4.11358501e-03 -9.34811764e-04]
 [-3.29733843e-03  5.60514393e-04 -9.92754974e-04 -8.74996381e-04]
 [ 1.24656553e-04 -4.20998330e-04  5.55260438e-04 -2.15105522e-04]
 [-2.56969984e-04 -3.83921014e-04  1.70044316e-03  4.88708063e-04]
 [-4.68977622e-03  2.07662071e-04 -2.23085724e-03 -7.32845758e-04]
 [ 4.06729206e-03 -4.78544332e-04  3.01691457e-03  5.97447535e-04]
 [ 5.10555781e-03 -1.49352994e-04  1.81214126e-03 -3.91226921e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.390154265441581e-05, theta_kick=8.861073028829229e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.50211481214767e-05, theta_kick=8.995317936997059e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00011095702134254563, theta_kick=-1.3304164349794011e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4240314411968417e-05, theta_kick=2.9065049054615266e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0690917365062194e-05, theta_kick=-1.2818812180957107e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.8237866528512086e-05, theta_kick=3.3858264455664503e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[3.81871693e-07 5.88026468e-08], y_co=[2.59096183e-05 9.04733110e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.390154265441581e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.50211481214767e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00011095702134254563, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.4240314411968417e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.0690917365062194e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.8237866528512086e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.54835640e-03  4.94842613e-04 -3.30317894e-03  1.59315483e-04]
 [-3.46328100e-03  6.06230312e-04 -1.98777867e-03  8.77807226e-05]
 [ 4.40279628e-05  4.42122967e-04  1.19061394e-03  1.30721108e-04]
 [-6.37714466e-04 -9.63760385e-05 -4.11358501e-03 -9.34811764e-04]
 [-3.29733843e-03  5.60514393e-04 -9.92754974e-04 -8.74996381e-04]
 [ 1.24656553e-04 -4.20998330e-04  5.55260438e-04 -2.15105522e-04]
 [-2.56969984e-04 -3.83921014e-04  1.70044316e-03  4.88708063e-04]
 [-4.68977622e-03  2.07662071e-04 -2.23085724e-03 -7.32845758e-04]
 [ 4.06729206e-03 -4.78544332e-04  3.01691457e-03  5.97447535e-04]
 [ 5.10555781e-03 -1.49352994e-04  1.81214126e-03 -3.91226921e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.797166989898216e-09, theta_kick=-5.75198372079409e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.2090814382363e-08, theta_kick=8.643959895899697e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8586778341499258e-09, theta_kick=-3.427662284771572e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.1951964870519155e-08, theta_kick=3.831160811571213e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.832724979627326e-08, theta_kick=-1.178980722016971e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.171739160258804e-08, theta_kick=-1.4049593414234224e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-3.61173695e-10  1.15848867e-10], y_co=[-8.53834985e-09  1.20751774e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.16886933e-03  6.02668119e-04 -3.91520807e-03 -5.96328665e-04]
 [-1.04445235e-03  8.45539994e-05 -4.69214141e-03  2.81487425e-04]
 [ 3.29473727e-03 -3.46249580e-04 -3.22260704e-03 -3.64420327e-04]
 [-1.20245431e-03 -3.73645614e-04  3.06230888e-03 -6.13179561e-04]
 [ 3.21117864e-03  1.20166148e-04 -7.90502880e-04 -1.64782979e-04]
 [ 3.14957014e-04  2.08794614e-04 -4.47421826e-03  1.32961928e-05]
 [-1.96543685e-03  5.40861950e-05 -3.12694332e-03 -1.60742544e-04]
 [ 3.00467048e-03 -8.41198817e-05  2.64163751e-03  5.34839045e-05]
 [ 1.71903513e-03  9.44883722e-04  6.10606537e-04  1.02063943e-03]
 [ 6.00797808e-04 -5.79890399e-05 -2.96086855e-03 -7.81336803e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.615998740382494e-05, theta_kick=-3.13668092021479e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2217007492028923e-05, theta_kick=-1.464865166439845e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.942911504056787e-06, theta_kick=3.528661624395829e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.750412468797561e-05, theta_kick=-3.297848038083061e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.287328323676922e-05, theta_kick=8.737780855688059e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.6330667610817107e-05, theta_kick=-3.1571461192405497e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 3.89772219e-08 -6.65588663e-08], y_co=[-1.28836611e-05 -6.74054747e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.615998740382494e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2217007492028923e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.942911504056787e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.750412468797561e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.287328323676922e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.6330667610817107e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.16886933e-03  6.02668119e-04 -3.91520807e-03 -5.96328665e-04]
 [-1.04445235e-03  8.45539994e-05 -4.69214141e-03  2.81487425e-04]
 [ 3.29473727e-03 -3.46249580e-04 -3.22260704e-03 -3.64420327e-04]
 [-1.20245431e-03 -3.73645614e-04  3.06230888e-03 -6.13179561e-04]
 [ 3.21117864e-03  1.20166148e-04 -7.90502880e-04 -1.64782979e-04]
 [ 3.14957014e-04  2.08794614e-04 -4.47421826e-03  1.32961928e-05]
 [-1.96543685e-03  5.40861950e-05 -3.12694332e-03 -1.60742544e-04]
 [ 3.00467048e-03 -8.41198817e-05  2.64163751e-03  5.34839045e-05]
 [ 1.71903513e-03  9.44883722e-04  6.10606537e-04  1.02063943e-03]
 [ 6.00797808e-04 -5.79890399e-05 -2.96086855e-03 -7.81336803e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.8711231588401617e-08, theta_kick=-3.4425846973473643e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.508929658885977e-08, theta_kick=5.406376315590397e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2061459980073685e-08, theta_kick=-2.6452520608424055e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.408406102693969e-09, theta_kick=5.285844789381211e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.575006679825356e-09, theta_kick=5.485605149934131e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.8831704914120777e-08, theta_kick=3.457029902398298e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.16219244e-10 -3.98735111e-11], y_co=[ 1.25151525e-09 -2.83750378e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.32544212e-03 -4.90062985e-04  4.89334150e-04 -2.17121227e-04]
 [-1.43265946e-03  8.70706522e-04  2.94546868e-03  1.42697545e-04]
 [ 2.60824270e-03 -5.22885649e-04 -3.80261812e-04 -4.67266194e-04]
 [ 2.68602514e-03 -6.97931351e-04  2.65824632e-04 -4.80240154e-04]
 [-4.20391585e-03 -2.01805778e-04 -1.92519394e-03 -1.36965635e-04]
 [-2.55472138e-03 -2.63839994e-04  4.02297991e-04  8.79158767e-04]
 [-4.46168695e-04  1.21508693e-04  4.41774035e-03 -7.34370511e-04]
 [ 1.61368219e-03 -1.25540139e-03  2.48562625e-03  6.40235796e-04]
 [-1.06574797e-03 -4.66201457e-04 -2.10601360e-03 -6.49783018e-04]
 [-1.86644207e-03 -8.27105283e-05 -2.32773011e-03  5.27614080e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.547249448835566e-05, theta_kick=1.8552103065102255e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.84601370457098e-05, theta_kick=9.407665648674274e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.6566849695149748e-05, theta_kick=-1.9864276134645407e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.444075759886322e-05, theta_kick=5.3286140504740115e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6813211711101063e-05, theta_kick=-2.0159673461475605e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.315530089036674e-06, theta_kick=5.174482954420292e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-7.27294553e-08 -1.31047468e-08], y_co=[-3.22391262e-05  4.75623452e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.547249448835566e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.84601370457098e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.6566849695149748e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.444075759886322e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.6813211711101063e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.315530089036674e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.32544212e-03 -4.90062985e-04  4.89334150e-04 -2.17121227e-04]
 [-1.43265946e-03  8.70706522e-04  2.94546868e-03  1.42697545e-04]
 [ 2.60824270e-03 -5.22885649e-04 -3.80261812e-04 -4.67266194e-04]
 [ 2.68602514e-03 -6.97931351e-04  2.65824632e-04 -4.80240154e-04]
 [-4.20391585e-03 -2.01805778e-04 -1.92519394e-03 -1.36965635e-04]
 [-2.55472138e-03 -2.63839994e-04  4.02297991e-04  8.79158767e-04]
 [-4.46168695e-04  1.21508693e-04  4.41774035e-03 -7.34370511e-04]
 [ 1.61368219e-03 -1.25540139e-03  2.48562625e-03  6.40235796e-04]
 [-1.06574797e-03 -4.66201457e-04 -2.10601360e-03 -6.49783018e-04]
 [-1.86644207e-03 -8.27105283e-05 -2.32773011e-03  5.27614080e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.0352309226947607e-08, theta_kick=2.4403184546313628e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.5450391461689014e-08, theta_kick=-3.0515976968018404e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.0133491750868e-08, theta_kick=3.613119042273601e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.552176154619123e-10, theta_kick=-1.1453418622955308e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.0728536039927824e-11, theta_kick=-6.082542344175769e-12
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.9231065650195854e-09, theta_kick=5.902990010011722e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[-1.67956208e-11 -7.62147383e-12], y_co=[-5.55330618e-09  1.90480304e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.81567115e-05  2.94860577e-04 -2.16914722e-04 -1.16515717e-04]
 [-2.13350077e-03  9.57787569e-05  2.52306982e-03  5.44398862e-04]
 [-3.77090807e-03 -1.78654314e-04 -8.07426771e-04 -2.58639349e-04]
 [-3.95021374e-03  5.24328799e-05 -3.53080403e-03 -1.54180873e-04]
 [ 3.67184802e-03 -5.75354186e-04  5.30730698e-03  5.02046769e-04]
 [-9.05120870e-05  5.02655148e-04 -5.11741035e-04  9.18695151e-04]
 [ 1.79573185e-04 -3.56336206e-04 -1.73422977e-05 -2.68631648e-04]
 [ 5.23636612e-03  3.51448196e-04 -2.99859285e-03 -4.45769363e-04]
 [ 4.60320600e-04  7.54073047e-04  2.77088415e-03  9.77916352e-05]
 [ 3.47666170e-03 -7.29162355e-04 -5.31955126e-04 -2.92760567e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.2950801990089e-05, theta_kick=-6.349000393176756e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.472979244797783e-05, theta_kick=-5.363270416415624e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.207551452899324e-05, theta_kick=6.244050133203737e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.974699604610609e-05, theta_kick=-7.163889632093937e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.7504443798138297e-05, theta_kick=-3.297886300592262e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.325270702969683e-05, theta_kick=8.783275196093497e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[ 1.43144286e-07 -7.73137556e-09], y_co=[ 4.68019389e-05 -6.67618741e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.2950801990089e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.472979244797783e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.207551452899324e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.974699604610609e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.7504443798138297e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.325270702969683e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015086837558366714}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007538273038851655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004406659617524457}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.81567115e-05  2.94860577e-04 -2.16914722e-04 -1.16515717e-04]
 [-2.13350077e-03  9.57787569e-05  2.52306982e-03  5.44398862e-04]
 [-3.77090807e-03 -1.78654314e-04 -8.07426771e-04 -2.58639349e-04]
 [-3.95021374e-03  5.24328799e-05 -3.53080403e-03 -1.54180873e-04]
 [ 3.67184802e-03 -5.75354186e-04  5.30730698e-03  5.02046769e-04]
 [-9.05120870e-05  5.02655148e-04 -5.11741035e-04  9.18695151e-04]
 [ 1.79573185e-04 -3.56336206e-04 -1.73422977e-05 -2.68631648e-04]
 [ 5.23636612e-03  3.51448196e-04 -2.99859285e-03 -4.45769363e-04]
 [ 4.60320600e-04  7.54073047e-04  2.77088415e-03  9.77916352e-05]
 [ 3.47666170e-03 -7.29162355e-04 -5.31955126e-04 -2.92760567e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015086837558366714
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.8141225307244922e-08, theta_kick=-2.175201173156254e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.938414738221299e-08, theta_kick=2.324232206607596e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007538273038851655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.5572598343989636e-08, theta_kick=-1.867213135455056e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.123781650569716e-09, theta_kick=2.5464941091945194e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.2880859946369103e-08, theta_kick=-2.7435011999045937e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004406659617524457
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.8811210993952866e-08, theta_kick=2.255534977904438e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01436141e-01 -6.31908251e+00  7.04625117e-03  2.24063804e-02]
 [ 1.79987241e-01  4.56073276e-01 -1.00446703e-03  1.42256987e-02]
 [ 8.13958320e-03  2.24040550e-02  3.84026675e-01 -5.11997902e+00]
 [ 1.99120385e-03  2.05606789e-02  2.12557325e-01 -2.30223045e-01]]
compute_tune_4x4()/ evals =  [0.08953615+0.99598357j 0.08953615-0.99598357j 0.06468424+0.99790578j
 0.06468424-0.99790578j]
compute_tune_4x4()/ angles =  [0.23573077088771724, 0.2396979915182532, 0.7603020084817468, 0.7642692291122828]
compute_tune_4x4()/  0.23573077088771724 0.2396979915182532
compute_tunes()/ 0.23573077088771724 0.2396979915182532

 Running simulation ..
Closed orbit computation: x_co=[3.68492448e-11 1.30311053e-11], y_co=[1.29881726e-08 1.37783326e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
^CTraceback (most recent call last):
  File "/home/aribra/jnps/thesis/lattice_error_net/main.py", line 146, in <module>
    main_evaluation_block(model, data_sub_cfg, run_benchmark=RUN_BENCHMARK)
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 577, in main_evaluation_block
    stats = benchmark_evaluation(
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 460, in benchmark_evaluation
    actual_deltas, predicted_deltas = _run_evaluation(
  File "/home/aribra/jnps/thesis/lattice_error_net/eval.py", line 355, in _run_evaluation
    runner_corrected.run_configurations(draw_plots=False, verbose=False, initial_states=initial_states)
  File "/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py", line 3313, in run_configurations
    simulator_with_error.simulate(initial_states)
  File "/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py", line 1597, in simulate
    states_x.append([x, xp])
KeyboardInterrupt
^C
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ ^C[?2004l[?2004h[?2004l
[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ 
[?2004l[?2004h(py310)  [01;32maribra@scar3[00m:[01;34m~/jnps/thesis/lattice_error_net [1;36;40m(main)[00m$ python3 main.py [Kpython3 main.py 
[?2004l--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-36-02/figs
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-36-02/training
--->Creating save directory: exps/exp_LSTM_2000_mix/run_2025-01-17_14-36-02/benchmarks
/home/aribra/jnps/thesis/lattice_error_net/data.py:52: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT] =   torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_DIPOLE_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:53: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN] = torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_MISALIGN}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:54: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT] =     torch.load(f'{data_dir}/{C.DATA_KEY_ALL_ERROR_VALUES_QUAD_TILT}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:55: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATA_AUTOMATION] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATA_AUTOMATION}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:56: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_DATASET_SCALERS] =                torch.load(f'{data_dir}/{C.DATA_KEY_DATASET_SCALERS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:57: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS] =                  torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:58: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_INPUT_TENSORS_SCALED] =           torch.load(f'{data_dir}/{C.DATA_KEY_INPUT_TENSORS_SCALED}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:59: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_MERGED_CONFIG] =                  torch.load(f'{data_dir}/{C.DATA_KEY_MERGED_CONFIG}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:60: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS] =                 torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS}-{postfix}.pt')
/home/aribra/jnps/thesis/lattice_error_net/data.py:61: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sim_data[C.DATA_KEY_TARGET_TENSORS_SCALED] =          torch.load(f'{data_dir}/{C.DATA_KEY_TARGET_TENSORS_SCALED}-{postfix}.pt')
All Input Tensors Shape: torch.Size([2000, 101, 8, 2])
All Target Tensors Shape: torch.Size([2000, 6])
merged_config:  {'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': (0.0, 0.05), 'xp0_mean_std': (0.0, 0.0), 'y0_mean_std': (0.0, 0.05), 'yp0_mean_std': (0.0, 0.0), 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': (4.71238898038469, 6.283185307179586), 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_2000_mix/run_2025-01-17_14-36-02/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': (0, 5e-05), 'quad_tilt_angle_range': (0, 0.01), 'dipole_tilt_angle_range': (0, 0.05), 'com_delta_range': (-5e-05, 5e-05), 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 15, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0005}], 'dipole_tilt_errors': None}
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:79: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  show()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/visualization.py:176: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
nb_all_model_params =  564230
nb_trainable_parameters =  564230
model number_of_parameters:  (564230, 564230)
/home/aribra/jnps/thesis/lattice_error_net/models/net.py:434: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  chkpnt_state_dict = torch.load(model_load_path)
Checkpoint Loaded.
QuadErrorCorrectionLSTM(
  (lstm): LSTM(16, 256, batch_first=True, bidirectional=True)
  (fc): Linear(in_features=512, out_features=6, bias=True)
)
[1, 2, 3, 4, 5, 7]
torch.Size([16, 101, 16])
/home/aribra/jnps/thesis/lattice_error_net/eval.py:156: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
/home/aribra/jnps/thesis/lattice_error_net/eval.py:162: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
torch.Size([16, 101, 16])
The PostScript backend does not support transparency; partially transparent artists will be rendered opaque.
Running benchmark...
Running evaluation for noise_level= 0.0
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.65377295e-04 -4.53035970e-04 -2.13053144e-03  1.87092048e-04]
 [-2.96864881e-03  1.90390618e-04 -9.24314587e-04  1.98857383e-04]
 [ 1.65597102e-03 -2.18123042e-04 -3.84525225e-03 -9.04855673e-04]
 [-1.69585784e-03  5.75482325e-04 -6.67790292e-04  1.34311413e-04]
 [ 4.33215899e-04  2.57809699e-05 -4.88086226e-04 -1.42303386e-04]
 [-1.55991284e-03  1.35076488e-04 -1.07427981e-03  2.73873545e-04]
 [-1.34539103e-03  4.50760198e-05 -1.51951203e-03  5.82692442e-04]
 [-9.78005182e-04  4.38380258e-04  1.69368834e-03  7.27039664e-04]
 [ 5.18152825e-04 -7.44515853e-05  3.15259484e-03 -2.46055350e-04]
 [-2.32666056e-03  9.01894926e-05  1.82744726e-03  9.04325197e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0003912897220421131
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.590614709540932e-05, theta_kick=4.30528213848179e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.875563225642482e-05, theta_kick=-4.646946130861451e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007448868040533051
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.529044636312021e-06, theta_kick=7.82857018308665e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.720996288714653e-05, theta_kick=3.262576931340032e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.517074181498023e-05, theta_kick=7.814217157360089e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0060752585214885425
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.3880124638139164e-05, theta_kick=-6.460429675380317e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01682724e-01 -6.31970531e+00 -7.37342444e-03 -1.88131032e-03]
 [ 1.80000198e-01  4.56187369e-01  1.23027776e-03 -9.94506604e-03]
 [-6.17658229e-03 -1.88237549e-03  3.83992362e-01 -5.11890930e+00]
 [-9.29477046e-04 -1.25301256e-02  2.12573287e-01 -2.29741591e-01]]
compute_tune_4x4()/ evals =  [0.08614558+0.99628256j 0.08614558-0.99628256j 0.06823213+0.99766947j
 0.06823213-0.99766947j]
compute_tune_4x4()/ angles =  [0.2362724903495702, 0.239132075800505, 0.760867924199495, 0.7637275096504298]
compute_tune_4x4()/  0.2362724903495702 0.239132075800505
compute_tunes()/ 0.2362724903495702 0.239132075800505

 Running simulation ..
Closed orbit computation: x_co=[ 7.70094897e-08 -1.21910163e-08], y_co=[-3.94481593e-05 -2.84951187e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.590614709540932e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.875563225642482e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.529044636312021e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.720996288714653e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.517074181498023e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.3880124638139164e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0003912897220421131}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.007448868040533051}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0060752585214885425}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.65377295e-04 -4.53035970e-04 -2.13053144e-03  1.87092048e-04]
 [-2.96864881e-03  1.90390618e-04 -9.24314587e-04  1.98857383e-04]
 [ 1.65597102e-03 -2.18123042e-04 -3.84525225e-03 -9.04855673e-04]
 [-1.69585784e-03  5.75482325e-04 -6.67790292e-04  1.34311413e-04]
 [ 4.33215899e-04  2.57809699e-05 -4.88086226e-04 -1.42303386e-04]
 [-1.55991284e-03  1.35076488e-04 -1.07427981e-03  2.73873545e-04]
 [-1.34539103e-03  4.50760198e-05 -1.51951203e-03  5.82692442e-04]
 [-9.78005182e-04  4.38380258e-04  1.69368834e-03  7.27039664e-04]
 [ 5.18152825e-04 -7.44515853e-05  3.15259484e-03 -2.46055350e-04]
 [-2.32666056e-03  9.01894926e-05  1.82744726e-03  9.04325197e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0003912897220421131
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.14384141834253e-09, theta_kick=-1.09638099100121e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3475353398192534e-08, theta_kick=-1.6157455752857865e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007448868040533051
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.1424970424421176e-08, theta_kick=-2.5689345682414992e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0498674081620309e-08, theta_kick=-1.2588305250696338e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.560366977931772e-08, theta_kick=1.8709387174613776e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0060752585214885425
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.784708778642681e-08, theta_kick=-6.936083483096208e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01682724e-01 -6.31970531e+00 -7.37342444e-03 -1.88131032e-03]
 [ 1.80000198e-01  4.56187369e-01  1.23027776e-03 -9.94506604e-03]
 [-6.17658229e-03 -1.88237549e-03  3.83992362e-01 -5.11890930e+00]
 [-9.29477046e-04 -1.25301256e-02  2.12573287e-01 -2.29741591e-01]]
compute_tune_4x4()/ evals =  [0.08614558+0.99628256j 0.08614558-0.99628256j 0.06823213+0.99766947j
 0.06823213-0.99766947j]
compute_tune_4x4()/ angles =  [0.2362724903495702, 0.239132075800505, 0.760867924199495, 0.7637275096504298]
compute_tune_4x4()/  0.2362724903495702 0.239132075800505
compute_tunes()/ 0.2362724903495702 0.239132075800505

 Running simulation ..
Closed orbit computation: x_co=[1.46172604e-10 2.77763631e-12], y_co=[4.42304673e-10 1.49582811e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
^[[A^[[A^[[A^[[A^[[A	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.71488232e-03 -5.91206513e-05 -2.26437072e-03  7.54205106e-04]
 [-3.47763552e-03  1.10649293e-03 -4.68473881e-04  2.67684793e-04]
 [ 5.37284672e-04 -3.81286709e-04 -1.51197006e-03 -3.63912425e-04]
 [ 2.25340006e-03 -5.60202196e-04  1.26113563e-03 -1.96127544e-05]
 [-2.65313437e-03  1.33184752e-05 -2.18356376e-03 -3.35553613e-04]
 [-3.67532876e-04  1.39077998e-05 -1.42048518e-05 -3.75175565e-04]
 [-2.24716972e-03  3.20100357e-05 -8.45813668e-04 -2.12080280e-04]
 [-1.82505914e-03  1.50515254e-04 -4.11240520e-03  2.43649129e-04]
 [ 2.81336552e-03  2.86205989e-05 -1.65357413e-03  7.35912593e-05]
 [-5.45323791e-03  5.13340061e-04  1.59473126e-03 -9.85046517e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.013815370456451736
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.990513144265825e-05, theta_kick=3.5857377820826593e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.112761893453445e-05, theta_kick=6.130393884842554e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004935767842851676
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.203257101291041e-05, theta_kick=-9.836013923108342e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.192367141352671e-05, theta_kick=-5.026805945974432e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.414805564299035e-05, theta_kick=7.691593237343252e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002520866354180858
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.785390082641665e-06, theta_kick=5.737862765871397e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01591146e-01 -6.31960372e+00 -4.54695546e-03 -8.23987930e-02]
 [ 1.80034524e-01  4.56298210e-01 -1.66951148e-03 -1.36836819e-03]
 [-1.26228043e-02 -8.23922195e-02  3.83998897e-01 -5.12019784e+00]
 [-3.54464694e-03 -1.27315217e-02  2.12572364e-01 -2.29899661e-01]]
compute_tune_4x4()/ evals =  [0.08497735+0.99638288j 0.08497735-0.99638288j 0.0694258 +0.99758712j
 0.0694258 -0.99758712j]
compute_tune_4x4()/ angles =  [0.23645910404831405, 0.23894164547957994, 0.76105835452042, 0.763540895951686]
compute_tune_4x4()/  0.23645910404831405 0.23894164547957994
compute_tunes()/ 0.23645910404831405 0.23894164547957994

 Running simulation ..
Closed orbit computation: x_co=[ 2.79183609e-07 -6.34781974e-08], y_co=[2.35629196e-05 1.77224747e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.990513144265825e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.112761893453445e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.203257101291041e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.192367141352671e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.414805564299035e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.785390082641665e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.013815370456451736}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004935767842851676}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002520866354180858}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.71488232e-03 -5.91206513e-05 -2.26437072e-03  7.54205106e-04]
 [-3.47763552e-03  1.10649293e-03 -4.68473881e-04  2.67684793e-04]
 [ 5.37284672e-04 -3.81286709e-04 -1.51197006e-03 -3.63912425e-04]
 [ 2.25340006e-03 -5.60202196e-04  1.26113563e-03 -1.96127544e-05]
 [-2.65313437e-03  1.33184752e-05 -2.18356376e-03 -3.35553613e-04]
 [-3.67532876e-04  1.39077998e-05 -1.42048518e-05 -3.75175565e-04]
 [-2.24716972e-03  3.20100357e-05 -8.45813668e-04 -2.12080280e-04]
 [-1.82505914e-03  1.50515254e-04 -4.11240520e-03  2.43649129e-04]
 [ 2.81336552e-03  2.86205989e-05 -1.65357413e-03  7.35912593e-05]
 [-5.45323791e-03  5.13340061e-04  1.59473126e-03 -9.85046517e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.013815370456451736
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.3685503288908448e-09, theta_kick=-2.8399809642546323e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.911920054447192e-08, theta_kick=-9.48668984199154e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004935767842851676
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.303334551681955e-08, theta_kick=1.5627471671946387e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.6115199650477304e-08, theta_kick=-5.529385952777575e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.7663368171032842e-08, theta_kick=2.1179043045222212e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002520866354180858
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.882198883367514e-08, theta_kick=-7.05297778685853e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01591146e-01 -6.31960372e+00 -4.54695546e-03 -8.23987930e-02]
 [ 1.80034524e-01  4.56298210e-01 -1.66951148e-03 -1.36836819e-03]
 [-1.26228043e-02 -8.23922195e-02  3.83998897e-01 -5.12019784e+00]
 [-3.54464694e-03 -1.27315217e-02  2.12572364e-01 -2.29899661e-01]]
compute_tune_4x4()/ evals =  [0.08497735+0.99638288j 0.08497735-0.99638288j 0.0694258 +0.99758712j
 0.0694258 -0.99758712j]
compute_tune_4x4()/ angles =  [0.23645910404831405, 0.23894164547957994, 0.76105835452042, 0.763540895951686]
compute_tune_4x4()/  0.23645910404831405 0.23894164547957994
compute_tunes()/ 0.23645910404831405 0.23894164547957994

 Running simulation ..
Closed orbit computation: x_co=[-7.41678373e-11  4.67450603e-12], y_co=[2.04501274e-08 2.74090630e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.12651769e-03  2.73107554e-04 -1.29723962e-03 -3.72080263e-05]
 [ 1.21016339e-03 -1.15133496e-04 -2.67781039e-03  4.50487354e-06]
 [-1.91422883e-03  7.03531784e-05  1.77636723e-03  3.56466985e-04]
 [ 8.32626715e-04  2.15611380e-04  1.11752867e-04  1.20589901e-03]
 [ 2.79141253e-03 -1.05481029e-04  9.46385181e-05 -1.59363631e-04]
 [-4.93015893e-03  7.61827866e-04 -1.89390800e-03 -1.75323446e-04]
 [-2.65139550e-03  5.94204130e-04 -2.97946855e-03 -6.69446349e-04]
 [-3.19144793e-03  9.05647898e-04 -1.73405011e-03 -5.18182126e-05]
 [-5.17171950e-03  6.07595076e-04  4.97125928e-03  1.59998842e-04]
 [ 1.54113647e-03 -4.59992263e-04 -4.51362390e-03 -4.68851911e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.013605496699734043
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.791686141625545e-05, theta_kick=-5.745411977490818e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.496011116730361e-05, theta_kick=-7.78896175017732e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004108195419091927
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.919814478004487e-05, theta_kick=2.3019297947476525e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.219243983090572e-05, theta_kick=-5.0590322904957525e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.7421210519104547e-05, theta_kick=-2.088868690905051e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005987632688135707
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.597460077564833e-06, theta_kick=-5.51252761866327e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01502172e-01 -6.31923895e+00  3.74807984e-03  1.96899571e-02]
 [ 1.80001367e-01  4.56100453e-01 -4.60380167e-04  9.22226798e-03]
 [ 5.17273265e-03  1.96869369e-02  3.84026130e-01 -5.12012075e+00]
 [ 1.46771865e-03  1.40207414e-02  2.12556159e-01 -2.30080264e-01]]
compute_tune_4x4()/ evals =  [0.08513439+0.99636948j 0.08513439-0.99636948j 0.06913769+0.99760713j
 0.06913769-0.99760713j]
compute_tune_4x4()/ angles =  [0.23643402031918787, 0.2389876103040272, 0.7610123896959728, 0.7635659796808121]
compute_tune_4x4()/  0.23643402031918787 0.2389876103040272
compute_tunes()/ 0.23643402031918787 0.2389876103040272

 Running simulation ..
Closed orbit computation: x_co=[-1.48164367e-08  5.22300076e-08], y_co=[ 3.75348979e-05 -3.91565889e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.791686141625545e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.496011116730361e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.919814478004487e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.219243983090572e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.7421210519104547e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.597460077564833e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.013605496699734043}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004108195419091927}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005987632688135707}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.12651769e-03  2.73107554e-04 -1.29723962e-03 -3.72080263e-05]
 [ 1.21016339e-03 -1.15133496e-04 -2.67781039e-03  4.50487354e-06]
 [-1.91422883e-03  7.03531784e-05  1.77636723e-03  3.56466985e-04]
 [ 8.32626715e-04  2.15611380e-04  1.11752867e-04  1.20589901e-03]
 [ 2.79141253e-03 -1.05481029e-04  9.46385181e-05 -1.59363631e-04]
 [-4.93015893e-03  7.61827866e-04 -1.89390800e-03 -1.75323446e-04]
 [-2.65139550e-03  5.94204130e-04 -2.97946855e-03 -6.69446349e-04]
 [-3.19144793e-03  9.05647898e-04 -1.73405011e-03 -5.18182126e-05]
 [-5.17171950e-03  6.07595076e-04  4.97125928e-03  1.59998842e-04]
 [ 1.54113647e-03 -4.59992263e-04 -4.51362390e-03 -4.68851911e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.013605496699734043
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.512462976821521e-08, theta_kick=1.813500017677255e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.278522150279436e-08, theta_kick=1.1125297175149427e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004108195419091927
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.4455782646740407e-08, theta_kick=2.9323403575391085e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.7630860901478336e-08, theta_kick=6.910157066007941e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6481270025201464e-08, theta_kick=3.1752039153872187e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005987632688135707
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.477053277739737e-08, theta_kick=1.0164305840622346e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01502172e-01 -6.31923895e+00  3.74807984e-03  1.96899571e-02]
 [ 1.80001367e-01  4.56100453e-01 -4.60380167e-04  9.22226798e-03]
 [ 5.17273265e-03  1.96869369e-02  3.84026130e-01 -5.12012075e+00]
 [ 1.46771865e-03  1.40207414e-02  2.12556159e-01 -2.30080264e-01]]
compute_tune_4x4()/ evals =  [0.08513439+0.99636948j 0.08513439-0.99636948j 0.06913769+0.99760713j
 0.06913769-0.99760713j]
compute_tune_4x4()/ angles =  [0.23643402031918787, 0.2389876103040272, 0.7610123896959728, 0.7635659796808121]
compute_tune_4x4()/  0.23643402031918787 0.2389876103040272
compute_tunes()/ 0.23643402031918787 0.2389876103040272

 Running simulation ..
Closed orbit computation: x_co=[ 1.23216496e-10 -1.76177632e-10], y_co=[-5.60963280e-08 -4.95244841e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.68621512e-03  7.74098047e-04  7.75556957e-04  3.55248008e-04]
 [-1.72957793e-04 -7.37584997e-04 -2.77549003e-04 -4.33505378e-05]
 [ 2.67866616e-03  7.17430915e-04 -4.99647007e-03 -1.85211593e-04]
 [ 4.21236163e-03 -5.74763756e-04  1.07760635e-03 -3.13156000e-04]
 [ 1.47819942e-03 -9.88544351e-05 -3.57621277e-04  6.11618048e-04]
 [ 3.21897726e-03  1.85563260e-04 -3.02080969e-04 -1.07444206e-03]
 [-1.76687161e-03  3.99545835e-04  2.04856690e-03 -3.46366460e-04]
 [-2.55719626e-03 -8.12108584e-05  3.01516356e-03  1.24062920e-03]
 [ 2.03102519e-03  7.47389232e-05  2.53479331e-03  1.15166887e-03]
 [ 2.98954375e-03 -3.69115662e-04  2.24280270e-03  1.19076487e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035344491769099848
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.217877699679546e-05, theta_kick=-3.8583564389230905e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.494624916405544e-05, theta_kick=-4.190186764766467e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008853910567398775
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.757944314923203e-05, theta_kick=8.103029510401928e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.08286204038923e-05, theta_kick=-4.895505209641509e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.642123252729159e-05, theta_kick=7.964155698906916e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012411009877270885
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.004699171334386e-05, theta_kick=2.4037097359517705e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531765e-01 -6.32050433e+00  4.63535728e-03  9.22080794e-02]
 [ 1.80018531e-01  4.56215710e-01  2.39615204e-03 -5.05558857e-03]
 [ 1.37586804e-02  9.22378078e-02  3.84068712e-01 -5.12041045e+00]
 [ 3.56221801e-03  6.11920189e-03  2.12600522e-01 -2.30056642e-01]]
compute_tune_4x4()/ evals =  [0.08201332+0.99663123j 0.08201332-0.99663123j 0.07233468+0.99738042j
 0.07233468-0.99738042j]
compute_tune_4x4()/ angles =  [0.23693249687541312, 0.23847751450061053, 0.7615224854993895, 0.7630675031245868]
compute_tune_4x4()/  0.23693249687541312 0.23847751450061053
compute_tunes()/ 0.23693249687541312 0.23847751450061053

 Running simulation ..
Closed orbit computation: x_co=[-5.86329998e-09 -7.36940932e-08], y_co=[-1.64925759e-05 -1.04771030e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.217877699679546e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.494624916405544e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.757944314923203e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.08286204038923e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.642123252729159e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.004699171334386e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0035344491769099848}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.008853910567398775}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012411009877270885}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.68621512e-03  7.74098047e-04  7.75556957e-04  3.55248008e-04]
 [-1.72957793e-04 -7.37584997e-04 -2.77549003e-04 -4.33505378e-05]
 [ 2.67866616e-03  7.17430915e-04 -4.99647007e-03 -1.85211593e-04]
 [ 4.21236163e-03 -5.74763756e-04  1.07760635e-03 -3.13156000e-04]
 [ 1.47819942e-03 -9.88544351e-05 -3.57621277e-04  6.11618048e-04]
 [ 3.21897726e-03  1.85563260e-04 -3.02080969e-04 -1.07444206e-03]
 [-1.76687161e-03  3.99545835e-04  2.04856690e-03 -3.46366460e-04]
 [-2.55719626e-03 -8.12108584e-05  3.01516356e-03  1.24062920e-03]
 [ 2.03102519e-03  7.47389232e-05  2.53479331e-03  1.15166887e-03]
 [ 2.98954375e-03 -3.69115662e-04  2.24280270e-03  1.19076487e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035344491769099848
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.7980171955751057e-08, theta_kick=3.3549278966816664e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.435042978137742e-08, theta_kick=4.118745778932237e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008853910567398775
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.8480515070914928e-08, theta_kick=2.2158832924439833e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.5227560772497755e-08, theta_kick=-1.8258418323825784e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.006774334425222e-09, theta_kick=4.804273187287661e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012411009877270885
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.3601577387007096e-09, theta_kick=-1.6308803064795086e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531765e-01 -6.32050433e+00  4.63535728e-03  9.22080794e-02]
 [ 1.80018531e-01  4.56215710e-01  2.39615204e-03 -5.05558857e-03]
 [ 1.37586804e-02  9.22378078e-02  3.84068712e-01 -5.12041045e+00]
 [ 3.56221801e-03  6.11920189e-03  2.12600522e-01 -2.30056642e-01]]
compute_tune_4x4()/ evals =  [0.08201332+0.99663123j 0.08201332-0.99663123j 0.07233468+0.99738042j
 0.07233468-0.99738042j]
compute_tune_4x4()/ angles =  [0.23693249687541312, 0.23847751450061053, 0.7615224854993895, 0.7630675031245868]
compute_tune_4x4()/  0.23693249687541312 0.23847751450061053
compute_tunes()/ 0.23693249687541312 0.23847751450061053

 Running simulation ..
Closed orbit computation: x_co=[6.57526514e-11 7.71245299e-11], y_co=[-1.49824659e-08  5.25553159e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.38884381e-03 -1.06110533e-04  3.51380906e-03  1.99449915e-04]
 [-2.70623789e-03  6.30746105e-05  2.90109605e-03 -3.63048100e-05]
 [ 3.95278929e-05  2.96457189e-05  5.52389163e-04  5.60863290e-05]
 [ 2.20792707e-03 -3.19116968e-05 -3.67659557e-03 -4.28253467e-04]
 [ 1.00900278e-03 -8.44813163e-06  1.82923297e-03  6.64736781e-04]
 [ 4.88899224e-03  6.74232235e-05  1.66517125e-03  4.22748724e-04]
 [-3.71057080e-03 -8.01884124e-06  5.84157243e-05  3.46917204e-05]
 [ 1.24423212e-03 -9.01811462e-05  1.93483014e-03  1.54957276e-04]
 [-1.47168002e-04 -1.71560935e-04 -1.35135271e-04  1.41342766e-04]
 [-2.64473928e-03  9.88361633e-05 -1.62433309e-03 -2.08669622e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00517842224079105
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.913544021992977e-05, theta_kick=-2.2944112820554506e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.39037618121659e-06, theta_kick=1.1259414366902502e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.02232670477792296
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.8079917011795335e-06, theta_kick=-2.1678500778510824e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.6488881629671446e-05, theta_kick=-3.1761165754028625e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.356052802513624e-05, theta_kick=6.422108838955718e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004611746576821353
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.403462948731388e-05, theta_kick=8.877030640850944e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01733092e-01 -6.32094653e+00  1.20752011e-02 -6.76076839e-02]
 [ 1.80014866e-01  4.56890215e-01 -4.41389359e-03  2.42619925e-02]
 [ 2.44782618e-03 -6.75598774e-02  3.83670574e-01 -5.11765456e+00]
 [-8.37632046e-04  2.08943080e-02  2.12647115e-01 -2.30012518e-01]]
compute_tune_4x4()/ evals =  [0.09204462+0.99575488j 0.09204462-0.99575488j 0.06236297+0.99805354j
 0.06236297-0.99805354j]
compute_tune_4x4()/ angles =  [0.23532987898784716, 0.24006818042277842, 0.7599318195772216, 0.7646701210121528]
compute_tune_4x4()/  0.23532987898784716 0.24006818042277842
compute_tunes()/ 0.23532987898784716 0.24006818042277842

 Running simulation ..
Closed orbit computation: x_co=[ 1.07875661e-06 -1.05077280e-07], y_co=[ 1.32445244e-05 -1.00356634e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.913544021992977e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -9.39037618121659e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.8079917011795335e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.6488881629671446e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.356052802513624e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.403462948731388e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00517842224079105}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.02232670477792296}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004611746576821353}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.38884381e-03 -1.06110533e-04  3.51380906e-03  1.99449915e-04]
 [-2.70623789e-03  6.30746105e-05  2.90109605e-03 -3.63048100e-05]
 [ 3.95278929e-05  2.96457189e-05  5.52389163e-04  5.60863290e-05]
 [ 2.20792707e-03 -3.19116968e-05 -3.67659557e-03 -4.28253467e-04]
 [ 1.00900278e-03 -8.44813163e-06  1.82923297e-03  6.64736781e-04]
 [ 4.88899224e-03  6.74232235e-05  1.66517125e-03  4.22748724e-04]
 [-3.71057080e-03 -8.01884124e-06  5.84157243e-05  3.46917204e-05]
 [ 1.24423212e-03 -9.01811462e-05  1.93483014e-03  1.54957276e-04]
 [-1.47168002e-04 -1.71560935e-04 -1.35135271e-04  1.41342766e-04]
 [-2.64473928e-03  9.88361633e-05 -1.62433309e-03 -2.08669622e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00517842224079105
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.465365066625934e-08, theta_kick=2.9560654775846548e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.7496863060223613e-09, theta_kick=2.097939715238161e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.02232670477792296
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.756749929860428e-09, theta_kick=-1.0499672650480461e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.3119938663662118e-08, theta_kick=2.772167637674085e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.105154088428068e-08, theta_kick=-4.9222342140085795e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004611746576821353
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.9969688157931705e-08, theta_kick=-3.5934783751473322e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01733092e-01 -6.32094653e+00  1.20752011e-02 -6.76076839e-02]
 [ 1.80014866e-01  4.56890215e-01 -4.41389359e-03  2.42619925e-02]
 [ 2.44782618e-03 -6.75598774e-02  3.83670574e-01 -5.11765456e+00]
 [-8.37632046e-04  2.08943080e-02  2.12647115e-01 -2.30012518e-01]]
compute_tune_4x4()/ evals =  [0.09204462+0.99575488j 0.09204462-0.99575488j 0.06236297+0.99805354j
 0.06236297-0.99805354j]
compute_tune_4x4()/ angles =  [0.23532987898784716, 0.24006818042277842, 0.7599318195772216, 0.7646701210121528]
compute_tune_4x4()/  0.23532987898784716 0.24006818042277842
compute_tunes()/ 0.23532987898784716 0.24006818042277842

 Running simulation ..
Closed orbit computation: x_co=[-4.02429783e-10  3.56317377e-11], y_co=[-3.05622178e-09  7.13264478e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.53810987e-04  2.13525968e-06  3.79926669e-04  4.07798074e-05]
 [ 1.07651075e-04  2.77576334e-04  4.89614309e-04  5.26469233e-04]
 [ 1.49802279e-03 -6.48928125e-04 -2.92350402e-04 -5.60087494e-05]
 [-1.43180415e-03  5.93581599e-05  3.24681984e-03 -2.83080156e-06]
 [ 3.57186018e-03 -1.28524977e-04  3.26471361e-03 -2.01789948e-04]
 [-4.66575803e-03  7.55067473e-04 -1.36560858e-04  4.87515460e-04]
 [-9.83492715e-05 -6.58538922e-04  3.37451113e-03  3.27125740e-04]
 [ 6.42260595e-04 -2.40103177e-04 -2.26071056e-03 -1.98337035e-04]
 [ 1.45331746e-03 -6.41328299e-04  2.20817480e-03 -5.64640844e-05]
 [ 1.71834851e-03  4.64257468e-04 -4.65184393e-03 -1.18352840e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00018160402027366136
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.118005317189669e-06, theta_kick=7.335718573547784e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.3143489590345976e-05, theta_kick=-6.3721043614607635e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.018290553487726326
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.437062241100539e-05, theta_kick=8.917317456620446e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.05943612581924e-05, theta_kick=8.464529535704056e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6876900614808274e-05, theta_kick=2.0236038853401824e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003252703832936297
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.207008414688591e-05, theta_kick=2.6462861308927874e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01656353e-01 -6.32144902e+00 -7.13655792e-03  6.77237529e-02]
 [ 1.79990436e-01  4.56443984e-01  3.72768716e-03 -1.98015189e-02]
 [ 1.56766052e-03  6.77414926e-02  3.83982735e-01 -5.11864653e+00]
 [ 1.28494087e-03 -1.53696959e-02  2.12650283e-01 -2.30141843e-01]]
compute_tune_4x4()/ evals =  [0.0872893 +0.996183j  0.0872893 -0.996183j  0.06702496+0.9977513j
 0.06702496-0.9977513j]
compute_tune_4x4()/ angles =  [0.23608977381271795, 0.23932464266435916, 0.7606753573356408, 0.7639102261872821]
compute_tune_4x4()/  0.23608977381271795 0.23932464266435916
compute_tunes()/ 0.23608977381271795 0.23932464266435916

 Running simulation ..
Closed orbit computation: x_co=[ 2.80862955e-07 -2.34032209e-08], y_co=[-5.30266964e-05 -9.71555432e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.118005317189669e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.3143489590345976e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.437062241100539e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.05943612581924e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.6876900614808274e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.207008414688591e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00018160402027366136}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.018290553487726326}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.003252703832936297}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.53810987e-04  2.13525968e-06  3.79926669e-04  4.07798074e-05]
 [ 1.07651075e-04  2.77576334e-04  4.89614309e-04  5.26469233e-04]
 [ 1.49802279e-03 -6.48928125e-04 -2.92350402e-04 -5.60087494e-05]
 [-1.43180415e-03  5.93581599e-05  3.24681984e-03 -2.83080156e-06]
 [ 3.57186018e-03 -1.28524977e-04  3.26471361e-03 -2.01789948e-04]
 [-4.66575803e-03  7.55067473e-04 -1.36560858e-04  4.87515460e-04]
 [-9.83492715e-05 -6.58538922e-04  3.37451113e-03  3.27125740e-04]
 [ 6.42260595e-04 -2.40103177e-04 -2.26071056e-03 -1.98337035e-04]
 [ 1.45331746e-03 -6.41328299e-04  2.20817480e-03 -5.64640844e-05]
 [ 1.71834851e-03  4.64257468e-04 -4.65184393e-03 -1.18352840e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00018160402027366136
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.4114011659690585e-08, theta_kick=6.488473609295932e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1808201472181094e-08, theta_kick=1.4158477864720647e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.018290553487726326
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.2174020411525244e-09, theta_kick=7.454898985515629e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.981874556612371e-08, theta_kick=-2.3763421640930284e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.623485961374079e-08, theta_kick=-3.1456583799005327e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003252703832936297
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2678488470392759e-08, theta_kick=1.520198472130361e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01656353e-01 -6.32144902e+00 -7.13655792e-03  6.77237529e-02]
 [ 1.79990436e-01  4.56443984e-01  3.72768716e-03 -1.98015189e-02]
 [ 1.56766052e-03  6.77414926e-02  3.83982735e-01 -5.11864653e+00]
 [ 1.28494087e-03 -1.53696959e-02  2.12650283e-01 -2.30141843e-01]]
compute_tune_4x4()/ evals =  [0.0872893 +0.996183j  0.0872893 -0.996183j  0.06702496+0.9977513j
 0.06702496-0.9977513j]
compute_tune_4x4()/ angles =  [0.23608977381271795, 0.23932464266435916, 0.7606753573356408, 0.7639102261872821]
compute_tune_4x4()/  0.23608977381271795 0.23932464266435916
compute_tunes()/ 0.23608977381271795 0.23932464266435916

 Running simulation ..
Closed orbit computation: x_co=[-1.90497026e-10  3.88651238e-11], y_co=[1.22533085e-08 8.62168479e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.30906845e-04  7.40532418e-04 -3.18298745e-03 -4.98751805e-04]
 [ 6.91861564e-04 -5.62248792e-04 -2.49958197e-03  1.05477031e-05]
 [ 2.34957697e-04  1.01027135e-04  5.97909151e-04 -7.40928911e-04]
 [-1.42532184e-03  1.18115127e-04  2.35967470e-05  1.88610135e-04]
 [-1.60824350e-03 -4.70712023e-04  1.75660377e-03  7.32545194e-04]
 [-3.88796645e-03  5.26751935e-04 -1.19964264e-03  1.91064066e-04]
 [ 5.70348046e-04  6.61105328e-04  2.58761145e-03 -5.65495663e-05]
 [ 4.97408900e-03 -6.95069377e-04  1.69518305e-03  3.46462496e-04]
 [-5.34400545e-03 -2.33628963e-04  3.99595652e-04 -6.72022078e-04]
 [ 1.68525196e-03 -1.57897423e-04  4.31555443e-03  2.92662398e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0014756540315395952
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.947325022743162e-05, theta_kick=1.1927216983847454e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.121376320300937e-05, theta_kick=1.3445724013438659e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0052365933573790425
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.795979754800129e-05, theta_kick=-2.1534473021764224e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8675980902416397e-05, theta_kick=2.239320381107678e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5397126707649335e-05, theta_kick=1.8461734260220529e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005195175904658468
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.503862613848513e-05, theta_kick=8.997413616999777e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01676753e-01 -6.32023059e+00  1.16574730e-03  4.30598977e-02]
 [ 1.80003345e-01  4.56124112e-01  1.30303909e-03 -3.85610362e-03]
 [ 5.61658611e-03  4.30635126e-02  3.84090653e-01 -5.11942377e+00]
 [ 1.53890601e-03  1.00892713e-03  2.12587221e-01 -2.29798532e-01]]
compute_tune_4x4()/ evals =  [0.07816386+0.99694053j 0.07816386-0.99694053j 0.07620589+0.9970921j
 0.07620589-0.9970921j ]
compute_tune_4x4()/ angles =  [0.23754713369756134, 0.2378596868336104, 0.7621403131663896, 0.7624528663024387]
compute_tune_4x4()/  0.23754713369756134 0.2378596868336104
compute_tunes()/ 0.23754713369756134 0.2378596868336104

 Running simulation ..
Closed orbit computation: x_co=[-3.35362845e-07  7.01761990e-08], y_co=[6.52876440e-06 2.37062681e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.947325022743162e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.121376320300937e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.795979754800129e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8675980902416397e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.5397126707649335e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.503862613848513e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0014756540315395952}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0052365933573790425}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005195175904658468}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.30906845e-04  7.40532418e-04 -3.18298745e-03 -4.98751805e-04]
 [ 6.91861564e-04 -5.62248792e-04 -2.49958197e-03  1.05477031e-05]
 [ 2.34957697e-04  1.01027135e-04  5.97909151e-04 -7.40928911e-04]
 [-1.42532184e-03  1.18115127e-04  2.35967470e-05  1.88610135e-04]
 [-1.60824350e-03 -4.70712023e-04  1.75660377e-03  7.32545194e-04]
 [-3.88796645e-03  5.26751935e-04 -1.19964264e-03  1.91064066e-04]
 [ 5.70348046e-04  6.61105328e-04  2.58761145e-03 -5.65495663e-05]
 [ 4.97408900e-03 -6.95069377e-04  1.69518305e-03  3.46462496e-04]
 [-5.34400545e-03 -2.33628963e-04  3.99595652e-04 -6.72022078e-04]
 [ 1.68525196e-03 -1.57897423e-04  4.31555443e-03  2.92662398e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0014756540315395952
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.941970538720029e-10, theta_kick=8.323683876970271e-11
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.5028414561751957e-08, theta_kick=3.001001078754141e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0052365933573790425
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.217770742566117e-08, theta_kick=3.858228193319682e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.3194657221918385e-09, theta_kick=-8.776314805720596e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.9446366415246075e-09, theta_kick=-2.331692502775803e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005195175904658468
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.773933011201578e-09, theta_kick=3.3260500534177457e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01676753e-01 -6.32023059e+00  1.16574730e-03  4.30598977e-02]
 [ 1.80003345e-01  4.56124112e-01  1.30303909e-03 -3.85610362e-03]
 [ 5.61658611e-03  4.30635126e-02  3.84090653e-01 -5.11942377e+00]
 [ 1.53890601e-03  1.00892713e-03  2.12587221e-01 -2.29798532e-01]]
compute_tune_4x4()/ evals =  [0.07816386+0.99694053j 0.07816386-0.99694053j 0.07620589+0.9970921j
 0.07620589-0.9970921j ]
compute_tune_4x4()/ angles =  [0.23754713369756134, 0.2378596868336104, 0.7621403131663896, 0.7624528663024387]
compute_tune_4x4()/  0.23754713369756134 0.2378596868336104
compute_tunes()/ 0.23754713369756134 0.2378596868336104

 Running simulation ..
Closed orbit computation: x_co=[8.17814216e-11 1.45207854e-11], y_co=[-1.85283809e-08  1.93262000e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.71497516e-05  7.08836948e-04  1.72394999e-03 -4.53598319e-04]
 [-2.83232670e-03 -4.07341513e-05 -2.46502795e-04 -4.70785029e-05]
 [ 2.41866292e-03  3.91239243e-04  1.16927612e-04 -1.41464546e-04]
 [ 4.43971583e-03  4.86575091e-04  1.98939337e-03  3.57294032e-04]
 [-3.38093660e-03  1.34990964e-05 -2.59359617e-03 -5.80154029e-04]
 [-1.36443098e-03 -1.12076223e-04 -1.66483112e-03 -6.19237064e-05]
 [ 3.28255642e-04 -8.93134335e-04  3.91781887e-03  1.11371126e-03]
 [-1.47547960e-03 -2.57727767e-04  1.32058007e-03  4.43827437e-04]
 [ 1.47465554e-03 -2.14231902e-04  1.73922567e-03 -4.15102677e-04]
 [-2.94513222e-03  5.24540446e-04  1.22520032e-03  2.12107153e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008012357317768549
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.0806552691071417e-05, theta_kick=-2.494783955132372e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.385708798200766e-05, theta_kick=-6.457667493631611e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009411121066459397
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.4725897490962107e-05, theta_kick=1.7656905173504032e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.707809896295931e-05, theta_kick=9.241954082446995e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.04473229177975e-05, theta_kick=-9.645936711793614e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.019394225434238365
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.28704823589169e-05, theta_kick=9.93648264624946e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01269579e-01 -6.32000817e+00 -1.04634117e-02 -1.41504064e-01]
 [ 1.80050993e-01  4.56346149e-01 -2.98432277e-03  1.74319572e-03]
 [-2.38256461e-02 -1.41566228e-01  3.83981232e-01 -5.12201721e+00]
 [-5.94319513e-03 -1.68231385e-02  2.12590614e-01 -2.30355657e-01]]
compute_tune_4x4()/ evals =  [0.08945251+0.99599109j 0.08945251-0.99599109j 0.06489856+0.99789187j
 0.06489856-0.99789187j]
compute_tune_4x4()/ angles =  [0.23574413568563352, 0.23966380856649966, 0.7603361914335003, 0.7642558643143664]
compute_tune_4x4()/  0.23574413568563352 0.23966380856649966
compute_tunes()/ 0.23574413568563352 0.23966380856649966

 Running simulation ..
Closed orbit computation: x_co=[1.61542736e-07 6.95099623e-08], y_co=[ 1.96451536e-05 -7.65442670e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.0806552691071417e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.385708798200766e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.4725897490962107e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.707809896295931e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.04473229177975e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.28704823589169e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008012357317768549}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.009411121066459397}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.019394225434238365}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.71497516e-05  7.08836948e-04  1.72394999e-03 -4.53598319e-04]
 [-2.83232670e-03 -4.07341513e-05 -2.46502795e-04 -4.70785029e-05]
 [ 2.41866292e-03  3.91239243e-04  1.16927612e-04 -1.41464546e-04]
 [ 4.43971583e-03  4.86575091e-04  1.98939337e-03  3.57294032e-04]
 [-3.38093660e-03  1.34990964e-05 -2.59359617e-03 -5.80154029e-04]
 [-1.36443098e-03 -1.12076223e-04 -1.66483112e-03 -6.19237064e-05]
 [ 3.28255642e-04 -8.93134335e-04  3.91781887e-03  1.11371126e-03]
 [-1.47547960e-03 -2.57727767e-04  1.32058007e-03  4.43827437e-04]
 [ 1.47465554e-03 -2.14231902e-04  1.73922567e-03 -4.15102677e-04]
 [-2.94513222e-03  5.24540446e-04  1.22520032e-03  2.12107153e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008012357317768549
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.450422886467355e-08, theta_kick=1.0132374999482216e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.191620800586974e-08, theta_kick=-6.224948681668857e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009411121066459397
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.566630834962778e-08, theta_kick=4.2765245704368146e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.264856627170121e-08, theta_kick=-8.710836446048384e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.081943829274098e-08, theta_kick=1.0889592371738417e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.019394225434238365
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.052328084359135e-09, theta_kick=-1.261780968416237e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01269579e-01 -6.32000817e+00 -1.04634117e-02 -1.41504064e-01]
 [ 1.80050993e-01  4.56346149e-01 -2.98432277e-03  1.74319572e-03]
 [-2.38256461e-02 -1.41566228e-01  3.83981232e-01 -5.12201721e+00]
 [-5.94319513e-03 -1.68231385e-02  2.12590614e-01 -2.30355657e-01]]
compute_tune_4x4()/ evals =  [0.08945251+0.99599109j 0.08945251-0.99599109j 0.06489856+0.99789187j
 0.06489856-0.99789187j]
compute_tune_4x4()/ angles =  [0.23574413568563352, 0.23966380856649966, 0.7603361914335003, 0.7642558643143664]
compute_tune_4x4()/  0.23574413568563352 0.23966380856649966
compute_tunes()/ 0.23574413568563352 0.23966380856649966

 Running simulation ..
Closed orbit computation: x_co=[ 3.28692307e-10 -4.19914960e-11], y_co=[2.17393468e-09 6.69594088e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.20636386e-03 -6.24736099e-04 -1.07114879e-03 -7.35088328e-05]
 [ 1.90436792e-03  1.15172483e-04 -1.59476521e-03 -3.40726970e-04]
 [-2.44501962e-03 -7.34914106e-05 -3.73996054e-03  1.30168174e-05]
 [ 1.53110344e-03  8.38401180e-05 -2.16879485e-03  9.07784969e-05]
 [-1.19194433e-03  3.09094370e-04  9.05460862e-04  4.98901297e-04]
 [-2.60819604e-03 -3.95115936e-04  2.72965370e-03 -3.32634467e-04]
 [-9.14375600e-04 -2.82322656e-04  2.33456237e-04  8.34407025e-04]
 [-8.30206585e-04 -1.57194302e-04  3.02824956e-03  9.25555100e-05]
 [ 2.04672313e-03  2.59460120e-04 -3.60562312e-04 -1.05029000e-04]
 [ 1.19047784e-03  4.82692515e-04  9.27756213e-04 -2.01567999e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011037572937193704
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.7254257711053544e-05, theta_kick=-3.267888047391758e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.5906972790683135e-05, theta_kick=5.504418768806488e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009647492031737011
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.00010318315650215248, theta_kick=1.237204870521138e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.739126294552826e-05, theta_kick=1.1677578874988072e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.7030130299598243e-05, theta_kick=-3.2410143274485225e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012677565466312475
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.106544158979413e-05, theta_kick=-8.521013839966662e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01469553e-01 -6.32033950e+00  7.37450713e-03  1.26864181e-01]
 [ 1.80049400e-01  4.56393593e-01  2.88765172e-03 -2.47141393e-03]
 [ 1.97356007e-02  1.26887520e-01  3.84013665e-01 -5.12107357e+00]
 [ 5.20170697e-03  1.39578557e-02  2.12602661e-01 -2.30120198e-01]]
compute_tune_4x4()/ evals =  [0.08680252+0.99622554j 0.08680252-0.99622554j 0.06760623+0.99771208j
 0.06760623-0.99771208j]
compute_tune_4x4()/ angles =  [0.23616754214506386, 0.2392319203323535, 0.7607680796676465, 0.7638324578549361]
compute_tune_4x4()/  0.23616754214506386 0.2392319203323535
compute_tunes()/ 0.23616754214506386 0.2392319203323535

 Running simulation ..
Closed orbit computation: x_co=[ 1.15324561e-06 -6.01971914e-09], y_co=[-1.19324881e-04  1.97268152e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.7254257711053544e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.5906972790683135e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.00010318315650215248, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.739126294552826e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.7030130299598243e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.106544158979413e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011037572937193704}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009647492031737011}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012677565466312475}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.20636386e-03 -6.24736099e-04 -1.07114879e-03 -7.35088328e-05]
 [ 1.90436792e-03  1.15172483e-04 -1.59476521e-03 -3.40726970e-04]
 [-2.44501962e-03 -7.34914106e-05 -3.73996054e-03  1.30168174e-05]
 [ 1.53110344e-03  8.38401180e-05 -2.16879485e-03  9.07784969e-05]
 [-1.19194433e-03  3.09094370e-04  9.05460862e-04  4.98901297e-04]
 [-2.60819604e-03 -3.95115936e-04  2.72965370e-03 -3.32634467e-04]
 [-9.14375600e-04 -2.82322656e-04  2.33456237e-04  8.34407025e-04]
 [-8.30206585e-04 -1.57194302e-04  3.02824956e-03  9.25555100e-05]
 [ 2.04672313e-03  2.59460120e-04 -3.60562312e-04 -1.05029000e-04]
 [ 1.19047784e-03  4.82692515e-04  9.27756213e-04 -2.01567999e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011037572937193704
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.9298804279134913e-08, theta_kick=-2.3139992474335487e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0684596359401865e-07, theta_kick=1.2811233057333972e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009647492031737011
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.893789565178257e-07, theta_kick=2.2707249450464045e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.356340560607787e-08, theta_kick=1.1218604377156219e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.1254178023230144e-08, theta_kick=-6.145568795772882e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012677565466312475
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5204510510993558e-07, theta_kick=-1.8230780192984938e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01469553e-01 -6.32033950e+00  7.37450713e-03  1.26864181e-01]
 [ 1.80049400e-01  4.56393593e-01  2.88765172e-03 -2.47141393e-03]
 [ 1.97356007e-02  1.26887520e-01  3.84013665e-01 -5.12107357e+00]
 [ 5.20170697e-03  1.39578557e-02  2.12602661e-01 -2.30120198e-01]]
compute_tune_4x4()/ evals =  [0.08680252+0.99622554j 0.08680252-0.99622554j 0.06760623+0.99771208j
 0.06760623-0.99771208j]
compute_tune_4x4()/ angles =  [0.23616754214506386, 0.2392319203323535, 0.7607680796676465, 0.7638324578549361]
compute_tune_4x4()/  0.23616754214506386 0.2392319203323535
compute_tunes()/ 0.23616754214506386 0.2392319203323535

 Running simulation ..
Closed orbit computation: x_co=[2.06346877e-09 1.22908423e-10], y_co=[-1.91188037e-07  1.44506158e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.21064791e-03 -1.35863647e-04 -2.48649740e-03  2.92588612e-04]
 [ 5.93738238e-03 -1.49637387e-04 -1.24169921e-03 -1.06984324e-03]
 [ 1.79595906e-03 -3.35113195e-04  1.11310448e-03 -8.86746409e-04]
 [ 4.77409929e-03 -4.46271159e-05 -2.98105584e-03 -1.98637716e-04]
 [ 2.94673010e-05  3.11484417e-04 -6.14103214e-03 -1.37874362e-04]
 [ 5.07878654e-04 -2.67641372e-04  3.38937913e-03 -1.95484141e-04]
 [-2.13241356e-03  1.34616518e-03  1.30056287e-03  8.33805945e-04]
 [-2.02842775e-03  8.63376774e-04 -2.74901624e-03 -2.94581864e-04]
 [-6.75222353e-03  2.84188298e-04  3.67441610e-04  2.89069122e-04]
 [ 1.34628583e-03  1.85293229e-04 -2.19235065e-03  5.19156394e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009002983495000665
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.344078691706252e-05, theta_kick=8.805826682264696e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.644122532126429e-05, theta_kick=-6.767515283775261e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011579891555100514
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.3848459222137724e-06, theta_kick=-2.859519993792595e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.40003598262402e-06, theta_kick=-1.1270996832253124e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.924092224454204e-05, theta_kick=-7.103209479115179e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009261127229919265
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.8235092583425786e-05, theta_kick=3.3854938391132587e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01470745e-01 -6.32027494e+00 -3.66254144e-03  3.48881117e-02]
 [ 1.79979794e-01  4.56086974e-01  2.25895309e-03 -1.47196189e-02]
 [ 8.19053597e-04  3.49245466e-02  3.84081486e-01 -5.11993196e+00]
 [ 3.96536725e-04 -1.34918255e-02  2.12595653e-01 -2.30290654e-01]]
compute_tune_4x4()/ evals =  [0.08482662+0.99639573j 0.08482662-0.99639573j 0.06937691+0.99759052j
 0.06937691-0.99759052j]
compute_tune_4x4()/ angles =  [0.236483180673193, 0.2389494451243666, 0.7610505548756334, 0.763516819326807]
compute_tune_4x4()/  0.236483180673193 0.2389494451243666
compute_tunes()/ 0.236483180673193 0.2389494451243666

 Running simulation ..
Closed orbit computation: x_co=[-2.71664198e-07 -4.27478162e-08], y_co=[4.63540392e-05 7.98206969e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.344078691706252e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.644122532126429e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.3848459222137724e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 9.40003598262402e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.924092224454204e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.8235092583425786e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009002983495000665}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.011579891555100514}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.009261127229919265}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.21064791e-03 -1.35863647e-04 -2.48649740e-03  2.92588612e-04]
 [ 5.93738238e-03 -1.49637387e-04 -1.24169921e-03 -1.06984324e-03]
 [ 1.79595906e-03 -3.35113195e-04  1.11310448e-03 -8.86746409e-04]
 [ 4.77409929e-03 -4.46271159e-05 -2.98105584e-03 -1.98637716e-04]
 [ 2.94673010e-05  3.11484417e-04 -6.14103214e-03 -1.37874362e-04]
 [ 5.07878654e-04 -2.67641372e-04  3.38937913e-03 -1.95484141e-04]
 [-2.13241356e-03  1.34616518e-03  1.30056287e-03  8.33805945e-04]
 [-2.02842775e-03  8.63376774e-04 -2.74901624e-03 -2.94581864e-04]
 [-6.75222353e-03  2.84188298e-04  3.67441610e-04  2.89069122e-04]
 [ 1.34628583e-03  1.85293229e-04 -2.19235065e-03  5.19156394e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009002983495000665
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.8461468348236546e-08, theta_kick=-4.611674771438126e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.362418085271797e-08, theta_kick=-7.628778678839731e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011579891555100514
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.7456679350489868e-08, theta_kick=-2.0931215372444336e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.5096378846539405e-09, theta_kick=-1.8101126258704064e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0551852760533385e-07, theta_kick=-1.2652068487632945e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009261127229919265
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.815698106170143e-08, theta_kick=-8.172278479171637e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01470745e-01 -6.32027494e+00 -3.66254144e-03  3.48881117e-02]
 [ 1.79979794e-01  4.56086974e-01  2.25895309e-03 -1.47196189e-02]
 [ 8.19053597e-04  3.49245466e-02  3.84081486e-01 -5.11993196e+00]
 [ 3.96536725e-04 -1.34918255e-02  2.12595653e-01 -2.30290654e-01]]
compute_tune_4x4()/ evals =  [0.08482662+0.99639573j 0.08482662-0.99639573j 0.06937691+0.99759052j
 0.06937691-0.99759052j]
compute_tune_4x4()/ angles =  [0.236483180673193, 0.2389494451243666, 0.7610505548756334, 0.763516819326807]
compute_tune_4x4()/  0.236483180673193 0.2389494451243666
compute_tunes()/ 0.236483180673193 0.2389494451243666

 Running simulation ..
Closed orbit computation: x_co=[ 5.89883098e-10 -1.98695724e-10], y_co=[4.64369349e-08 7.55800693e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.29158098e-03  1.99640111e-04 -1.54581729e-03 -3.65492556e-04]
 [-4.40615864e-04 -3.24437587e-04  1.58175633e-04  8.51637832e-04]
 [ 4.85488476e-03 -3.51065325e-04 -4.86572313e-03 -4.70424796e-04]
 [-9.32293467e-04  3.80104720e-04  1.18764300e-03  2.97186217e-04]
 [ 2.67967221e-03 -2.48205109e-04 -2.33473866e-03 -6.01440898e-04]
 [ 2.53365979e-03 -1.10896468e-04  1.72645457e-03  1.10307485e-03]
 [-5.35816082e-04  4.14244539e-04  3.94338723e-05 -1.29102583e-04]
 [ 2.73560231e-03 -6.26599021e-04  2.04143102e-03 -1.94949423e-04]
 [ 1.68994911e-03 -7.21681309e-05 -8.12248393e-04 -3.92849701e-05]
 [-3.60146516e-03  2.06861783e-04 -1.75777284e-03  4.10857603e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017493697957044034
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.288321688311433e-05, theta_kick=8.738971937261527e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5697584900371272e-05, theta_kick=-1.8821994938440627e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008516076940676838
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.2935899201503094e-05, theta_kick=-1.5510629873332346e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.8678284664957105e-05, theta_kick=-4.637671863613683e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.3445657286423202e-05, theta_kick=2.811222526103578e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.026867252516113604
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.7138952610337396e-05, theta_kick=-4.453100158319409e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01048460e-01 -6.31533796e+00  2.16481822e-02  9.41571105e-02]
 [ 1.80035662e-01  4.56467351e-01 -4.99645360e-04  1.78165723e-02]
 [ 2.77534405e-02  9.40946576e-02  3.83366049e-01 -5.12046065e+00]
 [ 5.60541447e-03  3.45968321e-02  2.12440434e-01 -2.30134164e-01]]
compute_tune_4x4()/ evals =  [0.10248395+0.99473466j 0.10248395-0.99473466j 0.05184144+0.99865533j
 0.05184144-0.99865533j]
compute_tune_4x4()/ angles =  [0.23366048577165638, 0.2417454779412855, 0.7582545220587145, 0.7663395142283436]
compute_tune_4x4()/  0.23366048577165638 0.2417454779412855
compute_tunes()/ 0.23366048577165638 0.2417454779412855

 Running simulation ..
Closed orbit computation: x_co=[1.09945376e-07 5.51561675e-08], y_co=[1.03177671e-05 8.64030331e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.288321688311433e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.5697584900371272e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.2935899201503094e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.8678284664957105e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.3445657286423202e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.7138952610337396e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0017493697957044034}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.008516076940676838}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.026867252516113604}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.29158098e-03  1.99640111e-04 -1.54581729e-03 -3.65492556e-04]
 [-4.40615864e-04 -3.24437587e-04  1.58175633e-04  8.51637832e-04]
 [ 4.85488476e-03 -3.51065325e-04 -4.86572313e-03 -4.70424796e-04]
 [-9.32293467e-04  3.80104720e-04  1.18764300e-03  2.97186217e-04]
 [ 2.67967221e-03 -2.48205109e-04 -2.33473866e-03 -6.01440898e-04]
 [ 2.53365979e-03 -1.10896468e-04  1.72645457e-03  1.10307485e-03]
 [-5.35816082e-04  4.14244539e-04  3.94338723e-05 -1.29102583e-04]
 [ 2.73560231e-03 -6.26599021e-04  2.04143102e-03 -1.94949423e-04]
 [ 1.68994911e-03 -7.21681309e-05 -8.12248393e-04 -3.92849701e-05]
 [-3.60146516e-03  2.06861783e-04 -1.75777284e-03  4.10857603e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017493697957044034
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0069964692255306e-07, theta_kick=1.2074266562076206e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.75913539816038e-10, theta_kick=-9.303495290374002e-11
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008516076940676838
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.191160399506311e-08, theta_kick=6.224396643449927e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.7066318171350663e-08, theta_kick=-3.2453533894334067e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.0260638187583264e-08, theta_kick=2.4293267520868747e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.026867252516113604
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.136986284215255e-08, theta_kick=6.15943984084148e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01048460e-01 -6.31533796e+00  2.16481822e-02  9.41571105e-02]
 [ 1.80035662e-01  4.56467351e-01 -4.99645360e-04  1.78165723e-02]
 [ 2.77534405e-02  9.40946576e-02  3.83366049e-01 -5.12046065e+00]
 [ 5.60541447e-03  3.45968321e-02  2.12440434e-01 -2.30134164e-01]]
compute_tune_4x4()/ evals =  [0.10248395+0.99473466j 0.10248395-0.99473466j 0.05184144+0.99865533j
 0.05184144-0.99865533j]
compute_tune_4x4()/ angles =  [0.23366048577165638, 0.2417454779412855, 0.7582545220587145, 0.7663395142283436]
compute_tune_4x4()/  0.23366048577165638 0.2417454779412855
compute_tunes()/ 0.23366048577165638 0.2417454779412855

 Running simulation ..
Closed orbit computation: x_co=[4.00165614e-10 2.04431050e-10], y_co=[-8.87187657e-09  5.62418052e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.34238880e-04  3.60279207e-04  4.03167955e-04 -5.93850972e-04]
 [ 1.81843115e-03  2.33725486e-04 -1.32566588e-03 -6.59298684e-04]
 [-2.11758593e-03 -1.14763330e-04 -4.58606604e-03 -6.80787999e-04]
 [ 1.05401300e-03 -5.35235730e-04 -1.50491680e-03 -9.62273346e-04]
 [-4.27453941e-03  5.97462159e-04  1.34906198e-03  6.94916319e-04]
 [-2.42313188e-03  2.51838288e-04 -1.58645689e-04  1.53341094e-03]
 [-1.88110263e-03  8.82756212e-04  1.34022799e-03  6.74532299e-05]
 [-5.53208829e-03  6.57166473e-04  3.86203767e-03  8.26312307e-04]
 [-5.84884076e-03  2.22605644e-04  6.42558631e-04 -1.97520362e-05]
 [ 3.98625825e-03  3.35504173e-04 -7.76491216e-04 -2.27463664e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0011256434556218807
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.492210069889578e-05, theta_kick=-7.784404151995685e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2287501738416286e-05, theta_kick=-1.4733176918258409e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012615887634036609
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.9116575655334655e-05, theta_kick=-5.889262228843749e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.966940807454525e-05, theta_kick=9.552661795077695e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.7341026683630577e-05, theta_kick=3.278291973683757e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00336519171673326
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.536577894638552e-05, theta_kick=-9.036640469623789e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01681851e-01 -6.32083223e+00  3.83109918e-03 -5.55490221e-02]
 [ 1.79999534e-01  4.56270343e-01 -2.66052508e-03  1.28976717e-02]
 [-2.92404886e-03 -5.55572983e-02  3.84048761e-01 -5.11908944e+00]
 [-1.32448073e-03  8.47890634e-03  2.12616572e-01 -2.29931402e-01]]
compute_tune_4x4()/ evals =  [0.08271817+0.99657298j 0.08271817-0.99657298j 0.07163476+0.99743093j
 0.07163476-0.99743093j]
compute_tune_4x4()/ angles =  [0.23681993540479548, 0.23858920051224608, 0.7614107994877539, 0.7631800645952045]
compute_tune_4x4()/  0.23681993540479548 0.23858920051224608
compute_tunes()/ 0.23681993540479548 0.23858920051224608

 Running simulation ..
Closed orbit computation: x_co=[-4.57642938e-07  7.96384474e-08], y_co=[-3.60139844e-05 -8.87594604e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.492210069889578e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2287501738416286e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.9116575655334655e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.966940807454525e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.7341026683630577e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.536577894638552e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0011256434556218807}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.012615887634036609}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00336519171673326}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.34238880e-04  3.60279207e-04  4.03167955e-04 -5.93850972e-04]
 [ 1.81843115e-03  2.33725486e-04 -1.32566588e-03 -6.59298684e-04]
 [-2.11758593e-03 -1.14763330e-04 -4.58606604e-03 -6.80787999e-04]
 [ 1.05401300e-03 -5.35235730e-04 -1.50491680e-03 -9.62273346e-04]
 [-4.27453941e-03  5.97462159e-04  1.34906198e-03  6.94916319e-04]
 [-2.42313188e-03  2.51838288e-04 -1.58645689e-04  1.53341094e-03]
 [-1.88110263e-03  8.82756212e-04  1.34022799e-03  6.74532299e-05]
 [-5.53208829e-03  6.57166473e-04  3.86203767e-03  8.26312307e-04]
 [-5.84884076e-03  2.22605644e-04  6.42558631e-04 -1.97520362e-05]
 [ 3.98625825e-03  3.35504173e-04 -7.76491216e-04 -2.27463664e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0011256434556218807
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.6389851197892965e-09, theta_kick=-5.562317706726364e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.938479635143805e-09, theta_kick=1.0717573404941558e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012615887634036609
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.25362183684229e-08, theta_kick=3.9012150043027995e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4061227454365806e-10, theta_kick=2.8850317054060368e-11
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.654993156126435e-09, theta_kick=9.178624823682377e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00336519171673326
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.356432282106003e-08, theta_kick=7.621601475619992e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01681851e-01 -6.32083223e+00  3.83109918e-03 -5.55490221e-02]
 [ 1.79999534e-01  4.56270343e-01 -2.66052508e-03  1.28976717e-02]
 [-2.92404886e-03 -5.55572983e-02  3.84048761e-01 -5.11908944e+00]
 [-1.32448073e-03  8.47890634e-03  2.12616572e-01 -2.29931402e-01]]
compute_tune_4x4()/ evals =  [0.08271817+0.99657298j 0.08271817-0.99657298j 0.07163476+0.99743093j
 0.07163476-0.99743093j]
compute_tune_4x4()/ angles =  [0.23681993540479548, 0.23858920051224608, 0.7614107994877539, 0.7631800645952045]
compute_tune_4x4()/  0.23681993540479548 0.23858920051224608
compute_tunes()/ 0.23681993540479548 0.23858920051224608

 Running simulation ..
Closed orbit computation: x_co=[ 2.58732746e-10 -2.87195288e-11], y_co=[-4.77125028e-09 -5.10217792e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.64923538e-04  1.81061302e-04 -1.64500530e-04  6.52562990e-04]
 [-2.81273545e-03  2.07768732e-04 -4.62752474e-03 -4.67755588e-04]
 [ 2.67076329e-03 -3.99691091e-05 -2.24094375e-03  2.39111612e-04]
 [ 5.05717652e-04 -8.78720006e-05 -2.82069798e-03 -8.20125968e-04]
 [ 1.58198406e-03  4.43992231e-04  2.24886079e-03 -1.62398126e-04]
 [-3.52831739e-03  2.00455552e-04 -1.40060017e-03 -8.24563572e-05]
 [-1.70342713e-03  1.16308067e-04  9.72666178e-04 -7.20355353e-04]
 [ 2.22371321e-03 -7.94726391e-04  9.48074134e-04 -1.22543928e-04]
 [-1.43871153e-03 -5.20014991e-05 -3.81136396e-03 -7.65016043e-04]
 [-3.83321016e-03 -4.17143820e-04 -1.65228525e-03  6.33718924e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004408883592644423
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0255685796332933e-05, theta_kick=-1.2296953153873394e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.005556588375239e-05, theta_kick=1.0798001195727274e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.02444472779109169
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.034128977787972e-06, theta_kick=-1.0832260565707995e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.643562214397964e-05, theta_kick=-1.036395632079985e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00010374347178420227, theta_kick=-1.2439232615791296e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0038024294561633943
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.752003923363254e-05, theta_kick=8.09590675740627e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531766e-01 -6.32198574e+00 -1.17163002e-02  6.88589780e-02]
 [ 1.79953309e-01  4.56572751e-01  4.75757646e-03 -2.87236090e-02]
 [-2.01647518e-03  6.89110461e-02  3.83907149e-01 -5.11786567e+00]
 [ 6.38024822e-04 -2.62336635e-02  2.12690084e-01 -2.30597974e-01]]
compute_tune_4x4()/ evals =  [0.09417225+0.99555592j 0.09417225-0.99555592j 0.06000283+0.99819821j
 0.06000283-0.99819821j]
compute_tune_4x4()/ angles =  [0.23498977862425727, 0.24044451341484674, 0.7595554865851533, 0.7650102213757427]
compute_tune_4x4()/  0.23498977862425727 0.24044451341484674
compute_tunes()/ 0.23498977862425727 0.24044451341484674

 Running simulation ..
Closed orbit computation: x_co=[-3.79490906e-07 -4.84169668e-09], y_co=[6.76424408e-05 1.44241407e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.0255685796332933e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -9.005556588375239e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 9.034128977787972e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 8.643562214397964e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00010374347178420227, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.752003923363254e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004408883592644423}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.02444472779109169}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0038024294561633943}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.64923538e-04  1.81061302e-04 -1.64500530e-04  6.52562990e-04]
 [-2.81273545e-03  2.07768732e-04 -4.62752474e-03 -4.67755588e-04]
 [ 2.67076329e-03 -3.99691091e-05 -2.24094375e-03  2.39111612e-04]
 [ 5.05717652e-04 -8.78720006e-05 -2.82069798e-03 -8.20125968e-04]
 [ 1.58198406e-03  4.43992231e-04  2.24886079e-03 -1.62398126e-04]
 [-3.52831739e-03  2.00455552e-04 -1.40060017e-03 -8.24563572e-05]
 [-1.70342713e-03  1.16308067e-04  9.72666178e-04 -7.20355353e-04]
 [ 2.22371321e-03 -7.94726391e-04  9.48074134e-04 -1.22543928e-04]
 [-1.43871153e-03 -5.20014991e-05 -3.81136396e-03 -7.65016043e-04]
 [-3.83321016e-03 -4.17143820e-04 -1.65228525e-03  6.33718924e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004408883592644423
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4975026819933506e-08, theta_kick=1.7955620612769208e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.576418518318273e-08, theta_kick=1.1482486129182362e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.02444472779109169
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.4898604044574996e-09, theta_kick=4.1844739356695463e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.8910655017465878e-08, theta_kick=-3.4664963168498345e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.517781470145699e-08, theta_kick=-5.416989970352192e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0038024294561633943
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.0807027781077182e-09, theta_kick=1.2958032938570763e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531766e-01 -6.32198574e+00 -1.17163002e-02  6.88589780e-02]
 [ 1.79953309e-01  4.56572751e-01  4.75757646e-03 -2.87236090e-02]
 [-2.01647518e-03  6.89110461e-02  3.83907149e-01 -5.11786567e+00]
 [ 6.38024822e-04 -2.62336635e-02  2.12690084e-01 -2.30597974e-01]]
compute_tune_4x4()/ evals =  [0.09417225+0.99555592j 0.09417225-0.99555592j 0.06000283+0.99819821j
 0.06000283-0.99819821j]
compute_tune_4x4()/ angles =  [0.23498977862425727, 0.24044451341484674, 0.7595554865851533, 0.7650102213757427]
compute_tune_4x4()/  0.23498977862425727 0.24044451341484674
compute_tunes()/ 0.23498977862425727 0.24044451341484674

 Running simulation ..
Closed orbit computation: x_co=[ 3.96483293e-10 -4.31473235e-11], y_co=[-3.91737791e-09  1.28839041e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.07167810e-03  5.40932298e-04  1.64043025e-03 -3.18916615e-04]
 [-8.46383263e-04  1.44269423e-04  2.03100866e-03  4.92731695e-05]
 [-1.89457212e-03  7.75723526e-04 -3.87694085e-05 -2.36553905e-05]
 [ 9.96590689e-04 -6.14631484e-05  4.15562628e-04  4.60388693e-04]
 [ 4.25548430e-03  1.94686484e-04 -1.86721821e-03  7.11916484e-04]
 [-4.69847850e-03  1.75187251e-04  1.10189100e-03  3.85886862e-04]
 [ 2.01595488e-03 -6.18007528e-04  5.14196111e-04 -2.42338532e-04]
 [ 1.22732396e-03  1.27677582e-04  2.40521436e-03  4.69167896e-04]
 [ 2.84218216e-03 -1.50353839e-04 -3.30796102e-04  4.45642102e-04]
 [ 4.58860554e-03  4.62192025e-05 -4.97058030e-04  3.80117401e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0034540398291470907
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.904142322068219e-05, theta_kick=-1.187543930093059e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.749387056384668e-05, theta_kick=-5.694693782726626e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003435124385624264
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.3251747078969654e-05, theta_kick=-5.186047215325631e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.836139918872433e-07, theta_kick=-1.1793901860816309e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.22169970831079e-06, theta_kick=6.261014423789359e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010635954155139474
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.367806879775399e-05, theta_kick=-4.03812716714651e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01583276e-01 -6.31984331e+00  6.23433058e-03  6.86635871e-02]
 [ 1.80011773e-01  4.56137623e-01  1.25731075e-03  5.78659421e-04]
 [ 1.25002055e-02  6.86698068e-02  3.84052653e-01 -5.11991488e+00]
 [ 3.00947130e-03  9.91470906e-03  2.12575084e-01 -2.29873725e-01]]
compute_tune_4x4()/ evals =  [0.08445029+0.99642769j 0.08445029-0.99642769j 0.06991635+0.99755286j
 0.06991635-0.99755286j]
compute_tune_4x4()/ angles =  [0.2365432913740888, 0.23886338181503186, 0.7611366181849681, 0.7634567086259112]
compute_tune_4x4()/  0.2365432913740888 0.23886338181503186
compute_tunes()/ 0.2365432913740888 0.23886338181503186

 Running simulation ..
Closed orbit computation: x_co=[-1.50398898e-08 -1.69574972e-07], y_co=[ 2.9738197e-05 -1.0310320e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.904142322068219e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.749387056384668e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.3251747078969654e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 9.836139918872433e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.22169970831079e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.367806879775399e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0034540398291470907}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.003435124385624264}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010635954155139474}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.07167810e-03  5.40932298e-04  1.64043025e-03 -3.18916615e-04]
 [-8.46383263e-04  1.44269423e-04  2.03100866e-03  4.92731695e-05]
 [-1.89457212e-03  7.75723526e-04 -3.87694085e-05 -2.36553905e-05]
 [ 9.96590689e-04 -6.14631484e-05  4.15562628e-04  4.60388693e-04]
 [ 4.25548430e-03  1.94686484e-04 -1.86721821e-03  7.11916484e-04]
 [-4.69847850e-03  1.75187251e-04  1.10189100e-03  3.85886862e-04]
 [ 2.01595488e-03 -6.18007528e-04  5.14196111e-04 -2.42338532e-04]
 [ 1.22732396e-03  1.27677582e-04  2.40521436e-03  4.69167896e-04]
 [ 2.84218216e-03 -1.50353839e-04 -3.30796102e-04  4.45642102e-04]
 [ 4.58860554e-03  4.62192025e-05 -4.97058030e-04  3.80117401e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0034540398291470907
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.0441382162972766e-08, theta_kick=2.4509986348097664e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.76852327907847e-08, theta_kick=-1.0513789339181105e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003435124385624264
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.581274921495158e-09, theta_kick=5.493121007547307e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.9688874384148372e-08, theta_kick=-2.360770120716271e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.551619070409353e-08, theta_kick=1.0253713031672168e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010635954155139474
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.6341578729583365e-08, theta_kick=1.959416777080609e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01583276e-01 -6.31984331e+00  6.23433058e-03  6.86635871e-02]
 [ 1.80011773e-01  4.56137623e-01  1.25731075e-03  5.78659421e-04]
 [ 1.25002055e-02  6.86698068e-02  3.84052653e-01 -5.11991488e+00]
 [ 3.00947130e-03  9.91470906e-03  2.12575084e-01 -2.29873725e-01]]
compute_tune_4x4()/ evals =  [0.08445029+0.99642769j 0.08445029-0.99642769j 0.06991635+0.99755286j
 0.06991635-0.99755286j]
compute_tune_4x4()/ angles =  [0.2365432913740888, 0.23886338181503186, 0.7611366181849681, 0.7634567086259112]
compute_tune_4x4()/  0.2365432913740888 0.23886338181503186
compute_tunes()/ 0.2365432913740888 0.23886338181503186

 Running simulation ..
Closed orbit computation: x_co=[-1.71070978e-10 -9.92814981e-11], y_co=[ 1.13087229e-08 -1.12923137e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 15/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.21028533e-03 -3.77275823e-04  4.39980977e-03  6.51161236e-04]
 [-5.75193331e-03 -4.73892721e-04 -6.08114608e-04  3.16560071e-04]
 [-1.29386465e-03 -1.56763284e-04 -1.85542137e-03  6.49536191e-05]
 [-1.95334644e-03  1.47477889e-04 -2.95239262e-03  5.55559608e-04]
 [ 8.06587001e-04 -2.38280977e-04 -2.87840991e-03 -1.27079570e-04]
 [-2.93866600e-04 -2.86879104e-04 -3.39209914e-03 -7.94192119e-05]
 [-1.28915143e-03  4.11245184e-04  3.69742335e-03  7.82696335e-04]
 [-2.49225090e-03 -3.66974121e-04 -4.72221066e-04 -2.96587625e-04]
 [ 9.67849003e-04 -3.00054323e-05 -1.98182682e-03  3.88410054e-04]
 [-4.97565868e-05  1.15554102e-05 -1.15208930e-03 -4.07159382e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0036212521086742
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.369189603080211e-05, theta_kick=2.84074747806124e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.4352215018240516e-05, theta_kick=4.118959835549318e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01785034483557865
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.778418971508718e-05, theta_kick=6.928541767680073e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.086984472087761e-05, theta_kick=2.5023729076509703e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.846541017857952e-05, theta_kick=2.2140721590187643e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010534732324711023
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.021798808771888e-05, theta_kick=4.822288097345512e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01558045e-01 -6.31869855e+00 -1.69790525e-02 -6.72744019e-03]
 [ 1.79976574e-01  4.56490606e-01  2.91416265e-03 -2.48007100e-02]
 [-1.44810819e-02 -6.74019733e-03  3.83674967e-01 -5.11735741e+00]
 [-2.34880187e-03 -3.15258765e-02  2.12568302e-01 -2.29956810e-01]]
compute_tune_4x4()/ evals =  [0.09898962+0.99508847j 0.09898962-0.99508847j 0.05533573+0.9984678j
 0.05533573-0.9984678j ]
compute_tune_4x4()/ angles =  [0.234219467955126, 0.2411885435421112, 0.7588114564578888, 0.7657805320448741]
compute_tune_4x4()/  0.234219467955126 0.2411885435421112
compute_tunes()/ 0.234219467955126 0.2411885435421112

 Running simulation ..
Closed orbit computation: x_co=[-5.71934099e-08 -7.10909103e-08], y_co=[-4.51611458e-05 -1.51765833e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.369189603080211e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.4352215018240516e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.778418971508718e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.086984472087761e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.846541017857952e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.021798808771888e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0036212521086742}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01785034483557865}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010534732324711023}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.21028533e-03 -3.77275823e-04  4.39980977e-03  6.51161236e-04]
 [-5.75193331e-03 -4.73892721e-04 -6.08114608e-04  3.16560071e-04]
 [-1.29386465e-03 -1.56763284e-04 -1.85542137e-03  6.49536191e-05]
 [-1.95334644e-03  1.47477889e-04 -2.95239262e-03  5.55559608e-04]
 [ 8.06587001e-04 -2.38280977e-04 -2.87840991e-03 -1.27079570e-04]
 [-2.93866600e-04 -2.86879104e-04 -3.39209914e-03 -7.94192119e-05]
 [-1.28915143e-03  4.11245184e-04  3.69742335e-03  7.82696335e-04]
 [-2.49225090e-03 -3.66974121e-04 -4.72221066e-04 -2.96587625e-04]
 [ 9.67849003e-04 -3.00054323e-05 -1.98182682e-03  3.88410054e-04]
 [-4.97565868e-05  1.15554102e-05 -1.15208930e-03 -4.07159382e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0036212521086742
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2776142277924225e-07, theta_kick=1.531907531089063e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.760431367367021e-08, theta_kick=-2.110823448087896e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01785034483557865
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.341892202361464e-08, theta_kick=4.007054493852361e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.654001902146645e-08, theta_kick=-3.182248141090447e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.825503351273073e-08, theta_kick=8.18403533698568e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010534732324711023
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.842140756122881e-09, theta_kick=1.1801097090469226e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01558045e-01 -6.31869855e+00 -1.69790525e-02 -6.72744019e-03]
 [ 1.79976574e-01  4.56490606e-01  2.91416265e-03 -2.48007100e-02]
 [-1.44810819e-02 -6.74019733e-03  3.83674967e-01 -5.11735741e+00]
 [-2.34880187e-03 -3.15258765e-02  2.12568302e-01 -2.29956810e-01]]
compute_tune_4x4()/ evals =  [0.09898962+0.99508847j 0.09898962-0.99508847j 0.05533573+0.9984678j
 0.05533573-0.9984678j ]
compute_tune_4x4()/ angles =  [0.234219467955126, 0.2411885435421112, 0.7588114564578888, 0.7657805320448741]
compute_tune_4x4()/  0.234219467955126 0.2411885435421112
compute_tunes()/ 0.234219467955126 0.2411885435421112

 Running simulation ..
Closed orbit computation: x_co=[-6.75271329e-10 -1.97775791e-11], y_co=[-2.14881861e-08  5.51954430e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 16/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.12529633e-03 -2.97464603e-04  1.83175774e-03  6.25415235e-04]
 [ 3.20749248e-03  1.37762104e-04  8.72106067e-04 -1.40338724e-04]
 [ 2.30638780e-05  2.09268268e-04  5.26094349e-05  5.16598080e-04]
 [ 1.14323734e-03  6.19799527e-04 -6.28940702e-04  5.85958148e-04]
 [-1.33741176e-03 -2.57574116e-04  5.55966125e-04 -1.98476409e-04]
 [ 2.51903976e-05 -3.57665252e-04  2.98664089e-03 -1.17662038e-04]
 [ 3.56852587e-03 -1.45496594e-04  1.39373394e-03 -3.02576448e-04]
 [ 3.71658853e-03 -4.06394843e-04  1.47399724e-03 -1.81370636e-04]
 [ 1.02734423e-04  1.48566710e-04 -2.43768626e-04 -1.62245455e-04]
 [-1.17225362e-03 -5.04140281e-04 -2.68552019e-03 -8.83055405e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00619807129470353
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00010725259589142246, theta_kick=1.2859989799801791e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.5437292095698226e-05, theta_kick=6.647139912595139e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005924518899709779
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.80239861648834e-05, theta_kick=1.1753444769695575e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.07573408047124e-05, theta_kick=3.687920891146114e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.180938859523078e-05, theta_kick=-9.809253511474476e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008283668018559778
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.0342655328813475e-06, theta_kick=-4.837236168630136e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01658911e-01 -6.31950344e+00  5.67348092e-03 -8.63620306e-03]
 [ 1.80014562e-01  4.56237937e-01 -1.09283557e-03  6.17535553e-03]
 [ 3.65922738e-03 -8.63339093e-03  3.83949842e-01 -5.11938059e+00]
 [ 2.24432504e-04  6.46590000e-03  2.12563019e-01 -2.29760712e-01]]
compute_tune_4x4()/ evals =  [0.08265601+0.99657814j 0.08265601-0.99657814j 0.07172806+0.99742423j
 0.07172806-0.99742423j]
compute_tune_4x4()/ angles =  [0.23682986140519996, 0.23857431223238473, 0.7614256877676153, 0.7631701385948]
compute_tune_4x4()/  0.23682986140519996 0.23857431223238473
compute_tunes()/ 0.23682986140519996 0.23857431223238473

 Running simulation ..
Closed orbit computation: x_co=[-1.56795519e-07  1.48093591e-07], y_co=[-5.87030326e-05  1.97826799e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00010725259589142246, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.5437292095698226e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.80239861648834e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.07573408047124e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.180938859523078e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.0342655328813475e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00619807129470353}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005924518899709779}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.008283668018559778}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.12529633e-03 -2.97464603e-04  1.83175774e-03  6.25415235e-04]
 [ 3.20749248e-03  1.37762104e-04  8.72106067e-04 -1.40338724e-04]
 [ 2.30638780e-05  2.09268268e-04  5.26094349e-05  5.16598080e-04]
 [ 1.14323734e-03  6.19799527e-04 -6.28940702e-04  5.85958148e-04]
 [-1.33741176e-03 -2.57574116e-04  5.55966125e-04 -1.98476409e-04]
 [ 2.51903976e-05 -3.57665252e-04  2.98664089e-03 -1.17662038e-04]
 [ 3.56852587e-03 -1.45496594e-04  1.39373394e-03 -3.02576448e-04]
 [ 3.71658853e-03 -4.06394843e-04  1.47399724e-03 -1.81370636e-04]
 [ 1.02734423e-04  1.48566710e-04 -2.43768626e-04 -1.62245455e-04]
 [-1.17225362e-03 -5.04140281e-04 -2.68552019e-03 -8.83055405e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00619807129470353
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.1032197269691426e-07, theta_kick=1.3228019627726258e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.577035640906176e-08, theta_kick=7.886113203321598e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005924518899709779
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.8328673143564074e-08, theta_kick=2.1976768740287957e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2112845592990833e-07, theta_kick=-1.4523757628219234e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.334712945660578e-08, theta_kick=-8.794596800357052e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008283668018559778
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.1864028293546258e-08, theta_kick=1.4225416324097253e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01658911e-01 -6.31950344e+00  5.67348092e-03 -8.63620306e-03]
 [ 1.80014562e-01  4.56237937e-01 -1.09283557e-03  6.17535553e-03]
 [ 3.65922738e-03 -8.63339093e-03  3.83949842e-01 -5.11938059e+00]
 [ 2.24432504e-04  6.46590000e-03  2.12563019e-01 -2.29760712e-01]]
compute_tune_4x4()/ evals =  [0.08265601+0.99657814j 0.08265601-0.99657814j 0.07172806+0.99742423j
 0.07172806-0.99742423j]
compute_tune_4x4()/ angles =  [0.23682986140519996, 0.23857431223238473, 0.7614256877676153, 0.7631701385948]
compute_tune_4x4()/  0.23682986140519996 0.23857431223238473
compute_tunes()/ 0.23682986140519996 0.23857431223238473

 Running simulation ..
Closed orbit computation: x_co=[ 1.92896741e-10 -5.31352709e-11], y_co=[5.07164683e-08 2.75239613e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 17/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.65637648e-04 -2.07210223e-04  5.21618166e-04  2.46904336e-04]
 [-2.74702339e-04 -6.14851524e-05  1.13025654e-03  4.43149318e-04]
 [-8.58065417e-05 -4.75049455e-04 -4.12590451e-03 -3.49839958e-04]
 [ 3.52392013e-03 -2.06740156e-04  8.30605427e-04 -2.80206993e-04]
 [-4.17844325e-03  2.45285692e-04 -1.51370127e-03  4.68672793e-04]
 [-3.32211033e-03 -5.02012752e-05  6.39248332e-04  1.57134044e-04]
 [-3.39104300e-03 -4.65942774e-04 -2.82783730e-03 -2.07033140e-04]
 [-5.65403842e-04 -7.40024477e-08  4.97320208e-03  1.79279052e-04]
 [ 1.36304228e-03 -1.93315933e-04  8.75570237e-04  3.10515254e-04]
 [-1.71728691e-03  4.81243507e-04  6.80971046e-05 -4.34114709e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005038211673801879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.0530068237590064e-05, theta_kick=-4.859707681558904e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.615514919115236e-05, theta_kick=-4.335138426665495e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0022008684293215496
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.480106993625948e-05, theta_kick=-4.172779229097222e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.539511760143607e-05, theta_kick=-1.023919591110959e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.3279694502900308e-05, theta_kick=1.5922853375471516e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.02066474359598946
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.5798002021569047e-05, theta_kick=5.4913527635724294e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01264902e-01 -6.31766125e+00 -1.59237383e-02 -1.00499985e-01]
 [ 1.80026207e-01  4.56235273e-01 -6.29146230e-04 -1.04444107e-02]
 [-2.38034700e-02 -1.00485148e-01  3.83778502e-01 -5.12064922e+00]
 [-5.21719909e-03 -2.63548088e-02  2.12510139e-01 -2.30062297e-01]]
compute_tune_4x4()/ evals =  [0.09620065+0.99536196j 0.09620065-0.99536196j 0.05814264+0.99830829j
 0.05814264-0.99830829j]
compute_tune_4x4()/ angles =  [0.2346654766445729, 0.2407410896460562, 0.7592589103539438, 0.7653345233554271]
compute_tune_4x4()/  0.2346654766445729 0.2407410896460562
compute_tunes()/ 0.2346654766445729 0.2407410896460562

 Running simulation ..
Closed orbit computation: x_co=[2.12399396e-08 2.58386324e-07], y_co=[ 7.80723442e-05 -5.49805043e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.0530068237590064e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.615514919115236e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.480106993625948e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 8.539511760143607e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.3279694502900308e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.5798002021569047e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.005038211673801879}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0022008684293215496}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.02066474359598946}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.65637648e-04 -2.07210223e-04  5.21618166e-04  2.46904336e-04]
 [-2.74702339e-04 -6.14851524e-05  1.13025654e-03  4.43149318e-04]
 [-8.58065417e-05 -4.75049455e-04 -4.12590451e-03 -3.49839958e-04]
 [ 3.52392013e-03 -2.06740156e-04  8.30605427e-04 -2.80206993e-04]
 [-4.17844325e-03  2.45285692e-04 -1.51370127e-03  4.68672793e-04]
 [-3.32211033e-03 -5.02012752e-05  6.39248332e-04  1.57134044e-04]
 [-3.39104300e-03 -4.65942774e-04 -2.82783730e-03 -2.07033140e-04]
 [-5.65403842e-04 -7.40024477e-08  4.97320208e-03  1.79279052e-04]
 [ 1.36304228e-03 -1.93315933e-04  8.75570237e-04  3.10515254e-04]
 [-1.71728691e-03  4.81243507e-04  6.80971046e-05 -4.34114709e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005038211673801879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.218435197549035e-08, theta_kick=-6.257100152554376e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.794064162293399e-08, theta_kick=3.350188061038668e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0022008684293215496
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.9849461279045455e-08, theta_kick=4.778100346353531e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.402693379626773e-08, theta_kick=6.478032645829276e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.8431974620977196e-08, theta_kick=5.807175988920164e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.02066474359598946
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.553106450695028e-09, theta_kick=1.145453408295397e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01264902e-01 -6.31766125e+00 -1.59237383e-02 -1.00499985e-01]
 [ 1.80026207e-01  4.56235273e-01 -6.29146230e-04 -1.04444107e-02]
 [-2.38034700e-02 -1.00485148e-01  3.83778502e-01 -5.12064922e+00]
 [-5.21719909e-03 -2.63548088e-02  2.12510139e-01 -2.30062297e-01]]
compute_tune_4x4()/ evals =  [0.09620065+0.99536196j 0.09620065-0.99536196j 0.05814264+0.99830829j
 0.05814264-0.99830829j]
compute_tune_4x4()/ angles =  [0.2346654766445729, 0.2407410896460562, 0.7592589103539438, 0.7653345233554271]
compute_tune_4x4()/  0.2346654766445729 0.2407410896460562
compute_tunes()/ 0.2346654766445729 0.2407410896460562

 Running simulation ..
Closed orbit computation: x_co=[-4.49953306e-12  1.70731623e-11], y_co=[-6.47777841e-08 -1.17806697e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 18/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.96476632e-04 -1.83912924e-04 -1.01962720e-03  3.50050503e-05]
 [-2.65446501e-03  1.41806617e-04  2.52983541e-04 -1.76664753e-05]
 [ 3.10469913e-03 -5.15324851e-05 -1.60349257e-03 -4.94826080e-04]
 [-8.19048219e-04 -3.37481655e-04  4.60828534e-04 -2.68666676e-04]
 [-2.00517716e-03  8.15828819e-05  1.85361590e-04  4.14848008e-04]
 [ 1.68035343e-03  3.48744026e-04  4.50570928e-03 -6.43984602e-06]
 [-7.27575380e-04  3.57535413e-04  1.65582220e-03  1.05878160e-04]
 [ 3.34937936e-04  3.73060578e-04  4.70412556e-03  1.33059596e-04]
 [ 2.46476985e-03 -3.22099856e-04 -4.41225239e-04 -6.25471315e-04]
 [-4.48498663e-04 -2.31357545e-04  4.17231175e-03  9.98056066e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010744988400633742
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00011483213417214251, theta_kick=1.3768804958699612e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0756298055587478e-05, theta_kick=-1.2897206088933967e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011720973426431764
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.6428564419695968e-05, theta_kick=1.969846688620552e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.1759084829994652e-05, theta_kick=2.6089961426204683e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.4971995764207045e-05, theta_kick=1.7951986262905603e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0026029768918189363
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.716121878741325e-05, theta_kick=9.251920462148621e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01515845e-01 -6.31919155e+00  1.17865070e-02  2.12810478e-02]
 [ 1.79971013e-01  4.56131965e-01 -1.72712304e-03  1.89158561e-02]
 [ 1.18560652e-02  2.12845992e-02  3.83979852e-01 -5.11870137e+00]
 [ 2.39537253e-03  2.62052711e-02  2.12570477e-01 -2.30075874e-01]]
compute_tune_4x4()/ evals =  [0.09422675+0.99555076j 0.09422675-0.99555076j 0.0600333 +0.99819638j
 0.0600333 -0.99819638j]
compute_tune_4x4()/ angles =  [0.23498106603879784, 0.24043965536366954, 0.7595603446363305, 0.7650189339612021]
compute_tune_4x4()/  0.23498106603879784 0.24043965536366954
compute_tunes()/ 0.23498106603879784 0.24043965536366954

 Running simulation ..
Closed orbit computation: x_co=[ 6.96661729e-07 -4.18508601e-08], y_co=[-4.51372380e-06  2.28373105e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00011483213417214251, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.0756298055587478e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.6428564419695968e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.1759084829994652e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.4971995764207045e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.716121878741325e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.010744988400633742}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.011720973426431764}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0026029768918189363}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.96476632e-04 -1.83912924e-04 -1.01962720e-03  3.50050503e-05]
 [-2.65446501e-03  1.41806617e-04  2.52983541e-04 -1.76664753e-05]
 [ 3.10469913e-03 -5.15324851e-05 -1.60349257e-03 -4.94826080e-04]
 [-8.19048219e-04 -3.37481655e-04  4.60828534e-04 -2.68666676e-04]
 [-2.00517716e-03  8.15828819e-05  1.85361590e-04  4.14848008e-04]
 [ 1.68035343e-03  3.48744026e-04  4.50570928e-03 -6.43984602e-06]
 [-7.27575380e-04  3.57535413e-04  1.65582220e-03  1.05878160e-04]
 [ 3.34937936e-04  3.73060578e-04  4.70412556e-03  1.33059596e-04]
 [ 2.46476985e-03 -3.22099856e-04 -4.41225239e-04 -6.25471315e-04]
 [-4.48498663e-04 -2.31357545e-04  4.17231175e-03  9.98056066e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010744988400633742
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.5512021788426202e-08, theta_kick=3.0589874048700813e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.955321158827138e-08, theta_kick=4.742578893750128e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011720973426431764
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.168804557141818e-08, theta_kick=6.197591147286048e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.112913667049853e-09, theta_kick=-7.329613493449912e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6797852148251765e-08, theta_kick=2.0141256767694934e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0026029768918189363
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.470019703746981e-08, theta_kick=4.160684188984395e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01515845e-01 -6.31919155e+00  1.17865070e-02  2.12810478e-02]
 [ 1.79971013e-01  4.56131965e-01 -1.72712304e-03  1.89158561e-02]
 [ 1.18560652e-02  2.12845992e-02  3.83979852e-01 -5.11870137e+00]
 [ 2.39537253e-03  2.62052711e-02  2.12570477e-01 -2.30075874e-01]]
compute_tune_4x4()/ evals =  [0.09422675+0.99555076j 0.09422675-0.99555076j 0.0600333 +0.99819638j
 0.0600333 -0.99819638j]
compute_tune_4x4()/ angles =  [0.23498106603879784, 0.24043965536366954, 0.7595603446363305, 0.7650189339612021]
compute_tune_4x4()/  0.23498106603879784 0.24043965536366954
compute_tunes()/ 0.23498106603879784 0.24043965536366954

 Running simulation ..
Closed orbit computation: x_co=[4.65643458e-11 1.47777961e-12], y_co=[-3.18075845e-08  1.06016638e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 19/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.99964265e-03  4.82473044e-04  2.18404500e-03  1.93277865e-04]
 [-1.68498986e-03 -2.32202768e-04 -1.99786926e-03  4.22531282e-04]
 [-3.92485811e-03  6.77694365e-04 -4.65098481e-03 -2.91591366e-04]
 [ 2.63429501e-03  6.48446119e-04  4.75771361e-04 -6.61901462e-04]
 [ 2.59240257e-03 -6.24060308e-05 -1.61988263e-03 -4.16514768e-04]
 [ 8.35271367e-04 -2.49807653e-04  1.52426010e-04 -1.15432909e-04]
 [-7.82393930e-05  4.62839422e-05  2.16200510e-03  3.64760709e-04]
 [ 3.18006537e-03  6.32260609e-05  2.27649036e-04 -5.24425660e-04]
 [-2.33548413e-03  8.32137169e-04 -2.69663921e-03 -7.51332066e-04]
 [-8.83214873e-04  5.41507130e-04  4.06033090e-03 -3.32666978e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.023111002965380763
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.1380517333843445e-06, theta_kick=1.3645668490658768e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.2973409069879949e-05, theta_kick=1.5555605616875802e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011958393236252045
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.0710052490508596e-05, theta_kick=7.279363723408124e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.616213235953234e-07, theta_kick=-9.132126240247682e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.794703452453465e-06, theta_kick=5.749029846703902e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0006632102020473767
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.66391653125119e-06, theta_kick=-1.995098528083569e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01470155e-01 -6.31931016e+00  3.53416507e-03  1.33872191e-01]
 [ 1.80114702e-01  4.56890743e-01  3.37259248e-03 -2.89944235e-03]
 [ 1.73773751e-02  1.33808721e-01  3.83740218e-01 -5.12187252e+00]
 [ 5.31800539e-03  1.43780085e-02  2.12576618e-01 -2.30178100e-01]]
compute_tune_4x4()/ evals =  [0.08531287+0.99635421j 0.08531287-0.99635421j 0.06917849+0.9976043j
 0.06917849-0.9976043j ]
compute_tune_4x4()/ angles =  [0.23640551074966604, 0.23898110114162413, 0.7610188988583759, 0.7635944892503339]
compute_tune_4x4()/  0.23640551074966604 0.23898110114162413
compute_tunes()/ 0.23640551074966604 0.23898110114162413

 Running simulation ..
Closed orbit computation: x_co=[ 3.24004742e-07 -7.53539921e-08], y_co=[-3.48779083e-05  5.67363176e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.1380517333843445e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.2973409069879949e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.0710052490508596e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.616213235953234e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.794703452453465e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.66391653125119e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.023111002965380763}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.011958393236252045}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0006632102020473767}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.99964265e-03  4.82473044e-04  2.18404500e-03  1.93277865e-04]
 [-1.68498986e-03 -2.32202768e-04 -1.99786926e-03  4.22531282e-04]
 [-3.92485811e-03  6.77694365e-04 -4.65098481e-03 -2.91591366e-04]
 [ 2.63429501e-03  6.48446119e-04  4.75771361e-04 -6.61901462e-04]
 [ 2.59240257e-03 -6.24060308e-05 -1.61988263e-03 -4.16514768e-04]
 [ 8.35271367e-04 -2.49807653e-04  1.52426010e-04 -1.15432909e-04]
 [-7.82393930e-05  4.62839422e-05  2.16200510e-03  3.64760709e-04]
 [ 3.18006537e-03  6.32260609e-05  2.27649036e-04 -5.24425660e-04]
 [-2.33548413e-03  8.32137169e-04 -2.69663921e-03 -7.51332066e-04]
 [-8.83214873e-04  5.41507130e-04  4.06033090e-03 -3.32666978e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.023111002965380763
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.20397314484485e-09, theta_kick=9.836872486271468e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.818562876297109e-08, theta_kick=1.057378869905388e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011958393236252045
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.372225815947849e-08, theta_kick=-7.64053851694947e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.6902681606583687e-08, theta_kick=3.225732749613105e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.706456351887334e-08, theta_kick=-3.245142999999258e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0006632102020473767
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.933448156368155e-08, theta_kick=1.0711540472573349e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01470155e-01 -6.31931016e+00  3.53416507e-03  1.33872191e-01]
 [ 1.80114702e-01  4.56890743e-01  3.37259248e-03 -2.89944235e-03]
 [ 1.73773751e-02  1.33808721e-01  3.83740218e-01 -5.12187252e+00]
 [ 5.31800539e-03  1.43780085e-02  2.12576618e-01 -2.30178100e-01]]
compute_tune_4x4()/ evals =  [0.08531287+0.99635421j 0.08531287-0.99635421j 0.06917849+0.9976043j
 0.06917849-0.9976043j ]
compute_tune_4x4()/ angles =  [0.23640551074966604, 0.23898110114162413, 0.7610188988583759, 0.7635944892503339]
compute_tune_4x4()/  0.23640551074966604 0.23898110114162413
compute_tunes()/ 0.23640551074966604 0.23898110114162413

 Running simulation ..
Closed orbit computation: x_co=[-6.85641221e-10  1.19221642e-10], y_co=[2.0762153e-08 6.8247411e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 20/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.82107940e-03 -7.97670196e-05 -3.76357115e-03 -3.69245337e-04]
 [-2.67137656e-04  8.67749928e-04 -1.81652600e-03 -6.92066438e-06]
 [ 2.14051077e-03 -8.73282509e-04 -8.35804109e-04 -6.72630920e-05]
 [-3.40024593e-03 -3.92214448e-04  2.89062945e-03  1.33567138e-05]
 [ 1.47362153e-03 -6.26803730e-05 -1.40123974e-03 -3.38948408e-05]
 [ 1.78173193e-03 -4.48797837e-04  4.06499964e-03  7.48963893e-04]
 [-1.73207407e-03  4.64002763e-04  2.27717473e-03  9.91335583e-04]
 [ 3.95272643e-03 -8.29998041e-04  1.61297736e-03  2.95246940e-04]
 [ 5.27915022e-04  1.50077220e-04  9.07446703e-04 -3.62323311e-04]
 [ 1.71174986e-04 -2.65847073e-04  3.50137046e-03  2.22862569e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.017795184042565172
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.0943250978517438e-05, theta_kick=-2.511174594142973e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.788101279542285e-05, theta_kick=9.33822647203143e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01146889953742585
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.799581247862193e-05, theta_kick=-4.555840880578047e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.297264849215594e-06, theta_kick=-6.351619870975005e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.892618984648232e-05, theta_kick=-9.463547133073691e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002868918136348092
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.9422430154848197e-05, theta_kick=-3.527860081445253e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01568354e-01 -6.32003607e+00 -3.04474436e-03 -1.19505895e-01]
 [ 1.80078631e-01  4.56665686e-01 -3.13690666e-03  4.15262257e-03]
 [-1.54266787e-02 -1.19473656e-01  3.83878389e-01 -5.12094279e+00]
 [-4.65086350e-03 -1.08988560e-02  2.12596063e-01 -2.30033147e-01]]
compute_tune_4x4()/ evals =  [0.08351342+0.99650665j 0.08351342-0.99650665j 0.07095787+0.99747931j
 0.07095787-0.99747931j]
compute_tune_4x4()/ angles =  [0.2366929280891322, 0.23869720540535136, 0.7613027945946487, 0.7633070719108678]
compute_tune_4x4()/  0.2366929280891322 0.23869720540535136
compute_tunes()/ 0.2366929280891322 0.23869720540535136

 Running simulation ..
Closed orbit computation: x_co=[-2.59276206e-07 -1.54641623e-07], y_co=[1.45145678e-05 1.24003833e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.0943250978517438e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.788101279542285e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.799581247862193e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.297264849215594e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.892618984648232e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.9422430154848197e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.017795184042565172}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01146889953742585}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002868918136348092}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.82107940e-03 -7.97670196e-05 -3.76357115e-03 -3.69245337e-04]
 [-2.67137656e-04  8.67749928e-04 -1.81652600e-03 -6.92066438e-06]
 [ 2.14051077e-03 -8.73282509e-04 -8.35804109e-04 -6.72630920e-05]
 [-3.40024593e-03 -3.92214448e-04  2.89062945e-03  1.33567138e-05]
 [ 1.47362153e-03 -6.26803730e-05 -1.40123974e-03 -3.38948408e-05]
 [ 1.78173193e-03 -4.48797837e-04  4.06499964e-03  7.48963893e-04]
 [-1.73207407e-03  4.64002763e-04  2.27717473e-03  9.91335583e-04]
 [ 3.95272643e-03 -8.29998041e-04  1.61297736e-03  2.95246940e-04]
 [ 5.27915022e-04  1.50077220e-04  9.07446703e-04 -3.62323311e-04]
 [ 1.71174986e-04 -2.65847073e-04  3.50137046e-03  2.22862569e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.017795184042565172
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.167040114113913e-08, theta_kick=-3.797400260996877e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.616672273290189e-08, theta_kick=-5.53556376422286e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01146889953742585
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.484148083747216e-09, theta_kick=5.376662274558688e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.231683755141961e-09, theta_kick=-6.27298567160322e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.388622206430147e-08, theta_kick=6.461160779719569e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002868918136348092
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.1302251009555298e-08, theta_kick=-2.5542200486506586e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01568354e-01 -6.32003607e+00 -3.04474436e-03 -1.19505895e-01]
 [ 1.80078631e-01  4.56665686e-01 -3.13690666e-03  4.15262257e-03]
 [-1.54266787e-02 -1.19473656e-01  3.83878389e-01 -5.12094279e+00]
 [-4.65086350e-03 -1.08988560e-02  2.12596063e-01 -2.30033147e-01]]
compute_tune_4x4()/ evals =  [0.08351342+0.99650665j 0.08351342-0.99650665j 0.07095787+0.99747931j
 0.07095787-0.99747931j]
compute_tune_4x4()/ angles =  [0.2366929280891322, 0.23869720540535136, 0.7613027945946487, 0.7633070719108678]
compute_tune_4x4()/  0.2366929280891322 0.23869720540535136
compute_tunes()/ 0.2366929280891322 0.23869720540535136

 Running simulation ..
Closed orbit computation: x_co=[-7.86264366e-11  1.47436442e-10], y_co=[-6.25452761e-09 -9.05710583e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 21/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.01660513e-03 -7.64290818e-04 -2.97915701e-03 -4.29522883e-04]
 [-1.75179289e-03 -3.26412726e-04 -7.11868693e-05  2.58508770e-04]
 [-3.01248669e-03  1.69855645e-04  2.07565217e-03  3.48953535e-04]
 [ 2.53290736e-03 -5.71284002e-04 -4.98870487e-03 -3.00878151e-04]
 [-4.00195085e-03 -3.50770058e-04 -1.09309567e-03 -5.01574987e-04]
 [ 6.78014851e-04  2.14253936e-04  3.93817247e-05 -4.51180121e-04]
 [-1.69402328e-03 -1.79168444e-04  2.89682994e-03  3.49901084e-04]
 [-1.84319212e-03  3.48962929e-04 -2.30436404e-03  3.09056368e-04]
 [ 5.81706514e-04 -2.26766620e-04  2.85376811e-03  1.64259093e-04]
 [ 3.17444608e-04 -7.36085950e-05  2.32300891e-03  4.48394851e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00012553289799262295
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.627608161283238e-05, theta_kick=-4.349638679049547e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.807070817310798e-05, theta_kick=-2.1667459034429653e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011605549977473314
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.0001001324035663542, theta_kick=1.2006251949337998e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.694262381577437e-05, theta_kick=-9.225710102555928e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00011122955824580085, theta_kick=1.3336842549951329e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016779091871047674
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.00010418822205721914, theta_kick=-1.2492559846959166e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01477818e-01 -6.31774379e+00  1.62147281e-02  3.53725030e-02]
 [ 1.80009905e-01  4.56418989e-01 -1.59759040e-03  1.77142956e-02]
 [ 1.69726755e-02  3.53584138e-02  3.83637466e-01 -5.11874265e+00]
 [ 3.04934936e-03  2.66053171e-02  2.12519131e-01 -2.29838044e-01]]
compute_tune_4x4()/ evals =  [0.09645747+0.99533711j 0.09645747-0.99533711j 0.05791283+0.99832164j
 0.05791283-0.99832164j]
compute_tune_4x4()/ angles =  [0.23462441172071888, 0.24077772690109578, 0.7592222730989042, 0.7653755882792811]
compute_tune_4x4()/  0.23462441172071888 0.24077772690109578
compute_tunes()/ 0.23462441172071888 0.24077772690109578

 Running simulation ..
Closed orbit computation: x_co=[-8.03587571e-07  9.58479297e-08], y_co=[-6.53118915e-05 -3.41472261e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.627608161283238e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.807070817310798e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.0001001324035663542, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.694262381577437e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00011122955824580085, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.00010418822205721914, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00012553289799262295}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.011605549977473314}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.016779091871047674}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.01660513e-03 -7.64290818e-04 -2.97915701e-03 -4.29522883e-04]
 [-1.75179289e-03 -3.26412726e-04 -7.11868693e-05  2.58508770e-04]
 [-3.01248669e-03  1.69855645e-04  2.07565217e-03  3.48953535e-04]
 [ 2.53290736e-03 -5.71284002e-04 -4.98870487e-03 -3.00878151e-04]
 [-4.00195085e-03 -3.50770058e-04 -1.09309567e-03 -5.01574987e-04]
 [ 6.78014851e-04  2.14253936e-04  3.93817247e-05 -4.51180121e-04]
 [-1.69402328e-03 -1.79168444e-04  2.89682994e-03  3.49901084e-04]
 [-1.84319212e-03  3.48962929e-04 -2.30436404e-03  3.09056368e-04]
 [ 5.81706514e-04 -2.26766620e-04  2.85376811e-03  1.64259093e-04]
 [ 3.17444608e-04 -7.36085950e-05  2.32300891e-03  4.48394851e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00012553289799262295
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.1751986361527615e-07, theta_kick=1.4091073831877439e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.716377559741422e-09, theta_kick=-1.045126465964266e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011605549977473314
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.2625217327161846e-08, theta_kick=6.309961567035393e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2040760069658145e-07, theta_kick=-1.4437324373427878e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5358149871271736e-07, theta_kick=1.841499956684752e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016779091871047674
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.4543286799932028e-08, theta_kick=-2.9428324347530134e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01477818e-01 -6.31774379e+00  1.62147281e-02  3.53725030e-02]
 [ 1.80009905e-01  4.56418989e-01 -1.59759040e-03  1.77142956e-02]
 [ 1.69726755e-02  3.53584138e-02  3.83637466e-01 -5.11874265e+00]
 [ 3.04934936e-03  2.66053171e-02  2.12519131e-01 -2.29838044e-01]]
compute_tune_4x4()/ evals =  [0.09645747+0.99533711j 0.09645747-0.99533711j 0.05791283+0.99832164j
 0.05791283-0.99832164j]
compute_tune_4x4()/ angles =  [0.23462441172071888, 0.24077772690109578, 0.7592222730989042, 0.7653755882792811]
compute_tune_4x4()/  0.23462441172071888 0.24077772690109578
compute_tunes()/ 0.23462441172071888 0.24077772690109578

 Running simulation ..
Closed orbit computation: x_co=[4.44833752e-10 4.13244142e-11], y_co=[-2.34147073e-08  4.72718177e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 22/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.26407272e-04  1.27563773e-04  1.71712119e-03  1.29604795e-04]
 [-3.95154908e-03  6.73127173e-04 -9.19785807e-04 -2.02865917e-04]
 [ 1.63966272e-03  4.19581453e-04  1.54021428e-03  4.48250598e-04]
 [ 2.47304425e-03  3.69675473e-04 -9.90243946e-04 -3.02100516e-05]
 [ 2.02328111e-03  4.14382846e-04 -1.00520215e-03 -2.54540577e-04]
 [-2.14511946e-03  6.44050593e-04  4.96732218e-03  8.53464691e-04]
 [-1.34089845e-03 -1.48419758e-04 -3.01128722e-03  3.78637902e-04]
 [ 3.91626260e-04 -3.64975937e-04 -1.57406139e-03  1.18805190e-03]
 [ 2.66645786e-03 -2.99033756e-04  3.60093109e-04  2.96963004e-05]
 [-2.48899285e-03  9.07644935e-04 -4.01739933e-04  5.04294838e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006731185623097229
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.595429144152338e-05, theta_kick=4.311054826730489e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.334302644155048e-05, theta_kick=3.997954327995461e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002866072678845673
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.627401679715239e-06, theta_kick=-9.145541605298677e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.7013046348490414e-06, theta_kick=-4.438003523784591e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5666356027093795e-05, theta_kick=-1.8784550344352274e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00760868192754256
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.1532566818320186e-05, theta_kick=1.3827981543614198e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647472e-01 -6.31958900e+00 -3.50004684e-03  4.72478571e-03]
 [ 1.80011170e-01  4.56168255e-01  5.43590189e-04 -2.27350890e-03]
 [-2.32286125e-03  4.72357526e-03  3.84002227e-01 -5.11956326e+00]
 [-7.20857380e-05 -2.17341353e-03  2.12563710e-01 -2.29787073e-01]]
compute_tune_4x4()/ evals =  [0.07973839+0.99681583j 0.07973839-0.99681583j 0.07462958+0.99721132j
 0.07462958-0.99721132j]
compute_tune_4x4()/ angles =  [0.23729575419284618, 0.23811128015185182, 0.7618887198481482, 0.7627042458071538]
compute_tune_4x4()/  0.23729575419284618 0.23811128015185182
compute_tunes()/ 0.23729575419284618 0.23811128015185182

 Running simulation ..
Closed orbit computation: x_co=[-5.98254857e-08 -2.53998801e-09], y_co=[1.47354103e-06 6.27057031e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.595429144152338e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.334302644155048e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.627401679715239e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.7013046348490414e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.5666356027093795e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.1532566818320186e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006731185623097229}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.002866072678845673}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00760868192754256}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.26407272e-04  1.27563773e-04  1.71712119e-03  1.29604795e-04]
 [-3.95154908e-03  6.73127173e-04 -9.19785807e-04 -2.02865917e-04]
 [ 1.63966272e-03  4.19581453e-04  1.54021428e-03  4.48250598e-04]
 [ 2.47304425e-03  3.69675473e-04 -9.90243946e-04 -3.02100516e-05]
 [ 2.02328111e-03  4.14382846e-04 -1.00520215e-03 -2.54540577e-04]
 [-2.14511946e-03  6.44050593e-04  4.96732218e-03  8.53464691e-04]
 [-1.34089845e-03 -1.48419758e-04 -3.01128722e-03  3.78637902e-04]
 [ 3.91626260e-04 -3.64975937e-04 -1.57406139e-03  1.18805190e-03]
 [ 2.66645786e-03 -2.99033756e-04  3.60093109e-04  2.96963004e-05]
 [-2.48899285e-03  9.07644935e-04 -4.01739933e-04  5.04294838e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006731185623097229
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.706610997119554e-09, theta_kick=9.240516557224315e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.166460919133861e-08, theta_kick=-4.995743410777376e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002866072678845673
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.399797536801338e-09, theta_kick=8.872635674030725e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.6908523029963165e-08, theta_kick=-3.2264331582554513e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.2389971944424645e-08, theta_kick=6.281754760502584e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00760868192754256
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.09153633052546e-08, theta_kick=-2.5078307571876104e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647472e-01 -6.31958900e+00 -3.50004684e-03  4.72478571e-03]
 [ 1.80011170e-01  4.56168255e-01  5.43590189e-04 -2.27350890e-03]
 [-2.32286125e-03  4.72357526e-03  3.84002227e-01 -5.11956326e+00]
 [-7.20857380e-05 -2.17341353e-03  2.12563710e-01 -2.29787073e-01]]
compute_tune_4x4()/ evals =  [0.07973839+0.99681583j 0.07973839-0.99681583j 0.07462958+0.99721132j
 0.07462958-0.99721132j]
compute_tune_4x4()/ angles =  [0.23729575419284618, 0.23811128015185182, 0.7618887198481482, 0.7627042458071538]
compute_tune_4x4()/  0.23729575419284618 0.23811128015185182
compute_tunes()/ 0.23729575419284618 0.23811128015185182

 Running simulation ..
Closed orbit computation: x_co=[5.88115735e-12 1.42787823e-11], y_co=[ 4.59000775e-10 -3.66495498e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 23/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.28167037e-03  2.53658934e-04 -4.08752285e-03 -2.08714001e-04]
 [-2.49122548e-03  6.16349903e-04 -3.72875242e-03 -1.12834142e-04]
 [ 7.41391127e-05  3.50270517e-04 -1.21053071e-03 -7.83625088e-04]
 [ 3.90046915e-03 -1.93675664e-04  6.71141115e-03 -2.83411786e-04]
 [ 3.54053555e-03 -3.49792599e-04 -1.76521560e-03 -4.88143352e-05]
 [ 1.99900651e-03  5.44381221e-04  4.29291736e-04 -8.24148670e-04]
 [ 1.11392263e-03 -8.90710757e-05  1.23820242e-03  5.93680580e-04]
 [-2.82552556e-03  1.20620580e-04  2.27557480e-03 -2.85664831e-04]
 [-5.13228550e-04 -2.60270647e-05  8.06248837e-04  6.35300317e-04]
 [ 1.28657662e-03 -5.66673846e-04 -1.44916884e-03  1.06126153e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0011345348816878273
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.595580489354726e-06, theta_kick=-5.510273921677298e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.9036309649551195e-05, theta_kick=5.8796380327385936e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002047050437420476
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.3260537508326992e-05, theta_kick=1.589988341817024e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.341489323765232e-05, theta_kick=-1.608496174547471e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.172141177152112e-05, theta_kick=3.8035166275140837e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006531245106176538
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.904363773246534e-05, theta_kick=-3.482441444743748e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664041e-01 -6.31997149e+00  2.56977693e-03  2.84370625e-02]
 [ 1.80001949e-01  4.56093058e-01  6.18752761e-04 -1.05545818e-03]
 [ 5.16725427e-03  2.84388119e-02  3.84079515e-01 -5.11944807e+00]
 [ 1.16959438e-03  2.50695454e-03  2.12576641e-01 -2.29782540e-01]]
compute_tune_4x4()/ evals =  [0.07946611+0.99683757j 0.07946611-0.99683757j 0.07489688+0.99719128j
 0.07489688-0.99719128j]
compute_tune_4x4()/ angles =  [0.2373392261128516, 0.23806861832901857, 0.7619313816709814, 0.7626607738871484]
compute_tune_4x4()/  0.2373392261128516 0.23806861832901857
compute_tunes()/ 0.2373392261128516 0.23806861832901857

 Running simulation ..
Closed orbit computation: x_co=[5.40504865e-08 2.48685852e-08], y_co=[-3.24185681e-05  2.17142442e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.595580489354726e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.9036309649551195e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.3260537508326992e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.341489323765232e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.172141177152112e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.904363773246534e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0011345348816878273}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.002047050437420476}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006531245106176538}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.28167037e-03  2.53658934e-04 -4.08752285e-03 -2.08714001e-04]
 [-2.49122548e-03  6.16349903e-04 -3.72875242e-03 -1.12834142e-04]
 [ 7.41391127e-05  3.50270517e-04 -1.21053071e-03 -7.83625088e-04]
 [ 3.90046915e-03 -1.93675664e-04  6.71141115e-03 -2.83411786e-04]
 [ 3.54053555e-03 -3.49792599e-04 -1.76521560e-03 -4.88143352e-05]
 [ 1.99900651e-03  5.44381221e-04  4.29291736e-04 -8.24148670e-04]
 [ 1.11392263e-03 -8.90710757e-05  1.23820242e-03  5.93680580e-04]
 [-2.82552556e-03  1.20620580e-04  2.27557480e-03 -2.85664831e-04]
 [-5.13228550e-04 -2.60270647e-05  8.06248837e-04  6.35300317e-04]
 [ 1.28657662e-03 -5.66673846e-04 -1.44916884e-03  1.06126153e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0011345348816878273
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.28565389225816e-09, theta_kick=-1.1133848402123368e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.517216859435476e-11, theta_kick=1.141150111263928e-11
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002047050437420476
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.8559779505609985e-09, theta_kick=3.4244250227616704e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.31974676769972e-09, theta_kick=-3.980501284440953e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5087678021207646e-09, theta_kick=-1.8090693641750945e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006531245106176538
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.7417629467715757e-09, theta_kick=3.287476935723922e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664041e-01 -6.31997149e+00  2.56977693e-03  2.84370625e-02]
 [ 1.80001949e-01  4.56093058e-01  6.18752761e-04 -1.05545818e-03]
 [ 5.16725427e-03  2.84388119e-02  3.84079515e-01 -5.11944807e+00]
 [ 1.16959438e-03  2.50695454e-03  2.12576641e-01 -2.29782540e-01]]
compute_tune_4x4()/ evals =  [0.07946611+0.99683757j 0.07946611-0.99683757j 0.07489688+0.99719128j
 0.07489688-0.99719128j]
compute_tune_4x4()/ angles =  [0.2373392261128516, 0.23806861832901857, 0.7619313816709814, 0.7626607738871484]
compute_tune_4x4()/  0.2373392261128516 0.23806861832901857
compute_tunes()/ 0.2373392261128516 0.23806861832901857

 Running simulation ..
Closed orbit computation: x_co=[ 7.92947757e-13 -3.60465418e-12], y_co=[ 1.70400018e-09 -7.37025797e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 24/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.97992760e-04 -5.89967337e-04 -3.39389947e-04 -2.96270949e-04]
 [ 2.19017209e-03 -1.32638447e-04  3.36417766e-03  1.07116739e-04]
 [ 1.30700586e-03 -4.77187851e-04 -2.14278551e-03  1.30851950e-04]
 [-2.71425192e-03  1.72608666e-04 -5.88251904e-04  2.96860843e-04]
 [-7.22650976e-04  2.59031818e-04  1.51429741e-04 -1.01068731e-04]
 [-1.63041844e-03 -4.62131180e-04 -2.27049177e-03  2.81060400e-04]
 [ 3.06011316e-03 -2.57946871e-04 -1.68640505e-03 -5.51852585e-04]
 [ 3.09857289e-04  3.42834401e-04 -4.03188069e-03  5.02194823e-05]
 [ 1.60824311e-03  9.41135998e-05 -9.52339850e-04  2.53439279e-04]
 [ 6.41904942e-04 -4.76058986e-04 -6.87615863e-04  1.77539428e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00201299309028428
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.593742827323072e-05, theta_kick=-1.9109576166930894e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.0101596777332544e-05, theta_kick=-2.410257088582964e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009007430393313988
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.2366624589592942e-05, theta_kick=2.681842445746945e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.843853563458927e-05, theta_kick=3.4098874264297986e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0423090268654478e-05, theta_kick=1.249767741500696e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007861837559468699
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.849072939299189e-06, theta_kick=4.6151832808029363e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01673113e-01 -6.31953162e+00 -8.62583578e-03  1.98790693e-03]
 [ 1.80004691e-01  4.56259403e-01  1.53335409e-03 -1.14660570e-02]
 [-6.77143393e-03  1.98510266e-03  3.83928941e-01 -5.11884982e+00]
 [-9.09750768e-04 -1.38892606e-02  2.12569283e-01 -2.29745876e-01]]
compute_tune_4x4()/ evals =  [0.08732462+0.99617991j 0.08732462-0.99617991j 0.06706006+0.99774894j
 0.06706006-0.99774894j]
compute_tune_4x4()/ angles =  [0.23608413026209266, 0.23931904501010184, 0.7606809549898982, 0.7639158697379074]
compute_tune_4x4()/  0.23608413026209266 0.23931904501010184
compute_tunes()/ 0.23608413026209266 0.23931904501010184

 Running simulation ..
Closed orbit computation: x_co=[ 8.72142432e-08 -1.44566715e-08], y_co=[-1.98420764e-05 -5.59156006e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.593742827323072e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.0101596777332544e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.2366624589592942e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.843853563458927e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0423090268654478e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.849072939299189e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00201299309028428}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009007430393313988}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007861837559468699}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.97992760e-04 -5.89967337e-04 -3.39389947e-04 -2.96270949e-04]
 [ 2.19017209e-03 -1.32638447e-04  3.36417766e-03  1.07116739e-04]
 [ 1.30700586e-03 -4.77187851e-04 -2.14278551e-03  1.30851950e-04]
 [-2.71425192e-03  1.72608666e-04 -5.88251904e-04  2.96860843e-04]
 [-7.22650976e-04  2.59031818e-04  1.51429741e-04 -1.01068731e-04]
 [-1.63041844e-03 -4.62131180e-04 -2.27049177e-03  2.81060400e-04]
 [ 3.06011316e-03 -2.57946871e-04 -1.68640505e-03 -5.51852585e-04]
 [ 3.09857289e-04  3.42834401e-04 -4.03188069e-03  5.02194823e-05]
 [ 1.60824311e-03  9.41135998e-05 -9.52339850e-04  2.53439279e-04]
 [ 6.41904942e-04 -4.76058986e-04 -6.87615863e-04  1.77539428e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00201299309028428
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.552315490592481e-08, theta_kick=-1.0254548065675493e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.114791086822048e-08, theta_kick=4.93378933768808e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009007430393313988
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.550401139745758e-08, theta_kick=-5.456102181561918e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.851401484373878e-08, theta_kick=4.617975293962151e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.484317027571698e-08, theta_kick=-1.0173015349979293e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007861837559468699
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.4961230665535847e-08, theta_kick=-1.793907850454742e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01673113e-01 -6.31953162e+00 -8.62583578e-03  1.98790693e-03]
 [ 1.80004691e-01  4.56259403e-01  1.53335409e-03 -1.14660570e-02]
 [-6.77143393e-03  1.98510266e-03  3.83928941e-01 -5.11884982e+00]
 [-9.09750768e-04 -1.38892606e-02  2.12569283e-01 -2.29745876e-01]]
compute_tune_4x4()/ evals =  [0.08732462+0.99617991j 0.08732462-0.99617991j 0.06706006+0.99774894j
 0.06706006-0.99774894j]
compute_tune_4x4()/ angles =  [0.23608413026209266, 0.23931904501010184, 0.7606809549898982, 0.7639158697379074]
compute_tune_4x4()/  0.23608413026209266 0.23931904501010184
compute_tunes()/ 0.23608413026209266 0.23931904501010184

 Running simulation ..
Closed orbit computation: x_co=[ 3.06529101e-10 -7.63910988e-12], y_co=[1.64860442e-08 1.12827072e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 25/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.69852882e-04  3.42827077e-04 -6.76550123e-04 -2.03176225e-04]
 [ 3.94961660e-03 -6.87868887e-04  4.75925222e-03  6.29772637e-04]
 [ 2.78752619e-03 -5.63219945e-04 -2.65432112e-03 -6.04904796e-04]
 [-3.32906563e-03  5.16147772e-05  3.79368584e-03  4.91619531e-04]
 [ 1.40246799e-04 -1.40554941e-04  3.21617796e-03  1.67778819e-04]
 [ 4.70774127e-03  2.68537855e-04  4.58662096e-08 -3.91284776e-04]
 [-1.14024321e-03  3.95013943e-04 -4.62868811e-03 -3.32802575e-05]
 [ 2.60246518e-03  3.43140954e-04  2.05065085e-03  3.90153986e-04]
 [ 1.44375191e-04  7.67461374e-04 -1.46907959e-03  4.03753376e-04]
 [-5.17756732e-04  5.87762331e-04 -2.78010008e-03 -5.41392675e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004299538729948896
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.382181660728496e-06, theta_kick=-8.851513575798189e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.012590153643537e-05, theta_kick=-3.6122089470039187e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0007509724318636292
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.3843004132199996e-05, theta_kick=-2.8588659079835467e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.750065905353626e-08, theta_kick=-4.496470121828441e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.711572745894933e-05, theta_kick=4.450315375280201e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.001068811969289037
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.14174570817443e-05, theta_kick=-1.3689960638299946e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01692593e-01 -6.31995729e+00  1.41932142e-03  1.12484194e-02]
 [ 1.80000517e-01  4.56090759e-01 -4.56198155e-06  2.51773973e-03]
 [ 2.37024271e-03  1.12484284e-02  3.84087022e-01 -5.11927263e+00]
 [ 6.50259246e-04  4.61522000e-03  2.12576715e-01 -2.29744248e-01]]
compute_tune_4x4()/ evals =  [0.07990081+0.99680282j 0.07990081-0.99680282j 0.07446966+0.99722328j
 0.07446966-0.99722328j]
compute_tune_4x4()/ angles =  [0.23726982057122772, 0.23813680395264422, 0.7618631960473558, 0.7627301794287723]
compute_tune_4x4()/  0.23726982057122772 0.23813680395264422
compute_tunes()/ 0.23726982057122772 0.23813680395264422

 Running simulation ..
Closed orbit computation: x_co=[ 1.88311089e-08 -9.61287148e-09], y_co=[ 6.69153038e-06 -5.19753120e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.382181660728496e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.012590153643537e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.3843004132199996e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.750065905353626e-08, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.711572745894933e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.14174570817443e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004299538729948896}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0007509724318636292}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.001068811969289037}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.69852882e-04  3.42827077e-04 -6.76550123e-04 -2.03176225e-04]
 [ 3.94961660e-03 -6.87868887e-04  4.75925222e-03  6.29772637e-04]
 [ 2.78752619e-03 -5.63219945e-04 -2.65432112e-03 -6.04904796e-04]
 [-3.32906563e-03  5.16147772e-05  3.79368584e-03  4.91619531e-04]
 [ 1.40246799e-04 -1.40554941e-04  3.21617796e-03  1.67778819e-04]
 [ 4.70774127e-03  2.68537855e-04  4.58662096e-08 -3.91284776e-04]
 [-1.14024321e-03  3.95013943e-04 -4.62868811e-03 -3.32802575e-05]
 [ 2.60246518e-03  3.43140954e-04  2.05065085e-03  3.90153986e-04]
 [ 1.44375191e-04  7.67461374e-04 -1.46907959e-03  4.03753376e-04]
 [-5.17756732e-04  5.87762331e-04 -2.78010008e-03 -5.41392675e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004299538729948896
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.6329195627808317e-09, theta_kick=3.1569696229392606e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.012152179003141e-08, theta_kick=3.6116837989306946e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0007509724318636292
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.915191100544617e-10, theta_kick=-9.490611949339894e-11
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.652964463006761e-09, theta_kick=-1.9819665861720955e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.6247079624668126e-08, theta_kick=-4.346161231544743e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.001068811969289037
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.4471477089994737e-09, theta_kick=4.1332598066923486e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01692593e-01 -6.31995729e+00  1.41932142e-03  1.12484194e-02]
 [ 1.80000517e-01  4.56090759e-01 -4.56198155e-06  2.51773973e-03]
 [ 2.37024271e-03  1.12484284e-02  3.84087022e-01 -5.11927263e+00]
 [ 6.50259246e-04  4.61522000e-03  2.12576715e-01 -2.29744248e-01]]
compute_tune_4x4()/ evals =  [0.07990081+0.99680282j 0.07990081-0.99680282j 0.07446966+0.99722328j
 0.07446966-0.99722328j]
compute_tune_4x4()/ angles =  [0.23726982057122772, 0.23813680395264422, 0.7618631960473558, 0.7627301794287723]
compute_tune_4x4()/  0.23726982057122772 0.23813680395264422
compute_tunes()/ 0.23726982057122772 0.23813680395264422

 Running simulation ..
Closed orbit computation: x_co=[-1.57261344e-11  1.48612335e-11], y_co=[3.86954531e-09 5.31219899e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 26/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.66044951e-04 -6.74839051e-04 -1.14354228e-04  5.28439585e-04]
 [ 3.69032757e-04 -2.07278121e-04 -9.09524847e-04  5.41368280e-04]
 [ 6.40020317e-04 -8.05472175e-04 -2.80923614e-04  2.76844276e-04]
 [ 3.32730765e-03 -7.43184310e-04 -3.78725901e-03 -4.08238021e-04]
 [ 2.09818463e-03 -2.07607879e-04  1.72386437e-03 -6.05875881e-05]
 [ 3.20435983e-03  4.40469183e-05  1.40928821e-04 -8.30146056e-04]
 [ 1.80906123e-03 -3.36150688e-04 -5.73590123e-03 -1.03493600e-03]
 [ 4.43972221e-04  4.34974051e-04  2.76469159e-03 -1.96884551e-05]
 [ 2.33960252e-03 -5.19624476e-05 -1.45038139e-03 -3.10786045e-04]
 [ 9.38294414e-05 -7.73071602e-04 -4.79655905e-04 -1.16987279e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006998652796968402
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.167800001473164e-05, theta_kick=6.1963866472415645e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.3512989100584144e-05, theta_kick=5.217371116675701e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.021706816792180655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.5021895715524901e-06, theta_kick=1.8011818182088977e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00010236007900450495, theta_kick=1.2273358616302863e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.641101117123228e-05, theta_kick=1.1560042998919901e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013152833115497784
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.352509400812209e-05, theta_kick=-5.218822540635856e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01306446e-01 -6.32225629e+00 -5.55384498e-03  8.89254885e-02]
 [ 1.79960456e-01  4.56317585e-01  4.49064384e-03 -2.42426808e-02]
 [ 5.15000355e-03  8.90851810e-02  3.84078020e-01 -5.12016857e+00]
 [ 1.93120222e-03 -1.79904938e-02  2.12683307e-01 -2.30967889e-01]]
compute_tune_4x4()/ evals =  [0.08764677+0.99615162j 0.08764677-0.99615162j 0.06641386+0.99779216j
 0.06641386-0.99779216j]
compute_tune_4x4()/ angles =  [0.23603266075887727, 0.23942211993160536, 0.7605778800683947, 0.7639673392411227]
compute_tune_4x4()/  0.23603266075887727 0.23942211993160536
compute_tunes()/ 0.23603266075887727 0.23942211993160536

 Running simulation ..
Closed orbit computation: x_co=[2.98187335e-07 1.73812552e-07], y_co=[-1.06764847e-04 -4.62847844e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.167800001473164e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.3512989100584144e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.5021895715524901e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00010236007900450495, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -9.641101117123228e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.352509400812209e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.006998652796968402}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.021706816792180655}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.013152833115497784}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.66044951e-04 -6.74839051e-04 -1.14354228e-04  5.28439585e-04]
 [ 3.69032757e-04 -2.07278121e-04 -9.09524847e-04  5.41368280e-04]
 [ 6.40020317e-04 -8.05472175e-04 -2.80923614e-04  2.76844276e-04]
 [ 3.32730765e-03 -7.43184310e-04 -3.78725901e-03 -4.08238021e-04]
 [ 2.09818463e-03 -2.07607879e-04  1.72386437e-03 -6.05875881e-05]
 [ 3.20435983e-03  4.40469183e-05  1.40928821e-04 -8.30146056e-04]
 [ 1.80906123e-03 -3.36150688e-04 -5.73590123e-03 -1.03493600e-03]
 [ 4.43972221e-04  4.34974051e-04  2.76469159e-03 -1.96884551e-05]
 [ 2.33960252e-03 -5.19624476e-05 -1.45038139e-03 -3.10786045e-04]
 [ 9.38294414e-05 -7.73071602e-04 -4.79655905e-04 -1.16987279e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006998652796968402
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0424453975634842e-07, theta_kick=-1.2499312550987741e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.0130006109049094e-08, theta_kick=-6.010776353413469e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.021706816792180655
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4302790892014816e-07, theta_kick=-1.7149584441407316e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.988939439994557e-08, theta_kick=7.1809637305123865e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.6126690140662106e-09, theta_kick=-4.331726079430681e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013152833115497784
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.606191681929126e-08, theta_kick=-9.120110019898232e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01306446e-01 -6.32225629e+00 -5.55384498e-03  8.89254885e-02]
 [ 1.79960456e-01  4.56317585e-01  4.49064384e-03 -2.42426808e-02]
 [ 5.15000355e-03  8.90851810e-02  3.84078020e-01 -5.12016857e+00]
 [ 1.93120222e-03 -1.79904938e-02  2.12683307e-01 -2.30967889e-01]]
compute_tune_4x4()/ evals =  [0.08764677+0.99615162j 0.08764677-0.99615162j 0.06641386+0.99779216j
 0.06641386-0.99779216j]
compute_tune_4x4()/ angles =  [0.23603266075887727, 0.23942211993160536, 0.7605778800683947, 0.7639673392411227]
compute_tune_4x4()/  0.23603266075887727 0.23942211993160536
compute_tunes()/ 0.23603266075887727 0.23942211993160536

 Running simulation ..
Closed orbit computation: x_co=[ 1.52441093e-11 -2.25158352e-10], y_co=[ 4.15345717e-08 -1.06806737e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 27/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.54353893e-03 -1.77647723e-04 -3.62158338e-03  2.60872105e-04]
 [ 1.07999577e-03  4.05554308e-04  2.02979276e-03 -2.21333314e-04]
 [ 3.49179649e-03 -5.62302471e-04  3.08256642e-03 -5.61530055e-04]
 [-2.82985813e-03 -7.97912777e-04 -4.95209662e-03 -4.91731787e-04]
 [ 1.81475680e-03 -1.32426167e-04 -3.50718082e-04  2.78461438e-04]
 [ 1.83603232e-03 -1.26383255e-05  7.05694407e-04 -4.80777853e-04]
 [ 1.21914009e-03 -4.27990994e-04 -3.55998975e-04 -5.69609815e-04]
 [ 2.61287879e-04  1.41806922e-04  4.11342651e-04  4.15449044e-04]
 [-1.08165795e-03  6.65938547e-04 -2.14884805e-03 -1.29125373e-04]
 [-1.33560788e-03 -1.92678993e-04  1.40687140e-03  3.02577370e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.014535617927624919
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.607049811674307e-05, theta_kick=7.922101323396418e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.663614947508974e-05, theta_kick=6.790887423247465e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01811543413043052
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.985475596507146e-05, theta_kick=-5.9777728254846e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.925608763761322e-05, theta_kick=-4.706952614097103e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0937937731264718e-05, theta_kick=-1.3114998894509821e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0019624107295458113
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.74695817000249e-06, theta_kick=-1.1686969588337143e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01332952e-01 -6.31880906e+00 -1.61163075e-02 -1.57008798e-02]
 [ 1.79935011e-01  4.56194545e-01  2.84279096e-03 -2.77256376e-02]
 [-1.47565458e-02 -1.57033338e-02  3.83881570e-01 -5.11808208e+00]
 [-2.84898156e-03 -3.63369408e-02  2.12579079e-01 -2.30510263e-01]]
compute_tune_4x4()/ evals =  [0.10066368+0.99492051j 0.10066368-0.99492051j 0.05345277+0.99857038j
 0.05345277-0.99857038j]
compute_tune_4x4()/ angles =  [0.2339516963056991, 0.24148867082340428, 0.7585113291765957, 0.7660483036943009]
compute_tune_4x4()/  0.2339516963056991 0.24148867082340428
compute_tunes()/ 0.2339516963056991 0.24148867082340428

 Running simulation ..
Closed orbit computation: x_co=[-3.48587782e-07 -1.31806985e-07], y_co=[2.36193494e-05 1.35808334e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.607049811674307e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.663614947508974e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.985475596507146e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.925608763761322e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.0937937731264718e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.74695817000249e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.014535617927624919}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01811543413043052}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0019624107295458113}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.54353893e-03 -1.77647723e-04 -3.62158338e-03  2.60872105e-04]
 [ 1.07999577e-03  4.05554308e-04  2.02979276e-03 -2.21333314e-04]
 [ 3.49179649e-03 -5.62302471e-04  3.08256642e-03 -5.61530055e-04]
 [-2.82985813e-03 -7.97912777e-04 -4.95209662e-03 -4.91731787e-04]
 [ 1.81475680e-03 -1.32426167e-04 -3.50718082e-04  2.78461438e-04]
 [ 1.83603232e-03 -1.26383255e-05  7.05694407e-04 -4.80777853e-04]
 [ 1.21914009e-03 -4.27990994e-04 -3.55998975e-04 -5.69609815e-04]
 [ 2.61287879e-04  1.41806922e-04  4.11342651e-04  4.15449044e-04]
 [-1.08165795e-03  6.65938547e-04 -2.14884805e-03 -1.29125373e-04]
 [-1.33560788e-03 -1.92678993e-04  1.40687140e-03  3.02577370e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.014535617927624919
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.908039700264577e-08, theta_kick=1.068107477767758e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.9119201208930787e-08, theta_kick=3.4915017898897717e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01811543413043052
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.963343151778923e-08, theta_kick=1.1946423323265136e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.2379297414168459e-08, theta_kick=1.4843243387421908e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.757260232316338e-08, theta_kick=2.1070211378438753e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0019624107295458113
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.418476646322044e-07, theta_kick=1.7008068710453852e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01332952e-01 -6.31880906e+00 -1.61163075e-02 -1.57008798e-02]
 [ 1.79935011e-01  4.56194545e-01  2.84279096e-03 -2.77256376e-02]
 [-1.47565458e-02 -1.57033338e-02  3.83881570e-01 -5.11808208e+00]
 [-2.84898156e-03 -3.63369408e-02  2.12579079e-01 -2.30510263e-01]]
compute_tune_4x4()/ evals =  [0.10066368+0.99492051j 0.10066368-0.99492051j 0.05345277+0.99857038j
 0.05345277-0.99857038j]
compute_tune_4x4()/ angles =  [0.2339516963056991, 0.24148867082340428, 0.7585113291765957, 0.7660483036943009]
compute_tune_4x4()/  0.2339516963056991 0.24148867082340428
compute_tunes()/ 0.2339516963056991 0.24148867082340428

 Running simulation ..
Closed orbit computation: x_co=[-9.98358797e-10  1.36451296e-10], y_co=[-3.60925658e-08 -2.08043362e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 28/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.92234587e-03 -4.04690449e-04 -1.17996680e-03  4.21977002e-04]
 [-4.02136025e-04 -6.35604831e-04 -1.52835024e-03  2.55557719e-04]
 [ 3.81860027e-03  1.23906647e-04 -2.94583881e-03 -1.68114480e-04]
 [ 6.25162433e-04  3.76030403e-04 -2.01521260e-03 -1.09485303e-03]
 [ 1.71983084e-03 -2.23090814e-05  4.04641613e-03  2.76671409e-04]
 [ 3.51267539e-03 -4.49563922e-04 -2.15677457e-03 -2.29991901e-04]
 [ 2.81555945e-03  1.22865150e-04  5.94843313e-03  3.65164547e-04]
 [-2.55733491e-03 -5.29981401e-04  2.61224701e-04 -3.14702305e-04]
 [-1.88288645e-03  1.28070740e-04  4.05378606e-04  3.93470933e-04]
 [ 3.70891403e-03 -3.96568659e-04  1.17839112e-04  3.14602404e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007294722906955102
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.254172910023159e-05, theta_kick=-7.4989886408452686e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.29101876888887e-05, theta_kick=6.34413058564603e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008718292883030753
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.9027765614407893e-05, theta_kick=2.281500691713089e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.376953337463072e-05, theta_kick=-7.646206993125623e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.1949560139581094e-05, theta_kick=-2.631834848929036e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005117341129773109
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.5549595311924134e-05, theta_kick=4.262530238067533e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588827e-01 -6.32008141e+00 -4.11412191e-03  1.64110943e-02]
 [ 1.79986331e-01  4.56086558e-01  1.60268126e-03 -1.18243490e-02]
 [-1.55159841e-03  1.64213507e-02  3.84082320e-01 -5.11942421e+00]
 [-1.89318838e-04 -1.23976598e-02  2.12586558e-01 -2.30010892e-01]]
compute_tune_4x4()/ evals =  [0.08457405+0.9964172j  0.08457405-0.9964172j  0.06971052+0.99756726j
 0.06971052-0.99756726j]
compute_tune_4x4()/ angles =  [0.2365235227423576, 0.23889621979624018, 0.7611037802037598, 0.7634764772576423]
compute_tune_4x4()/  0.2365235227423576 0.23889621979624018
compute_tunes()/ 0.2365235227423576 0.23889621979624018

 Running simulation ..
Closed orbit computation: x_co=[ 3.62334823e-08 -2.13092741e-08], y_co=[2.31084532e-05 3.87777906e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.254172910023159e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.29101876888887e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.9027765614407893e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.376953337463072e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.1949560139581094e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.5549595311924134e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007294722906955102}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.008718292883030753}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005117341129773109}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.92234587e-03 -4.04690449e-04 -1.17996680e-03  4.21977002e-04]
 [-4.02136025e-04 -6.35604831e-04 -1.52835024e-03  2.55557719e-04]
 [ 3.81860027e-03  1.23906647e-04 -2.94583881e-03 -1.68114480e-04]
 [ 6.25162433e-04  3.76030403e-04 -2.01521260e-03 -1.09485303e-03]
 [ 1.71983084e-03 -2.23090814e-05  4.04641613e-03  2.76671409e-04]
 [ 3.51267539e-03 -4.49563922e-04 -2.15677457e-03 -2.29991901e-04]
 [ 2.81555945e-03  1.22865150e-04  5.94843313e-03  3.65164547e-04]
 [-2.55733491e-03 -5.29981401e-04  2.61224701e-04 -3.14702305e-04]
 [-1.88288645e-03  1.28070740e-04  4.05378606e-04  3.93470933e-04]
 [ 3.70891403e-03 -3.96568659e-04  1.17839112e-04  3.14602404e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007294722906955102
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.499587084776154e-08, theta_kick=-4.196136591351135e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.4591183299478184e-08, theta_kick=-4.147613031620243e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008718292883030753
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.0142888465140174e-08, theta_kick=-3.6142457436712443e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.3227184587034989e-08, theta_kick=-1.5859892010592287e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.211392551521019e-08, theta_kick=1.4525052495593778e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005117341129773109
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.7057201883505636e-08, theta_kick=-2.0452226858649426e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588827e-01 -6.32008141e+00 -4.11412191e-03  1.64110943e-02]
 [ 1.79986331e-01  4.56086558e-01  1.60268126e-03 -1.18243490e-02]
 [-1.55159841e-03  1.64213507e-02  3.84082320e-01 -5.11942421e+00]
 [-1.89318838e-04 -1.23976598e-02  2.12586558e-01 -2.30010892e-01]]
compute_tune_4x4()/ evals =  [0.08457405+0.9964172j  0.08457405-0.9964172j  0.06971052+0.99756726j
 0.06971052-0.99756726j]
compute_tune_4x4()/ angles =  [0.2365235227423576, 0.23889621979624018, 0.7611037802037598, 0.7634764772576423]
compute_tune_4x4()/  0.2365235227423576 0.23889621979624018
compute_tunes()/ 0.2365235227423576 0.23889621979624018

 Running simulation ..
Closed orbit computation: x_co=[-5.96329392e-11 -2.52806856e-11], y_co=[ 2.49180234e-08 -4.55175858e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 29/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.53454478e-03 -2.22002556e-05 -3.09747746e-03  4.68216844e-05]
 [ 2.83965615e-03  3.35729331e-04  1.27414306e-04  5.10211180e-04]
 [ 1.32431904e-03 -2.30670191e-04 -1.27965692e-03 -1.15080705e-04]
 [ 3.50330711e-04 -7.11656056e-04 -1.50089612e-03  1.13625121e-04]
 [-1.52712296e-03  9.87900219e-05  8.90022770e-04  2.70911747e-04]
 [ 1.64051075e-03 -7.35199848e-04  2.80721429e-03  9.58256099e-04]
 [ 9.27641362e-04 -5.62840199e-04  9.13961736e-05  5.12473941e-04]
 [ 2.23094181e-05  6.63515996e-04 -3.25198680e-04  5.14893680e-04]
 [-1.10387791e-03  1.42187271e-04 -2.63765910e-03  2.88844652e-04]
 [ 8.89137649e-04 -5.69322235e-04  5.81025334e-04  4.14563410e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01039669963914004
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2424219823442777e-05, theta_kick=-1.4897107046408314e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.073184139572412e-05, theta_kick=2.485825789708862e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010161698624657878
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.66673337439385e-05, theta_kick=-3.1975136553537345e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.0001377614666881836, theta_kick=1.6518118202092486e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.4376316080072634e-05, theta_kick=-5.320887269901076e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004784754372728781
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.43045657725129e-05, theta_kick=-5.312284138054413e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01519391e-01 -6.31983389e+00 -6.27753577e-03  6.33749510e-03]
 [ 1.79978352e-01  4.56077561e-01  1.73775573e-03 -1.49668790e-02]
 [-4.39715117e-03  6.34908731e-03  3.84064353e-01 -5.11946806e+00]
 [-8.56376301e-04 -1.76261605e-02  2.12582435e-01 -2.30148740e-01]]
compute_tune_4x4()/ evals =  [0.08787722+0.99613131j 0.08787722-0.99613131j 0.06635967+0.99779577j
 0.06635967-0.99779577j]
compute_tune_4x4()/ angles =  [0.23599584160067258, 0.2394307639632796, 0.7605692360367204, 0.7640041583993274]
compute_tune_4x4()/  0.23599584160067258 0.2394307639632796
compute_tunes()/ 0.23599584160067258 0.2394307639632796

 Running simulation ..
Closed orbit computation: x_co=[4.33212070e-07 2.15603721e-08], y_co=[-5.67425887e-05 -6.18681286e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.2424219823442777e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.073184139572412e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.66673337439385e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.0001377614666881836, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.4376316080072634e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.43045657725129e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01039669963914004}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.010161698624657878}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004784754372728781}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.53454478e-03 -2.22002556e-05 -3.09747746e-03  4.68216844e-05]
 [ 2.83965615e-03  3.35729331e-04  1.27414306e-04  5.10211180e-04]
 [ 1.32431904e-03 -2.30670191e-04 -1.27965692e-03 -1.15080705e-04]
 [ 3.50330711e-04 -7.11656056e-04 -1.50089612e-03  1.13625121e-04]
 [-1.52712296e-03  9.87900219e-05  8.90022770e-04  2.70911747e-04]
 [ 1.64051075e-03 -7.35199848e-04  2.80721429e-03  9.58256099e-04]
 [ 9.27641362e-04 -5.62840199e-04  9.13961736e-05  5.12473941e-04]
 [ 2.23094181e-05  6.63515996e-04 -3.25198680e-04  5.14893680e-04]
 [-1.10387791e-03  1.42187271e-04 -2.63765910e-03  2.88844652e-04]
 [ 8.89137649e-04 -5.69322235e-04  5.81025334e-04  4.14563410e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01039669963914004
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.1281994200506666e-07, theta_kick=1.3527535546721622e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.857721858212037e-09, theta_kick=1.1819779418134196e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010161698624657878
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.067281606768023e-08, theta_kick=7.2748989362039185e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.434114035730262e-08, theta_kick=4.117631942032951e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.4431432557963377e-08, theta_kick=-1.7303830639196575e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004784754372728781
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.0950204301069492e-07, theta_kick=1.3129706973252051e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01519391e-01 -6.31983389e+00 -6.27753577e-03  6.33749510e-03]
 [ 1.79978352e-01  4.56077561e-01  1.73775573e-03 -1.49668790e-02]
 [-4.39715117e-03  6.34908731e-03  3.84064353e-01 -5.11946806e+00]
 [-8.56376301e-04 -1.76261605e-02  2.12582435e-01 -2.30148740e-01]]
compute_tune_4x4()/ evals =  [0.08787722+0.99613131j 0.08787722-0.99613131j 0.06635967+0.99779577j
 0.06635967-0.99779577j]
compute_tune_4x4()/ angles =  [0.23599584160067258, 0.2394307639632796, 0.7605692360367204, 0.7640041583993274]
compute_tune_4x4()/  0.23599584160067258 0.2394307639632796
compute_tunes()/ 0.23599584160067258 0.2394307639632796

 Running simulation ..
Closed orbit computation: x_co=[-4.65095544e-10  1.05104179e-10], y_co=[-2.08592287e-08  3.11333515e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 30/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.36183578e-04  1.03350809e-03  8.72590265e-04 -1.54908109e-04]
 [ 2.86475529e-03 -4.79283648e-04 -4.02971933e-04 -1.55807761e-04]
 [ 3.46815283e-03 -3.67531257e-05 -4.45401268e-03 -6.14852900e-04]
 [-3.50267609e-03  2.71656481e-04  3.09402556e-03 -1.24291610e-04]
 [-1.63212357e-03 -7.43062147e-05  3.69682785e-05 -5.33160006e-05]
 [-2.87518825e-04  4.53291259e-04  1.35387807e-03 -9.31499212e-05]
 [ 4.57329283e-03  1.80519115e-04 -3.32565151e-03 -2.95544226e-04]
 [-1.90740967e-03  3.41941086e-04  5.08258797e-03  1.57981784e-04]
 [-3.54096871e-03 -1.89660791e-04 -2.51560174e-03 -8.47206480e-04]
 [-1.68491858e-03  1.43919070e-04  3.94947941e-03  6.87700604e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005378072570480004
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.8625252645559558e-05, theta_kick=-3.4322754985931823e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1005519225169904e-05, theta_kick=1.3196031648547391e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012162142209353941
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.822053249974392e-05, theta_kick=8.179898535713827e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.433935934640369e-05, theta_kick=-7.714531271188608e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.785183293641504e-05, theta_kick=1.1732802949852375e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012767504529804114
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.0049380782647786e-05, theta_kick=-4.802071447059663e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01511716e-01 -6.32105776e+00  3.92026074e-03  1.11023526e-01]
 [ 1.80028264e-01  4.56332583e-01  3.13943696e-03 -7.87770406e-03]
 [ 1.52194906e-02  1.11069623e-01  3.84063425e-01 -5.12068252e+00]
 [ 4.12353185e-03  5.16213815e-03  2.12624234e-01 -2.30174908e-01]]
compute_tune_4x4()/ evals =  [0.08126553+0.99669249j 0.08126553-0.99669249j 0.07308916+0.99732541j
 0.07308916-0.99732541j]
compute_tune_4x4()/ angles =  [0.23705191076627335, 0.23835711675719762, 0.7616428832428024, 0.7629480892337266]
compute_tune_4x4()/  0.23705191076627335 0.23835711675719762
compute_tunes()/ 0.23705191076627335 0.23835711675719762

 Running simulation ..
Closed orbit computation: x_co=[ 3.66939553e-07 -6.56532835e-08], y_co=[-4.50558791e-05 -4.92997757e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.8625252645559558e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.1005519225169904e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.822053249974392e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.433935934640369e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -9.785183293641504e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.0049380782647786e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005378072570480004}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.012162142209353941}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012767504529804114}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.36183578e-04  1.03350809e-03  8.72590265e-04 -1.54908109e-04]
 [ 2.86475529e-03 -4.79283648e-04 -4.02971933e-04 -1.55807761e-04]
 [ 3.46815283e-03 -3.67531257e-05 -4.45401268e-03 -6.14852900e-04]
 [-3.50267609e-03  2.71656481e-04  3.09402556e-03 -1.24291610e-04]
 [-1.63212357e-03 -7.43062147e-05  3.69682785e-05 -5.33160006e-05]
 [-2.87518825e-04  4.53291259e-04  1.35387807e-03 -9.31499212e-05]
 [ 4.57329283e-03  1.80519115e-04 -3.32565151e-03 -2.95544226e-04]
 [-1.90740967e-03  3.41941086e-04  5.08258797e-03  1.57981784e-04]
 [-3.54096871e-03 -1.89660791e-04 -2.51560174e-03 -8.47206480e-04]
 [-1.68491858e-03  1.43919070e-04  3.94947941e-03  6.87700604e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005378072570480004
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.270712857698544e-08, theta_kick=3.9217077813822595e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.263164444828716e-10, theta_kick=-7.50976982939581e-11
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012162142209353941
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.770832021377521e-08, theta_kick=4.521369476294337e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.436752419820507e-08, theta_kick=-6.518870716539086e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.650599314790312e-08, theta_kick=7.974318816241556e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012767504529804114
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.4848871539143157e-08, theta_kick=-5.377548447497558e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01511716e-01 -6.32105776e+00  3.92026074e-03  1.11023526e-01]
 [ 1.80028264e-01  4.56332583e-01  3.13943696e-03 -7.87770406e-03]
 [ 1.52194906e-02  1.11069623e-01  3.84063425e-01 -5.12068252e+00]
 [ 4.12353185e-03  5.16213815e-03  2.12624234e-01 -2.30174908e-01]]
compute_tune_4x4()/ evals =  [0.08126553+0.99669249j 0.08126553-0.99669249j 0.07308916+0.99732541j
 0.07308916-0.99732541j]
compute_tune_4x4()/ angles =  [0.23705191076627335, 0.23835711675719762, 0.7616428832428024, 0.7629480892337266]
compute_tune_4x4()/  0.23705191076627335 0.23835711675719762
compute_tunes()/ 0.23705191076627335 0.23835711675719762

 Running simulation ..
Closed orbit computation: x_co=[1.73752687e-10 2.14358489e-11], y_co=[-2.51831429e-08  3.00887412e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 31/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-6.23809766e-03  5.11381180e-04  1.31856114e-03  8.95391203e-06]
 [-2.78716114e-04 -4.73178776e-04 -2.31950782e-03 -1.34474157e-04]
 [-1.39846570e-03 -2.94417085e-04 -1.33741767e-03 -1.18745265e-04]
 [-1.82455950e-03  7.69313752e-04 -1.26569335e-03  5.54663214e-04]
 [-1.42335886e-03 -3.93407609e-04  1.94352460e-03 -3.59393532e-06]
 [-3.33517025e-03  5.27015419e-04  1.08255001e-03  2.68176584e-04]
 [ 1.32344963e-03 -1.33368292e-04  1.41754435e-03  4.07113304e-04]
 [-1.69063462e-03 -1.82080190e-04  2.34795225e-03 -3.62673029e-05]
 [ 2.14537559e-03 -1.28120606e-04  1.76121203e-03 -2.01664012e-05]
 [ 3.83632166e-03 -5.70021842e-04  4.01946112e-04 -1.87794638e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011841958339582377
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.257648636209033e-06, theta_kick=-2.7070056619027277e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.3126052809503531e-05, theta_kick=1.5738631204111946e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01062932218812455
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.646293142434271e-05, theta_kick=7.969155553561095e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.4847591708947885e-05, theta_kick=4.178357364687032e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.866894184907712e-05, theta_kick=-7.034626877545217e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.022731220788816044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.079975648633059e-05, theta_kick=7.2901195700306155e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01004922e-01 -6.31934357e+00  4.05024188e-03  7.62601788e-02]
 [ 1.80006472e-01  4.56094190e-01  2.49884239e-03 -1.12542392e-02]
 [ 1.15554340e-02  7.63913579e-02  3.83939285e-01 -5.12297899e+00]
 [ 2.53926571e-03 -3.64907133e-03  2.12554325e-01 -2.30961516e-01]]
compute_tune_4x4()/ evals =  [0.07757132+0.99698681j 0.07757132-0.99698681j 0.0764622 +0.99707248j
 0.0764622 -0.99707248j]
compute_tune_4x4()/ angles =  [0.23764172639112427, 0.2378187733049067, 0.7621812266950934, 0.7623582736088758]
compute_tune_4x4()/  0.23764172639112427 0.2378187733049067
compute_tunes()/ 0.23764172639112427 0.2378187733049067

 Running simulation ..
Closed orbit computation: x_co=[1.86198168e-07 1.56957958e-07], y_co=[-1.90265441e-05 -1.04652636e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.257648636209033e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.3126052809503531e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.646293142434271e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.4847591708947885e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.866894184907712e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.079975648633059e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.011841958339582377}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01062932218812455}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.022731220788816044}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-6.23809766e-03  5.11381180e-04  1.31856114e-03  8.95391203e-06]
 [-2.78716114e-04 -4.73178776e-04 -2.31950782e-03 -1.34474157e-04]
 [-1.39846570e-03 -2.94417085e-04 -1.33741767e-03 -1.18745265e-04]
 [-1.82455950e-03  7.69313752e-04 -1.26569335e-03  5.54663214e-04]
 [-1.42335886e-03 -3.93407609e-04  1.94352460e-03 -3.59393532e-06]
 [-3.33517025e-03  5.27015419e-04  1.08255001e-03  2.68176584e-04]
 [ 1.32344963e-03 -1.33368292e-04  1.41754435e-03  4.07113304e-04]
 [-1.69063462e-03 -1.82080190e-04  2.34795225e-03 -3.62673029e-05]
 [ 2.14537559e-03 -1.28120606e-04  1.76121203e-03 -2.01664012e-05]
 [ 3.83632166e-03 -5.70021842e-04  4.01946112e-04 -1.87794638e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011841958339582377
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.248256396343981e-08, theta_kick=5.093819265617939e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.1384320597493862e-08, theta_kick=-2.564060501042434e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01062932218812455
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.9279393330832507e-08, theta_kick=2.311671801695768e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2103297214043377e-08, theta_kick=-1.4512308762590543e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.422996781021623e-08, theta_kick=4.104301935335527e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.022731220788816044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.6057331476766106e-08, theta_kick=1.9253344619490274e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01004922e-01 -6.31934357e+00  4.05024188e-03  7.62601788e-02]
 [ 1.80006472e-01  4.56094190e-01  2.49884239e-03 -1.12542392e-02]
 [ 1.15554340e-02  7.63913579e-02  3.83939285e-01 -5.12297899e+00]
 [ 2.53926571e-03 -3.64907133e-03  2.12554325e-01 -2.30961516e-01]]
compute_tune_4x4()/ evals =  [0.07757132+0.99698681j 0.07757132-0.99698681j 0.0764622 +0.99707248j
 0.0764622 -0.99707248j]
compute_tune_4x4()/ angles =  [0.23764172639112427, 0.2378187733049067, 0.7621812266950934, 0.7623582736088758]
compute_tune_4x4()/  0.23764172639112427 0.2378187733049067
compute_tunes()/ 0.23764172639112427 0.2378187733049067

 Running simulation ..
Closed orbit computation: x_co=[-2.05867992e-10  6.22063642e-11], y_co=[-5.01435905e-09 -8.66188789e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 32/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.89430602e-03  5.32068284e-04  1.49326943e-03 -2.90943297e-04]
 [ 3.78090101e-03  7.72797747e-05  1.88178928e-03 -1.34838049e-04]
 [ 2.41871465e-03  2.55333839e-04 -1.56546156e-03 -4.79154311e-04]
 [ 1.29542992e-03 -1.71144095e-04  1.99215689e-03 -6.95005661e-04]
 [-1.88811021e-03  7.26911013e-04  4.88229261e-03 -7.96568978e-05]
 [-8.53390269e-04 -4.85567926e-04 -7.02758603e-04 -1.74057321e-04]
 [-9.81236420e-04 -4.49357036e-04  2.73600256e-03  6.88128254e-05]
 [-3.05895003e-04 -5.24761692e-05  6.41520214e-04  6.63890973e-04]
 [ 1.03935197e-03  8.62337880e-04  6.00864585e-04  9.74977982e-04]
 [ 3.51187609e-04  1.52935443e-04 -7.51858057e-05 -2.52513035e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0038207296742668634
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.417399621686766e-05, theta_kick=1.699515477983176e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.151180107201223e-05, theta_kick=-8.574534021372629e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006747563264154682
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.7767904660443868e-05, theta_kick=-2.130438622935305e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.5729591646244375e-05, theta_kick=1.8860372231039645e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00011074642474856632, theta_kick=1.3278913025777679e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005286707872302574
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1082143103131465e-05, theta_kick=-1.3287906561300503e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01698085e-01 -6.31983295e+00 -5.17152167e-03  1.36202175e-02]
 [ 1.80007300e-01  4.56207220e-01  1.27347881e-03 -7.37224451e-03]
 [-2.71132248e-03  1.36172792e-02  3.83999650e-01 -5.11910665e+00]
 [-7.72266277e-05 -7.27654028e-03  2.12575425e-01 -2.29732122e-01]]
compute_tune_4x4()/ evals =  [0.08279621+0.9965665j  0.08279621-0.9965665j  0.07159212+0.99743399j
 0.07159212-0.99743399j]
compute_tune_4x4()/ angles =  [0.23680747198434546, 0.23859600367633294, 0.7614039963236671, 0.7631925280156545]
compute_tune_4x4()/  0.23680747198434546 0.23859600367633294
compute_tunes()/ 0.23680747198434546 0.23859600367633294

 Running simulation ..
Closed orbit computation: x_co=[-1.78966817e-07  2.37586292e-08], y_co=[-1.46513330e-05 -1.34992987e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.417399621686766e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.151180107201223e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.7767904660443868e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.5729591646244375e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00011074642474856632, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.1082143103131465e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0038207296742668634}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006747563264154682}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005286707872302574}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.89430602e-03  5.32068284e-04  1.49326943e-03 -2.90943297e-04]
 [ 3.78090101e-03  7.72797747e-05  1.88178928e-03 -1.34838049e-04]
 [ 2.41871465e-03  2.55333839e-04 -1.56546156e-03 -4.79154311e-04]
 [ 1.29542992e-03 -1.71144095e-04  1.99215689e-03 -6.95005661e-04]
 [-1.88811021e-03  7.26911013e-04  4.88229261e-03 -7.96568978e-05]
 [-8.53390269e-04 -4.85567926e-04 -7.02758603e-04 -1.74057321e-04]
 [-9.81236420e-04 -4.49357036e-04  2.73600256e-03  6.88128254e-05]
 [-3.05895003e-04 -5.24761692e-05  6.41520214e-04  6.63890973e-04]
 [ 1.03935197e-03  8.62337880e-04  6.00864585e-04  9.74977982e-04]
 [ 3.51187609e-04  1.52935443e-04 -7.51858057e-05 -2.52513035e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0038207296742668634
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.808953356797024e-08, theta_kick=2.1690031391200488e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.753310178632914e-08, theta_kick=5.699397753915063e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006747563264154682
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.181895432351135e-08, theta_kick=-8.611362851933087e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.8747929407840185e-08, theta_kick=5.84506015668772e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6608960930571863e-08, theta_kick=1.9914769090408803e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005286707872302574
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2425332378689869e-08, theta_kick=1.4898441042010977e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01698085e-01 -6.31983295e+00 -5.17152167e-03  1.36202175e-02]
 [ 1.80007300e-01  4.56207220e-01  1.27347881e-03 -7.37224451e-03]
 [-2.71132248e-03  1.36172792e-02  3.83999650e-01 -5.11910665e+00]
 [-7.72266277e-05 -7.27654028e-03  2.12575425e-01 -2.29732122e-01]]
compute_tune_4x4()/ evals =  [0.08279621+0.9965665j  0.08279621-0.9965665j  0.07159212+0.99743399j
 0.07159212-0.99743399j]
compute_tune_4x4()/ angles =  [0.23680747198434546, 0.23859600367633294, 0.7614039963236671, 0.7631925280156545]
compute_tune_4x4()/  0.23680747198434546 0.23859600367633294
compute_tunes()/ 0.23680747198434546 0.23859600367633294

 Running simulation ..
Closed orbit computation: x_co=[-2.05814811e-10  1.16911928e-11], y_co=[-6.56528728e-09 -7.94204915e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 33/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.69951656e-03 -1.58679484e-04 -2.27503581e-03 -7.65063989e-04]
 [-1.95428206e-03 -1.18996260e-04 -3.32065805e-03  3.30010185e-04]
 [-2.61138331e-03 -5.74076570e-05 -1.05115659e-03 -1.05459610e-03]
 [ 2.20046744e-03 -4.36094387e-05 -1.21645129e-03  6.14584926e-04]
 [-5.16472762e-03 -1.65453629e-04  2.02277179e-03  2.46673506e-04]
 [-1.70408820e-03  7.87481024e-04 -2.77045966e-03  3.25690341e-04]
 [ 1.08761102e-03 -7.27474090e-04 -3.31499198e-03  2.07916810e-04]
 [-2.00862599e-04  3.94227901e-04 -6.41313666e-04  1.85931607e-04]
 [-2.10761629e-03  8.39518883e-04 -2.87112955e-03  9.97563524e-04]
 [-4.17907525e-03 -3.30542270e-04  8.29915220e-04  3.89460513e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008961627842471377
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.7717998771829893e-05, theta_kick=-5.721567598176556e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.1427678159264036e-05, theta_kick=6.1663721149011094e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0007343159136425952
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.00012662826463183724, theta_kick=1.5183205385355743e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.443450031168378e-06, theta_kick=-1.1323051909970193e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.2879866967672425e-05, theta_kick=-3.942419764377222e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010263702850950828
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.815257760407895e-05, theta_kick=-8.171750488034096e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531384e-01 -6.31925237e+00 -9.54777037e-03 -8.21396667e-02]
 [ 1.80016293e-01  4.56164956e-01 -9.50989969e-04 -6.05171976e-03]
 [-1.66466617e-02 -8.21401774e-02  3.84010409e-01 -5.11995218e+00]
 [-3.99185813e-03 -1.84756784e-02  2.12560494e-01 -2.29887595e-01]]
compute_tune_4x4()/ evals =  [0.08980011+0.99595981j 0.08980011-0.99595981j 0.06457808+0.99791266j
 0.06457808-0.99791266j]
compute_tune_4x4()/ angles =  [0.23568858986842717, 0.23971492162347302, 0.7602850783765269, 0.7643114101315729]
compute_tune_4x4()/  0.23568858986842717 0.23971492162347302
compute_tunes()/ 0.23568858986842717 0.23971492162347302

 Running simulation ..
Closed orbit computation: x_co=[-1.38619707e-07 -1.08025847e-07], y_co=[-7.76141273e-05  6.86656467e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.7717998771829893e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.1427678159264036e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.00012662826463183724, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 9.443450031168378e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.2879866967672425e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.815257760407895e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008961627842471377}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0007343159136425952}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010263702850950828}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.69951656e-03 -1.58679484e-04 -2.27503581e-03 -7.65063989e-04]
 [-1.95428206e-03 -1.18996260e-04 -3.32065805e-03  3.30010185e-04]
 [-2.61138331e-03 -5.74076570e-05 -1.05115659e-03 -1.05459610e-03]
 [ 2.20046744e-03 -4.36094387e-05 -1.21645129e-03  6.14584926e-04]
 [-5.16472762e-03 -1.65453629e-04  2.02277179e-03  2.46673506e-04]
 [-1.70408820e-03  7.87481024e-04 -2.77045966e-03  3.25690341e-04]
 [ 1.08761102e-03 -7.27474090e-04 -3.31499198e-03  2.07916810e-04]
 [-2.00862599e-04  3.94227901e-04 -6.41313666e-04  1.85931607e-04]
 [-2.10761629e-03  8.39518883e-04 -2.87112955e-03  9.97563524e-04]
 [-4.17907525e-03 -3.30542270e-04  8.29915220e-04  3.89460513e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008961627842471377
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.9313359750071876e-08, theta_kick=4.713819755874977e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.434001147107092e-08, theta_kick=2.9184589579716065e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0007343159136425952
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.375885309987793e-08, theta_kick=5.246851135287628e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.0979103402149544e-08, theta_kick=3.7145110609906406e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.329592855704405e-09, theta_kick=6.390382367140124e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010263702850950828
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.202428477377212e-08, theta_kick=-8.635982745502987e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531384e-01 -6.31925237e+00 -9.54777037e-03 -8.21396667e-02]
 [ 1.80016293e-01  4.56164956e-01 -9.50989969e-04 -6.05171976e-03]
 [-1.66466617e-02 -8.21401774e-02  3.84010409e-01 -5.11995218e+00]
 [-3.99185813e-03 -1.84756784e-02  2.12560494e-01 -2.29887595e-01]]
compute_tune_4x4()/ evals =  [0.08980011+0.99595981j 0.08980011-0.99595981j 0.06457808+0.99791266j
 0.06457808-0.99791266j]
compute_tune_4x4()/ angles =  [0.23568858986842717, 0.23971492162347302, 0.7602850783765269, 0.7643114101315729]
compute_tune_4x4()/  0.23568858986842717 0.23971492162347302
compute_tunes()/ 0.23568858986842717 0.23971492162347302

 Running simulation ..
Closed orbit computation: x_co=[-8.54691686e-11 -1.12236851e-10], y_co=[-6.48988728e-08  7.89514579e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 34/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.42975094e-03 -3.02997569e-04 -4.27497363e-03  1.93263213e-04]
 [-8.40390277e-04  2.30262047e-04  7.11290353e-04 -2.89392002e-04]
 [-1.84615611e-03 -6.66259532e-04 -9.32880854e-04  1.00870442e-03]
 [ 1.42689682e-03 -4.34322505e-04 -3.05826405e-03  2.90690559e-04]
 [ 4.75838473e-04  4.37793708e-04 -2.89168181e-04 -4.74910566e-04]
 [-1.89389297e-03 -3.98797341e-04  2.45110181e-03 -8.58276145e-05]
 [ 3.09841240e-03 -6.56032206e-05  3.42269150e-03  5.61305524e-05]
 [ 2.32902565e-03 -5.31094191e-04  2.59833684e-04 -3.01634510e-04]
 [-1.14661747e-03  2.72110336e-04 -1.54524762e-03  2.44712928e-04]
 [ 2.18995365e-03  2.41680274e-04  2.09438630e-03  3.15453959e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010332308479332315
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.906032016510533e-05, theta_kick=-9.479629862960083e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.55427230463481e-06, theta_kick=-1.14559319856946e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=2.3699311800840956e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4598172238841543e-05, theta_kick=-1.750375779037585e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.539367368396191e-05, theta_kick=-6.641909900907772e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.510299409203172e-05, theta_kick=-7.806093950468578e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0018965782821303975
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.189939742627396e-05, theta_kick=-8.621008282632395e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627720e-01 -6.31960055e+00  2.90477500e-03  3.51683447e-02]
 [ 1.80008876e-01  4.56135394e-01  3.75062990e-04  4.15689182e-03]
 [ 6.16896773e-03  3.51678643e-02  3.84047644e-01 -5.11966992e+00]
 [ 1.75838291e-03  9.84331014e-03  2.12566762e-01 -2.29842684e-01]]
compute_tune_4x4()/ evals =  [0.08291529+0.9965566j  0.08291529-0.9965566j  0.07144103+0.99744483j
 0.07144103-0.99744483j]
compute_tune_4x4()/ angles =  [0.23678845475361268, 0.23862011254566898, 0.761379887454331, 0.7632115452463873]
compute_tune_4x4()/  0.23678845475361268 0.23862011254566898
compute_tunes()/ 0.23678845475361268 0.23862011254566898

 Running simulation ..
Closed orbit computation: x_co=[-2.81016928e-08  8.98197870e-08], y_co=[4.19086620e-05 6.32309934e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.906032016510533e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 9.55427230463481e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.4598172238841543e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.539367368396191e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.510299409203172e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.189939742627396e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.010332308479332315}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 2.3699311800840956e-05}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0018965782821303975}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.42975094e-03 -3.02997569e-04 -4.27497363e-03  1.93263213e-04]
 [-8.40390277e-04  2.30262047e-04  7.11290353e-04 -2.89392002e-04]
 [-1.84615611e-03 -6.66259532e-04 -9.32880854e-04  1.00870442e-03]
 [ 1.42689682e-03 -4.34322505e-04 -3.05826405e-03  2.90690559e-04]
 [ 4.75838473e-04  4.37793708e-04 -2.89168181e-04 -4.74910566e-04]
 [-1.89389297e-03 -3.98797341e-04  2.45110181e-03 -8.58276145e-05]
 [ 3.09841240e-03 -6.56032206e-05  3.42269150e-03  5.61305524e-05]
 [ 2.32902565e-03 -5.31094191e-04  2.59833684e-04 -3.01634510e-04]
 [-1.14661747e-03  2.72110336e-04 -1.54524762e-03  2.44712928e-04]
 [ 2.18995365e-03  2.41680274e-04  2.09438630e-03  3.15453959e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010332308479332315
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9727561060173563e-08, theta_kick=2.3654087987355502e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.384274703801034e-08, theta_kick=-4.057872707777432e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=2.3699311800840956e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.8327206157912275e-09, theta_kick=-4.595576229638568e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.855719859531309e-08, theta_kick=-7.02122844096978e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.213374460056249e-08, theta_kick=-9.848145016947155e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0018965782821303975
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.280400414793722e-08, theta_kick=-5.132361153201413e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627720e-01 -6.31960055e+00  2.90477500e-03  3.51683447e-02]
 [ 1.80008876e-01  4.56135394e-01  3.75062990e-04  4.15689182e-03]
 [ 6.16896773e-03  3.51678643e-02  3.84047644e-01 -5.11966992e+00]
 [ 1.75838291e-03  9.84331014e-03  2.12566762e-01 -2.29842684e-01]]
compute_tune_4x4()/ evals =  [0.08291529+0.9965566j  0.08291529-0.9965566j  0.07144103+0.99744483j
 0.07144103-0.99744483j]
compute_tune_4x4()/ angles =  [0.23678845475361268, 0.23862011254566898, 0.761379887454331, 0.7632115452463873]
compute_tune_4x4()/  0.23678845475361268 0.23862011254566898
compute_tunes()/ 0.23678845475361268 0.23862011254566898

 Running simulation ..
Closed orbit computation: x_co=[-6.48332639e-11  1.47672693e-10], y_co=[5.48753275e-08 1.41378978e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 35/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.01747177e-03 -6.45926522e-04 -1.40581647e-03  7.51686927e-04]
 [ 8.65112875e-04 -5.17581328e-04  8.99484878e-04 -1.49778945e-04]
 [-3.31519059e-03  2.96840732e-04 -7.08402612e-03 -6.79429984e-04]
 [-2.21560016e-03 -4.88241429e-04  1.76858685e-03 -1.48611772e-04]
 [ 5.63847320e-04 -9.09155988e-05 -8.71958293e-04 -1.36280020e-04]
 [-4.80860476e-03  8.11203672e-04  2.23747400e-03  3.74296240e-04]
 [ 9.04187794e-04 -6.42624314e-04  2.89625533e-05 -1.09181352e-04]
 [-2.19429253e-03  2.60006644e-04 -8.40473800e-04  1.04441096e-04]
 [ 4.22870289e-04 -5.82338738e-04  2.76499108e-03 -3.05891825e-05]
 [ 8.24856032e-03 -4.46934952e-04 -3.00747522e-03  3.73871500e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01068323681414664
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6033148617230217e-05, theta_kick=-1.9224348460993896e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.300496906765755e-05, theta_kick=2.7583823505244585e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008952713710223239
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.236290994500473e-05, theta_kick=-3.880434672238542e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.010514312519244e-06, theta_kick=8.405870440807867e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.868838139199529e-05, theta_kick=-4.638882499175863e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0010560136223694177
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.668337120959534e-05, theta_kick=5.597511860538282e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01546527e-01 -6.31952147e+00  8.09488871e-03  1.38936529e-02]
 [ 1.79980888e-01  4.56085498e-01 -1.33611502e-03  1.47436057e-02]
 [ 8.06464961e-03  1.38931753e-02  3.84044546e-01 -5.11921874e+00]
 [ 1.71934044e-03  2.00626774e-02  2.12573121e-01 -2.30041577e-01]]
compute_tune_4x4()/ evals =  [0.08980729+0.99595916j 0.08980729-0.99595916j 0.06446368+0.99792005j
 0.06446368-0.99792005j]
compute_tune_4x4()/ angles =  [0.23568744295510108, 0.23973316703279604, 0.760266832967204, 0.764312557044899]
compute_tune_4x4()/  0.23568744295510108 0.23973316703279604
compute_tunes()/ 0.23568744295510108 0.23973316703279604

 Running simulation ..
Closed orbit computation: x_co=[ 2.02292206e-07 -9.49976640e-10], y_co=[ 2.94904029e-05 -1.68963614e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.6033148617230217e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.300496906765755e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.236290994500473e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.010514312519244e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.868838139199529e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.668337120959534e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.01068323681414664}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.008952713710223239}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0010560136223694177}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.01747177e-03 -6.45926522e-04 -1.40581647e-03  7.51686927e-04]
 [ 8.65112875e-04 -5.17581328e-04  8.99484878e-04 -1.49778945e-04]
 [-3.31519059e-03  2.96840732e-04 -7.08402612e-03 -6.79429984e-04]
 [-2.21560016e-03 -4.88241429e-04  1.76858685e-03 -1.48611772e-04]
 [ 5.63847320e-04 -9.09155988e-05 -8.71958293e-04 -1.36280020e-04]
 [-4.80860476e-03  8.11203672e-04  2.23747400e-03  3.74296240e-04]
 [ 9.04187794e-04 -6.42624314e-04  2.89625533e-05 -1.09181352e-04]
 [-2.19429253e-03  2.60006644e-04 -8.40473800e-04  1.04441096e-04]
 [ 4.22870289e-04 -5.82338738e-04  2.76499108e-03 -3.05891825e-05]
 [ 8.24856032e-03 -4.46934952e-04 -3.00747522e-03  3.73871500e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01068323681414664
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.5818130330044e-08, theta_kick=-3.095690970784908e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.3751441873792436e-08, theta_kick=2.8478872486850803e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008952713710223239
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.6920051348503866e-08, theta_kick=-2.0287778206707644e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.863500099343254e-10, theta_kick=1.1826707746664674e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.863652241119333e-09, theta_kick=-1.1826890170378734e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0010560136223694177
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.564249573266269e-09, theta_kick=7.870782227128236e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01546527e-01 -6.31952147e+00  8.09488871e-03  1.38936529e-02]
 [ 1.79980888e-01  4.56085498e-01 -1.33611502e-03  1.47436057e-02]
 [ 8.06464961e-03  1.38931753e-02  3.84044546e-01 -5.11921874e+00]
 [ 1.71934044e-03  2.00626774e-02  2.12573121e-01 -2.30041577e-01]]
compute_tune_4x4()/ evals =  [0.08980729+0.99595916j 0.08980729-0.99595916j 0.06446368+0.99792005j
 0.06446368-0.99792005j]
compute_tune_4x4()/ angles =  [0.23568744295510108, 0.23973316703279604, 0.760266832967204, 0.764312557044899]
compute_tune_4x4()/  0.23568744295510108 0.23973316703279604
compute_tunes()/ 0.23568744295510108 0.23973316703279604

 Running simulation ..
Closed orbit computation: x_co=[ 2.93880397e-12 -7.18553729e-14], y_co=[ 5.92591204e-09 -6.66395900e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 36/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.30968161e-03 -7.00221945e-05  6.79123931e-04 -8.61038525e-05]
 [-1.57720022e-04  2.63866381e-04  1.05234734e-03  4.50045873e-04]
 [-3.10620176e-03  2.09348859e-04  4.18266374e-04  6.95793615e-05]
 [ 2.11092478e-05  2.82048342e-04  2.38760875e-03  2.05136717e-04]
 [ 4.55202600e-04  2.39107621e-04  3.75756720e-03  2.69695392e-04]
 [ 1.10219111e-02 -7.11132276e-04  1.32735965e-03 -2.14551026e-04]
 [ 9.18845176e-04 -5.76764494e-04 -7.79820105e-04 -4.89649392e-04]
 [ 4.37739204e-03  8.12183537e-06  5.48966312e-03  4.82494052e-04]
 [ 4.18836916e-03 -2.73560588e-04  9.01725205e-04 -6.27066829e-04]
 [-2.31380144e-03  3.50426281e-04 -1.54767211e-04 -8.86694834e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.012454469234175565
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.59338632986739e-05, theta_kick=-5.5076430418937605e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.8498901055963575e-05, theta_kick=-5.815200720294808e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0054026596457961
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.810438096705661e-06, theta_kick=-1.1763084408972476e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0854046455384515e-05, theta_kick=-1.3014410098206565e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.869013131871362e-05, theta_kick=4.639092321973728e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006820162436732423
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.778833856960595e-05, theta_kick=6.9290392309475e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01615289e-01 -6.31933853e+00  2.02363761e-03 -3.92316624e-02]
 [ 1.80031246e-01  4.56314030e-01 -1.32115122e-03  2.33619592e-03]
 [-2.61587205e-03 -3.92211010e-02  3.83922117e-01 -5.11999061e+00]
 [-1.35929310e-03 -2.37382671e-03  2.12557831e-01 -2.29856509e-01]]
compute_tune_4x4()/ evals =  [0.07741389+0.99699904j 0.07741389-0.99699904j 0.07696829+0.99703354j
 0.07696829-0.99703354j]
compute_tune_4x4()/ angles =  [0.2376668578670226, 0.23773798909602134, 0.7622620109039786, 0.7623331421329774]
compute_tune_4x4()/  0.2376668578670226 0.23773798909602134
compute_tunes()/ 0.2376668578670226 0.23773798909602134

 Running simulation ..
Closed orbit computation: x_co=[1.38196021e-07 9.72026924e-09], y_co=[ 2.93088852e-05 -1.42954531e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.59338632986739e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.8498901055963575e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 9.810438096705661e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.0854046455384515e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.869013131871362e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.778833856960595e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.012454469234175565}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0054026596457961}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006820162436732423}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.30968161e-03 -7.00221945e-05  6.79123931e-04 -8.61038525e-05]
 [-1.57720022e-04  2.63866381e-04  1.05234734e-03  4.50045873e-04]
 [-3.10620176e-03  2.09348859e-04  4.18266374e-04  6.95793615e-05]
 [ 2.11092478e-05  2.82048342e-04  2.38760875e-03  2.05136717e-04]
 [ 4.55202600e-04  2.39107621e-04  3.75756720e-03  2.69695392e-04]
 [ 1.10219111e-02 -7.11132276e-04  1.32735965e-03 -2.14551026e-04]
 [ 9.18845176e-04 -5.76764494e-04 -7.79820105e-04 -4.89649392e-04]
 [ 4.37739204e-03  8.12183537e-06  5.48966312e-03  4.82494052e-04]
 [ 4.18836916e-03 -2.73560588e-04  9.01725205e-04 -6.27066829e-04]
 [-2.31380144e-03  3.50426281e-04 -1.54767211e-04 -8.86694834e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.012454469234175565
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2384412516628978e-08, theta_kick=-1.4849376587734729e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.43883171902452e-08, theta_kick=4.123288621811993e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0054026596457961
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.0840853635058443e-08, theta_kick=-2.4988967673783644e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.313427320942641e-08, theta_kick=-1.574848777292316e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.6954241855921776e-08, theta_kick=-5.62999027022032e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006820162436732423
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1221280710386312e-09, theta_kick=-1.345473778764001e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01615289e-01 -6.31933853e+00  2.02363761e-03 -3.92316624e-02]
 [ 1.80031246e-01  4.56314030e-01 -1.32115122e-03  2.33619592e-03]
 [-2.61587205e-03 -3.92211010e-02  3.83922117e-01 -5.11999061e+00]
 [-1.35929310e-03 -2.37382671e-03  2.12557831e-01 -2.29856509e-01]]
compute_tune_4x4()/ evals =  [0.07741389+0.99699904j 0.07741389-0.99699904j 0.07696829+0.99703354j
 0.07696829-0.99703354j]
compute_tune_4x4()/ angles =  [0.2376668578670226, 0.23773798909602134, 0.7622620109039786, 0.7623331421329774]
compute_tune_4x4()/  0.2376668578670226 0.23773798909602134
compute_tunes()/ 0.2376668578670226 0.23773798909602134

 Running simulation ..
Closed orbit computation: x_co=[ 1.53765488e-12 -6.16685480e-11], y_co=[2.04664202e-08 6.12634178e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 37/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.02771633e-05  4.21483494e-04  1.43667791e-03 -2.82571919e-04]
 [-2.05072606e-03  3.32407482e-04  3.44530681e-03 -2.30941062e-04]
 [-1.88746576e-04 -8.93882869e-04  2.40739007e-03  4.81838871e-04]
 [-2.05505331e-03 -2.48663616e-04 -2.08510663e-04 -4.62046295e-04]
 [ 2.59711524e-03 -3.30547570e-04 -5.88493430e-04 -5.22542958e-05]
 [-1.13273669e-03 -5.06389281e-05 -4.46061792e-03  1.16180504e-04]
 [-3.24774253e-03  4.21196131e-04 -3.21499434e-03 -9.14855554e-05]
 [-1.16681593e-03  4.87065132e-04  2.18419121e-04  4.04769619e-04]
 [-2.37478246e-04  1.00023599e-04 -4.51382670e-04 -6.16977944e-04]
 [-5.13610043e-04  2.19650280e-04  2.24223111e-03 -4.28579689e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.003480294368822401
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.476535778954024e-07, theta_kick=1.136272296646126e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.088801300275903e-05, theta_kick=-4.902626605718329e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006293618910940206
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.523174073625088e-05, theta_kick=4.224418278473413e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.0840969948266186e-05, theta_kick=2.4989107137696172e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.532700038588703e-05, theta_kick=6.633915521601278e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0087814553191031
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.737962358249055e-05, theta_kick=-1.1676183271565172e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657819e-01 -6.31946463e+00  7.24531246e-03  3.66490698e-03]
 [ 1.80008887e-01  4.56216532e-01 -1.02718561e-03  7.96738387e-03]
 [ 6.26681314e-03  3.66513347e-03  3.83951926e-01 -5.11919119e+00]
 [ 8.79615255e-04  1.03265617e-02  2.12562909e-01 -2.29746629e-01]]
compute_tune_4x4()/ evals =  [0.0850991+0.99637249j 0.0850991-0.99637249j 0.0692829+0.99759705j
 0.0692829-0.99759705j]
compute_tune_4x4()/ angles =  [0.2364396561294267, 0.23896444321452334, 0.7610355567854766, 0.7635603438705734]
compute_tune_4x4()/  0.2364396561294267 0.23896444321452334
compute_tunes()/ 0.2364396561294267 0.23896444321452334

 Running simulation ..
Closed orbit computation: x_co=[-3.39093348e-07  5.91952570e-08], y_co=[-5.61052161e-05 -1.96869621e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.476535778954024e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.088801300275903e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.523174073625088e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.0840969948266186e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.532700038588703e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.737962358249055e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.003480294368822401}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006293618910940206}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0087814553191031}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.02771633e-05  4.21483494e-04  1.43667791e-03 -2.82571919e-04]
 [-2.05072606e-03  3.32407482e-04  3.44530681e-03 -2.30941062e-04]
 [-1.88746576e-04 -8.93882869e-04  2.40739007e-03  4.81838871e-04]
 [-2.05505331e-03 -2.48663616e-04 -2.08510663e-04 -4.62046295e-04]
 [ 2.59711524e-03 -3.30547570e-04 -5.88493430e-04 -5.22542958e-05]
 [-1.13273669e-03 -5.06389281e-05 -4.46061792e-03  1.16180504e-04]
 [-3.24774253e-03  4.21196131e-04 -3.21499434e-03 -9.14855554e-05]
 [-1.16681593e-03  4.87065132e-04  2.18419121e-04  4.04769619e-04]
 [-2.37478246e-04  1.00023599e-04 -4.51382670e-04 -6.16977944e-04]
 [-5.13610043e-04  2.19650280e-04  2.24223111e-03 -4.28579689e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.003480294368822401
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.337805244635488e-08, theta_kick=2.803116451407018e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.295320816152394e-09, theta_kick=6.349288902185351e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006293618910940206
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.2028513101047165e-08, theta_kick=2.6413016060800307e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.3352269157282944e-08, theta_kick=-3.999062564388753e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.653187827167822e-09, theta_kick=-6.778384913623897e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0087814553191031
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.759244468359222e-08, theta_kick=6.905550816937173e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657819e-01 -6.31946463e+00  7.24531246e-03  3.66490698e-03]
 [ 1.80008887e-01  4.56216532e-01 -1.02718561e-03  7.96738387e-03]
 [ 6.26681314e-03  3.66513347e-03  3.83951926e-01 -5.11919119e+00]
 [ 8.79615255e-04  1.03265617e-02  2.12562909e-01 -2.29746629e-01]]
compute_tune_4x4()/ evals =  [0.0850991+0.99637249j 0.0850991-0.99637249j 0.0692829+0.99759705j
 0.0692829-0.99759705j]
compute_tune_4x4()/ angles =  [0.2364396561294267, 0.23896444321452334, 0.7610355567854766, 0.7635603438705734]
compute_tune_4x4()/  0.2364396561294267 0.23896444321452334
compute_tunes()/ 0.2364396561294267 0.23896444321452334

 Running simulation ..
Closed orbit computation: x_co=[ 1.93732875e-10 -1.26771058e-11], y_co=[1.92155122e-08 9.91124845e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 38/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.10011253e-03 -9.31133217e-05 -1.08219968e-03  1.18661682e-04]
 [ 2.09286286e-03 -2.30448746e-04  1.43017376e-03 -4.63285478e-05]
 [-1.37824824e-04 -5.70746273e-05 -2.22835405e-03 -3.47109567e-04]
 [-1.20281077e-03 -6.91864884e-05  4.42529504e-04  7.27568156e-04]
 [ 6.46916697e-04 -6.21238989e-04  1.40539588e-03  8.48820740e-04]
 [-1.71626868e-03  4.45264419e-04  2.69534915e-03 -4.44406131e-05]
 [-2.89931515e-03  2.62966002e-04 -6.48661442e-04 -2.78469910e-04]
 [ 2.47091556e-03 -9.11199577e-05  5.32904169e-04 -6.08459915e-04]
 [-1.45467032e-03 -2.58417127e-04 -4.74623329e-03  3.53849117e-04]
 [ 1.63097242e-03  4.73115336e-04 -2.53262814e-03  2.58107979e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015677651747792648
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.916684046000721e-05, theta_kick=-7.094326794406702e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.289716759629946e-05, theta_kick=5.143531801200141e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0038498117263720904
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.957794730575895e-05, theta_kick=-5.944582425702953e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.971033012047685e-05, theta_kick=-8.358530876005057e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.255283092682659e-05, theta_kick=6.301282165271559e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006260838293953958
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.079101205250617e-07, theta_kick=-3.691958200449219e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01548238e-01 -6.31903771e+00 -3.83677045e-04 -5.04284603e-02]
 [ 1.80037123e-01  4.56319414e-01 -1.17901473e-03 -1.04727466e-03]
 [-5.78061628e-03 -5.04171377e-02  3.83912848e-01 -5.12045068e+00]
 [-2.09437278e-03 -8.05073308e-03  2.12548712e-01 -2.29964030e-01]]
compute_tune_4x4()/ evals =  [0.08098028+0.9967157j  0.08098028-0.9967157j  0.07337971+0.99730407j
 0.07337971-0.99730407j]
compute_tune_4x4()/ angles =  [0.2370974592223725, 0.23831074952560255, 0.7616892504743975, 0.7629025407776275]
compute_tune_4x4()/  0.2370974592223725 0.23831074952560255
compute_tunes()/ 0.2370974592223725 0.23831074952560255

 Running simulation ..
Closed orbit computation: x_co=[ 5.33518212e-08 -3.91068449e-08], y_co=[ 2.95712585e-05 -4.14499785e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.916684046000721e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.289716759629946e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.957794730575895e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.971033012047685e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.255283092682659e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.079101205250617e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.015677651747792648}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0038498117263720904}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006260838293953958}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.10011253e-03 -9.31133217e-05 -1.08219968e-03  1.18661682e-04]
 [ 2.09286286e-03 -2.30448746e-04  1.43017376e-03 -4.63285478e-05]
 [-1.37824824e-04 -5.70746273e-05 -2.22835405e-03 -3.47109567e-04]
 [-1.20281077e-03 -6.91864884e-05  4.42529504e-04  7.27568156e-04]
 [ 6.46916697e-04 -6.21238989e-04  1.40539588e-03  8.48820740e-04]
 [-1.71626868e-03  4.45264419e-04  2.69534915e-03 -4.44406131e-05]
 [-2.89931515e-03  2.62966002e-04 -6.48661442e-04 -2.78469910e-04]
 [ 2.47091556e-03 -9.11199577e-05  5.32904169e-04 -6.08459915e-04]
 [-1.45467032e-03 -2.58417127e-04 -4.74623329e-03  3.53849117e-04]
 [ 1.63097242e-03  4.73115336e-04 -2.53262814e-03  2.58107979e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015677651747792648
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3015719973352323e-08, theta_kick=1.5606337982144235e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1145213765285152e-09, theta_kick=-1.3363530658341871e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0038498117263720904
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.2000171379162183e-09, theta_kick=3.836940953341031e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.040914009279171e-09, theta_kick=-6.044245568343634e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.318109659108649e-09, theta_kick=-6.376613582350986e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006260838293953958
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.2448462656602304e-09, theta_kick=-5.089730390617335e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01548238e-01 -6.31903771e+00 -3.83677045e-04 -5.04284603e-02]
 [ 1.80037123e-01  4.56319414e-01 -1.17901473e-03 -1.04727466e-03]
 [-5.78061628e-03 -5.04171377e-02  3.83912848e-01 -5.12045068e+00]
 [-2.09437278e-03 -8.05073308e-03  2.12548712e-01 -2.29964030e-01]]
compute_tune_4x4()/ evals =  [0.08098028+0.9967157j  0.08098028-0.9967157j  0.07337971+0.99730407j
 0.07337971-0.99730407j]
compute_tune_4x4()/ angles =  [0.2370974592223725, 0.23831074952560255, 0.7616892504743975, 0.7629025407776275]
compute_tune_4x4()/  0.2370974592223725 0.23831074952560255
compute_tunes()/ 0.2370974592223725 0.23831074952560255

 Running simulation ..
Closed orbit computation: x_co=[ 1.08023598e-11 -2.00543487e-11], y_co=[1.34831831e-09 2.27435076e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 39/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.49296980e-03 -8.96210181e-04  2.02037237e-03  2.18926195e-05]
 [ 4.26630124e-03 -1.33404728e-04 -1.90930820e-04 -2.21585900e-04]
 [-1.63504220e-03 -4.67457459e-05 -2.91929711e-03 -3.99002209e-04]
 [ 1.36352432e-03 -1.75386424e-04 -3.35310913e-04  3.26169612e-04]
 [-9.48421281e-05  1.81553519e-04  6.36931318e-04  5.48937453e-04]
 [ 2.53471403e-03 -3.97695965e-04 -1.08905565e-03  3.85246618e-04]
 [ 8.71895969e-04  8.82370532e-05  1.63821544e-03  4.42340582e-04]
 [-5.58214331e-03  9.55350205e-04  1.80402250e-03  5.70798157e-04]
 [ 2.31833127e-03 -2.18380182e-04  2.79984406e-03  5.27942688e-04]
 [ 3.18088752e-03 -1.96470994e-05 -1.93114317e-03 -7.91981235e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007220565295852421
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.687734573101847e-05, theta_kick=-8.018845388221483e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8990751235813308e-05, theta_kick=-3.476100154802562e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002368351800387639
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.537525783024398e-05, theta_kick=-1.8435512653365374e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.325086805838585e-05, theta_kick=2.787866564741043e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.2697664003872504e-05, theta_kick=-3.92057294345428e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008996883944947182
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.8828540328353506e-05, theta_kick=-5.854725709366775e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01621532e-01 -6.31946749e+00 -3.91613147e-03 -4.69366611e-04]
 [ 1.80012523e-01  4.56170300e-01  4.10563599e-04 -1.86501754e-03]
 [-3.22362303e-03 -4.70516324e-04  3.83986579e-01 -5.11970365e+00]
 [-2.71083803e-04 -2.36501229e-03  2.12559106e-01 -2.29818256e-01]]
compute_tune_4x4()/ evals =  [0.08000761+0.99679425j 0.08000761-0.99679425j 0.07435094+0.99723214j
 0.07435094-0.99723214j]
compute_tune_4x4()/ angles =  [0.2372527695869198, 0.23815575074888826, 0.7618442492511117, 0.7627472304130802]
compute_tune_4x4()/  0.2372527695869198 0.23815575074888826
compute_tunes()/ 0.2372527695869198 0.23815575074888826

 Running simulation ..
Closed orbit computation: x_co=[1.24484207e-07 3.21121343e-08], y_co=[ 5.74135792e-06 -2.88383393e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.687734573101847e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8990751235813308e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.537525783024398e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.325086805838585e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.2697664003872504e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.8828540328353506e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007220565295852421}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.002368351800387639}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.008996883944947182}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.49296980e-03 -8.96210181e-04  2.02037237e-03  2.18926195e-05]
 [ 4.26630124e-03 -1.33404728e-04 -1.90930820e-04 -2.21585900e-04]
 [-1.63504220e-03 -4.67457459e-05 -2.91929711e-03 -3.99002209e-04]
 [ 1.36352432e-03 -1.75386424e-04 -3.35310913e-04  3.26169612e-04]
 [-9.48421281e-05  1.81553519e-04  6.36931318e-04  5.48937453e-04]
 [ 2.53471403e-03 -3.97695965e-04 -1.08905565e-03  3.85246618e-04]
 [ 8.71895969e-04  8.82370532e-05  1.63821544e-03  4.42340582e-04]
 [-5.58214331e-03  9.55350205e-04  1.80402250e-03  5.70798157e-04]
 [ 2.31833127e-03 -2.18380182e-04  2.79984406e-03  5.27942688e-04]
 [ 3.18088752e-03 -1.96470994e-05 -1.93114317e-03 -7.91981235e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007220565295852421
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.941486915214179e-09, theta_kick=7.12406636783519e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.096115580533118e-08, theta_kick=1.3142838238926998e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002368351800387639
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.507162387992771e-09, theta_kick=1.1399445423066368e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.507195163942906e-08, theta_kick=1.8071837118272003e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.3821479839081e-08, theta_kick=5.254360316959665e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008996883944947182
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.169703443175914e-08, theta_kick=2.601556066399002e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01621532e-01 -6.31946749e+00 -3.91613147e-03 -4.69366611e-04]
 [ 1.80012523e-01  4.56170300e-01  4.10563599e-04 -1.86501754e-03]
 [-3.22362303e-03 -4.70516324e-04  3.83986579e-01 -5.11970365e+00]
 [-2.71083803e-04 -2.36501229e-03  2.12559106e-01 -2.29818256e-01]]
compute_tune_4x4()/ evals =  [0.08000761+0.99679425j 0.08000761-0.99679425j 0.07435094+0.99723214j
 0.07435094-0.99723214j]
compute_tune_4x4()/ angles =  [0.2372527695869198, 0.23815575074888826, 0.7618442492511117, 0.7627472304130802]
compute_tune_4x4()/  0.2372527695869198 0.23815575074888826
compute_tunes()/ 0.2372527695869198 0.23815575074888826

 Running simulation ..
Closed orbit computation: x_co=[-2.16554793e-11 -4.75954330e-11], y_co=[-2.37628094e-08 -5.36615566e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 40/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.94776957e-04 -2.17223840e-05 -2.78647602e-03  6.53298682e-04]
 [ 1.36170730e-03 -1.93305767e-05 -5.25541542e-04 -2.38577512e-04]
 [ 8.28582980e-04 -1.96703708e-04  5.85322782e-03 -2.37501195e-04]
 [-1.43180430e-03  2.04835717e-04  3.89898173e-04 -7.55491336e-05]
 [ 6.82042855e-04 -9.44602923e-04 -1.03131934e-03  6.60777606e-04]
 [-1.34433439e-03  4.97205529e-04  4.83236871e-04 -4.61093706e-04]
 [ 4.96979730e-04 -1.42718510e-04  6.00959128e-04  3.40855158e-04]
 [-2.33688416e-03  1.64657491e-04  3.87704402e-03 -3.41277087e-05]
 [-2.23051124e-03  7.84797293e-04  1.55216806e-03  7.02182381e-05]
 [ 6.21704040e-04 -1.38904030e-04  1.98156977e-03 -4.78087108e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001667934732918855
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.808332398816708e-06, theta_kick=8.163446718910152e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.587171586603319e-05, theta_kick=3.10211607817285e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004230589410657101
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.856776652053296e-06, theta_kick=9.420570827676048e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00011096549122929298, theta_kick=-1.3305179921084115e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9666060206697816e-05, theta_kick=-3.5570722413530935e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008403197613057051
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.2449688446005754e-05, theta_kick=2.6918021146698523e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01700773e-01 -6.32002027e+00  3.31720596e-03 -1.92692562e-03]
 [ 1.79997521e-01  4.56100286e-01 -7.23298369e-04  5.79483381e-03]
 [ 2.47779382e-03 -1.92687494e-03  3.84081595e-01 -5.11911038e+00]
 [ 3.84972010e-04  6.89610331e-03  2.12580172e-01 -2.29740748e-01]]
compute_tune_4x4()/ evals =  [0.08178106+0.99665032j 0.08178106-0.99665032j 0.07258912+0.99736193j
 0.07258912-0.99736193j]
compute_tune_4x4()/ angles =  [0.23696958779997232, 0.23843691266147904, 0.761563087338521, 0.7630304122000277]
compute_tune_4x4()/  0.23696958779997232 0.23843691266147904
compute_tunes()/ 0.23696958779997232 0.23843691266147904

 Running simulation ..
Closed orbit computation: x_co=[5.38655409e-08 1.15682772e-08], y_co=[5.62082887e-05 9.82628451e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.808332398816708e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.587171586603319e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.856776652053296e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00011096549122929298, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.9666060206697816e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.2449688446005754e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.001667934732918855}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004230589410657101}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0008403197613057051}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.94776957e-04 -2.17223840e-05 -2.78647602e-03  6.53298682e-04]
 [ 1.36170730e-03 -1.93305767e-05 -5.25541542e-04 -2.38577512e-04]
 [ 8.28582980e-04 -1.96703708e-04  5.85322782e-03 -2.37501195e-04]
 [-1.43180430e-03  2.04835717e-04  3.89898173e-04 -7.55491336e-05]
 [ 6.82042855e-04 -9.44602923e-04 -1.03131934e-03  6.60777606e-04]
 [-1.34433439e-03  4.97205529e-04  4.83236871e-04 -4.61093706e-04]
 [ 4.96979730e-04 -1.42718510e-04  6.00959128e-04  3.40855158e-04]
 [-2.33688416e-03  1.64657491e-04  3.87704402e-03 -3.41277087e-05]
 [-2.23051124e-03  7.84797293e-04  1.55216806e-03  7.02182381e-05]
 [ 6.21704040e-04 -1.38904030e-04  1.98156977e-03 -4.78087108e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001667934732918855
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.3706202645555615e-08, theta_kick=-4.041500521355339e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.58654549551842e-09, theta_kick=1.9023277450499533e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004230589410657101
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.7033560607750052e-08, theta_kick=-3.241425634302923e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.8402605711439436e-08, theta_kick=4.604616919807508e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.937491373597049e-09, theta_kick=8.318313189453163e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008403197613057051
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.6200256190210498e-08, theta_kick=3.141509299219182e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01700773e-01 -6.32002027e+00  3.31720596e-03 -1.92692562e-03]
 [ 1.79997521e-01  4.56100286e-01 -7.23298369e-04  5.79483381e-03]
 [ 2.47779382e-03 -1.92687494e-03  3.84081595e-01 -5.11911038e+00]
 [ 3.84972010e-04  6.89610331e-03  2.12580172e-01 -2.29740748e-01]]
compute_tune_4x4()/ evals =  [0.08178106+0.99665032j 0.08178106-0.99665032j 0.07258912+0.99736193j
 0.07258912-0.99736193j]
compute_tune_4x4()/ angles =  [0.23696958779997232, 0.23843691266147904, 0.761563087338521, 0.7630304122000277]
compute_tune_4x4()/  0.23696958779997232 0.23843691266147904
compute_tunes()/ 0.23696958779997232 0.23843691266147904

 Running simulation ..
Closed orbit computation: x_co=[ 6.51617267e-11 -1.93410214e-11], y_co=[-2.80798066e-10 -7.83980872e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 41/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.98746053e-03  1.91345772e-04 -2.25867156e-03 -6.22110748e-04]
 [-2.05273569e-03 -3.22742584e-05 -1.68564682e-03 -3.43717367e-04]
 [ 8.08000873e-04  1.01604185e-04 -1.95001285e-03 -4.75809585e-04]
 [ 1.52276483e-03 -1.76325263e-04 -1.14501197e-03 -4.50871759e-04]
 [ 1.80791058e-03  1.38914839e-05  2.18801744e-03  1.58000144e-04]
 [ 8.12927219e-04 -4.37485721e-05 -2.36012506e-03  1.02948336e-03]
 [ 8.55858864e-04  6.45648587e-05  1.16930896e-04  2.09802027e-04]
 [-4.48630678e-03 -3.45711396e-04  2.22466894e-03  1.87890081e-04]
 [ 3.03320618e-03 -3.99996997e-04 -3.01869030e-04  4.41941419e-04]
 [ 1.03482339e-03  2.87472499e-04  3.23907914e-03  2.58819309e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011345384432332307
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.647386758673242e-05, theta_kick=-1.1567579719644145e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-0.0001591754744670563, theta_kick=1.9085738307884286e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01265425133995515
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.7722449841015404e-05, theta_kick=6.921138924474227e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.271554076552907e-05, theta_kick=2.723678808086062e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.297533635260412e-05, theta_kick=-7.550979781910759e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011493116421828303
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.1313154723976086e-05, theta_kick=4.953602697745569e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01360061e-01 -6.32016227e+00 -3.74694079e-03  3.75524156e-02]
 [ 1.79975196e-01  4.56070838e-01  2.45918221e-03 -1.63966317e-02]
 [ 1.03965602e-03  3.76092131e-02  3.84069978e-01 -5.12041062e+00]
 [ 4.01699910e-04 -1.52006109e-02  2.12593171e-01 -2.30513780e-01]]
compute_tune_4x4()/ evals =  [0.08560236+0.99632938j 0.08560236-0.99632938j 0.06853112+0.99764898j
 0.06853112-0.99764898j]
compute_tune_4x4()/ angles =  [0.2363592666437385, 0.23908437720595624, 0.7609156227940438, 0.7636407333562615]
compute_tune_4x4()/  0.2363592666437385 0.23908437720595624
compute_tunes()/ 0.2363592666437385 0.23908437720595624

 Running simulation ..
Closed orbit computation: x_co=[7.34286493e-07 9.30770311e-08], y_co=[-5.48610300e-05  1.81679192e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.647386758673242e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -0.0001591754744670563, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.7722449841015404e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.271554076552907e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.297533635260412e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.1313154723976086e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.011345384432332307}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01265425133995515}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011493116421828303}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.98746053e-03  1.91345772e-04 -2.25867156e-03 -6.22110748e-04]
 [-2.05273569e-03 -3.22742584e-05 -1.68564682e-03 -3.43717367e-04]
 [ 8.08000873e-04  1.01604185e-04 -1.95001285e-03 -4.75809585e-04]
 [ 1.52276483e-03 -1.76325263e-04 -1.14501197e-03 -4.50871759e-04]
 [ 1.80791058e-03  1.38914839e-05  2.18801744e-03  1.58000144e-04]
 [ 8.12927219e-04 -4.37485721e-05 -2.36012506e-03  1.02948336e-03]
 [ 8.55858864e-04  6.45648587e-05  1.16930896e-04  2.09802027e-04]
 [-4.48630678e-03 -3.45711396e-04  2.22466894e-03  1.87890081e-04]
 [ 3.03320618e-03 -3.99996997e-04 -3.01869030e-04  4.41941419e-04]
 [ 1.03482339e-03  2.87472499e-04  3.23907914e-03  2.58819309e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011345384432332307
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.4528925952078444e-08, theta_kick=-6.538223394124466e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1917021155587225e-07, theta_kick=1.4288956759612591e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01265425133995515
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.009081640317076e-08, theta_kick=9.603190239285813e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.5260173138735075e-08, theta_kick=6.6259026832211885e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.932928066575482e-08, theta_kick=-1.0710916865342852e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011493116421828303
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.3334587501640207e-08, theta_kick=6.39501772005672e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01360061e-01 -6.32016227e+00 -3.74694079e-03  3.75524156e-02]
 [ 1.79975196e-01  4.56070838e-01  2.45918221e-03 -1.63966317e-02]
 [ 1.03965602e-03  3.76092131e-02  3.84069978e-01 -5.12041062e+00]
 [ 4.01699910e-04 -1.52006109e-02  2.12593171e-01 -2.30513780e-01]]
compute_tune_4x4()/ evals =  [0.08560236+0.99632938j 0.08560236-0.99632938j 0.06853112+0.99764898j
 0.06853112-0.99764898j]
compute_tune_4x4()/ angles =  [0.2363592666437385, 0.23908437720595624, 0.7609156227940438, 0.7636407333562615]
compute_tune_4x4()/  0.2363592666437385 0.23908437720595624
compute_tunes()/ 0.2363592666437385 0.23908437720595624

 Running simulation ..
Closed orbit computation: x_co=[7.31723550e-10 1.14115045e-10], y_co=[-5.89885589e-08  3.30916435e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 42/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.47885140e-03 -6.59173712e-04  3.44080662e-03  4.66945104e-04]
 [-1.07818364e-03 -3.41157352e-04  1.33405876e-03  5.80475707e-04]
 [-2.27452698e-03 -3.54402484e-04 -1.10573531e-03 -7.11899436e-05]
 [ 1.29939070e-03 -2.62451697e-04 -9.90792777e-04 -6.60658053e-04]
 [ 3.07670775e-03 -2.28937310e-04 -2.69677599e-03  3.08694455e-04]
 [ 9.92570427e-04 -2.25465149e-04  2.66761839e-03  2.84082780e-04]
 [-2.09690009e-04  2.02824013e-05 -8.83746782e-04  3.12587322e-04]
 [-8.58439158e-04  1.61051722e-04 -7.59644563e-04  3.71065273e-04]
 [ 3.20967091e-03 -1.01940980e-03 -6.30131706e-03  2.49522312e-04]
 [-2.00116739e-03 -3.53613138e-05  9.81008194e-04 -8.37214469e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0031308177584156607
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.6432179321579852e-08, theta_kick=-3.169317755312565e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.5757400031556286e-05, theta_kick=1.8893715531356795e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003509672179979866
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.413780775999949e-05, theta_kick=5.292289224904444e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.492869548571447e-06, theta_kick=2.989044386330715e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.824816030437116e-05, theta_kick=3.3870607080236796e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.014429398126363242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.78312728806771e-05, theta_kick=8.133224842745669e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01498032e-01 -6.31868126e+00  1.19624991e-02  6.28066036e-02]
 [ 1.80010077e-01  4.56175490e-01  3.56195726e-05  9.35835652e-03]
 [ 1.65049145e-02  6.27977510e-02  3.83906090e-01 -5.11967084e+00]
 [ 3.50045437e-03  1.99657411e-02  2.12540051e-01 -2.29860418e-01]]
compute_tune_4x4()/ evals =  [0.09155001+0.99580048j 0.09155001-0.99580048j 0.06281155+0.9980254j
 0.06281155-0.9980254j ]
compute_tune_4x4()/ angles =  [0.2354089319296356, 0.23999664602353998, 0.76000335397646, 0.7645910680703644]
compute_tune_4x4()/  0.2354089319296356 0.23999664602353998
compute_tunes()/ 0.2354089319296356 0.23999664602353998

 Running simulation ..
Closed orbit computation: x_co=[1.0656059e-07 1.1463552e-08], y_co=[-1.91335895e-05 -6.66098396e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.6432179321579852e-08, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.5757400031556286e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.413780775999949e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.492869548571447e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.824816030437116e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.78312728806771e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0031308177584156607}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003509672179979866}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.014429398126363242}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.47885140e-03 -6.59173712e-04  3.44080662e-03  4.66945104e-04]
 [-1.07818364e-03 -3.41157352e-04  1.33405876e-03  5.80475707e-04]
 [-2.27452698e-03 -3.54402484e-04 -1.10573531e-03 -7.11899436e-05]
 [ 1.29939070e-03 -2.62451697e-04 -9.90792777e-04 -6.60658053e-04]
 [ 3.07670775e-03 -2.28937310e-04 -2.69677599e-03  3.08694455e-04]
 [ 9.92570427e-04 -2.25465149e-04  2.66761839e-03  2.84082780e-04]
 [-2.09690009e-04  2.02824013e-05 -8.83746782e-04  3.12587322e-04]
 [-8.58439158e-04  1.61051722e-04 -7.59644563e-04  3.71065273e-04]
 [ 3.20967091e-03 -1.01940980e-03 -6.30131706e-03  2.49522312e-04]
 [-2.00116739e-03 -3.53613138e-05  9.81008194e-04 -8.37214469e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0031308177584156607
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.562552377637313e-08, theta_kick=1.8735590939369452e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.4575182049575788e-09, theta_kick=1.74761916884092e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003509672179979866
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.0575696706805714e-09, theta_kick=6.064216333055735e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.694158567382966e-09, theta_kick=8.026547999076031e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.18682528986726e-08, theta_kick=-1.4230481784600229e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.014429398126363242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.4155034087630493e-08, theta_kick=-2.896279473694637e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01498032e-01 -6.31868126e+00  1.19624991e-02  6.28066036e-02]
 [ 1.80010077e-01  4.56175490e-01  3.56195726e-05  9.35835652e-03]
 [ 1.65049145e-02  6.27977510e-02  3.83906090e-01 -5.11967084e+00]
 [ 3.50045437e-03  1.99657411e-02  2.12540051e-01 -2.29860418e-01]]
compute_tune_4x4()/ evals =  [0.09155001+0.99580048j 0.09155001-0.99580048j 0.06281155+0.9980254j
 0.06281155-0.9980254j ]
compute_tune_4x4()/ angles =  [0.2354089319296356, 0.23999664602353998, 0.76000335397646, 0.7645910680703644]
compute_tune_4x4()/  0.2354089319296356 0.23999664602353998
compute_tunes()/ 0.2354089319296356 0.23999664602353998

 Running simulation ..
Closed orbit computation: x_co=[-3.93222994e-11  4.90654405e-11], y_co=[-9.06275065e-09  4.00983169e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 43/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.80588568e-03  7.30941110e-04 -3.79058091e-04 -1.42462477e-04]
 [-6.17719158e-04  3.01517320e-04  1.00939188e-03  2.52915283e-04]
 [ 3.25190687e-03 -3.98734569e-04  9.61317494e-04 -1.58441584e-04]
 [-7.49700789e-04 -2.77244157e-05  2.78313481e-04  1.14273611e-03]
 [ 1.87456679e-03 -6.11709727e-04  2.46867558e-03  4.76842663e-04]
 [-2.16953296e-04 -2.24532790e-04  8.92886188e-04  1.98986679e-04]
 [ 8.24007038e-03 -7.62301366e-04  3.33095699e-04  8.94516558e-05]
 [-6.82133701e-04 -5.83107077e-04  2.28977202e-03 -1.94799849e-04]
 [ 2.26074360e-03  4.51088837e-04  2.49858694e-03  6.66391195e-04]
 [ 3.22891358e-04  2.40575485e-04  3.06080761e-03  5.96117432e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015170878833296023
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.5165224297277806e-05, theta_kick=4.21644270716343e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.2430971097728725e-05, theta_kick=-5.087633086894033e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003295418223202376
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.006342102892054e-05, theta_kick=-7.20183017812525e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.075323671651142e-05, theta_kick=2.488391169174052e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9104702691775093e-05, theta_kick=-3.489763363130169e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006224485854995204
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.860611485178062e-05, theta_kick=-4.629018431465124e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01472845e-01 -6.31902585e+00 -3.81100468e-03 -2.75904372e-02]
 [ 1.80006924e-01  4.56124673e-01  2.42782957e-04 -8.94648474e-03]
 [-6.08090540e-03 -2.75877721e-02  3.84002282e-01 -5.12034099e+00]
 [-1.76998306e-03 -1.47385079e-02  2.12549318e-01 -2.30117852e-01]]
compute_tune_4x4()/ evals =  [0.08548426+0.99633952j 0.08548426-0.99633952j 0.06878386+0.99763159j
 0.06878386-0.99763159j]
compute_tune_4x4()/ angles =  [0.23637813183765857, 0.23904405715470134, 0.7609559428452987, 0.7636218681623415]
compute_tune_4x4()/  0.23637813183765857 0.23904405715470134
compute_tunes()/ 0.23637813183765857 0.23904405715470134

 Running simulation ..
Closed orbit computation: x_co=[ 7.94813226e-09 -1.08069838e-07], y_co=[3.03111650e-05 5.17301158e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.5165224297277806e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.2430971097728725e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.006342102892054e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.075323671651142e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.9104702691775093e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.860611485178062e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.015170878833296023}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.003295418223202376}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006224485854995204}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.80588568e-03  7.30941110e-04 -3.79058091e-04 -1.42462477e-04]
 [-6.17719158e-04  3.01517320e-04  1.00939188e-03  2.52915283e-04]
 [ 3.25190687e-03 -3.98734569e-04  9.61317494e-04 -1.58441584e-04]
 [-7.49700789e-04 -2.77244157e-05  2.78313481e-04  1.14273611e-03]
 [ 1.87456679e-03 -6.11709727e-04  2.46867558e-03  4.76842663e-04]
 [-2.16953296e-04 -2.24532790e-04  8.92886188e-04  1.98986679e-04]
 [ 8.24007038e-03 -7.62301366e-04  3.33095699e-04  8.94516558e-05]
 [-6.82133701e-04 -5.83107077e-04  2.28977202e-03 -1.94799849e-04]
 [ 2.26074360e-03  4.51088837e-04  2.49858694e-03  6.66391195e-04]
 [ 3.22891358e-04  2.40575485e-04  3.06080761e-03  5.96117432e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015170878833296023
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.2538772972124e-08, theta_kick=-6.2995965636077594e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.4679123728092196e-08, theta_kick=-4.158157419898838e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003295418223202376
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.770882446961751e-08, theta_kick=3.322392312112581e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.4310822923907637e-08, theta_kick=-1.7159215149862887e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.377229638332294e-08, theta_kick=-4.049425409200282e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006224485854995204
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.76940684061638e-08, theta_kick=-5.718698257291948e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01472845e-01 -6.31902585e+00 -3.81100468e-03 -2.75904372e-02]
 [ 1.80006924e-01  4.56124673e-01  2.42782957e-04 -8.94648474e-03]
 [-6.08090540e-03 -2.75877721e-02  3.84002282e-01 -5.12034099e+00]
 [-1.76998306e-03 -1.47385079e-02  2.12549318e-01 -2.30117852e-01]]
compute_tune_4x4()/ evals =  [0.08548426+0.99633952j 0.08548426-0.99633952j 0.06878386+0.99763159j
 0.06878386-0.99763159j]
compute_tune_4x4()/ angles =  [0.23637813183765857, 0.23904405715470134, 0.7609559428452987, 0.7636218681623415]
compute_tune_4x4()/  0.23637813183765857 0.23904405715470134
compute_tunes()/ 0.23637813183765857 0.23904405715470134

 Running simulation ..
Closed orbit computation: x_co=[ 1.50337722e-10 -4.87991297e-11], y_co=[4.95754855e-09 3.52708025e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 44/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.61724780e-03 -5.02578537e-04  9.83022447e-04  1.24804930e-04]
 [ 2.78590663e-03  2.75530534e-04 -5.38922148e-04 -2.67108194e-04]
 [-2.05143405e-03  3.43037463e-04 -3.55364948e-04  3.08770925e-04]
 [ 2.70058522e-03  6.26338010e-05 -5.31055702e-04  2.06357837e-04]
 [-9.79992718e-04 -5.71676096e-04 -5.57882939e-03 -6.96450637e-04]
 [-8.85193820e-04  6.05940936e-04 -2.83569545e-03 -2.34253744e-04]
 [-1.04648579e-04 -1.56056241e-04  1.71528519e-04  5.69462215e-04]
 [ 1.89563361e-03  1.04753395e-04  2.38338630e-03 -2.11671854e-04]
 [-1.24478329e-03 -4.18904745e-04  1.15268798e-03 -5.95264162e-04]
 [-7.54921038e-04 -1.83653859e-04  2.88704215e-03  1.81534860e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.017477777489169292
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.439613971168933e-05, theta_kick=-1.7261513188572845e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.94556649855777e-05, theta_kick=8.327995568118583e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0010471306715166388
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.425836766191393e-05, theta_kick=-7.704820063476101e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.349060240250226e-05, theta_kick=-7.6127621200518545e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.549113443855981e-05, theta_kick=-3.056482933029618e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013598786381485631
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2516608880961662e-05, theta_kick=-1.5007885002636895e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01259028e-01 -6.31792632e+00  1.48317505e-02  1.32351284e-01]
 [ 1.80045459e-01  4.56313659e-01  1.51725632e-03  1.04827271e-02]
 [ 2.63752179e-02  1.32353731e-01  3.83887540e-01 -5.12117015e+00]
 [ 6.45523180e-03  3.06742637e-02  2.12531308e-01 -2.30181101e-01]]
compute_tune_4x4()/ evals =  [0.09767014+0.99521884j 0.09767014-0.99521884j 0.0567104 +0.99839067j
 0.0567104 -0.99839067j]
compute_tune_4x4()/ angles =  [0.2344304932680833, 0.24096941513705258, 0.7590305848629474, 0.7655695067319167]
compute_tune_4x4()/  0.2344304932680833 0.24096941513705258
compute_tunes()/ 0.2344304932680833 0.24096941513705258

 Running simulation ..
Closed orbit computation: x_co=[-9.70904953e-08  1.65896955e-07], y_co=[4.50496417e-05 9.61625832e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.439613971168933e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.94556649855777e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.425836766191393e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.349060240250226e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.549113443855981e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.2516608880961662e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.017477777489169292}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0010471306715166388}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.013598786381485631}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.61724780e-03 -5.02578537e-04  9.83022447e-04  1.24804930e-04]
 [ 2.78590663e-03  2.75530534e-04 -5.38922148e-04 -2.67108194e-04]
 [-2.05143405e-03  3.43037463e-04 -3.55364948e-04  3.08770925e-04]
 [ 2.70058522e-03  6.26338010e-05 -5.31055702e-04  2.06357837e-04]
 [-9.79992718e-04 -5.71676096e-04 -5.57882939e-03 -6.96450637e-04]
 [-8.85193820e-04  6.05940936e-04 -2.83569545e-03 -2.34253744e-04]
 [-1.04648579e-04 -1.56056241e-04  1.71528519e-04  5.69462215e-04]
 [ 1.89563361e-03  1.04753395e-04  2.38338630e-03 -2.11671854e-04]
 [-1.24478329e-03 -4.18904745e-04  1.15268798e-03 -5.95264162e-04]
 [-7.54921038e-04 -1.83653859e-04  2.88704215e-03  1.81534860e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.017477777489169292
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.8790167896668385e-08, theta_kick=-2.2530118313625244e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.006525901019238e-09, theta_kick=-6.003012932640819e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0010471306715166388
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.563456805351646e-09, theta_kick=5.471756415860481e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.900434238426122e-09, theta_kick=-7.074842663703737e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.103050028586217e-08, theta_kick=2.521636114380944e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013598786381485631
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2775667581359413e-08, theta_kick=1.5318506131848318e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01259028e-01 -6.31792632e+00  1.48317505e-02  1.32351284e-01]
 [ 1.80045459e-01  4.56313659e-01  1.51725632e-03  1.04827271e-02]
 [ 2.63752179e-02  1.32353731e-01  3.83887540e-01 -5.12117015e+00]
 [ 6.45523180e-03  3.06742637e-02  2.12531308e-01 -2.30181101e-01]]
compute_tune_4x4()/ evals =  [0.09767014+0.99521884j 0.09767014-0.99521884j 0.0567104 +0.99839067j
 0.0567104 -0.99839067j]
compute_tune_4x4()/ angles =  [0.2344304932680833, 0.24096941513705258, 0.7590305848629474, 0.7655695067319167]
compute_tune_4x4()/  0.2344304932680833 0.24096941513705258
compute_tunes()/ 0.2344304932680833 0.24096941513705258

 Running simulation ..
Closed orbit computation: x_co=[ 5.08514390e-12 -8.98087346e-11], y_co=[-4.62407739e-10 -4.64474951e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 45/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-6.94973348e-04 -3.64522522e-04 -2.38911540e-03 -2.80441997e-04]
 [ 1.15847169e-03 -1.01585308e-04 -3.08297219e-03 -3.88900591e-04]
 [-2.70113291e-03  8.89718814e-05  8.75417915e-05 -6.34816412e-05]
 [-3.00624125e-03  4.88505663e-04  1.10101582e-04  3.10404164e-04]
 [-2.97897348e-03  3.24665564e-04 -7.87337105e-04  6.23137958e-04]
 [-3.74500430e-03  4.80270805e-04 -1.54906382e-03 -8.47392074e-05]
 [-2.01240472e-03  6.12732990e-04  4.55842915e-05 -2.40247407e-04]
 [-1.19395697e-03  5.33440309e-06 -3.66431422e-03  1.56041405e-04]
 [-5.64561079e-04  6.58082872e-04 -1.46723300e-03 -3.59573898e-04]
 [ 1.68500954e-03 -1.27907005e-04  2.23474181e-03 -7.34267091e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009994403317205896
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.866627304916808e-05, theta_kick=5.835269252039824e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.29981680760207e-05, theta_kick=-2.757566886037548e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013868168267841688
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.6445741032353446e-05, theta_kick=1.9719062291075158e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.967435993412382e-06, theta_kick=3.55806740990032e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.855603887997145e-06, theta_kick=1.0618202265800463e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016094602019897108
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.462375017269289e-05, theta_kick=-1.1345743680383423e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01550564e-01 -6.31805002e+00  1.30229353e-02 -1.51486118e-02]
 [ 1.80049326e-01  4.56726439e-01 -2.49631957e-03  1.56098582e-02]
 [ 8.91056990e-03 -1.51251441e-02  3.83498976e-01 -5.11926824e+00]
 [ 7.86758155e-04  1.72346515e-02  2.12525699e-01 -2.29835112e-01]]
compute_tune_4x4()/ evals =  [0.09083366+0.99586608j 0.09083366-0.99586608j 0.06358621+0.99797635j
 0.06358621-0.99797635j]
compute_tune_4x4()/ angles =  [0.23552342026334722, 0.23987310829989628, 0.7601268917001037, 0.7644765797366528]
compute_tune_4x4()/  0.23552342026334722 0.23987310829989628
compute_tunes()/ 0.23552342026334722 0.23987310829989628

 Running simulation ..
Closed orbit computation: x_co=[-5.52523071e-07  9.31529748e-08], y_co=[-3.05850805e-05  8.90375064e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.866627304916808e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.29981680760207e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.6445741032353446e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.967435993412382e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.855603887997145e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.462375017269289e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009994403317205896}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.013868168267841688}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.016094602019897108}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-6.94973348e-04 -3.64522522e-04 -2.38911540e-03 -2.80441997e-04]
 [ 1.15847169e-03 -1.01585308e-04 -3.08297219e-03 -3.88900591e-04]
 [-2.70113291e-03  8.89718814e-05  8.75417915e-05 -6.34816412e-05]
 [-3.00624125e-03  4.88505663e-04  1.10101582e-04  3.10404164e-04]
 [-2.97897348e-03  3.24665564e-04 -7.87337105e-04  6.23137958e-04]
 [-3.74500430e-03  4.80270805e-04 -1.54906382e-03 -8.47392074e-05]
 [-2.01240472e-03  6.12732990e-04  4.55842915e-05 -2.40247407e-04]
 [-1.19395697e-03  5.33440309e-06 -3.66431422e-03  1.56041405e-04]
 [-5.64561079e-04  6.58082872e-04 -1.46723300e-03 -3.59573898e-04]
 [ 1.68500954e-03 -1.27907005e-04  2.23474181e-03 -7.34267091e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009994403317205896
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.462447984537627e-08, theta_kick=-2.95256778640161e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.632211694529183e-09, theta_kick=-1.0350346620398497e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013868168267841688
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.1284245102822444e-08, theta_kick=-4.9501363253928815e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.597798512655326e-09, theta_kick=1.0309083920489158e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.594263219782996e-09, theta_kick=5.508694465896742e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016094602019897108
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.7504518248532088e-08, theta_kick=2.0988576011200302e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01550564e-01 -6.31805002e+00  1.30229353e-02 -1.51486118e-02]
 [ 1.80049326e-01  4.56726439e-01 -2.49631957e-03  1.56098582e-02]
 [ 8.91056990e-03 -1.51251441e-02  3.83498976e-01 -5.11926824e+00]
 [ 7.86758155e-04  1.72346515e-02  2.12525699e-01 -2.29835112e-01]]
compute_tune_4x4()/ evals =  [0.09083366+0.99586608j 0.09083366-0.99586608j 0.06358621+0.99797635j
 0.06358621-0.99797635j]
compute_tune_4x4()/ angles =  [0.23552342026334722, 0.23987310829989628, 0.7601268917001037, 0.7644765797366528]
compute_tune_4x4()/  0.23552342026334722 0.23987310829989628
compute_tunes()/ 0.23552342026334722 0.23987310829989628

 Running simulation ..
Closed orbit computation: x_co=[ 2.49461641e-10 -1.01867906e-10], y_co=[ 2.23304236e-08 -5.01161120e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 46/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.79449744e-03 -2.90006650e-04  2.70288827e-03  6.64940954e-04]
 [-1.64432492e-03 -1.06516014e-03 -9.08805260e-04  3.94980269e-04]
 [ 1.30753650e-03 -3.20286898e-04 -6.68048652e-04 -9.20901951e-05]
 [-9.97988415e-04 -2.80878564e-04  3.26634353e-04  5.10169067e-04]
 [-3.24547693e-04  5.02866821e-04  1.31136807e-03 -2.71453841e-04]
 [-2.45638680e-03  9.11806871e-04  1.66908100e-04 -1.40107738e-04]
 [ 2.86223379e-03 -6.14230582e-05  2.43663176e-03  6.88934199e-04]
 [ 5.52382764e-04 -1.58435588e-05 -3.11150377e-03 -2.75771390e-05]
 [-2.41425746e-04  2.79745891e-04 -3.18156385e-03 -1.18892701e-04]
 [ 2.19421934e-03 -1.74545722e-04  3.35127790e-03 -1.83727123e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0031962388883597544
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.398226696417271e-05, theta_kick=1.676526419177767e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.6616439111108638e-05, theta_kick=1.9923735710249067e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016432851045827254
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.734649848103564e-05, theta_kick=-1.1672211447263046e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8727854455170334e-05, theta_kick=2.2455402152641436e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4118112879018058e-05, theta_kick=2.891852481860958e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015919166025330708
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-0.00010700388854032201, theta_kick=1.2830168852609748e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01397240e-01 -6.32191868e+00 -2.86175690e-03 -1.27497141e-01]
 [ 1.80026010e-01  4.56412868e-01 -4.01115032e-03  1.28604687e-02]
 [-1.61477589e-02 -1.27608798e-01  3.84071658e-01 -5.12127385e+00]
 [-4.45183640e-03 -1.23111565e-03  2.12658891e-01 -2.30520016e-01]]
compute_tune_4x4()/ evals =  [0.0790087 +0.99687393j 0.0790087 -0.99687393j 0.07527493+0.99716282j
 0.07527493-0.99716282j]
compute_tune_4x4()/ angles =  [0.23741225464300045, 0.23800827964440982, 0.7619917203555902, 0.7625877453569996]
compute_tune_4x4()/  0.23741225464300045 0.23800827964440982
compute_tunes()/ 0.23741225464300045 0.23800827964440982

 Running simulation ..
Closed orbit computation: x_co=[ 1.67666817e-06 -6.63881220e-08], y_co=[ 5.14994317e-05 -8.55442243e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.398226696417271e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.6616439111108638e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 9.734649848103564e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8727854455170334e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.4118112879018058e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -0.00010700388854032201, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0031962388883597544}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.016432851045827254}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.015919166025330708}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.79449744e-03 -2.90006650e-04  2.70288827e-03  6.64940954e-04]
 [-1.64432492e-03 -1.06516014e-03 -9.08805260e-04  3.94980269e-04]
 [ 1.30753650e-03 -3.20286898e-04 -6.68048652e-04 -9.20901951e-05]
 [-9.97988415e-04 -2.80878564e-04  3.26634353e-04  5.10169067e-04]
 [-3.24547693e-04  5.02866821e-04  1.31136807e-03 -2.71453841e-04]
 [-2.45638680e-03  9.11806871e-04  1.66908100e-04 -1.40107738e-04]
 [ 2.86223379e-03 -6.14230582e-05  2.43663176e-03  6.88934199e-04]
 [ 5.52382764e-04 -1.58435588e-05 -3.11150377e-03 -2.75771390e-05]
 [-2.41425746e-04  2.79745891e-04 -3.18156385e-03 -1.18892701e-04]
 [ 2.19421934e-03 -1.74545722e-04  3.35127790e-03 -1.83727123e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0031962388883597544
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.16534359171217e-09, theta_kick=-9.790554198576122e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.953631337105532e-08, theta_kick=-8.337665612987823e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016432851045827254
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.9886098764432605e-08, theta_kick=2.384418065995797e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.256882167316951e-08, theta_kick=-8.70127476863458e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.134864679047933e-08, theta_kick=7.35593358277217e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015919166025330708
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.778140300936968e-09, theta_kick=1.0525320510242919e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01397240e-01 -6.32191868e+00 -2.86175690e-03 -1.27497141e-01]
 [ 1.80026010e-01  4.56412868e-01 -4.01115032e-03  1.28604687e-02]
 [-1.61477589e-02 -1.27608798e-01  3.84071658e-01 -5.12127385e+00]
 [-4.45183640e-03 -1.23111565e-03  2.12658891e-01 -2.30520016e-01]]
compute_tune_4x4()/ evals =  [0.0790087 +0.99687393j 0.0790087 -0.99687393j 0.07527493+0.99716282j
 0.07527493-0.99716282j]
compute_tune_4x4()/ angles =  [0.23741225464300045, 0.23800827964440982, 0.7619917203555902, 0.7625877453569996]
compute_tune_4x4()/  0.23741225464300045 0.23800827964440982
compute_tunes()/ 0.23741225464300045 0.23800827964440982

 Running simulation ..
Closed orbit computation: x_co=[4.63744099e-10 1.06016860e-10], y_co=[ 3.04226560e-08 -7.08270052e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 47/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.15030604e-04  2.35666494e-04  8.29080657e-04  5.44014822e-04]
 [ 4.39241595e-03 -1.54047771e-04 -3.02306800e-03  2.03794762e-04]
 [-1.47897499e-03 -2.39814163e-04 -3.16815976e-03 -4.18573870e-04]
 [ 3.44763936e-03 -6.86999533e-04  2.00403880e-03  2.39071807e-05]
 [ 4.55556222e-04  4.71635886e-05 -3.25436609e-03  4.44768256e-05]
 [ 1.73784977e-03 -2.18537369e-04  1.39319086e-03  1.12166729e-04]
 [ 1.51302921e-03  3.06023024e-04 -5.27779237e-03  8.75982863e-06]
 [-2.54067309e-03  3.59979455e-04 -2.97755043e-03  5.89333597e-04]
 [ 2.15902745e-03 -4.76105142e-04 -5.14674083e-04  1.07889421e-03]
 [-2.50197247e-03 -6.21474053e-04 -1.48937073e-03 -3.89446064e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01628368725001838
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.935228955007167e-06, theta_kick=-4.7184875853735974e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.1553370113514792e-05, theta_kick=2.5843301740850467e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00018122885995662533
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.883770927650316e-05, theta_kick=3.457749848040173e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.85035187492286e-05, theta_kick=-4.616716772737404e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.8678072922868485e-05, theta_kick=-5.836684101295126e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006594892350709939
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.909661003676115e-05, theta_kick=4.687830649698864e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01443646e-01 -6.31865947e+00 -1.04507540e-02 -9.57158326e-02]
 [ 1.80027169e-01  4.56230662e-01 -1.01010300e-03 -9.00824535e-03]
 [-1.88517271e-02 -9.57176348e-02  3.83971185e-01 -5.12040082e+00]
 [-4.74248190e-03 -2.39447163e-02  2.12547379e-01 -2.30030889e-01]]
compute_tune_4x4()/ evals =  [0.09266108+0.99569771j 0.09266108-0.99569771j 0.06170257+0.99809458j
 0.06170257-0.99809458j]
compute_tune_4x4()/ angles =  [0.23523134482914895, 0.24017348855282641, 0.7598265114471736, 0.764768655170851]
compute_tune_4x4()/  0.23523134482914895 0.24017348855282641
compute_tunes()/ 0.23523134482914895 0.24017348855282641

 Running simulation ..
Closed orbit computation: x_co=[ 3.10489326e-08 -1.02731087e-07], y_co=[2.31693893e-05 5.02026974e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.935228955007167e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.1553370113514792e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.883770927650316e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.85035187492286e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.8678072922868485e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.909661003676115e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01628368725001838}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00018122885995662533}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006594892350709939}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.15030604e-04  2.35666494e-04  8.29080657e-04  5.44014822e-04]
 [ 4.39241595e-03 -1.54047771e-04 -3.02306800e-03  2.03794762e-04]
 [-1.47897499e-03 -2.39814163e-04 -3.16815976e-03 -4.18573870e-04]
 [ 3.44763936e-03 -6.86999533e-04  2.00403880e-03  2.39071807e-05]
 [ 4.55556222e-04  4.71635886e-05 -3.25436609e-03  4.44768256e-05]
 [ 1.73784977e-03 -2.18537369e-04  1.39319086e-03  1.12166729e-04]
 [ 1.51302921e-03  3.06023024e-04 -5.27779237e-03  8.75982863e-06]
 [-2.54067309e-03  3.59979455e-04 -2.97755043e-03  5.89333597e-04]
 [ 2.15902745e-03 -4.76105142e-04 -5.14674083e-04  1.07889421e-03]
 [-2.50197247e-03 -6.21474053e-04 -1.48937073e-03 -3.89446064e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01628368725001838
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.7224597429865325e-08, theta_kick=-5.66240692078562e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.411247013831534e-08, theta_kick=4.090213522373703e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00018122885995662533
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.1446885062173774e-08, theta_kick=-4.969637468473984e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.882580579732213e-08, theta_kick=4.655360202452492e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6086411434988355e-08, theta_kick=-1.928821258357157e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006594892350709939
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.570151035545824e-08, theta_kick=5.4797830497427795e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01443646e-01 -6.31865947e+00 -1.04507540e-02 -9.57158326e-02]
 [ 1.80027169e-01  4.56230662e-01 -1.01010300e-03 -9.00824535e-03]
 [-1.88517271e-02 -9.57176348e-02  3.83971185e-01 -5.12040082e+00]
 [-4.74248190e-03 -2.39447163e-02  2.12547379e-01 -2.30030889e-01]]
compute_tune_4x4()/ evals =  [0.09266108+0.99569771j 0.09266108-0.99569771j 0.06170257+0.99809458j
 0.06170257-0.99809458j]
compute_tune_4x4()/ angles =  [0.23523134482914895, 0.24017348855282641, 0.7598265114471736, 0.764768655170851]
compute_tune_4x4()/  0.23523134482914895 0.24017348855282641
compute_tunes()/ 0.23523134482914895 0.24017348855282641

 Running simulation ..
Closed orbit computation: x_co=[-1.79825465e-11  8.37154350e-11], y_co=[ 8.89114477e-09 -6.43578058e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 48/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.13912490e-04  1.33901429e-04  1.29884717e-03 -1.67829116e-04]
 [ 8.39502962e-04  1.17265737e-04 -1.16728486e-03  2.43125235e-04]
 [ 1.97932564e-03 -3.68008845e-04 -3.09035938e-03 -2.19597840e-04]
 [ 1.83797738e-03 -4.05669673e-04  1.90517771e-04  2.88860441e-05]
 [ 3.01677365e-04 -9.75605472e-04  1.78507579e-04 -6.66000935e-05]
 [ 1.82814049e-04 -2.41749724e-04 -1.97318825e-03 -8.18147830e-04]
 [ 4.06363583e-03  1.08781289e-04 -1.98196533e-03 -4.61441399e-04]
 [-1.55031279e-03  6.44928352e-05 -1.88755164e-03  4.05744671e-04]
 [-1.03440357e-03  5.90954446e-04  1.55196840e-04 -1.33576945e-04]
 [ 2.15803260e-03  3.72766429e-04 -2.96610342e-03  2.85966897e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005848559862761209
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.883218318185004e-05, theta_kick=2.258049622144007e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.857628050746517e-05, theta_kick=1.0620629313098828e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0020668171253916956
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.089612017629252e-05, theta_kick=2.505523433620178e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.794067626210859e-07, theta_kick=-9.345380346178924e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.360086152062845e-05, theta_kick=-6.426944976825475e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.016182373465916437
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.418111438502398e-06, theta_kick=6.496519478546501e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01414263e-01 -6.31902437e+00 -1.13137735e-02 -9.76994968e-02]
 [ 1.80024018e-01  4.56185881e-01 -1.31882086e-03 -4.73941278e-03]
 [-1.97649674e-02 -9.77056019e-02  3.83956677e-01 -5.12057931e+00]
 [-4.60160856e-03 -1.89413640e-02  2.12551867e-01 -2.30008930e-01]]
compute_tune_4x4()/ evals =  [0.09079539+0.99586957j 0.09079539-0.99586957j 0.06356429+0.99797775j
 0.06356429-0.99797775j]
compute_tune_4x4()/ angles =  [0.23552953573233235, 0.23987660422102844, 0.7601233957789716, 0.7644704642676676]
compute_tune_4x4()/  0.23552953573233235 0.23987660422102844
compute_tunes()/ 0.23552953573233235 0.23987660422102844

 Running simulation ..
Closed orbit computation: x_co=[-1.16811287e-07 -2.20449004e-07], y_co=[-1.99863651e-05  1.17155344e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.883218318185004e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.857628050746517e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.089612017629252e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.794067626210859e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.360086152062845e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.418111438502398e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.005848559862761209}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0020668171253916956}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.016182373465916437}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.13912490e-04  1.33901429e-04  1.29884717e-03 -1.67829116e-04]
 [ 8.39502962e-04  1.17265737e-04 -1.16728486e-03  2.43125235e-04]
 [ 1.97932564e-03 -3.68008845e-04 -3.09035938e-03 -2.19597840e-04]
 [ 1.83797738e-03 -4.05669673e-04  1.90517771e-04  2.88860441e-05]
 [ 3.01677365e-04 -9.75605472e-04  1.78507579e-04 -6.66000935e-05]
 [ 1.82814049e-04 -2.41749724e-04 -1.97318825e-03 -8.18147830e-04]
 [ 4.06363583e-03  1.08781289e-04 -1.98196533e-03 -4.61441399e-04]
 [-1.55031279e-03  6.44928352e-05 -1.88755164e-03  4.05744671e-04]
 [-1.03440357e-03  5.90954446e-04  1.55196840e-04 -1.33576945e-04]
 [ 2.15803260e-03  3.72766429e-04 -2.96610342e-03  2.85966897e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005848559862761209
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0611039683521996e-07, theta_kick=-1.272303583528444e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.702417851702549e-09, theta_kick=5.638375939032816e-10
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0020668171253916956
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.078458306795783e-08, theta_kick=-2.49214971465737e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.085410117694426e-08, theta_kick=2.500485197496145e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.955784427940974e-09, theta_kick=-1.193736012897621e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.016182373465916437
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.6114857117339203e-08, theta_kick=-1.9322320027017566e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01414263e-01 -6.31902437e+00 -1.13137735e-02 -9.76994968e-02]
 [ 1.80024018e-01  4.56185881e-01 -1.31882086e-03 -4.73941278e-03]
 [-1.97649674e-02 -9.77056019e-02  3.83956677e-01 -5.12057931e+00]
 [-4.60160856e-03 -1.89413640e-02  2.12551867e-01 -2.30008930e-01]]
compute_tune_4x4()/ evals =  [0.09079539+0.99586957j 0.09079539-0.99586957j 0.06356429+0.99797775j
 0.06356429-0.99797775j]
compute_tune_4x4()/ angles =  [0.23552953573233235, 0.23987660422102844, 0.7601233957789716, 0.7644704642676676]
compute_tune_4x4()/  0.23552953573233235 0.23987660422102844
compute_tunes()/ 0.23552953573233235 0.23987660422102844

 Running simulation ..
Closed orbit computation: x_co=[-1.31807435e-11  1.64418815e-10], y_co=[ 1.50116239e-09 -8.99988706e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 49/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.77037668e-04  8.24069436e-05 -1.47999007e-03 -6.81361620e-04]
 [-1.94774938e-03 -1.06258728e-04 -6.45724866e-04  2.30924788e-04]
 [-1.00538556e-03  4.57675757e-04 -5.80766114e-03 -1.18384693e-03]
 [ 7.35980693e-04 -2.77135533e-04 -1.55988734e-03 -6.21782432e-04]
 [ 4.99617173e-04 -1.48471688e-04  9.07116120e-04 -8.53454649e-04]
 [ 3.13660337e-03 -4.12134161e-04 -2.84766664e-03 -9.80261924e-04]
 [-4.37194765e-03  1.99986924e-04 -1.69856782e-03 -4.15907853e-04]
 [-8.49674704e-04  2.06642118e-04  4.82870954e-04  2.64794904e-04]
 [ 1.30186492e-03  1.99160682e-04  1.78399087e-03  1.63386209e-04]
 [-5.56775400e-03 -5.35722421e-04  1.43465818e-03 -1.13934076e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006822617673346389
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.350428611475908e-06, theta_kick=-1.1211515727702001e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.203346286883554e-06, theta_kick=8.637083233634916e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005014277512351713
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.3650250922144708e-05, theta_kick=2.8357540728378548e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.101438580116457e-06, theta_kick=-7.315854432451081e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.4515410800446295e-05, theta_kick=-6.5366028765911825e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0008783034242021945
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.4948990593203576e-05, theta_kick=1.7924402197271724e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01646913e-01 -6.31982778e+00  4.68853983e-03  1.00799602e-02]
 [ 1.79993673e-01  4.56084385e-01 -7.23707411e-04  8.56129606e-03]
 [ 4.89156415e-03  1.00799216e-02  3.84076490e-01 -5.11924626e+00]
 [ 1.07849547e-03  1.19197188e-02  2.12575798e-01 -2.29837797e-01]]
compute_tune_4x4()/ evals =  [0.08464297+0.99641134j 0.08464297-0.99641134j 0.06969511+0.99756834j
 0.06969511-0.99756834j]
compute_tune_4x4()/ angles =  [0.23651251486963523, 0.23889867890477973, 0.7611013210952202, 0.7634874851303648]
compute_tune_4x4()/  0.23651251486963523 0.23889867890477973
compute_tunes()/ 0.23651251486963523 0.23889867890477973

 Running simulation ..
Closed orbit computation: x_co=[-8.24221967e-08  3.06805813e-08], y_co=[1.05206262e-05 4.04154455e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.350428611475908e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.203346286883554e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.3650250922144708e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.101438580116457e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.4515410800446295e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.4948990593203576e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006822617673346389}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005014277512351713}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0008783034242021945}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.77037668e-04  8.24069436e-05 -1.47999007e-03 -6.81361620e-04]
 [-1.94774938e-03 -1.06258728e-04 -6.45724866e-04  2.30924788e-04]
 [-1.00538556e-03  4.57675757e-04 -5.80766114e-03 -1.18384693e-03]
 [ 7.35980693e-04 -2.77135533e-04 -1.55988734e-03 -6.21782432e-04]
 [ 4.99617173e-04 -1.48471688e-04  9.07116120e-04 -8.53454649e-04]
 [ 3.13660337e-03 -4.12134161e-04 -2.84766664e-03 -9.80261924e-04]
 [-4.37194765e-03  1.99986924e-04 -1.69856782e-03 -4.15907853e-04]
 [-8.49674704e-04  2.06642118e-04  4.82870954e-04  2.64794904e-04]
 [ 1.30186492e-03  1.99160682e-04  1.78399087e-03  1.63386209e-04]
 [-5.56775400e-03 -5.35722421e-04  1.43465818e-03 -1.13934076e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006822617673346389
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3662444864931709e-08, theta_kick=1.6381785461048003e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3586834390205597e-08, theta_kick=-2.828150192045064e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005014277512351713
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.7443096277683324e-09, theta_kick=2.0914928757067778e-10
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.310812518964627e-09, theta_kick=9.964976915817253e-10
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.1405805386132788e-08, theta_kick=2.5666366080396685e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0008783034242021945
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.6014886703109317e-08, theta_kick=-6.716395679301678e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01646913e-01 -6.31982778e+00  4.68853983e-03  1.00799602e-02]
 [ 1.79993673e-01  4.56084385e-01 -7.23707411e-04  8.56129606e-03]
 [ 4.89156415e-03  1.00799216e-02  3.84076490e-01 -5.11924626e+00]
 [ 1.07849547e-03  1.19197188e-02  2.12575798e-01 -2.29837797e-01]]
compute_tune_4x4()/ evals =  [0.08464297+0.99641134j 0.08464297-0.99641134j 0.06969511+0.99756834j
 0.06969511-0.99756834j]
compute_tune_4x4()/ angles =  [0.23651251486963523, 0.23889867890477973, 0.7611013210952202, 0.7634874851303648]
compute_tune_4x4()/  0.23651251486963523 0.23889867890477973
compute_tunes()/ 0.23651251486963523 0.23889867890477973

 Running simulation ..
Closed orbit computation: x_co=[-1.09861040e-10  9.74548535e-12], y_co=[-1.87908819e-08  1.32298510e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 50/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.96082345e-03 -2.39651013e-05 -1.51098586e-03 -2.93477198e-04]
 [-1.91859344e-03  8.81535030e-05 -1.77726807e-03 -1.47467129e-04]
 [-6.77981147e-05  1.56696953e-04  2.20246391e-03 -1.62348999e-04]
 [ 1.04040547e-03  2.92930328e-04 -9.63117264e-05 -2.46917122e-04]
 [ 1.32210717e-03  4.33512286e-04 -1.84249895e-03 -1.14385606e-04]
 [ 8.86498927e-04 -4.42098621e-04  5.41068997e-04 -7.66099395e-04]
 [ 1.06793641e-04  9.35856234e-04 -8.68573032e-04  1.83311944e-05]
 [ 3.47708266e-03 -4.51602398e-04 -3.57686739e-03  1.61481747e-05]
 [ 4.38528734e-05  3.43159656e-04  3.05047450e-03  2.15155053e-04]
 [-3.95950317e-04 -2.58034647e-04  1.49520876e-03  1.50352939e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004540442278875104
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.151117702956352e-07, theta_kick=-8.574459196334983e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.930701313208122e-05, theta_kick=8.310171651561619e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0021682040902841117
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.969992004850269e-05, theta_kick=-9.556320295560626e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.095108679219566e-05, theta_kick=4.9101893903954575e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.976147749153962e-05, theta_kick=-4.767550759180663e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.003230720470152951
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.1877208572737814e-05, theta_kick=2.623159623831956e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01675197e-01 -6.31981537e+00 -4.89758330e-03 -2.59991925e-02]
 [ 1.79999474e-01  4.56094731e-01  9.67674632e-05 -5.41336094e-03]
 [-6.78829150e-03 -2.59992823e-02  3.84073273e-01 -5.11922183e+00]
 [-1.53783921e-03 -1.01661777e-02  2.12573813e-01 -2.29751819e-01]]
compute_tune_4x4()/ evals =  [0.08396398+0.99646879j 0.08396398-0.99646879j 0.07040651+0.99751838j
 0.07040651-0.99751838j]
compute_tune_4x4()/ angles =  [0.23662096535221713, 0.23878517723035825, 0.7612148227696418, 0.7633790346477829]
compute_tune_4x4()/  0.23662096535221713 0.23878517723035825
compute_tunes()/ 0.23662096535221713 0.23878517723035825

 Running simulation ..
Closed orbit computation: x_co=[-4.28150926e-08 -1.82485327e-08], y_co=[1.49177859e-05 3.84390068e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.151117702956352e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.930701313208122e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.969992004850269e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.095108679219566e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.976147749153962e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.1877208572737814e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004540442278875104}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0021682040902841117}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.003230720470152951}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.96082345e-03 -2.39651013e-05 -1.51098586e-03 -2.93477198e-04]
 [-1.91859344e-03  8.81535030e-05 -1.77726807e-03 -1.47467129e-04]
 [-6.77981147e-05  1.56696953e-04  2.20246391e-03 -1.62348999e-04]
 [ 1.04040547e-03  2.92930328e-04 -9.63117264e-05 -2.46917122e-04]
 [ 1.32210717e-03  4.33512286e-04 -1.84249895e-03 -1.14385606e-04]
 [ 8.86498927e-04 -4.42098621e-04  5.41068997e-04 -7.66099395e-04]
 [ 1.06793641e-04  9.35856234e-04 -8.68573032e-04  1.83311944e-05]
 [ 3.47708266e-03 -4.51602398e-04 -3.57686739e-03  1.61481747e-05]
 [ 4.38528734e-05  3.43159656e-04  3.05047450e-03  2.15155053e-04]
 [-3.95950317e-04 -2.58034647e-04  1.49520876e-03  1.50352939e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004540442278875104
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.3825048993302625e-08, theta_kick=2.8567130192711095e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.4492745592409435e-08, theta_kick=-4.135809980157492e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0021682040902841117
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.4243543135521574e-08, theta_kick=4.1059296679186375e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.2511723652039674e-08, theta_kick=-2.699240369289185e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.169432309391138e-08, theta_kick=2.6012309667892795e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.003230720470152951
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0134309371992266e-08, theta_kick=-1.2151418254136556e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01675197e-01 -6.31981537e+00 -4.89758330e-03 -2.59991925e-02]
 [ 1.79999474e-01  4.56094731e-01  9.67674632e-05 -5.41336094e-03]
 [-6.78829150e-03 -2.59992823e-02  3.84073273e-01 -5.11922183e+00]
 [-1.53783921e-03 -1.01661777e-02  2.12573813e-01 -2.29751819e-01]]
compute_tune_4x4()/ evals =  [0.08396398+0.99646879j 0.08396398-0.99646879j 0.07040651+0.99751838j
 0.07040651-0.99751838j]
compute_tune_4x4()/ angles =  [0.23662096535221713, 0.23878517723035825, 0.7612148227696418, 0.7633790346477829]
compute_tune_4x4()/  0.23662096535221713 0.23878517723035825
compute_tunes()/ 0.23662096535221713 0.23878517723035825

 Running simulation ..
Closed orbit computation: x_co=[ 6.15544797e-12 -6.22892440e-13], y_co=[-5.07238883e-09  2.17925874e-10]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
Completed benchmarking for noise_level=0.0 meters.
Running evaluation for noise_level= 1e-05
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.54353185e-03 -1.08492803e-04 -1.56458427e-03  4.56186577e-04]
 [ 3.46145491e-04 -5.61244724e-04 -1.29764446e-03 -2.36980428e-04]
 [ 1.29014666e-03  3.49978628e-04 -1.95143222e-03 -5.01457808e-04]
 [-4.06441867e-04  4.85304239e-05  1.07494323e-03  3.93596838e-04]
 [-3.69112190e-03  6.96094924e-05 -2.97688062e-03 -3.49687600e-04]
 [-3.87647172e-03  5.05619416e-04  1.26783149e-04  6.62408354e-04]
 [ 2.70499175e-05  1.42191923e-04 -3.27151720e-03 -6.89870000e-04]
 [-6.07736110e-03 -1.95051063e-04 -2.22180926e-03  3.84188849e-04]
 [ 4.42085166e-03 -3.88317953e-04  2.51290684e-03  6.52043398e-04]
 [ 1.99804498e-03 -6.59409951e-04 -1.86336695e-03  1.31921548e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0022663353635275587
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.89533790213351e-05, theta_kick=1.1864882470150648e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.556042851866754e-05, theta_kick=6.66190443302663e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013669060306966381
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.046239846027231e-05, theta_kick=-9.647744326060113e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.771165952220394e-05, theta_kick=-4.521769871939541e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.945476253235216e-05, theta_kick=4.7307744815175055e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004314003331269592
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9255540624043244e-05, theta_kick=3.5078493987572724e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636675e-01 -6.32084163e+00  5.11746512e-03 -4.84535772e-02]
 [ 1.79987236e-01  4.56230450e-01 -2.75881516e-03  1.53776900e-02]
 [-1.11270056e-03 -4.84711161e-02  3.84058720e-01 -5.11903460e+00]
 [-8.47526736e-04  1.24913249e-02  2.12619161e-01 -2.30042596e-01]]
compute_tune_4x4()/ evals =  [0.08507879+0.99637423j 0.08507879-0.99637423j 0.06922616+0.99760099j
 0.06922616-0.99760099j]
compute_tune_4x4()/ angles =  [0.23644290041937355, 0.23897349617501293, 0.761026503824987, 0.7635570995806265]
compute_tune_4x4()/  0.23644290041937355 0.23897349617501293
compute_tunes()/ 0.23644290041937355 0.23897349617501293

 Running simulation ..
Closed orbit computation: x_co=[ 9.75450345e-07 -1.03571192e-07], y_co=[3.07363552e-05 9.03683793e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.89533790213351e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.556042851866754e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.046239846027231e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.771165952220394e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.945476253235216e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9255540624043244e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0022663353635275587}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.013669060306966381}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004314003331269592}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.54353185e-03 -1.08492803e-04 -1.56458427e-03  4.56186577e-04]
 [ 3.46145491e-04 -5.61244724e-04 -1.29764446e-03 -2.36980428e-04]
 [ 1.29014666e-03  3.49978628e-04 -1.95143222e-03 -5.01457808e-04]
 [-4.06441867e-04  4.85304239e-05  1.07494323e-03  3.93596838e-04]
 [-3.69112190e-03  6.96094924e-05 -2.97688062e-03 -3.49687600e-04]
 [-3.87647172e-03  5.05619416e-04  1.26783149e-04  6.62408354e-04]
 [ 2.70499175e-05  1.42191923e-04 -3.27151720e-03 -6.89870000e-04]
 [-6.07736110e-03 -1.95051063e-04 -2.22180926e-03  3.84188849e-04]
 [ 4.42085166e-03 -3.88317953e-04  2.51290684e-03  6.52043398e-04]
 [ 1.99804498e-03 -6.59409951e-04 -1.86336695e-03  1.31921548e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0022663353635275587
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9935290918842027e-07, theta_kick=2.390316390401631e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.833218211255003e-07, theta_kick=-4.596172865322338e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013669060306966381
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4230927792152355e-07, theta_kick=-1.7063417880725747e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.810463348978898e-07, theta_kick=1.1763114687398238e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.676697573860477e-07, theta_kick=-9.20464923720361e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004314003331269592
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.510971678805455e-07, theta_kick=1.811711895243884e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636675e-01 -6.32084163e+00  5.11746512e-03 -4.84535772e-02]
 [ 1.79987236e-01  4.56230450e-01 -2.75881516e-03  1.53776900e-02]
 [-1.11270056e-03 -4.84711161e-02  3.84058720e-01 -5.11903460e+00]
 [-8.47526736e-04  1.24913249e-02  2.12619161e-01 -2.30042596e-01]]
compute_tune_4x4()/ evals =  [0.08507879+0.99637423j 0.08507879-0.99637423j 0.06922616+0.99760099j
 0.06922616-0.99760099j]
compute_tune_4x4()/ angles =  [0.23644290041937355, 0.23897349617501293, 0.761026503824987, 0.7635570995806265]
compute_tune_4x4()/  0.23644290041937355 0.23897349617501293
compute_tunes()/ 0.23644290041937355 0.23897349617501293

 Running simulation ..
Closed orbit computation: x_co=[-6.57683857e-10  1.19958255e-11], y_co=[-1.17131784e-08  2.96039678e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.16212776e-03 -2.01608522e-04  1.95499672e-03 -5.40646564e-04]
 [ 7.88861185e-04  7.12880886e-05 -1.84553302e-03 -3.20358290e-04]
 [ 2.22644333e-03 -3.69102252e-04 -3.61251718e-03 -4.87369972e-04]
 [-1.49510436e-03 -8.07132583e-05  1.94188465e-03 -4.26230201e-05]
 [-5.53872801e-03  5.60974871e-04  3.90130738e-04  2.98782747e-04]
 [-6.22906225e-04  3.69690433e-04 -1.42670232e-03 -3.51240798e-04]
 [ 1.63545197e-03  8.01583752e-05  1.19494002e-03 -2.34620029e-04]
 [ 3.61089274e-03  4.26070119e-04 -4.79226027e-03 -3.51476075e-04]
 [-2.53412096e-03  9.96586205e-05  4.10026090e-04 -2.76922522e-04]
 [-2.29616995e-03  1.48763474e-04  2.79155237e-03  2.64376545e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0012391440234195761
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.984189050185787e-06, theta_kick=-2.3791173289735094e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8445236341324833e-05, theta_kick=-3.4106908663797095e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.018481453242446436
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.7222640936563394e-05, theta_kick=-2.065059450813415e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.561204973176553e-05, theta_kick=1.0265206889772618e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.9263079506091714e-06, theta_kick=7.105866218144681e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004700849186913789
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.261399809986913e-05, theta_kick=9.905729218532866e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01649380e-01 -6.32169719e+00 -5.91422205e-03  7.87040703e-02]
 [ 1.79996826e-01  4.56470516e-01  3.87002438e-03 -1.91415552e-02]
 [ 3.74842548e-03  7.87295093e-02  3.83996210e-01 -5.11890851e+00]
 [ 1.80805050e-03 -1.30807812e-02  2.12658303e-01 -2.30176794e-01]]
compute_tune_4x4()/ evals =  [0.08571432+0.99631976j 0.08571432-0.99631976j 0.06860596+0.99764384j
 0.06860596-0.99764384j]
compute_tune_4x4()/ angles =  [0.23634138304845895, 0.2390724386379508, 0.7609275613620492, 0.763658616951541]
compute_tune_4x4()/  0.23634138304845895 0.2390724386379508
compute_tunes()/ 0.23634138304845895 0.2390724386379508

 Running simulation ..
Closed orbit computation: x_co=[-8.35653146e-07  6.51613016e-08], y_co=[-4.93253464e-06 -1.31110580e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.984189050185787e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8445236341324833e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.7222640936563394e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -8.561204973176553e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.9263079506091714e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.261399809986913e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0012391440234195761}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.018481453242446436}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004700849186913789}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.16212776e-03 -2.01608522e-04  1.95499672e-03 -5.40646564e-04]
 [ 7.88861185e-04  7.12880886e-05 -1.84553302e-03 -3.20358290e-04]
 [ 2.22644333e-03 -3.69102252e-04 -3.61251718e-03 -4.87369972e-04]
 [-1.49510436e-03 -8.07132583e-05  1.94188465e-03 -4.26230201e-05]
 [-5.53872801e-03  5.60974871e-04  3.90130738e-04  2.98782747e-04]
 [-6.22906225e-04  3.69690433e-04 -1.42670232e-03 -3.51240798e-04]
 [ 1.63545197e-03  8.01583752e-05  1.19494002e-03 -2.34620029e-04]
 [ 3.61089274e-03  4.26070119e-04 -4.79226027e-03 -3.51476075e-04]
 [-2.53412096e-03  9.96586205e-05  4.10026090e-04 -2.76922522e-04]
 [-2.29616995e-03  1.48763474e-04  2.79155237e-03  2.64376545e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0012391440234195761
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.167004711885074e-08, theta_kick=6.195433065101597e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5643255320565897e-06, theta_kick=-1.8756851728029948e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.018481453242446436
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.170929318924763e-06, theta_kick=2.6030259375471075e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6753509427750167e-06, theta_kick=-2.0088088177358598e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.861335596398391e-07, theta_kick=5.8289242944185414e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004700849186913789
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9945979610645395e-07, theta_kick=3.5906356311210835e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01649380e-01 -6.32169719e+00 -5.91422205e-03  7.87040703e-02]
 [ 1.79996826e-01  4.56470516e-01  3.87002438e-03 -1.91415552e-02]
 [ 3.74842548e-03  7.87295093e-02  3.83996210e-01 -5.11890851e+00]
 [ 1.80805050e-03 -1.30807812e-02  2.12658303e-01 -2.30176794e-01]]
compute_tune_4x4()/ evals =  [0.08571432+0.99631976j 0.08571432-0.99631976j 0.06860596+0.99764384j
 0.06860596-0.99764384j]
compute_tune_4x4()/ angles =  [0.23634138304845895, 0.2390724386379508, 0.7609275613620492, 0.763658616951541]
compute_tune_4x4()/  0.23634138304845895 0.2390724386379508
compute_tunes()/ 0.23634138304845895 0.2390724386379508

 Running simulation ..
Closed orbit computation: x_co=[ 3.63430613e-09 -6.48122954e-10], y_co=[ 1.73469707e-07 -5.60013434e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.34410511e-03  7.28539170e-04  2.66757993e-03  2.90548836e-04]
 [-1.41785243e-03 -1.06623214e-04 -1.79610615e-04  1.90802514e-04]
 [-4.95757364e-03 -5.49953871e-04 -1.93436377e-03 -4.50315420e-04]
 [ 1.87509516e-03 -1.55235354e-04  2.22359226e-03  3.95747266e-04]
 [ 2.24155886e-03 -6.86332243e-04  4.51815401e-03  1.04279095e-04]
 [-3.96969768e-03  2.65748934e-04  6.65101704e-04 -6.61940111e-05]
 [ 9.82652966e-04 -9.28432277e-05  2.72219958e-03 -2.65531826e-05]
 [-3.09270072e-04 -9.31742702e-05  4.48581029e-04  2.19387452e-04]
 [ 1.09774701e-03  1.33738404e-05  1.30517802e-03 -1.73542788e-04]
 [ 3.39976135e-03  1.03969611e-04  1.07367428e-03  2.22633121e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.000159327578554288
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.815990937742681e-06, theta_kick=-1.1769742474309028e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.353380833861461e-05, theta_kick=-5.219867421650758e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006659381695327554
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.131184078060467e-05, theta_kick=-8.550558030055178e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.6317237431650932e-05, theta_kick=1.95649816387108e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0030878138200492e-05, theta_kick=1.2027400313079943e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012345818242489863
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.085353890283194e-05, theta_kick=2.500417778714445e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01539519e-01 -6.32017511e+00 -4.23735695e-03 -7.01547403e-02]
 [ 1.80008817e-01  4.56134918e-01 -1.80294695e-03  4.26140283e-03]
 [-1.10442269e-02 -7.01769726e-02  3.84067099e-01 -5.12021769e+00]
 [-2.71156242e-03 -4.14215329e-03  2.12585570e-01 -2.30011518e-01]]
compute_tune_4x4()/ evals =  [0.080934  +0.99671946j 0.080934  -0.99671946j 0.07339149+0.99730321j
 0.07339149-0.99730321j]
compute_tune_4x4()/ angles =  [0.23710485005699558, 0.23830886982860125, 0.7616911301713988, 0.7628951499430044]
compute_tune_4x4()/  0.23710485005699558 0.23830886982860125
compute_tunes()/ 0.23710485005699558 0.23830886982860125

 Running simulation ..
Closed orbit computation: x_co=[3.41886600e-07 8.73369254e-08], y_co=[ 4.25930310e-05 -6.81758535e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.815990937742681e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.353380833861461e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.131184078060467e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.6317237431650932e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0030878138200492e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.085353890283194e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.000159327578554288}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006659381695327554}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012345818242489863}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.34410511e-03  7.28539170e-04  2.66757993e-03  2.90548836e-04]
 [-1.41785243e-03 -1.06623214e-04 -1.79610615e-04  1.90802514e-04]
 [-4.95757364e-03 -5.49953871e-04 -1.93436377e-03 -4.50315420e-04]
 [ 1.87509516e-03 -1.55235354e-04  2.22359226e-03  3.95747266e-04]
 [ 2.24155886e-03 -6.86332243e-04  4.51815401e-03  1.04279095e-04]
 [-3.96969768e-03  2.65748934e-04  6.65101704e-04 -6.61940111e-05]
 [ 9.82652966e-04 -9.28432277e-05  2.72219958e-03 -2.65531826e-05]
 [-3.09270072e-04 -9.31742702e-05  4.48581029e-04  2.19387452e-04]
 [ 1.09774701e-03  1.33738404e-05  1.30517802e-03 -1.73542788e-04]
 [ 3.39976135e-03  1.03969611e-04  1.07367428e-03  2.22633121e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.000159327578554288
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.5139464648375005e-07, theta_kick=-1.8152787756266603e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.599027011352964e-07, theta_kick=6.713444057587822e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006659381695327554
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.1319113910574282e-07, theta_kick=-2.556241973931784e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.8123603377206937e-07, theta_kick=3.372125863794378e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.7117935155227755e-07, theta_kick=-3.251542460016164e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012345818242489863
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.676535390380088e-07, theta_kick=5.607341894044518e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01539519e-01 -6.32017511e+00 -4.23735695e-03 -7.01547403e-02]
 [ 1.80008817e-01  4.56134918e-01 -1.80294695e-03  4.26140283e-03]
 [-1.10442269e-02 -7.01769726e-02  3.84067099e-01 -5.12021769e+00]
 [-2.71156242e-03 -4.14215329e-03  2.12585570e-01 -2.30011518e-01]]
compute_tune_4x4()/ evals =  [0.080934  +0.99671946j 0.080934  -0.99671946j 0.07339149+0.99730321j
 0.07339149-0.99730321j]
compute_tune_4x4()/ angles =  [0.23710485005699558, 0.23830886982860125, 0.7616911301713988, 0.7628951499430044]
compute_tune_4x4()/  0.23710485005699558 0.23830886982860125
compute_tunes()/ 0.23710485005699558 0.23830886982860125

 Running simulation ..
Closed orbit computation: x_co=[ 8.48231278e-10 -4.48013288e-10], y_co=[ 2.75432051e-10 -5.03720860e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.94432868e-03 -5.71391175e-04 -2.50125799e-03 -8.43122892e-04]
 [ 3.62961042e-04 -3.64580209e-04  7.88702452e-04 -5.22324179e-04]
 [ 1.58693102e-03  1.29824164e-04  1.67079136e-03  1.20922329e-04]
 [ 2.81402924e-03 -1.09929209e-04 -3.25802599e-04 -7.26146067e-04]
 [-4.25515441e-03  1.30619321e-04 -1.93288741e-03 -3.54409870e-04]
 [-2.40611990e-03  4.96270440e-04 -1.51481980e-04 -2.24025132e-04]
 [ 1.04013955e-03 -8.18700258e-05 -1.31631147e-03  4.41020418e-04]
 [ 1.35638254e-03 -7.17365530e-04 -3.74432937e-04  4.83809458e-05]
 [-1.80954166e-03  6.21221471e-05  9.86595666e-05 -1.64134238e-04]
 [ 2.42504382e-03 -1.27345499e-04 -1.77563418e-03 -6.90004238e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0010144792134916757
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.714067890822109e-05, theta_kick=4.453307147931094e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.391015709029013e-05, theta_kick=-4.065955426685232e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01477736706875481
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.6428276038473427e-05, theta_kick=6.765962616045206e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.877979061216584e-05, theta_kick=3.450805182259308e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.4642964691377607e-05, theta_kick=-5.352859441698062e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009065510633052564
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.949451960172356e-06, theta_kick=-2.3374662510173398e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01586021e-01 -6.32142464e+00 -1.42582960e-03  8.51014829e-02]
 [ 1.80003609e-01  4.56311327e-01  3.31221492e-03 -1.38448868e-02]
 [ 8.07792245e-03  8.51449895e-02  3.84075384e-01 -5.11978798e+00]
 [ 2.53965683e-03 -5.68152242e-03  2.12639193e-01 -2.30177348e-01]]
compute_tune_4x4()/ evals =  [0.08036491+0.99676551j 0.08036491-0.99676551j 0.07394676+0.99726219j
 0.07394676-0.99726219j]
compute_tune_4x4()/ angles =  [0.2371957198013944, 0.23822025477270736, 0.7617797452272926, 0.7628042801986056]
compute_tune_4x4()/  0.2371957198013944 0.23822025477270736
compute_tunes()/ 0.2371957198013944 0.23822025477270736

 Running simulation ..
Closed orbit computation: x_co=[3.80861894e-07 1.32695152e-08], y_co=[-1.82193721e-05  4.32734021e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.714067890822109e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.391015709029013e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.6428276038473427e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.877979061216584e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.4642964691377607e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.949451960172356e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0010144792134916757}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01477736706875481}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.009065510633052564}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.94432868e-03 -5.71391175e-04 -2.50125799e-03 -8.43122892e-04]
 [ 3.62961042e-04 -3.64580209e-04  7.88702452e-04 -5.22324179e-04]
 [ 1.58693102e-03  1.29824164e-04  1.67079136e-03  1.20922329e-04]
 [ 2.81402924e-03 -1.09929209e-04 -3.25802599e-04 -7.26146067e-04]
 [-4.25515441e-03  1.30619321e-04 -1.93288741e-03 -3.54409870e-04]
 [-2.40611990e-03  4.96270440e-04 -1.51481980e-04 -2.24025132e-04]
 [ 1.04013955e-03 -8.18700258e-05 -1.31631147e-03  4.41020418e-04]
 [ 1.35638254e-03 -7.17365530e-04 -3.74432937e-04  4.83809458e-05]
 [-1.80954166e-03  6.21221471e-05  9.86595666e-05 -1.64134238e-04]
 [ 2.42504382e-03 -1.27345499e-04 -1.77563418e-03 -6.90004238e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0010144792134916757
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.188204190006147e-06, theta_kick=1.424701531609534e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1763113620734365e-06, theta_kick=-1.4104415834344533e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01477736706875481
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.441717148534499e-07, theta_kick=2.927710734008073e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.199516951525824e-07, theta_kick=9.831529342811645e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.9881958997565163e-07, theta_kick=-4.781996945081111e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009065510633052564
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.4326237528168436e-07, theta_kick=-4.1158450367458505e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01586021e-01 -6.32142464e+00 -1.42582960e-03  8.51014829e-02]
 [ 1.80003609e-01  4.56311327e-01  3.31221492e-03 -1.38448868e-02]
 [ 8.07792245e-03  8.51449895e-02  3.84075384e-01 -5.11978798e+00]
 [ 2.53965683e-03 -5.68152242e-03  2.12639193e-01 -2.30177348e-01]]
compute_tune_4x4()/ evals =  [0.08036491+0.99676551j 0.08036491-0.99676551j 0.07394676+0.99726219j
 0.07394676-0.99726219j]
compute_tune_4x4()/ angles =  [0.2371957198013944, 0.23822025477270736, 0.7617797452272926, 0.7628042801986056]
compute_tune_4x4()/  0.2371957198013944 0.23822025477270736
compute_tunes()/ 0.2371957198013944 0.23822025477270736

 Running simulation ..
Closed orbit computation: x_co=[1.39404861e-09 2.68517049e-10], y_co=[-1.48572366e-07  6.01418340e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.83131991e-04  6.40811231e-05  2.75576024e-03  2.57189654e-04]
 [-2.13628422e-03  3.47180982e-04 -8.14856310e-04  6.39246768e-04]
 [ 4.88285684e-04 -1.72093960e-04  3.04321994e-03 -3.72137014e-04]
 [ 3.48354348e-03  4.49637008e-06  2.03275496e-03  4.33884455e-04]
 [ 4.15127451e-03 -9.62134390e-04 -1.42707309e-03  7.41497770e-04]
 [-4.95928698e-04  2.73108952e-04  2.02679452e-04 -1.80520978e-05]
 [-3.41141708e-03  8.80170292e-04  1.78415765e-03 -7.53128180e-04]
 [ 5.63093354e-03 -5.67360993e-04 -2.96047713e-03 -3.96286833e-04]
 [-7.65600737e-04  1.01856640e-03  2.10400426e-03  8.02243317e-04]
 [ 2.11480351e-03 -4.76443892e-04 -3.25990800e-03  2.78768443e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010759505426815849
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.130569222617078e-05, theta_kick=1.355595037116321e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.111288663529396e-05, theta_kick=7.327665053085925e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013813308113747312
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00015939149158799028, theta_kick=-1.9111639573477946e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.808597013954635e-06, theta_kick=1.1760876881480765e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.090876254153784e-06, theta_kick=6.104152179845436e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006257187933471096
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.73826543692275e-05, theta_kick=5.68135854252579e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01454338e-01 -6.32014429e+00  7.34918226e-03 -2.16112357e-02]
 [ 1.79965691e-01  4.56101818e-01 -2.49827354e-03  1.88765419e-02]
 [ 3.60749196e-03 -2.16411047e-02  3.84059374e-01 -5.11943655e+00]
 [ 5.14149764e-04  2.04046469e-02  2.12599034e-01 -2.30360216e-01]]
compute_tune_4x4()/ evals =  [0.08957999+0.99597963j 0.08957999-0.99597963j 0.06459333+0.99791167j
 0.06459333-0.99791167j]
compute_tune_4x4()/ angles =  [0.23572376538201154, 0.23971248956299385, 0.7602875104370062, 0.7642762346179884]
compute_tune_4x4()/  0.23572376538201154 0.23971248956299385
compute_tunes()/ 0.23572376538201154 0.23971248956299385

 Running simulation ..
Closed orbit computation: x_co=[ 1.14459918e-06 -3.87629946e-08], y_co=[6.27207306e-05 2.50197793e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.130569222617078e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.111288663529396e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00015939149158799028, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.808597013954635e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.090876254153784e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.73826543692275e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.010759505426815849}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.013813308113747312}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006257187933471096}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.83131991e-04  6.40811231e-05  2.75576024e-03  2.57189654e-04]
 [-2.13628422e-03  3.47180982e-04 -8.14856310e-04  6.39246768e-04]
 [ 4.88285684e-04 -1.72093960e-04  3.04321994e-03 -3.72137014e-04]
 [ 3.48354348e-03  4.49637008e-06  2.03275496e-03  4.33884455e-04]
 [ 4.15127451e-03 -9.62134390e-04 -1.42707309e-03  7.41497770e-04]
 [-4.95928698e-04  2.73108952e-04  2.02679452e-04 -1.80520978e-05]
 [-3.41141708e-03  8.80170292e-04  1.78415765e-03 -7.53128180e-04]
 [ 5.63093354e-03 -5.67360993e-04 -2.96047713e-03 -3.96286833e-04]
 [-7.65600737e-04  1.01856640e-03  2.10400426e-03  8.02243317e-04]
 [ 2.11480351e-03 -4.76443892e-04 -3.25990800e-03  2.78768443e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010759505426815849
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.304352948686732e-07, theta_kick=-7.55915639529482e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.6401113157027945e-06, theta_kick=1.966555178937562e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013813308113747312
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.1743020347965295e-06, theta_kick=-2.607069950780359e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.6243506879728322e-06, theta_kick=1.9476575932743696e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.907730834736751e-07, theta_kick=-1.0680704436288233e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006257187933471096
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.7616573229982065e-07, theta_kick=3.311331041372506e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01454338e-01 -6.32014429e+00  7.34918226e-03 -2.16112357e-02]
 [ 1.79965691e-01  4.56101818e-01 -2.49827354e-03  1.88765419e-02]
 [ 3.60749196e-03 -2.16411047e-02  3.84059374e-01 -5.11943655e+00]
 [ 5.14149764e-04  2.04046469e-02  2.12599034e-01 -2.30360216e-01]]
compute_tune_4x4()/ evals =  [0.08957999+0.99597963j 0.08957999-0.99597963j 0.06459333+0.99791167j
 0.06459333-0.99791167j]
compute_tune_4x4()/ angles =  [0.23572376538201154, 0.23971248956299385, 0.7602875104370062, 0.7642762346179884]
compute_tune_4x4()/  0.23572376538201154 0.23971248956299385
compute_tunes()/ 0.23572376538201154 0.23971248956299385

 Running simulation ..
Closed orbit computation: x_co=[ 4.29069713e-09 -3.61018113e-10], y_co=[1.22608193e-07 6.52308811e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.46985186e-03 -1.85679339e-05 -3.06707272e-03 -3.84620959e-04]
 [ 3.64562612e-04  5.38120513e-04 -2.47510560e-04 -3.31335592e-04]
 [-3.85279258e-03  1.12579612e-04 -1.37649796e-03 -5.21797892e-04]
 [ 8.71830121e-04 -4.10601717e-04 -5.23124779e-04 -1.20038711e-03]
 [-1.48377119e-03 -2.50527729e-04 -2.33456435e-03  2.80807547e-04]
 [-3.80338936e-03  8.50893198e-04 -6.54251355e-04 -3.90499305e-04]
 [-1.13166801e-03  3.45368268e-04  4.71214855e-03 -8.97936954e-06]
 [ 2.30297063e-03 -1.15633591e-04 -3.93266864e-04  1.23614205e-04]
 [ 1.58503615e-03 -5.29055556e-04  1.28584874e-03 -2.75539640e-04]
 [ 2.44105825e-04 -3.37102975e-04  3.92668259e-05  3.66662570e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.021283246669484494
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.289193210215595e-05, theta_kick=1.1138092177525965e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.253907322289918e-06, theta_kick=8.697707817514594e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01079616847800685
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.4728668692983063e-05, theta_kick=-2.9650604212543167e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.798209142159773e-05, theta_kick=-6.952270926922665e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.1760702258778486e-05, theta_kick=5.0072653311266e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0028201283421422853
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.298360266374963e-05, theta_kick=-3.954858064656487e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01481342e-01 -6.31949345e+00 -4.73525035e-03 -1.31846027e-01]
 [ 1.80097658e-01  4.56749790e-01 -3.15384862e-03  1.81747364e-03]
 [-1.81334318e-02 -1.31804190e-01  3.83822781e-01 -5.12160679e+00]
 [-5.34410914e-03 -1.54381904e-02  2.12581099e-01 -2.30138423e-01]]
compute_tune_4x4()/ evals =  [0.08631934+0.99626752j 0.08631934-0.99626752j 0.06815707+0.9976746j
 0.06815707-0.9976746j ]
compute_tune_4x4()/ angles =  [0.23624473299768572, 0.23914404966392683, 0.7608559503360732, 0.7637552670023142]
compute_tune_4x4()/  0.23624473299768572 0.23914404966392683
compute_tunes()/ 0.23624473299768572 0.23914404966392683

 Running simulation ..
Closed orbit computation: x_co=[ 3.46227055e-07 -2.26699419e-07], y_co=[1.26333774e-05 1.09555968e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.289193210215595e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.253907322289918e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.4728668692983063e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.798209142159773e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.1760702258778486e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.298360266374963e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.021283246669484494}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01079616847800685}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0028201283421422853}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.46985186e-03 -1.85679339e-05 -3.06707272e-03 -3.84620959e-04]
 [ 3.64562612e-04  5.38120513e-04 -2.47510560e-04 -3.31335592e-04]
 [-3.85279258e-03  1.12579612e-04 -1.37649796e-03 -5.21797892e-04]
 [ 8.71830121e-04 -4.10601717e-04 -5.23124779e-04 -1.20038711e-03]
 [-1.48377119e-03 -2.50527729e-04 -2.33456435e-03  2.80807547e-04]
 [-3.80338936e-03  8.50893198e-04 -6.54251355e-04 -3.90499305e-04]
 [-1.13166801e-03  3.45368268e-04  4.71214855e-03 -8.97936954e-06]
 [ 2.30297063e-03 -1.15633591e-04 -3.93266864e-04  1.23614205e-04]
 [ 1.58503615e-03 -5.29055556e-04  1.28584874e-03 -2.75539640e-04]
 [ 2.44105825e-04 -3.37102975e-04  3.92668259e-05  3.66662570e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.021283246669484494
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.8116655063889838e-08, theta_kick=2.1722551085291108e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.4466336536567392e-07, theta_kick=-1.7345681822852267e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01079616847800685
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4621989679246495e-06, theta_kick=-1.7532315797584848e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.7314929677070112e-06, theta_kick=3.2751628444036357e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.7533259618918116e-06, theta_kick=-2.1023037995726144e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0028201283421422853
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.999133198374978e-07, theta_kick=4.795111177655323e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01481342e-01 -6.31949345e+00 -4.73525035e-03 -1.31846027e-01]
 [ 1.80097658e-01  4.56749790e-01 -3.15384862e-03  1.81747364e-03]
 [-1.81334318e-02 -1.31804190e-01  3.83822781e-01 -5.12160679e+00]
 [-5.34410914e-03 -1.54381904e-02  2.12581099e-01 -2.30138423e-01]]
compute_tune_4x4()/ evals =  [0.08631934+0.99626752j 0.08631934-0.99626752j 0.06815707+0.9976746j
 0.06815707-0.9976746j ]
compute_tune_4x4()/ angles =  [0.23624473299768572, 0.23914404966392683, 0.7608559503360732, 0.7637552670023142]
compute_tune_4x4()/  0.23624473299768572 0.23914404966392683
compute_tunes()/ 0.23624473299768572 0.23914404966392683

 Running simulation ..
Closed orbit computation: x_co=[1.40861029e-09 1.05057600e-10], y_co=[ 8.50123829e-08 -2.49721409e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.21640413e-03  2.14964221e-04  2.95971873e-03  8.83902032e-05]
 [ 2.30000602e-03 -4.99635314e-04  5.47839723e-04 -4.21667828e-04]
 [-1.37000972e-04 -5.44766181e-04  2.06454575e-03  2.82261385e-05]
 [ 2.13788412e-03  3.68287899e-04  4.51143572e-05  1.06119719e-03]
 [ 1.70042825e-03  2.57624111e-04  3.00306953e-03 -2.59751369e-04]
 [-2.78588700e-03  4.44147873e-05 -6.60469799e-04  2.75606303e-04]
 [-4.15029989e-03  1.86772554e-04 -1.26682394e-04  4.98691329e-04]
 [ 9.97329771e-04 -1.60321872e-04 -2.96206842e-03  2.53725244e-04]
 [ 4.80418487e-03  1.51268300e-04  1.75949405e-03 -2.71542918e-04]
 [-4.28156331e-04 -1.82266451e-04 -1.09129628e-03 -5.72764277e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0029039414358087426
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.9544985649455004e-05, theta_kick=5.940630199089413e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.259146177537281e-06, theta_kick=-2.708801270302318e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006115678655849579
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.9861601927410714e-05, theta_kick=3.5805184294187817e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.965636010026472e-05, theta_kick=-5.9539844148029556e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.8330707961537208e-05, theta_kick=3.3969584827146305e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00361090338757454
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.938747226996093e-06, theta_kick=4.72270612586807e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01678170e-01 -6.31980766e+00  6.47722714e-03  9.23491857e-03]
 [ 1.79995010e-01  4.56123009e-01 -9.26491883e-04  9.25645381e-03]
 [ 6.24852109e-03  9.23530203e-03  3.84045411e-01 -5.11897044e+00]
 [ 1.15069671e-03  1.26652790e-02  2.12576058e-01 -2.29762071e-01]]
compute_tune_4x4()/ evals =  [0.08579613+0.99631271j 0.08579613-0.99631271j 0.06856796+0.99764645j
 0.06856796-0.99764645j]
compute_tune_4x4()/ angles =  [0.2363283140032766, 0.23907850071870115, 0.7609214992812988, 0.7636716859967234]
compute_tune_4x4()/  0.2363283140032766 0.23907850071870115
compute_tunes()/ 0.2363283140032766 0.23907850071870115

 Running simulation ..
Closed orbit computation: x_co=[7.38649580e-08 1.35291224e-08], y_co=[4.9160964e-07 4.4940252e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.9544985649455004e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.259146177537281e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.9861601927410714e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.965636010026472e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.8330707961537208e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.938747226996093e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0029039414358087426}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006115678655849579}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00361090338757454}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.21640413e-03  2.14964221e-04  2.95971873e-03  8.83902032e-05]
 [ 2.30000602e-03 -4.99635314e-04  5.47839723e-04 -4.21667828e-04]
 [-1.37000972e-04 -5.44766181e-04  2.06454575e-03  2.82261385e-05]
 [ 2.13788412e-03  3.68287899e-04  4.51143572e-05  1.06119719e-03]
 [ 1.70042825e-03  2.57624111e-04  3.00306953e-03 -2.59751369e-04]
 [-2.78588700e-03  4.44147873e-05 -6.60469799e-04  2.75606303e-04]
 [-4.15029989e-03  1.86772554e-04 -1.26682394e-04  4.98691329e-04]
 [ 9.97329771e-04 -1.60321872e-04 -2.96206842e-03  2.53725244e-04]
 [ 4.80418487e-03  1.51268300e-04  1.75949405e-03 -2.71542918e-04]
 [-4.28156331e-04 -1.82266451e-04 -1.09129628e-03 -5.72764277e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0029039414358087426
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.6602672618217226e-08, theta_kick=-5.587835795792665e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.126011415020402e-07, theta_kick=-8.544355812441688e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006115678655849579
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.402117084245157e-07, theta_kick=1.0074454525046557e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0608466552483039e-07, theta_kick=-1.271995055435119e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.8034189487129136e-07, theta_kick=-3.3614048019421765e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00361090338757454
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.941196140807772e-08, theta_kick=9.521792971090283e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01678170e-01 -6.31980766e+00  6.47722714e-03  9.23491857e-03]
 [ 1.79995010e-01  4.56123009e-01 -9.26491883e-04  9.25645381e-03]
 [ 6.24852109e-03  9.23530203e-03  3.84045411e-01 -5.11897044e+00]
 [ 1.15069671e-03  1.26652790e-02  2.12576058e-01 -2.29762071e-01]]
compute_tune_4x4()/ evals =  [0.08579613+0.99631271j 0.08579613-0.99631271j 0.06856796+0.99764645j
 0.06856796-0.99764645j]
compute_tune_4x4()/ angles =  [0.2363283140032766, 0.23907850071870115, 0.7609214992812988, 0.7636716859967234]
compute_tune_4x4()/  0.2363283140032766 0.23907850071870115
compute_tunes()/ 0.2363283140032766 0.23907850071870115

 Running simulation ..
Closed orbit computation: x_co=[-1.54733970e-09  1.10998251e-10], y_co=[-1.98960293e-08 -1.82775163e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.12712946e-03  8.24863105e-05 -6.31598506e-04  3.59005609e-04]
 [ 1.00052285e-03 -4.55617366e-04 -2.54367211e-03 -4.70115366e-04]
 [ 2.71264274e-03 -1.07551859e-04  7.75639663e-04 -2.49043298e-04]
 [ 8.12950418e-04 -6.20937543e-04  6.48407730e-03 -2.93239139e-05]
 [ 2.64949674e-03  8.36712849e-04 -4.79050112e-04 -4.48508070e-04]
 [-5.22750937e-03  1.12655280e-03  1.75141987e-03 -1.57508487e-04]
 [ 3.98229981e-03 -1.10829357e-04 -1.16969757e-03 -6.88554827e-04]
 [-1.43917430e-03  3.39779922e-04  8.26874797e-06 -7.66069005e-05]
 [ 1.17317461e-03 -3.53986939e-05 -1.72931864e-06 -1.79536462e-04]
 [ 1.77436698e-03 -5.56301514e-04 -1.15491099e-03 -6.79517734e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004483208409772838
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4895689161864303e-05, theta_kick=1.7860491775557378e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.163875313134652e-05, theta_kick=-1.0987831303670285e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006865183579979762
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.035444676993979e-05, theta_kick=6.037687633142653e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.7431916687416363e-05, theta_kick=2.0901524007690467e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.6825107880020185e-05, theta_kick=4.415468994271065e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007399586498317357
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.971376954907519e-05, theta_kick=1.075701852914447e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01639743e-01 -6.32034158e+00  2.90392882e-03  6.95050997e-02]
 [ 1.80012829e-01  4.56185399e-01  1.84272900e-03 -3.73468838e-03]
 [ 9.89354512e-03  6.95128163e-02  3.84077669e-01 -5.11975355e+00]
 [ 2.66799470e-03  4.70362171e-03  2.12593353e-01 -2.29866654e-01]]
compute_tune_4x4()/ evals =  [0.08061245+0.99674552j 0.08061245-0.99674552j 0.07376589+0.99727559j
 0.07376589-0.99727559j]
compute_tune_4x4()/ angles =  [0.23715619379071676, 0.23824912130024517, 0.7617508786997549, 0.7628438062092833]
compute_tune_4x4()/  0.23715619379071676 0.23824912130024517
compute_tunes()/ 0.23715619379071676 0.23824912130024517

 Running simulation ..
Closed orbit computation: x_co=[-3.23472326e-07 -4.83107578e-08], y_co=[ 6.65695251e-06 -1.46595328e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.4895689161864303e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 9.163875313134652e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.035444676993979e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.7431916687416363e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.6825107880020185e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.971376954907519e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004483208409772838}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006865183579979762}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.007399586498317357}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.12712946e-03  8.24863105e-05 -6.31598506e-04  3.59005609e-04]
 [ 1.00052285e-03 -4.55617366e-04 -2.54367211e-03 -4.70115366e-04]
 [ 2.71264274e-03 -1.07551859e-04  7.75639663e-04 -2.49043298e-04]
 [ 8.12950418e-04 -6.20937543e-04  6.48407730e-03 -2.93239139e-05]
 [ 2.64949674e-03  8.36712849e-04 -4.79050112e-04 -4.48508070e-04]
 [-5.22750937e-03  1.12655280e-03  1.75141987e-03 -1.57508487e-04]
 [ 3.98229981e-03 -1.10829357e-04 -1.16969757e-03 -6.88554827e-04]
 [-1.43917430e-03  3.39779922e-04  8.26874797e-06 -7.66069005e-05]
 [ 1.17317461e-03 -3.53986939e-05 -1.72931864e-06 -1.79536462e-04]
 [ 1.77436698e-03 -5.56301514e-04 -1.15491099e-03 -6.79517734e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004483208409772838
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.380368070935752e-07, theta_kick=-5.252226134334183e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.169054828269666e-06, theta_kick=1.4017407263668186e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006865183579979762
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.216671660993195e-06, theta_kick=-2.657872726804739e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.7090028126956744e-06, theta_kick=3.2481963023224955e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.681307996306898e-06, theta_kick=-2.0159515490627938e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007399586498317357
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.5393603941393577e-07, theta_kick=4.2438262858022574e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01639743e-01 -6.32034158e+00  2.90392882e-03  6.95050997e-02]
 [ 1.80012829e-01  4.56185399e-01  1.84272900e-03 -3.73468838e-03]
 [ 9.89354512e-03  6.95128163e-02  3.84077669e-01 -5.11975355e+00]
 [ 2.66799470e-03  4.70362171e-03  2.12593353e-01 -2.29866654e-01]]
compute_tune_4x4()/ evals =  [0.08061245+0.99674552j 0.08061245-0.99674552j 0.07376589+0.99727559j
 0.07376589-0.99727559j]
compute_tune_4x4()/ angles =  [0.23715619379071676, 0.23824912130024517, 0.7617508786997549, 0.7628438062092833]
compute_tune_4x4()/  0.23715619379071676 0.23824912130024517
compute_tunes()/ 0.23715619379071676 0.23824912130024517

 Running simulation ..
Closed orbit computation: x_co=[-1.19241588e-09  3.28880772e-10], y_co=[2.94384031e-08 5.05798801e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.52373001e-03 -2.90330300e-04 -2.74638122e-04 -4.76322507e-04]
 [-2.27066603e-03  8.11838304e-05  2.70379219e-04  3.70088139e-04]
 [ 1.71934971e-03  6.94452106e-06  8.41196105e-04 -1.47433070e-04]
 [ 1.87959164e-03 -1.31356130e-04  3.94089240e-03  2.68531571e-04]
 [ 3.10596840e-03 -5.42648445e-04  3.09656073e-03 -5.49756303e-04]
 [ 6.01121748e-04  4.88436722e-04 -1.46672093e-03  3.66819941e-05]
 [ 1.01422447e-03 -3.43774613e-04  1.95304563e-03 -1.95367347e-04]
 [-4.89186119e-04  5.32473782e-06  2.39958997e-03  1.93647178e-04]
 [-2.35276454e-03 -2.32027671e-04 -7.80459639e-03 -1.87539795e-04]
 [ 7.89785057e-04 -7.04501510e-04 -8.05005345e-04 -8.05671615e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011466776308332718
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.66381310658596e-06, theta_kick=6.791125023436775e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3555350987835284e-05, theta_kick=-1.6253375872857195e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01743594632157028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.351093124138185e-05, theta_kick=8.814237250678105e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.5851592407123194e-05, theta_kick=3.0997031997323015e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.1936025683213133e-05, theta_kick=2.6302120166852922e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0013555496840361309
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.26457217281479e-05, theta_kick=-8.71049537457336e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708140e-01 -6.32128713e+00 -3.41086613e-03  1.04315250e-01]
 [ 1.80054708e-01  4.56771796e-01  3.97107021e-03 -1.42208996e-02]
 [ 8.54933508e-03  1.04282757e-01  3.83856811e-01 -5.11960111e+00]
 [ 3.21473800e-03 -3.56704374e-03  2.12643529e-01 -2.29992813e-01]]
compute_tune_4x4()/ evals =  [0.08039067+0.99676343j 0.08039067-0.99676343j 0.07407316+0.99725281j
 0.07407316-0.99725281j]
compute_tune_4x4()/ angles =  [0.23719160667388434, 0.2382000829058878, 0.7617999170941122, 0.7628083933261156]
compute_tune_4x4()/  0.23719160667388434 0.2382000829058878
compute_tunes()/ 0.23719160667388434 0.2382000829058878

 Running simulation ..
Closed orbit computation: x_co=[ 1.14376390e-06 -1.57500623e-07], y_co=[-6.89621546e-05  1.24178641e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.66381310658596e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.3555350987835284e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.351093124138185e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.5851592407123194e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.1936025683213133e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.26457217281479e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011466776308332718}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01743594632157028}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0013555496840361309}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.52373001e-03 -2.90330300e-04 -2.74638122e-04 -4.76322507e-04]
 [-2.27066603e-03  8.11838304e-05  2.70379219e-04  3.70088139e-04]
 [ 1.71934971e-03  6.94452106e-06  8.41196105e-04 -1.47433070e-04]
 [ 1.87959164e-03 -1.31356130e-04  3.94089240e-03  2.68531571e-04]
 [ 3.10596840e-03 -5.42648445e-04  3.09656073e-03 -5.49756303e-04]
 [ 6.01121748e-04  4.88436722e-04 -1.46672093e-03  3.66819941e-05]
 [ 1.01422447e-03 -3.43774613e-04  1.95304563e-03 -1.95367347e-04]
 [-4.89186119e-04  5.32473782e-06  2.39958997e-03  1.93647178e-04]
 [-2.35276454e-03 -2.32027671e-04 -7.80459639e-03 -1.87539795e-04]
 [ 7.89785057e-04 -7.04501510e-04 -8.05005345e-04 -8.05671615e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011466776308332718
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6392401737526848e-06, theta_kick=-1.9655106469614845e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.497628857136276e-06, theta_kick=2.994750976375377e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01743594632157028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.564662583116504e-06, theta_kick=-3.0751269360604123e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.0635292895874094e-06, theta_kick=2.474249261300035e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.25645482886665e-06, theta_kick=-1.506536615626015e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0013555496840361309
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.969351049717894e-07, theta_kick=8.356514139885527e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708140e-01 -6.32128713e+00 -3.41086613e-03  1.04315250e-01]
 [ 1.80054708e-01  4.56771796e-01  3.97107021e-03 -1.42208996e-02]
 [ 8.54933508e-03  1.04282757e-01  3.83856811e-01 -5.11960111e+00]
 [ 3.21473800e-03 -3.56704374e-03  2.12643529e-01 -2.29992813e-01]]
compute_tune_4x4()/ evals =  [0.08039067+0.99676343j 0.08039067-0.99676343j 0.07407316+0.99725281j
 0.07407316-0.99725281j]
compute_tune_4x4()/ angles =  [0.23719160667388434, 0.2382000829058878, 0.7617999170941122, 0.7628083933261156]
compute_tune_4x4()/  0.23719160667388434 0.2382000829058878
compute_tunes()/ 0.23719160667388434 0.2382000829058878

 Running simulation ..
Closed orbit computation: x_co=[-4.53763668e-09  7.19150952e-11], y_co=[ 8.85040442e-08 -6.00714941e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.08083007e-03 -9.03890444e-05  1.76998887e-03  1.32053296e-04]
 [ 2.89020620e-04  1.24510077e-04 -5.84353309e-03  6.98914332e-05]
 [ 4.81359615e-03  6.30930027e-05 -1.02778174e-03 -6.45306560e-05]
 [ 1.48651281e-03 -8.67809742e-04  8.04095059e-04  1.04971676e-04]
 [-2.04711642e-03 -1.09815574e-03 -7.54475940e-04 -2.17717130e-04]
 [-4.12364986e-04  5.50521682e-04  4.13303994e-04 -9.66230708e-05]
 [-1.12320475e-03 -3.26765296e-04 -6.44514704e-04  2.09415734e-04]
 [-8.72581193e-04 -5.74192766e-04  1.77903206e-03 -1.86840802e-04]
 [-3.71220180e-04 -6.62791877e-05 -1.24111957e-03 -5.91301351e-04]
 [-3.59014614e-03  7.63898783e-04  2.41004958e-03  5.86927691e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018625033716454187
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.434961216979875e-05, theta_kick=-5.317685370582158e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.713279434451426e-05, theta_kick=6.85043701178506e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0006902707106692419
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.00014893826610989176, theta_kick=1.7858258506977103e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.238790848490843e-05, theta_kick=9.878620223006277e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.013248392322668e-05, theta_kick=-7.210111079011051e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013461168176488179
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.083896115412678e-05, theta_kick=2.498669851793942e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01212238e-01 -6.31745321e+00  1.60765101e-02  1.31468087e-01]
 [ 1.80040133e-01  4.56298541e-01  1.22055915e-03  1.29413185e-02]
 [ 2.72886226e-02  1.31470474e-01  3.83858061e-01 -5.12107385e+00]
 [ 6.60995055e-03  3.35890897e-02  2.12518868e-01 -2.30221571e-01]]
compute_tune_4x4()/ evals =  [0.09953331+0.99503423j 0.09953331-0.99503423j 0.05482809+0.99849581j
 0.05482809-0.99849581j]
compute_tune_4x4()/ angles =  [0.234132508450306, 0.24126946090958168, 0.7587305390904183, 0.765867491549694]
compute_tune_4x4()/  0.234132508450306 0.24126946090958168
compute_tunes()/ 0.234132508450306 0.24126946090958168

 Running simulation ..
Closed orbit computation: x_co=[1.13225322e-07 6.57507200e-08], y_co=[-1.03452788e-04 -1.38741198e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.434961216979875e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.713279434451426e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.00014893826610989176, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -8.238790848490843e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.013248392322668e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.083896115412678e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.018625033716454187}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0006902707106692419}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.013461168176488179}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.08083007e-03 -9.03890444e-05  1.76998887e-03  1.32053296e-04]
 [ 2.89020620e-04  1.24510077e-04 -5.84353309e-03  6.98914332e-05]
 [ 4.81359615e-03  6.30930027e-05 -1.02778174e-03 -6.45306560e-05]
 [ 1.48651281e-03 -8.67809742e-04  8.04095059e-04  1.04971676e-04]
 [-2.04711642e-03 -1.09815574e-03 -7.54475940e-04 -2.17717130e-04]
 [-4.12364986e-04  5.50521682e-04  4.13303994e-04 -9.66230708e-05]
 [-1.12320475e-03 -3.26765296e-04 -6.44514704e-04  2.09415734e-04]
 [-8.72581193e-04 -5.74192766e-04  1.77903206e-03 -1.86840802e-04]
 [-3.71220180e-04 -6.62791877e-05 -1.24111957e-03 -5.91301351e-04]
 [-3.59014614e-03  7.63898783e-04  2.41004958e-03  5.86927691e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018625033716454187
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.145373110122131e-07, theta_kick=-2.5723830816057778e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.70041318513104e-07, theta_kick=1.1631160400158168e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0006902707106692419
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.695347496936432e-07, theta_kick=-3.231823064927411e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.762192772415875e-07, theta_kick=-5.710048318080455e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.613222982025798e-07, theta_kick=9.12854081327633e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.013461168176488179
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.6439183808655046e-07, theta_kick=-3.170157619668213e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01212238e-01 -6.31745321e+00  1.60765101e-02  1.31468087e-01]
 [ 1.80040133e-01  4.56298541e-01  1.22055915e-03  1.29413185e-02]
 [ 2.72886226e-02  1.31470474e-01  3.83858061e-01 -5.12107385e+00]
 [ 6.60995055e-03  3.35890897e-02  2.12518868e-01 -2.30221571e-01]]
compute_tune_4x4()/ evals =  [0.09953331+0.99503423j 0.09953331-0.99503423j 0.05482809+0.99849581j
 0.05482809-0.99849581j]
compute_tune_4x4()/ angles =  [0.234132508450306, 0.24126946090958168, 0.7587305390904183, 0.765867491549694]
compute_tune_4x4()/  0.234132508450306 0.24126946090958168
compute_tunes()/ 0.234132508450306 0.24126946090958168

 Running simulation ..
Closed orbit computation: x_co=[2.56852665e-10 1.36867816e-10], y_co=[-2.43131257e-07  8.87197614e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.43009239e-03  8.71419539e-04  1.29062556e-03  6.37594170e-04]
 [-4.13434379e-03 -2.01599130e-04 -6.55534389e-03  1.46467689e-04]
 [ 1.39708958e-03 -4.63954180e-04 -2.14631508e-03  5.63823469e-04]
 [ 3.60063444e-03 -5.71221123e-04  2.57493565e-03 -2.20109582e-04]
 [-6.43622335e-04  3.80686935e-04  1.80481243e-04  3.91449948e-04]
 [-2.41255703e-03  3.78332740e-04  4.74155633e-03  6.28940819e-04]
 [-4.81012156e-04 -6.34996510e-04 -2.89674916e-03  1.94843164e-04]
 [-1.14971048e-03  1.67642645e-04 -3.99603245e-04  7.30023820e-04]
 [ 1.10246048e-03 -3.02877491e-04 -2.06580585e-03  6.64744029e-04]
 [ 1.22306585e-03  3.50687985e-05 -1.41551205e-03  6.61354399e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00031779827958256527
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.997742260435191e-05, theta_kick=-4.793443390729595e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.75638587131083e-05, theta_kick=-2.105972746099254e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006567290508379078
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.872062451213872e-05, theta_kick=9.438899076018477e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.177215656048775e-05, theta_kick=-7.406713997709057e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6154918089169713e-06, theta_kick=3.1360730903136456e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005654535486505714
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.1444382441218962e-05, theta_kick=1.3722245157413188e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664797e-01 -6.32031557e+00 -6.88173026e-05 -4.13953572e-02]
 [ 1.80000312e-01  4.56122338e-01 -1.50507410e-03  6.05835651e-03]
 [-4.54747591e-03 -4.14018969e-02  3.84093377e-01 -5.11943141e+00]
 [-1.30264190e-03  1.93253445e-03  2.12590711e-01 -2.29842134e-01]]
compute_tune_4x4()/ evals =  [0.078018  +0.99695195j 0.078018  -0.99695195j 0.07633639+0.99708212j
 0.07633639-0.99708212j]
compute_tune_4x4()/ angles =  [0.23757041814949334, 0.23783885562441962, 0.7621611443755804, 0.7624295818505067]
compute_tune_4x4()/  0.23757041814949334 0.23783885562441962
compute_tunes()/ 0.23757041814949334 0.23783885562441962

 Running simulation ..
Closed orbit computation: x_co=[-1.46424139e-07  2.11793142e-08], y_co=[ 9.11338831e-07 -2.31123003e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.997742260435191e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.75638587131083e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.872062451213872e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.177215656048775e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.6154918089169713e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.1444382441218962e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00031779827958256527}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006567290508379078}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005654535486505714}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.43009239e-03  8.71419539e-04  1.29062556e-03  6.37594170e-04]
 [-4.13434379e-03 -2.01599130e-04 -6.55534389e-03  1.46467689e-04]
 [ 1.39708958e-03 -4.63954180e-04 -2.14631508e-03  5.63823469e-04]
 [ 3.60063444e-03 -5.71221123e-04  2.57493565e-03 -2.20109582e-04]
 [-6.43622335e-04  3.80686935e-04  1.80481243e-04  3.91449948e-04]
 [-2.41255703e-03  3.78332740e-04  4.74155633e-03  6.28940819e-04]
 [-4.81012156e-04 -6.34996510e-04 -2.89674916e-03  1.94843164e-04]
 [-1.14971048e-03  1.67642645e-04 -3.99603245e-04  7.30023820e-04]
 [ 1.10246048e-03 -3.02877491e-04 -2.06580585e-03  6.64744029e-04]
 [ 1.22306585e-03  3.50687985e-05 -1.41551205e-03  6.61354399e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00031779827958256527
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.459317861910436e-07, theta_kick=1.1342078036078547e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.870382114864138e-06, theta_kick=-2.2426585313827509e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006567290508379078
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.874412527385109e-06, theta_kick=3.446528773999703e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.1920863319390294e-06, theta_kick=-2.6283939922124864e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.999157839566523e-07, theta_kick=1.198936648149861e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005654535486505714
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.393422582298325e-07, theta_kick=-1.6707661055878496e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664797e-01 -6.32031557e+00 -6.88173026e-05 -4.13953572e-02]
 [ 1.80000312e-01  4.56122338e-01 -1.50507410e-03  6.05835651e-03]
 [-4.54747591e-03 -4.14018969e-02  3.84093377e-01 -5.11943141e+00]
 [-1.30264190e-03  1.93253445e-03  2.12590711e-01 -2.29842134e-01]]
compute_tune_4x4()/ evals =  [0.078018  +0.99695195j 0.078018  -0.99695195j 0.07633639+0.99708212j
 0.07633639-0.99708212j]
compute_tune_4x4()/ angles =  [0.23757041814949334, 0.23783885562441962, 0.7621611443755804, 0.7624295818505067]
compute_tune_4x4()/  0.23757041814949334 0.23783885562441962
compute_tunes()/ 0.23757041814949334 0.23783885562441962

 Running simulation ..
Closed orbit computation: x_co=[-2.30261875e-09  1.02124241e-10], y_co=[-1.25536562e-07  2.31800422e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.99467916e-03 -1.42742663e-05  1.03330361e-03  4.36627760e-04]
 [ 3.61190699e-05 -3.30259052e-04 -1.64067963e-04  2.62161775e-04]
 [-1.57551381e-03 -7.34119860e-04 -8.89753927e-04 -5.24667374e-04]
 [-5.91757463e-03  7.39527824e-04 -4.36808142e-04 -5.54072864e-04]
 [ 5.43089649e-03 -2.17139777e-04  3.05131974e-03 -4.99762822e-04]
 [-4.39463781e-03  1.30321446e-04 -1.57629025e-03  7.85659816e-04]
 [-1.04881168e-03  7.20890467e-04 -2.08269752e-03 -7.46041374e-04]
 [ 4.34785571e-03 -6.98370823e-04  8.97130319e-04  4.30749577e-04]
 [ 1.03455282e-04 -2.13970518e-04 -3.60706189e-04  3.58519185e-04]
 [ 1.94628107e-04 -3.40608860e-04 -9.85142301e-04 -3.20778636e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008117940337609283
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.330395227561508e-05, theta_kick=-5.192306814832541e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.846845881035648e-05, theta_kick=1.0607701085921754e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00022700232604187784
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.290693917716896e-05, theta_kick=-8.741816329577024e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.129479009987019e-05, theta_kick=-3.7523630838613087e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.272838783306755e-05, theta_kick=7.521369725241068e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0015284772899651906
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.677195421625663e-05, theta_kick=-1.0404283801760844e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657502e-01 -6.31976351e+00  2.38246561e-03  2.67545779e-02]
 [ 1.80004881e-01  4.56113783e-01  2.44947202e-04  3.53465948e-03]
 [ 4.83296586e-03  2.67544357e-02  3.84066211e-01 -5.11948447e+00]
 [ 1.36592141e-03  7.94795647e-03  2.12571305e-01 -2.29797257e-01]]
compute_tune_4x4()/ evals =  [0.08183023+0.99664628j 0.08183023-0.99664628j 0.07253238+0.99736606j
 0.07253238-0.99736606j]
compute_tune_4x4()/ angles =  [0.23696173491413736, 0.23844596667818097, 0.761554033321819, 0.7630382650858627]
compute_tune_4x4()/  0.23696173491413736 0.23844596667818097
compute_tunes()/ 0.23696173491413736 0.23844596667818097

 Running simulation ..
Closed orbit computation: x_co=[-7.06046195e-09  9.22483922e-09], y_co=[-1.75788075e-05  2.84667133e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.330395227561508e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.846845881035648e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.290693917716896e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.129479009987019e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.272838783306755e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.677195421625663e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008117940337609283}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00022700232604187784}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0015284772899651906}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.99467916e-03 -1.42742663e-05  1.03330361e-03  4.36627760e-04]
 [ 3.61190699e-05 -3.30259052e-04 -1.64067963e-04  2.62161775e-04]
 [-1.57551381e-03 -7.34119860e-04 -8.89753927e-04 -5.24667374e-04]
 [-5.91757463e-03  7.39527824e-04 -4.36808142e-04 -5.54072864e-04]
 [ 5.43089649e-03 -2.17139777e-04  3.05131974e-03 -4.99762822e-04]
 [-4.39463781e-03  1.30321446e-04 -1.57629025e-03  7.85659816e-04]
 [-1.04881168e-03  7.20890467e-04 -2.08269752e-03 -7.46041374e-04]
 [ 4.34785571e-03 -6.98370823e-04  8.97130319e-04  4.30749577e-04]
 [ 1.03455282e-04 -2.13970518e-04 -3.60706189e-04  3.58519185e-04]
 [ 1.94628107e-04 -3.40608860e-04 -9.85142301e-04 -3.20778636e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008117940337609283
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.335410776288361e-07, theta_kick=8.795433525536585e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.368115317066769e-07, theta_kick=-8.834647500482545e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00022700232604187784
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.167997831948646e-07, theta_kick=-6.196623853425308e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0008683569899215e-06, theta_kick=1.2000788190586012e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.878175087670206e-07, theta_kick=-7.048153104416695e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0015284772899651906
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.9894054086109624e-09, theta_kick=2.385371938997847e-10
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657502e-01 -6.31976351e+00  2.38246561e-03  2.67545779e-02]
 [ 1.80004881e-01  4.56113783e-01  2.44947202e-04  3.53465948e-03]
 [ 4.83296586e-03  2.67544357e-02  3.84066211e-01 -5.11948447e+00]
 [ 1.36592141e-03  7.94795647e-03  2.12571305e-01 -2.29797257e-01]]
compute_tune_4x4()/ evals =  [0.08183023+0.99664628j 0.08183023-0.99664628j 0.07253238+0.99736606j
 0.07253238-0.99736606j]
compute_tune_4x4()/ angles =  [0.23696173491413736, 0.23844596667818097, 0.761554033321819, 0.7630382650858627]
compute_tune_4x4()/  0.23696173491413736 0.23844596667818097
compute_tunes()/ 0.23696173491413736 0.23844596667818097

 Running simulation ..
Closed orbit computation: x_co=[-5.92906502e-11  2.41775410e-10], y_co=[1.55898953e-07 2.55965074e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.30568594e-05 -1.86577746e-04 -2.32068293e-03 -9.76013095e-04]
 [ 1.62077883e-04  1.94966893e-04 -3.62802516e-03  6.53046227e-05]
 [-4.44270462e-03  5.31686724e-04 -6.97964370e-04 -1.02903939e-03]
 [ 1.70749168e-03 -7.20498001e-04 -3.78718034e-03 -7.86616866e-04]
 [-4.43390809e-03  7.59345478e-04 -3.40111778e-04  5.22732675e-04]
 [-1.99289667e-03  2.12705921e-04 -4.49419618e-04 -6.68984665e-04]
 [-1.27225194e-03 -6.30132113e-05  7.23941876e-04  1.22775107e-04]
 [-7.42015113e-04  9.63746051e-05 -2.15391752e-03 -2.04765019e-04]
 [ 3.91574227e-03 -5.90834362e-04  3.87445379e-03  6.24593175e-04]
 [ 3.47322452e-04  2.92239787e-04 -4.11820779e-03  5.05699898e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016412202128963778
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.183047690361641e-06, theta_kick=-3.816593947224642e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-0.00012290032513589228, theta_kick=1.4736211412914611e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01661566414278056
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.030750505349566e-05, theta_kick=6.032059144716435e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3239430278319213e-06, theta_kick=1.5874575055202792e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6766565948747967e-05, theta_kick=3.2094119700850024e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004594197428889811
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.73004668283397e-06, theta_kick=9.268616826195319e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01611382e-01 -6.32117147e+00  9.74153344e-04  1.35975398e-01]
 [ 1.80089804e-01  4.56890839e-01  4.15631612e-03 -1.01581838e-02]
 [ 1.55323875e-02  1.35939142e-01  3.83845975e-01 -5.12083905e+00]
 [ 4.88167735e-03  5.70154872e-03  2.12642103e-01 -2.30120780e-01]]
compute_tune_4x4()/ evals =  [0.08027221+0.99677298j 0.08027221-0.99677298j 0.07423012+0.99724114j
 0.07423012-0.99724114j]
compute_tune_4x4()/ angles =  [0.2372105213004522, 0.2381750330636366, 0.7618249669363634, 0.7627894786995478]
compute_tune_4x4()/  0.2372105213004522 0.2381750330636366
compute_tunes()/ 0.2372105213004522 0.2381750330636366

 Running simulation ..
Closed orbit computation: x_co=[ 4.78047047e-07 -2.14845089e-08], y_co=[-6.97251116e-05  3.64309899e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.183047690361641e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -0.00012290032513589228, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.030750505349566e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.3239430278319213e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.6766565948747967e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.73004668283397e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.016412202128963778}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01661566414278056}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004594197428889811}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.30568594e-05 -1.86577746e-04 -2.32068293e-03 -9.76013095e-04]
 [ 1.62077883e-04  1.94966893e-04 -3.62802516e-03  6.53046227e-05]
 [-4.44270462e-03  5.31686724e-04 -6.97964370e-04 -1.02903939e-03]
 [ 1.70749168e-03 -7.20498001e-04 -3.78718034e-03 -7.86616866e-04]
 [-4.43390809e-03  7.59345478e-04 -3.40111778e-04  5.22732675e-04]
 [-1.99289667e-03  2.12705921e-04 -4.49419618e-04 -6.68984665e-04]
 [-1.27225194e-03 -6.30132113e-05  7.23941876e-04  1.22775107e-04]
 [-7.42015113e-04  9.63746051e-05 -2.15391752e-03 -2.04765019e-04]
 [ 3.91574227e-03 -5.90834362e-04  3.87445379e-03  6.24593175e-04]
 [ 3.47322452e-04  2.92239787e-04 -4.11820779e-03  5.05699898e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016412202128963778
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.411191276592627e-07, theta_kick=-4.090146691327065e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6712825130109962e-07, theta_kick=-2.003930617368618e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01661566414278056
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.9301624701325496e-07, theta_kick=3.5133750530209976e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.075787129872316e-07, theta_kick=-3.68798449937406e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.377061414300163e-07, theta_kick=-1.6511484495469448e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004594197428889811
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.529232695810803e-08, theta_kick=-9.027833299856262e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01611382e-01 -6.32117147e+00  9.74153344e-04  1.35975398e-01]
 [ 1.80089804e-01  4.56890839e-01  4.15631612e-03 -1.01581838e-02]
 [ 1.55323875e-02  1.35939142e-01  3.83845975e-01 -5.12083905e+00]
 [ 4.88167735e-03  5.70154872e-03  2.12642103e-01 -2.30120780e-01]]
compute_tune_4x4()/ evals =  [0.08027221+0.99677298j 0.08027221-0.99677298j 0.07423012+0.99724114j
 0.07423012-0.99724114j]
compute_tune_4x4()/ angles =  [0.2372105213004522, 0.2381750330636366, 0.7618249669363634, 0.7627894786995478]
compute_tune_4x4()/  0.2372105213004522 0.2381750330636366
compute_tunes()/ 0.2372105213004522 0.2381750330636366

 Running simulation ..
Closed orbit computation: x_co=[ 3.14170069e-09 -4.19291021e-10], y_co=[ 9.63707917e-08 -6.08086627e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.80813120e-04  2.52892925e-04  1.16784186e-03  5.06982356e-04]
 [-8.17313800e-04 -5.88672156e-04  1.06968601e-03  3.63472330e-04]
 [ 1.15638007e-03  3.35102622e-04 -2.19324726e-03 -5.09743893e-04]
 [ 1.51390091e-04 -4.66504667e-04 -6.95431825e-04  4.88521874e-04]
 [ 3.66604892e-03  5.36429437e-04  6.70224093e-04  4.40829713e-04]
 [ 2.93111599e-04  1.09958326e-05  2.90927113e-03  3.39395724e-05]
 [-1.68429507e-04  3.03435937e-04 -1.51920699e-03  4.21034858e-06]
 [ 4.07816368e-03 -2.67356917e-05  3.11553462e-04 -6.36781918e-04]
 [-4.13305784e-03  6.49367458e-05  6.38072657e-04 -1.66795049e-04]
 [ 2.92888331e-03 -1.40599887e-04 -1.81470504e-03 -7.25259642e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0062485047627032705
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.5994763499202852e-05, theta_kick=-1.9178323260187023e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8794496614001955e-05, theta_kick=-3.4525684872127822e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0014540212152096641
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.4718112758261496e-05, theta_kick=6.560907604026799e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7838497041830614e-05, theta_kick=-2.1389029150769733e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.396492570839474e-05, theta_kick=-1.1266748148197785e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01621649062043175
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.757965174174205e-05, theta_kick=-8.103054521428738e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01460528e-01 -6.31874558e+00  8.31748101e-03  3.72181530e-02]
 [ 1.80020283e-01  4.56197120e-01  1.05234736e-04  3.24275422e-03]
 [ 1.07768081e-02  3.72181055e-02  3.83877426e-01 -5.12040962e+00]
 [ 1.98343157e-03  8.98916163e-03  2.12533618e-01 -2.29975074e-01]]
compute_tune_4x4()/ evals =  [0.08495085+0.99638514j 0.08495085-0.99638514j 0.06936863+0.9975911j
 0.06936863-0.9975911j ]
compute_tune_4x4()/ angles =  [0.236463337854391, 0.23895076681879562, 0.7610492331812044, 0.763536662145609]
compute_tune_4x4()/  0.236463337854391 0.23895076681879562
compute_tunes()/ 0.236463337854391 0.23895076681879562

 Running simulation ..
Closed orbit computation: x_co=[-6.06405023e-08  3.23889612e-09], y_co=[4.32237775e-06 1.15264228e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.5994763499202852e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8794496614001955e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.4718112758261496e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.7838497041830614e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 9.396492570839474e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.757965174174205e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0062485047627032705}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0014540212152096641}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.01621649062043175}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.80813120e-04  2.52892925e-04  1.16784186e-03  5.06982356e-04]
 [-8.17313800e-04 -5.88672156e-04  1.06968601e-03  3.63472330e-04]
 [ 1.15638007e-03  3.35102622e-04 -2.19324726e-03 -5.09743893e-04]
 [ 1.51390091e-04 -4.66504667e-04 -6.95431825e-04  4.88521874e-04]
 [ 3.66604892e-03  5.36429437e-04  6.70224093e-04  4.40829713e-04]
 [ 2.93111599e-04  1.09958326e-05  2.90927113e-03  3.39395724e-05]
 [-1.68429507e-04  3.03435937e-04 -1.51920699e-03  4.21034858e-06]
 [ 4.07816368e-03 -2.67356917e-05  3.11553462e-04 -6.36781918e-04]
 [-4.13305784e-03  6.49367458e-05  6.38072657e-04 -1.66795049e-04]
 [ 2.92888331e-03 -1.40599887e-04 -1.81470504e-03 -7.25259642e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0062485047627032705
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.665079928307728e-07, theta_kick=-9.190719243056215e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.4298954612549113e-07, theta_kick=5.3116113388620056e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0014540212152096641
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.521298841511545e-07, theta_kick=6.62024505732028e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.108925219521001e-07, theta_kick=-1.092194407385581e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.8453054468834316e-08, theta_kick=4.610665915639438e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01621649062043175
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.336471408874118e-08, theta_kick=-4.000554758496335e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01460528e-01 -6.31874558e+00  8.31748101e-03  3.72181530e-02]
 [ 1.80020283e-01  4.56197120e-01  1.05234736e-04  3.24275422e-03]
 [ 1.07768081e-02  3.72181055e-02  3.83877426e-01 -5.12040962e+00]
 [ 1.98343157e-03  8.98916163e-03  2.12533618e-01 -2.29975074e-01]]
compute_tune_4x4()/ evals =  [0.08495085+0.99638514j 0.08495085-0.99638514j 0.06936863+0.9975911j
 0.06936863-0.9975911j ]
compute_tune_4x4()/ angles =  [0.236463337854391, 0.23895076681879562, 0.7610492331812044, 0.763536662145609]
compute_tune_4x4()/  0.236463337854391 0.23895076681879562
compute_tunes()/ 0.236463337854391 0.23895076681879562

 Running simulation ..
Closed orbit computation: x_co=[-4.99016063e-10 -7.81462325e-11], y_co=[4.16855635e-08 3.70853257e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 15/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.71825798e-03  1.19991007e-04  1.01898123e-03 -2.32063103e-04]
 [ 2.11189696e-03 -7.98900905e-04  1.34886884e-03 -3.78966456e-04]
 [ 2.18760852e-04 -1.61218011e-04  1.91145704e-03  1.06043610e-03]
 [ 6.77072588e-04  7.57858607e-05  4.83711598e-05 -1.02835865e-03]
 [-1.59013481e-04  2.03468293e-04  6.51582845e-03  2.24219005e-04]
 [ 4.29858753e-03  3.29908275e-04  1.09793068e-03  1.01248597e-03]
 [-5.65694559e-03  1.71563684e-04 -3.10793153e-03  1.65532115e-04]
 [-1.00366362e-03  6.41632731e-04  2.74266655e-03 -4.13733058e-04]
 [ 2.93836848e-03 -9.01745852e-05  2.05471464e-03 -7.29557413e-04]
 [-9.23836417e-04 -2.09391691e-04  1.41059107e-03  1.48151825e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011144044871116943
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.9830420998484666e-05, theta_kick=-4.7758173450726574e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.908802519804e-05, theta_kick=1.0681989427007468e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0008301827751916799
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.690308821520096e-05, theta_kick=-2.026743877161659e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.149561691400706e-05, theta_kick=-6.174518227223567e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.1158228128621964e-05, theta_kick=-6.134064042384886e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0012454629664380842
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.5782769032934925e-05, theta_kick=5.489526270919015e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01608153e-01 -6.31950537e+00 -4.06118247e-03 -3.87587903e-02]
 [ 1.80007727e-01  4.56129601e-01 -2.69308108e-04 -5.67452033e-03]
 [-7.49540766e-03 -3.87590722e-02  3.84046050e-01 -5.11970507e+00]
 [-2.03358263e-03 -1.21977331e-02  2.12564706e-01 -2.29871413e-01]]
compute_tune_4x4()/ evals =  [0.0844911 +0.99642423j 0.0844911 -0.99642423j 0.06985695+0.99755702j
 0.06985695-0.99755702j]
compute_tune_4x4()/ angles =  [0.23653677352036828, 0.23887285902125532, 0.7611271409787447, 0.7634632264796317]
compute_tune_4x4()/  0.23653677352036828 0.23887285902125532
compute_tunes()/ 0.23653677352036828 0.23887285902125532

 Running simulation ..
Closed orbit computation: x_co=[ 2.81464409e-08 -7.15370304e-08], y_co=[3.40393056e-05 6.01638578e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.9830420998484666e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.908802519804e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.690308821520096e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.149561691400706e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.1158228128621964e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.5782769032934925e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.011144044871116943}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0008301827751916799}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0012454629664380842}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.71825798e-03  1.19991007e-04  1.01898123e-03 -2.32063103e-04]
 [ 2.11189696e-03 -7.98900905e-04  1.34886884e-03 -3.78966456e-04]
 [ 2.18760852e-04 -1.61218011e-04  1.91145704e-03  1.06043610e-03]
 [ 6.77072588e-04  7.57858607e-05  4.83711598e-05 -1.02835865e-03]
 [-1.59013481e-04  2.03468293e-04  6.51582845e-03  2.24219005e-04]
 [ 4.29858753e-03  3.29908275e-04  1.09793068e-03  1.01248597e-03]
 [-5.65694559e-03  1.71563684e-04 -3.10793153e-03  1.65532115e-04]
 [-1.00366362e-03  6.41632731e-04  2.74266655e-03 -4.13733058e-04]
 [ 2.93836848e-03 -9.01745852e-05  2.05471464e-03 -7.29557413e-04]
 [-9.23836417e-04 -2.09391691e-04  1.41059107e-03  1.48151825e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011144044871116943
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.941166726414364e-07, theta_kick=-5.924644823062097e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.154272443336832e-06, theta_kick=2.583053716979671e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0008301827751916799
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.3918404714649383e-06, theta_kick=-4.0669443478787107e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.735394831280043e-06, theta_kick=3.279841325640603e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.325430897702141e-06, theta_kick=-1.589241517477792e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0012454629664380842
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.2482397793257797e-07, theta_kick=5.0937993411878774e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01608153e-01 -6.31950537e+00 -4.06118247e-03 -3.87587903e-02]
 [ 1.80007727e-01  4.56129601e-01 -2.69308108e-04 -5.67452033e-03]
 [-7.49540766e-03 -3.87590722e-02  3.84046050e-01 -5.11970507e+00]
 [-2.03358263e-03 -1.21977331e-02  2.12564706e-01 -2.29871413e-01]]
compute_tune_4x4()/ evals =  [0.0844911 +0.99642423j 0.0844911 -0.99642423j 0.06985695+0.99755702j
 0.06985695-0.99755702j]
compute_tune_4x4()/ angles =  [0.23653677352036828, 0.23887285902125532, 0.7611271409787447, 0.7634632264796317]
compute_tune_4x4()/  0.23653677352036828 0.23887285902125532
compute_tunes()/ 0.23653677352036828 0.23887285902125532

 Running simulation ..
Closed orbit computation: x_co=[-3.86188148e-10 -1.99349031e-10], y_co=[1.81335329e-07 1.61819821e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 16/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.33713682e-03  2.61941266e-04 -2.09209755e-03  2.16061032e-04]
 [ 1.77586141e-03 -2.63188931e-04  3.35590532e-04 -2.10546102e-04]
 [-1.47354297e-03 -1.88096693e-04  1.16601462e-03 -1.42439271e-05]
 [ 6.47929828e-03 -7.40795520e-04  5.93039396e-03  1.80942858e-04]
 [-4.51877178e-03 -8.13475387e-05  1.25253220e-03  1.28211842e-03]
 [-5.69256952e-03 -5.63491296e-04  1.87274263e-03  5.30630046e-04]
 [-4.87740458e-03 -7.72208070e-05  2.31571275e-04  2.92360926e-05]
 [ 2.07379666e-03 -5.17619027e-04 -6.32000237e-04 -2.34551231e-04]
 [ 4.19809468e-03 -2.19006906e-05 -1.16536454e-03 -4.04056630e-04]
 [-1.07334602e-03 -1.86834638e-04 -1.33640445e-03  1.27926595e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011861201278518266
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.5398618702723376e-05, theta_kick=-1.846352321845264e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.168587148030914e-06, theta_kick=-8.595405718290917e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0013733545382597536
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.0745805641660158e-05, theta_kick=1.2884625289843824e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.364408051006067e-05, theta_kick=6.432127096275701e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.1390416303805445e-05, theta_kick=-1.3657537728105361e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.017225472444901378
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.2885304931738373e-05, theta_kick=-2.7440341703752284e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01271538e-01 -6.31775905e+00 -1.60769925e-02 -1.16999775e-01]
 [ 1.80028142e-01  4.56237025e-01 -9.47003245e-04 -1.16693664e-02]
 [-2.57181988e-02 -1.16993494e-01  3.83848812e-01 -5.12063118e+00]
 [-5.95558526e-03 -3.00788513e-02  2.12521124e-01 -2.30088255e-01]]
compute_tune_4x4()/ evals =  [0.09795438+0.99519091j 0.09795438-0.99519091j 0.05640864+0.99840777j
 0.05640864-0.99840777j]
compute_tune_4x4()/ angles =  [0.23438503623436285, 0.24101751853818867, 0.7589824814618114, 0.7656149637656371]
compute_tune_4x4()/  0.23438503623436285 0.24101751853818867
compute_tunes()/ 0.23438503623436285 0.24101751853818867

 Running simulation ..
Closed orbit computation: x_co=[5.55263073e-09 1.66140579e-08], y_co=[-3.03565233e-05 -2.30059708e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.5398618702723376e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.168587148030914e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.0745805641660158e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.364408051006067e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.1390416303805445e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.2885304931738373e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.011861201278518266}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0013733545382597536}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.017225472444901378}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.33713682e-03  2.61941266e-04 -2.09209755e-03  2.16061032e-04]
 [ 1.77586141e-03 -2.63188931e-04  3.35590532e-04 -2.10546102e-04]
 [-1.47354297e-03 -1.88096693e-04  1.16601462e-03 -1.42439271e-05]
 [ 6.47929828e-03 -7.40795520e-04  5.93039396e-03  1.80942858e-04]
 [-4.51877178e-03 -8.13475387e-05  1.25253220e-03  1.28211842e-03]
 [-5.69256952e-03 -5.63491296e-04  1.87274263e-03  5.30630046e-04]
 [-4.87740458e-03 -7.72208070e-05  2.31571275e-04  2.92360926e-05]
 [ 2.07379666e-03 -5.17619027e-04 -6.32000237e-04 -2.34551231e-04]
 [ 4.19809468e-03 -2.19006906e-05 -1.16536454e-03 -4.04056630e-04]
 [-1.07334602e-03 -1.86834638e-04 -1.33640445e-03  1.27926595e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.011861201278518266
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.370639066512589e-07, theta_kick=4.041523065609264e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.148356190518677e-07, theta_kick=-3.7749975335982546e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0013733545382597536
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.651669001795059e-07, theta_kick=4.378488532144937e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.028131277995225e-07, theta_kick=-4.829880966212025e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.5761603752160747e-07, theta_kick=3.0889132214078e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.017225472444901378
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.9050719642635104e-07, theta_kick=-2.2842529660651722e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01271538e-01 -6.31775905e+00 -1.60769925e-02 -1.16999775e-01]
 [ 1.80028142e-01  4.56237025e-01 -9.47003245e-04 -1.16693664e-02]
 [-2.57181988e-02 -1.16993494e-01  3.83848812e-01 -5.12063118e+00]
 [-5.95558526e-03 -3.00788513e-02  2.12521124e-01 -2.30088255e-01]]
compute_tune_4x4()/ evals =  [0.09795438+0.99519091j 0.09795438-0.99519091j 0.05640864+0.99840777j
 0.05640864-0.99840777j]
compute_tune_4x4()/ angles =  [0.23438503623436285, 0.24101751853818867, 0.7589824814618114, 0.7656149637656371]
compute_tune_4x4()/  0.23438503623436285 0.24101751853818867
compute_tunes()/ 0.23438503623436285 0.24101751853818867

 Running simulation ..
Closed orbit computation: x_co=[ 7.90370017e-11 -3.63675063e-10], y_co=[-2.45386547e-08  2.59683679e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 17/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.19799362e-03 -5.62778289e-04 -4.74174073e-04  3.13164287e-04]
 [ 4.27820761e-03 -1.59189394e-03 -1.58650760e-03  3.37834592e-04]
 [-1.90427879e-03  4.14310099e-05  9.07689579e-04 -1.00328359e-05]
 [ 2.60513676e-03 -2.94239534e-04 -4.78287027e-03 -6.86569830e-04]
 [-2.13123303e-03  1.52911380e-04 -6.92531154e-04  6.80002826e-04]
 [-2.75087137e-03  6.47562925e-04 -5.75231154e-03 -2.26192613e-04]
 [ 4.47317275e-04 -1.35015737e-04 -4.23927478e-04 -4.33497643e-04]
 [ 1.39561951e-03 -4.13957139e-04 -4.95143016e-04  7.16293652e-05]
 [ 5.15917863e-03 -4.49233632e-04  4.74022101e-03  8.73960544e-05]
 [ 3.23520493e-03  2.20167766e-04  1.75790738e-03  3.02064850e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035105169697791073
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.125489693386609e-06, theta_kick=9.742767874926864e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.908819731610295e-05, theta_kick=-3.4877843064833677e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008360313548844726
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.9540978471973427e-05, theta_kick=-2.343036844368092e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.8321794838940895e-05, theta_kick=5.793965018487656e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.179210136652611e-05, theta_kick=-8.608143081352669e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00416514892558683
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.104632904056362e-05, theta_kick=4.921609294336637e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01651058e-01 -6.32029752e+00  3.02509086e-03 -2.71514093e-02]
 [ 1.79991916e-01  4.56114982e-01 -1.65764580e-03  9.95547927e-03]
 [-4.95988401e-04 -2.71587697e-02  3.84088370e-01 -5.11925710e+00]
 [-3.90287068e-04  8.65236701e-03  2.12592541e-01 -2.29897570e-01]]
compute_tune_4x4()/ evals =  [0.08241941+0.99659773j 0.08241941-0.99659773j 0.07190795+0.99741127j
 0.07190795-0.99741127j]
compute_tune_4x4()/ angles =  [0.23686764672776836, 0.2385456083200869, 0.7614543916799131, 0.7631323532722316]
compute_tune_4x4()/  0.23686764672776836 0.2385456083200869
compute_tunes()/ 0.23686764672776836 0.2385456083200869

 Running simulation ..
Closed orbit computation: x_co=[ 1.24414156e-07 -1.07775530e-09], y_co=[2.78550160e-05 2.93709472e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.125489693386609e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.908819731610295e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.9540978471973427e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.8321794838940895e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.179210136652611e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.104632904056362e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0035105169697791073}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.008360313548844726}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00416514892558683}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.19799362e-03 -5.62778289e-04 -4.74174073e-04  3.13164287e-04]
 [ 4.27820761e-03 -1.59189394e-03 -1.58650760e-03  3.37834592e-04]
 [-1.90427879e-03  4.14310099e-05  9.07689579e-04 -1.00328359e-05]
 [ 2.60513676e-03 -2.94239534e-04 -4.78287027e-03 -6.86569830e-04]
 [-2.13123303e-03  1.52911380e-04 -6.92531154e-04  6.80002826e-04]
 [-2.75087137e-03  6.47562925e-04 -5.75231154e-03 -2.26192613e-04]
 [ 4.47317275e-04 -1.35015737e-04 -4.23927478e-04 -4.33497643e-04]
 [ 1.39561951e-03 -4.13957139e-04 -4.95143016e-04  7.16293652e-05]
 [ 5.15917863e-03 -4.49233632e-04  4.74022101e-03  8.73960544e-05]
 [ 3.23520493e-03  2.20167766e-04  1.75790738e-03  3.02064850e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035105169697791073
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4377801630633125e-07, theta_kick=-1.7239525139391317e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.742743556487498e-07, theta_kick=1.0482878481797548e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008360313548844726
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.632722577000789e-07, theta_kick=-1.1549996814059174e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.491704545618805e-07, theta_kick=6.584760383019415e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5233148130275537e-07, theta_kick=-1.8265117776033252e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00416514892558683
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.0721922044739788e-07, theta_kick=-2.4846364222029388e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01651058e-01 -6.32029752e+00  3.02509086e-03 -2.71514093e-02]
 [ 1.79991916e-01  4.56114982e-01 -1.65764580e-03  9.95547927e-03]
 [-4.95988401e-04 -2.71587697e-02  3.84088370e-01 -5.11925710e+00]
 [-3.90287068e-04  8.65236701e-03  2.12592541e-01 -2.29897570e-01]]
compute_tune_4x4()/ evals =  [0.08241941+0.99659773j 0.08241941-0.99659773j 0.07190795+0.99741127j
 0.07190795-0.99741127j]
compute_tune_4x4()/ angles =  [0.23686764672776836, 0.2385456083200869, 0.7614543916799131, 0.7631323532722316]
compute_tune_4x4()/  0.23686764672776836 0.2385456083200869
compute_tunes()/ 0.23686764672776836 0.2385456083200869

 Running simulation ..
Closed orbit computation: x_co=[ 2.58423544e-10 -5.33611298e-11], y_co=[-7.41887842e-08  3.40785497e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 18/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.22833637e-03  2.62217614e-04  7.33611487e-04 -2.32868146e-04]
 [-4.03662917e-03 -1.62912759e-04 -5.18048103e-04 -8.08565404e-04]
 [ 3.89770924e-04 -2.67629355e-04 -2.35446506e-03 -4.51688209e-04]
 [-7.32025320e-04 -3.56423418e-04  1.18262637e-03  6.54169070e-04]
 [-2.17026913e-03  5.60767192e-04 -2.32652524e-03  4.76935604e-04]
 [-1.99501190e-04  7.84248520e-05  5.88096963e-03  3.40248166e-04]
 [-3.18004684e-03 -2.98987267e-05  4.16246180e-03  2.74984030e-04]
 [ 5.87842425e-04  4.68573886e-04 -2.25136564e-03 -7.43933636e-04]
 [ 1.71119512e-03 -3.84149708e-04  2.66529032e-03  7.56297754e-04]
 [ 2.40088755e-03  2.22667729e-06  2.20318648e-04  8.02239866e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011720836246170142
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.011906614907111e-05, theta_kick=-8.407539863758182e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.799839918571357e-05, theta_kick=1.0551339168264059e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0019165878784043772
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.14925597526161e-05, theta_kick=7.373189288424383e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.425594510630342e-06, theta_kick=-4.107416710879476e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.163436009398271e-05, theta_kick=-8.58922930925181e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0025318388841523527
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.6071454267286542e-05, theta_kick=3.126065464025917e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01619648e-01 -6.31952838e+00  2.10546731e-03  4.38342282e-02]
 [ 1.80017292e-01  4.56188317e-01  7.80580688e-04  2.46425220e-03]
 [ 6.46144156e-03  4.38313783e-02  3.84019413e-01 -5.11984382e+00]
 [ 1.97650212e-03  8.91520292e-03  2.12564668e-01 -2.29855242e-01]]
compute_tune_4x4()/ evals =  [0.08214334+0.99662053j 0.08214334-0.99662053j 0.07222308+0.9973885j
 0.07222308-0.9973885j ]
compute_tune_4x4()/ angles =  [0.23691173475233204, 0.23849532281099067, 0.7615046771890093, 0.7630882652476679]
compute_tune_4x4()/  0.23691173475233204 0.23849532281099067
compute_tunes()/ 0.23691173475233204 0.23849532281099067

 Running simulation ..
Closed orbit computation: x_co=[ 7.78021153e-08 -1.81826095e-08], y_co=[-2.38848531e-05  3.61876472e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.011906614907111e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.799839918571357e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.14925597526161e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.425594510630342e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.163436009398271e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.6071454267286542e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011720836246170142}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0019165878784043772}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0025318388841523527}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.22833637e-03  2.62217614e-04  7.33611487e-04 -2.32868146e-04]
 [-4.03662917e-03 -1.62912759e-04 -5.18048103e-04 -8.08565404e-04]
 [ 3.89770924e-04 -2.67629355e-04 -2.35446506e-03 -4.51688209e-04]
 [-7.32025320e-04 -3.56423418e-04  1.18262637e-03  6.54169070e-04]
 [-2.17026913e-03  5.60767192e-04 -2.32652524e-03  4.76935604e-04]
 [-1.99501190e-04  7.84248520e-05  5.88096963e-03  3.40248166e-04]
 [-3.18004684e-03 -2.98987267e-05  4.16246180e-03  2.74984030e-04]
 [ 5.87842425e-04  4.68573886e-04 -2.25136564e-03 -7.43933636e-04]
 [ 1.71119512e-03 -3.84149708e-04  2.66529032e-03  7.56297754e-04]
 [ 2.40088755e-03  2.22667729e-06  2.20318648e-04  8.02239866e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011720836246170142
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.6223329741532713e-07, theta_kick=-3.144275904840078e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.107482404280878e-08, theta_kick=3.7259883259675595e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0019165878784043772
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.108816981287692e-07, theta_kick=-7.32470141307773e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3049111689872938e-06, theta_kick=1.5646375906661018e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0327747728543387e-06, theta_kick=-1.2383358122021542e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0025318388841523527
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.5603727147806016e-07, theta_kick=4.269020848868136e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01619648e-01 -6.31952838e+00  2.10546731e-03  4.38342282e-02]
 [ 1.80017292e-01  4.56188317e-01  7.80580688e-04  2.46425220e-03]
 [ 6.46144156e-03  4.38313783e-02  3.84019413e-01 -5.11984382e+00]
 [ 1.97650212e-03  8.91520292e-03  2.12564668e-01 -2.29855242e-01]]
compute_tune_4x4()/ evals =  [0.08214334+0.99662053j 0.08214334-0.99662053j 0.07222308+0.9973885j
 0.07222308-0.9973885j ]
compute_tune_4x4()/ angles =  [0.23691173475233204, 0.23849532281099067, 0.7615046771890093, 0.7630882652476679]
compute_tune_4x4()/  0.23691173475233204 0.23849532281099067
compute_tunes()/ 0.23691173475233204 0.23849532281099067

 Running simulation ..
Closed orbit computation: x_co=[ 3.93425365e-11 -1.29606063e-10], y_co=[ 7.99447597e-08 -2.48784478e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 19/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.86623942e-03 -2.82358468e-04 -3.62807797e-03 -1.15372895e-03]
 [ 1.44459817e-04 -2.01511529e-04  2.47683552e-03  1.37425670e-05]
 [ 2.44333581e-03 -3.81341271e-04 -6.11227964e-04 -4.21532068e-04]
 [ 2.65029440e-03 -3.59334692e-04  3.67706542e-04  2.05454392e-04]
 [ 2.28828021e-03 -1.68396320e-04  5.17920085e-04 -5.66274829e-05]
 [ 1.13576336e-04 -4.33819920e-04 -3.70814662e-03 -3.35620788e-04]
 [ 1.78056234e-04 -7.40144405e-05 -2.36530352e-03 -1.08787689e-03]
 [-7.17847138e-04  2.90501854e-04 -5.82673557e-04 -2.67286013e-04]
 [ 3.06703099e-03 -1.97465063e-04 -4.36038394e-03  5.96075924e-04]
 [-1.69586357e-04  3.57830904e-04  9.32588998e-04 -1.07785847e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004368231911176268
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.938765432370135e-05, theta_kick=4.722727954796547e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.0814640106193647e-05, theta_kick=2.495753666635522e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007166585829003012
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.0001405278046719057, theta_kick=1.6849812535062153e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.669196918383363e-05, theta_kick=6.797580416355074e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.984036956648235e-05, theta_kick=-2.3789349630992596e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01259592221688136
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.9875028454614966e-05, theta_kick=5.980203573258854e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01505795e-01 -6.32009718e+00 -2.46885015e-03 -5.51582580e-02]
 [ 1.80001847e-01  4.56101440e-01 -1.73021655e-03  6.68515623e-03]
 [-7.98477037e-03 -5.51859345e-02  3.84065299e-01 -5.12030788e+00]
 [-1.90423221e-03  8.58327171e-04  2.12581870e-01 -2.30098066e-01]]
compute_tune_4x4()/ evals =  [0.07788014+0.99696273j 0.07788014-0.99696273j 0.0764013 +0.99707715j
 0.0764013 -0.99707715j]
compute_tune_4x4()/ angles =  [0.23759242658108592, 0.23782849473254852, 0.7621715052674515, 0.7624075734189141]
compute_tune_4x4()/  0.23759242658108592 0.23782849473254852
compute_tunes()/ 0.23759242658108592 0.23782849473254852

 Running simulation ..
Closed orbit computation: x_co=[-3.29462560e-07 -1.97427369e-07], y_co=[-8.40741254e-05  1.18718984e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.938765432370135e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.0814640106193647e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.0001405278046719057, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.669196918383363e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.984036956648235e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.9875028454614966e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004368231911176268}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007166585829003012}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01259592221688136}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.86623942e-03 -2.82358468e-04 -3.62807797e-03 -1.15372895e-03]
 [ 1.44459817e-04 -2.01511529e-04  2.47683552e-03  1.37425670e-05]
 [ 2.44333581e-03 -3.81341271e-04 -6.11227964e-04 -4.21532068e-04]
 [ 2.65029440e-03 -3.59334692e-04  3.67706542e-04  2.05454392e-04]
 [ 2.28828021e-03 -1.68396320e-04  5.17920085e-04 -5.66274829e-05]
 [ 1.13576336e-04 -4.33819920e-04 -3.70814662e-03 -3.35620788e-04]
 [ 1.78056234e-04 -7.40144405e-05 -2.36530352e-03 -1.08787689e-03]
 [-7.17847138e-04  2.90501854e-04 -5.82673557e-04 -2.67286013e-04]
 [ 3.06703099e-03 -1.97465063e-04 -4.36038394e-03  5.96075924e-04]
 [-1.69586357e-04  3.57830904e-04  9.32588998e-04 -1.07785847e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004368231911176268
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.930459496913734e-07, theta_kick=-8.309881704725983e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.4252756927422438e-06, theta_kick=2.9079968098811135e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007166585829003012
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8124020331280744e-06, theta_kick=-3.372175858156674e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.6924926232093115e-06, theta_kick=2.029362337555525e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.359760279523648e-07, theta_kick=-7.62559186974416e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01259592221688136
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.526555558761344e-07, theta_kick=3.029435180030165e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01505795e-01 -6.32009718e+00 -2.46885015e-03 -5.51582580e-02]
 [ 1.80001847e-01  4.56101440e-01 -1.73021655e-03  6.68515623e-03]
 [-7.98477037e-03 -5.51859345e-02  3.84065299e-01 -5.12030788e+00]
 [-1.90423221e-03  8.58327171e-04  2.12581870e-01 -2.30098066e-01]]
compute_tune_4x4()/ evals =  [0.07788014+0.99696273j 0.07788014-0.99696273j 0.0764013 +0.99707715j
 0.0764013 -0.99707715j]
compute_tune_4x4()/ angles =  [0.23759242658108592, 0.23782849473254852, 0.7621715052674515, 0.7624075734189141]
compute_tune_4x4()/  0.23759242658108592 0.23782849473254852
compute_tunes()/ 0.23759242658108592 0.23782849473254852

 Running simulation ..
Closed orbit computation: x_co=[ 3.35867489e-09 -5.53062308e-10], y_co=[6.69531331e-08 1.93110059e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 20/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.95512683e-04  3.49857486e-04  3.88079820e-03  1.07092330e-03]
 [-1.82727882e-04 -3.14021326e-04 -6.81908329e-04  2.70020089e-04]
 [-6.63191312e-04 -5.20543581e-04  2.56043512e-03  8.37345898e-04]
 [ 7.82946854e-04  1.14087619e-05  2.76264182e-03 -1.30752239e-04]
 [-2.26254933e-04  1.60025383e-04  2.99221170e-04  4.59633449e-04]
 [-3.24281521e-03 -4.91918639e-04 -1.30939047e-03 -6.48651571e-04]
 [ 1.37675611e-03 -6.39549622e-04 -9.07062571e-04  1.58248432e-04]
 [-4.80356912e-04 -6.55103095e-04 -2.68108094e-03 -1.05905137e-04]
 [-1.78724297e-03  9.03922364e-04  2.34847949e-03  1.33103487e-04]
 [-7.15352769e-04 -4.13331257e-04  1.63929139e-03 -8.69995259e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00784482565104027
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.7624418731024994e-05, theta_kick=3.3122717464673134e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.863756956469875e-05, theta_kick=5.831827596251203e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0019559343066907196
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.710516318381958e-05, theta_kick=-9.245199184360939e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.2856876631376132e-05, theta_kick=-2.7406255101964647e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.374102069450404e-06, theta_kick=-2.8466377100773026e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00020971207648762106
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.790591475105764e-06, theta_kick=-5.744099431145289e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01671828e-01 -6.31985191e+00  2.25115332e-03  3.92311682e-02]
 [ 1.80009054e-01  4.56141386e-01  7.32182392e-04  1.40578339e-03]
 [ 6.08031007e-03  3.92301877e-02  3.84063731e-01 -5.11948601e+00]
 [ 1.73516355e-03  6.99159328e-03  2.12574713e-01 -2.29773605e-01]]
compute_tune_4x4()/ evals =  [0.08134928+0.99668565j 0.08134928-0.99668565j 0.07303056+0.9973297j
 0.07303056-0.9973297j ]
compute_tune_4x4()/ angles =  [0.23703853710210665, 0.23836646837807476, 0.7616335316219253, 0.7629614628978933]
compute_tune_4x4()/  0.23703853710210665 0.23836646837807476
compute_tunes()/ 0.23703853710210665 0.23836646837807476

 Running simulation ..
Closed orbit computation: x_co=[-8.50565983e-08  6.51544338e-08], y_co=[3.13418728e-05 7.33074491e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.7624418731024994e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.863756956469875e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.710516318381958e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.2856876631376132e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.374102069450404e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.790591475105764e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00784482565104027}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0019559343066907196}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00020971207648762106}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.95512683e-04  3.49857486e-04  3.88079820e-03  1.07092330e-03]
 [-1.82727882e-04 -3.14021326e-04 -6.81908329e-04  2.70020089e-04]
 [-6.63191312e-04 -5.20543581e-04  2.56043512e-03  8.37345898e-04]
 [ 7.82946854e-04  1.14087619e-05  2.76264182e-03 -1.30752239e-04]
 [-2.26254933e-04  1.60025383e-04  2.99221170e-04  4.59633449e-04]
 [-3.24281521e-03 -4.91918639e-04 -1.30939047e-03 -6.48651571e-04]
 [ 1.37675611e-03 -6.39549622e-04 -9.07062571e-04  1.58248432e-04]
 [-4.80356912e-04 -6.55103095e-04 -2.68108094e-03 -1.05905137e-04]
 [-1.78724297e-03  9.03922364e-04  2.34847949e-03  1.33103487e-04]
 [-7.15352769e-04 -4.13331257e-04  1.63929139e-03 -8.69995259e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00784482565104027
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.172897699433773e-07, theta_kick=9.799611857967858e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.141049689831925e-07, theta_kick=-8.562387269776164e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0019559343066907196
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.922009829319234e-07, theta_kick=1.189686311441372e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7446524278417076e-06, theta_kick=-2.0919039058930718e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5112483825871243e-06, theta_kick=1.81204367348946e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00020971207648762106
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.774082114572298e-07, theta_kick=-1.0520454592096921e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01671828e-01 -6.31985191e+00  2.25115332e-03  3.92311682e-02]
 [ 1.80009054e-01  4.56141386e-01  7.32182392e-04  1.40578339e-03]
 [ 6.08031007e-03  3.92301877e-02  3.84063731e-01 -5.11948601e+00]
 [ 1.73516355e-03  6.99159328e-03  2.12574713e-01 -2.29773605e-01]]
compute_tune_4x4()/ evals =  [0.08134928+0.99668565j 0.08134928-0.99668565j 0.07303056+0.9973297j
 0.07303056-0.9973297j ]
compute_tune_4x4()/ angles =  [0.23703853710210665, 0.23836646837807476, 0.7616335316219253, 0.7629614628978933]
compute_tune_4x4()/  0.23703853710210665 0.23836646837807476
compute_tunes()/ 0.23703853710210665 0.23836646837807476

 Running simulation ..
Closed orbit computation: x_co=[1.10519654e-10 2.11118612e-10], y_co=[-1.39832124e-07  5.44815119e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 21/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.27383147e-03 -1.05058654e-03  1.94352486e-03 -1.63859617e-04]
 [ 2.61246314e-03 -6.87979521e-04 -4.24466549e-04  3.01475916e-05]
 [-1.72543380e-03 -1.71692836e-05  2.27316563e-03  1.12341174e-04]
 [ 4.34950106e-03  4.23343974e-04 -1.77088538e-03 -4.44849883e-05]
 [-3.54084136e-03  2.41651290e-04  2.65550072e-03 -2.07049677e-04]
 [-2.31759852e-03  7.29200455e-05 -3.36423719e-03 -2.42907691e-04]
 [-3.59336011e-03  3.23092245e-04  2.64224585e-03 -1.00189562e-04]
 [ 4.16547501e-03  1.02337421e-04 -1.24323226e-03  3.84905461e-04]
 [ 2.16239848e-03 -1.12110112e-04  1.12991075e-03  2.37121972e-04]
 [ 7.45002947e-04  4.94748973e-05 -1.54627903e-03 -3.14648245e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.028771974109941725
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.758875069110912e-05, theta_kick=6.905107893339302e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.4722834410044675e-06, theta_kick=-7.760511374196034e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008038882330531683
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.916717077999487e-05, theta_kick=-7.094366401016098e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.558106673686413e-06, theta_kick=-9.062454285751648e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5040448543509099e-06, theta_kick=-1.803406372091731e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010563264226474765
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1583236427450514e-05, theta_kick=-1.3888736311474141e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00836924e-01 -6.31644439e+00  8.89584260e-03  5.22362183e-02]
 [ 1.80009489e-01  4.56166461e-01 -7.60559275e-04  1.93416012e-02]
 [ 1.28762888e-02  5.22231157e-02  3.83798694e-01 -5.12301421e+00]
 [ 3.55239610e-03  3.08556122e-02  2.12478673e-01 -2.31222910e-01]]
compute_tune_4x4()/ evals =  [0.09488345+0.99548839j 0.09488345-0.99548839j 0.05906921+0.99825389j
 0.05906921-0.99825389j]
compute_tune_4x4()/ angles =  [0.23487607803838406, 0.2405933681253488, 0.7594066318746512, 0.7651239219616159]
compute_tune_4x4()/  0.23487607803838406 0.2405933681253488
compute_tunes()/ 0.23487607803838406 0.2405933681253488

 Running simulation ..
Closed orbit computation: x_co=[1.54177344e-07 1.75866494e-07], y_co=[2.95420720e-05 6.50952337e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.758875069110912e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.4722834410044675e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.916717077999487e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.558106673686413e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.5040448543509099e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.1583236427450514e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.028771974109941725}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.008038882330531683}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010563264226474765}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.27383147e-03 -1.05058654e-03  1.94352486e-03 -1.63859617e-04]
 [ 2.61246314e-03 -6.87979521e-04 -4.24466549e-04  3.01475916e-05]
 [-1.72543380e-03 -1.71692836e-05  2.27316563e-03  1.12341174e-04]
 [ 4.34950106e-03  4.23343974e-04 -1.77088538e-03 -4.44849883e-05]
 [-3.54084136e-03  2.41651290e-04  2.65550072e-03 -2.07049677e-04]
 [-2.31759852e-03  7.29200455e-05 -3.36423719e-03 -2.42907691e-04]
 [-3.59336011e-03  3.23092245e-04  2.64224585e-03 -1.00189562e-04]
 [ 4.16547501e-03  1.02337421e-04 -1.24323226e-03  3.84905461e-04]
 [ 2.16239848e-03 -1.12110112e-04  1.12991075e-03  2.37121972e-04]
 [ 7.45002947e-04  4.94748973e-05 -1.54627903e-03 -3.14648245e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.028771974109941725
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.021674824387144e-07, theta_kick=-6.0211770617577e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.800063925547215e-07, theta_kick=9.352570134702101e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008038882330531683
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.535935562215542e-08, theta_kick=-6.637795036170817e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.951715219562147e-07, theta_kick=-8.335368115956788e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.644691954735338e-07, theta_kick=6.768198042908641e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010563264226474765
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.7625641383599396e-07, theta_kick=-3.3124183471113804e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00836924e-01 -6.31644439e+00  8.89584260e-03  5.22362183e-02]
 [ 1.80009489e-01  4.56166461e-01 -7.60559275e-04  1.93416012e-02]
 [ 1.28762888e-02  5.22231157e-02  3.83798694e-01 -5.12301421e+00]
 [ 3.55239610e-03  3.08556122e-02  2.12478673e-01 -2.31222910e-01]]
compute_tune_4x4()/ evals =  [0.09488345+0.99548839j 0.09488345-0.99548839j 0.05906921+0.99825389j
 0.05906921-0.99825389j]
compute_tune_4x4()/ angles =  [0.23487607803838406, 0.2405933681253488, 0.7594066318746512, 0.7651239219616159]
compute_tune_4x4()/  0.23487607803838406 0.2405933681253488
compute_tunes()/ 0.23487607803838406 0.2405933681253488

 Running simulation ..
Closed orbit computation: x_co=[-9.27929215e-10 -5.89295385e-11], y_co=[-1.11718102e-07  2.67360834e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 22/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.99800358e-03 -5.03759772e-04  2.59259156e-03  1.23610943e-04]
 [-1.41935750e-03  3.62162393e-05 -5.63151044e-04 -4.66146947e-04]
 [-2.08500201e-03 -1.95871103e-04 -9.87294006e-04  6.35176626e-05]
 [-2.80852355e-04 -1.31118277e-04  2.70426478e-03  3.23404774e-04]
 [-4.91685012e-04  1.26699219e-04 -1.82921711e-03 -5.48838837e-04]
 [-1.20668496e-03 -7.15966065e-04 -1.99948355e-03 -8.39661628e-04]
 [-1.38599315e-04  5.93378334e-04  9.33618951e-04  7.33688051e-05]
 [-2.42851583e-03 -5.72313823e-04  1.83005612e-03 -5.93891403e-04]
 [ 3.77906259e-03 -8.51361730e-04 -1.34060421e-03 -9.19002104e-04]
 [ 1.48519083e-03 -3.81827819e-04 -2.32143496e-03 -3.45280349e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007068739591095729
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.997450633845466e-05, theta_kick=-1.0788281851248557e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.328371020499214e-05, theta_kick=-1.5927668353375853e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006938034903796089
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.3483306401919771e-05, theta_kick=-1.616699170356936e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.457355961473571e-05, theta_kick=-1.1339725643635584e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.032563204746653e-06, theta_kick=7.233270265853391e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.021571078172345652
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.306670945511139e-05, theta_kick=-6.3628981343504776e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01189600e-01 -6.31922587e+00  1.26852465e-02  1.39404159e-01]
 [ 1.80049143e-01  4.56296522e-01  2.54706419e-03  1.23238866e-03]
 [ 2.53985212e-02  1.39455669e-01  3.83923368e-01 -5.12216149e+00]
 [ 6.11492544e-03  2.02107370e-02  2.12562760e-01 -2.30361978e-01]]
compute_tune_4x4()/ evals =  [0.09196964+0.99576181j 0.09196964-0.99576181j 0.06236452+0.99805344j
 0.06236452-0.99805344j]
compute_tune_4x4()/ angles =  [0.23534186336029464, 0.24006793369989132, 0.7599320663001087, 0.7646581366397054]
compute_tune_4x4()/  0.23534186336029464 0.24006793369989132
compute_tunes()/ 0.23534186336029464 0.24006793369989132

 Running simulation ..
Closed orbit computation: x_co=[ 6.74102416e-08 -2.30599557e-07], y_co=[ 4.42242704e-05 -7.79599779e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 8.997450633845466e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.328371020499214e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.3483306401919771e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 9.457355961473571e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.032563204746653e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.306670945511139e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007068739591095729}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006938034903796089}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.021571078172345652}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.99800358e-03 -5.03759772e-04  2.59259156e-03  1.23610943e-04]
 [-1.41935750e-03  3.62162393e-05 -5.63151044e-04 -4.66146947e-04]
 [-2.08500201e-03 -1.95871103e-04 -9.87294006e-04  6.35176626e-05]
 [-2.80852355e-04 -1.31118277e-04  2.70426478e-03  3.23404774e-04]
 [-4.91685012e-04  1.26699219e-04 -1.82921711e-03 -5.48838837e-04]
 [-1.20668496e-03 -7.15966065e-04 -1.99948355e-03 -8.39661628e-04]
 [-1.38599315e-04  5.93378334e-04  9.33618951e-04  7.33688051e-05]
 [-2.42851583e-03 -5.72313823e-04  1.83005612e-03 -5.93891403e-04]
 [ 3.77906259e-03 -8.51361730e-04 -1.34060421e-03 -9.19002104e-04]
 [ 1.48519083e-03 -3.81827819e-04 -2.32143496e-03 -3.45280349e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007068739591095729
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.6196288694453548e-07, theta_kick=1.9419959551951062e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.114303875754831e-07, theta_kick=2.5351299005773558e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006938034903796089
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2999772206946466e-07, theta_kick=-2.757759227371307e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.324388314047253e-07, theta_kick=5.1851042995106905e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.899805152172159e-07, theta_kick=-4.6760131129058574e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.021571078172345652
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.1745645999037862e-07, theta_kick=2.6073847762233273e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01189600e-01 -6.31922587e+00  1.26852465e-02  1.39404159e-01]
 [ 1.80049143e-01  4.56296522e-01  2.54706419e-03  1.23238866e-03]
 [ 2.53985212e-02  1.39455669e-01  3.83923368e-01 -5.12216149e+00]
 [ 6.11492544e-03  2.02107370e-02  2.12562760e-01 -2.30361978e-01]]
compute_tune_4x4()/ evals =  [0.09196964+0.99576181j 0.09196964-0.99576181j 0.06236452+0.99805344j
 0.06236452-0.99805344j]
compute_tune_4x4()/ angles =  [0.23534186336029464, 0.24006793369989132, 0.7599320663001087, 0.7646581366397054]
compute_tune_4x4()/  0.23534186336029464 0.24006793369989132
compute_tunes()/ 0.23534186336029464 0.24006793369989132

 Running simulation ..
Closed orbit computation: x_co=[-3.38995771e-10  8.48959023e-10], y_co=[7.45504739e-09 2.48014279e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 23/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 8.08383716e-03 -6.95785680e-04 -5.43208155e-04 -8.27288045e-06]
 [ 1.46013729e-03  1.19827822e-04 -1.46907923e-03  5.89260496e-04]
 [-2.89332114e-03 -1.56384257e-04  2.03679310e-03  4.95667618e-04]
 [-1.33533489e-03  2.97750542e-04 -3.94507813e-03  1.77940790e-04]
 [ 2.04220370e-03 -4.36639980e-04  3.45626726e-03 -5.82497558e-04]
 [-8.33880551e-04  3.13255581e-04  2.40852323e-03  2.99591431e-04]
 [-2.74465703e-03  3.65043880e-04 -1.92005313e-03  2.21243790e-04]
 [ 2.96355576e-03 -3.43252386e-04  2.80904826e-03  6.64766042e-04]
 [-1.89097178e-03  9.51891630e-05 -7.24680410e-04 -9.01416745e-05]
 [ 2.32362940e-03 -9.58395144e-05  2.73731780e-03  2.07332346e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.003040432585816879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.807539209861725e-05, theta_kick=8.162495655508318e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.3469263715294196e-05, theta_kick=6.411165904811329e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011908008049750483
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.5883186097525116e-05, theta_kick=-1.904453775732454e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.9654891328591316e-05, theta_kick=-3.5557330508437074e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.1879193048131864e-05, theta_kick=2.6233975698985606e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0022507011645030257
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.4881542477610366e-05, theta_kick=4.18242818959403e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664666e-01 -6.32004058e+00  8.61034094e-03 -1.27833600e-02]
 [ 1.79985762e-01  4.56215159e-01 -2.11208775e-03  1.55250222e-02]
 [ 5.58665366e-03 -1.27818544e-02  3.83997205e-01 -5.11855296e+00]
 [ 7.16366432e-04  1.74558279e-02  2.12592244e-01 -2.29874941e-01]]
compute_tune_4x4()/ evals =  [0.08889787+0.99604075j 0.08889787-0.99604075j 0.0654385 +0.9978566j
 0.0654385 -0.9978566j ]
compute_tune_4x4()/ angles =  [0.23583276159690308, 0.23957769119996453, 0.7604223088000355, 0.7641672384030969]
compute_tune_4x4()/  0.23583276159690308 0.23957769119996453
compute_tunes()/ 0.23583276159690308 0.23957769119996453

 Running simulation ..
Closed orbit computation: x_co=[ 4.74129679e-07 -2.14287726e-08], y_co=[4.52904800e-06 6.78991827e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.807539209861725e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.3469263715294196e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.5883186097525116e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.9654891328591316e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.1879193048131864e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.4881542477610366e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.003040432585816879}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.011908008049750483}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0022507011645030257}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 8.08383716e-03 -6.95785680e-04 -5.43208155e-04 -8.27288045e-06]
 [ 1.46013729e-03  1.19827822e-04 -1.46907923e-03  5.89260496e-04]
 [-2.89332114e-03 -1.56384257e-04  2.03679310e-03  4.95667618e-04]
 [-1.33533489e-03  2.97750542e-04 -3.94507813e-03  1.77940790e-04]
 [ 2.04220370e-03 -4.36639980e-04  3.45626726e-03 -5.82497558e-04]
 [-8.33880551e-04  3.13255581e-04  2.40852323e-03  2.99591431e-04]
 [-2.74465703e-03  3.65043880e-04 -1.92005313e-03  2.21243790e-04]
 [ 2.96355576e-03 -3.43252386e-04  2.80904826e-03  6.64766042e-04]
 [-1.89097178e-03  9.51891630e-05 -7.24680410e-04 -9.01416745e-05]
 [ 2.32362940e-03 -9.58395144e-05  2.73731780e-03  2.07332346e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.003040432585816879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.7899188549772704e-07, theta_kick=-3.3452176815938266e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.3879800536391035e-07, theta_kick=2.863277935297507e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011908008049750483
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.508548951353319e-07, theta_kick=5.405919832934103e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.948951745949897e-07, theta_kick=-4.734941728052529e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.561206878868605e-07, theta_kick=-4.270021042996205e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0022507011645030257
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.762702807717333e-07, theta_kick=4.511622243243095e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664666e-01 -6.32004058e+00  8.61034094e-03 -1.27833600e-02]
 [ 1.79985762e-01  4.56215159e-01 -2.11208775e-03  1.55250222e-02]
 [ 5.58665366e-03 -1.27818544e-02  3.83997205e-01 -5.11855296e+00]
 [ 7.16366432e-04  1.74558279e-02  2.12592244e-01 -2.29874941e-01]]
compute_tune_4x4()/ evals =  [0.08889787+0.99604075j 0.08889787-0.99604075j 0.0654385 +0.9978566j
 0.0654385 -0.9978566j ]
compute_tune_4x4()/ angles =  [0.23583276159690308, 0.23957769119996453, 0.7604223088000355, 0.7641672384030969]
compute_tune_4x4()/  0.23583276159690308 0.23957769119996453
compute_tunes()/ 0.23583276159690308 0.23957769119996453

 Running simulation ..
Closed orbit computation: x_co=[-9.77865859e-10  2.13985780e-10], y_co=[1.15187694e-07 1.77742415e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 24/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.13305027e-03 -2.44151877e-05  1.25489859e-03  3.27294805e-05]
 [-6.13070623e-04  5.17847862e-04 -4.34498596e-04 -9.44575519e-05]
 [-1.12537548e-03  1.91226063e-04 -8.52159983e-04 -3.51666994e-04]
 [-2.09692339e-03 -1.65103320e-04 -1.95500607e-03 -6.17710861e-04]
 [ 1.56484390e-03 -8.03247083e-04  2.44804655e-03  6.87726645e-04]
 [-1.20444096e-03  4.40382873e-04 -1.00643753e-03  3.55866264e-04]
 [-1.61006500e-03  1.06164466e-07 -1.41747537e-03 -1.28379652e-05]
 [-3.21520508e-03  3.75139339e-04 -4.80058820e-04 -2.81087808e-04]
 [-3.46017804e-03  1.42527913e-05  1.01672738e-03  9.27540863e-04]
 [ 1.54544439e-03 -7.76821124e-04 -1.97047530e-03  4.25458609e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0032553481468988133
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.7787773615965043e-06, theta_kick=-2.1328209854619302e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.599929921936764e-05, theta_kick=-9.112601934060188e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0008492284019822442
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.838825600812208e-07, theta_kick=-7.00097158909621e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.751769045363996e-05, theta_kick=5.697549877138402e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.0001235904703566668, theta_kick=1.4818962421650354e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00679407469950428
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.8118123829817928e-05, theta_kick=-3.371468845444897e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664977e-01 -6.31979297e+00 -3.35401982e-03 -1.22424178e-02]
 [ 1.80003950e-01  4.56110517e-01  3.05808212e-05 -1.34132668e-03]
 [-4.04530148e-03 -1.22424392e-02  3.84051767e-01 -5.11941832e+00]
 [-6.91050985e-04 -3.29601371e-03  2.12570313e-01 -2.29763899e-01]]
compute_tune_4x4()/ evals =  [0.08017615+0.99678071j 0.08017615-0.99678071j 0.07419055+0.99724408j
 0.07419055-0.99724408j]
compute_tune_4x4()/ angles =  [0.23722585789414427, 0.23818134815349576, 0.7618186518465042, 0.7627741421058557]
compute_tune_4x4()/  0.23722585789414427 0.23818134815349576
compute_tunes()/ 0.23722585789414427 0.23818134815349576

 Running simulation ..
Closed orbit computation: x_co=[ 3.57854047e-08 -1.52615809e-09], y_co=[-4.45391551e-05 -1.71565787e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.7787773615965043e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.599929921936764e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.838825600812208e-07, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.751769045363996e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.0001235904703566668, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.8118123829817928e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0032553481468988133}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0008492284019822442}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00679407469950428}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.13305027e-03 -2.44151877e-05  1.25489859e-03  3.27294805e-05]
 [-6.13070623e-04  5.17847862e-04 -4.34498596e-04 -9.44575519e-05]
 [-1.12537548e-03  1.91226063e-04 -8.52159983e-04 -3.51666994e-04]
 [-2.09692339e-03 -1.65103320e-04 -1.95500607e-03 -6.17710861e-04]
 [ 1.56484390e-03 -8.03247083e-04  2.44804655e-03  6.87726645e-04]
 [-1.20444096e-03  4.40382873e-04 -1.00643753e-03  3.55866264e-04]
 [-1.61006500e-03  1.06164466e-07 -1.41747537e-03 -1.28379652e-05]
 [-3.21520508e-03  3.75139339e-04 -4.80058820e-04 -2.81087808e-04]
 [-3.46017804e-03  1.42527913e-05  1.01672738e-03  9.27540863e-04]
 [ 1.54544439e-03 -7.76821124e-04 -1.97047530e-03  4.25458609e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0032553481468988133
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.8548306083605806e-07, theta_kick=4.6220869426476426e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.140176265738792e-07, theta_kick=-4.9642271223609994e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0008492284019822442
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.4305506823355135e-07, theta_kick=1.7152840945274952e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.846591233357401e-07, theta_kick=4.6122076220011844e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.229302799465585e-07, theta_kick=-5.071093189805985e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00679407469950428
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.510004359189721e-07, theta_kick=3.009589668982485e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01664977e-01 -6.31979297e+00 -3.35401982e-03 -1.22424178e-02]
 [ 1.80003950e-01  4.56110517e-01  3.05808212e-05 -1.34132668e-03]
 [-4.04530148e-03 -1.22424392e-02  3.84051767e-01 -5.11941832e+00]
 [-6.91050985e-04 -3.29601371e-03  2.12570313e-01 -2.29763899e-01]]
compute_tune_4x4()/ evals =  [0.08017615+0.99678071j 0.08017615-0.99678071j 0.07419055+0.99724408j
 0.07419055-0.99724408j]
compute_tune_4x4()/ angles =  [0.23722585789414427, 0.23818134815349576, 0.7618186518465042, 0.7627741421058557]
compute_tune_4x4()/  0.23722585789414427 0.23818134815349576
compute_tunes()/ 0.23722585789414427 0.23818134815349576

 Running simulation ..
Closed orbit computation: x_co=[-1.41098776e-10 -6.58663180e-11], y_co=[5.76548878e-08 1.35475642e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 25/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.28043595e-04  3.22733791e-05  1.82054830e-03  5.84788514e-04]
 [-2.17635779e-04 -3.10040379e-04  8.71424210e-04 -5.70398976e-04]
 [-1.86889945e-03 -1.19614188e-04 -9.26803821e-04  2.83480931e-04]
 [ 5.43378110e-04 -1.61233384e-04  2.98821896e-05  5.81802970e-04]
 [-5.16471056e-03  2.36855728e-04  1.37034331e-03  3.18975754e-05]
 [ 5.27452635e-04 -9.73245547e-05 -2.14829978e-03  6.42482497e-04]
 [-2.54723662e-03  3.15903713e-04  3.56455040e-03 -6.51791334e-04]
 [ 1.20942793e-03  1.25232162e-04  1.92531276e-03  3.01887289e-04]
 [ 1.62665859e-03 -3.13573430e-04  1.41638828e-03 -7.48533914e-04]
 [-4.79093875e-04  1.33263490e-03 -2.90845456e-03 -3.56930645e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.003695932505068042
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.0742881121883563e-05, theta_kick=3.686187120768422e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.859356709954367e-05, theta_kick=5.826551535113873e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.016317401977531874
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.7716070095842332e-05, theta_kick=-3.3232610899595873e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.276790916419146e-05, theta_kick=5.128033228838031e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.167523687328345e-06, theta_kick=-1.0992205841603543e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.019484278239172415
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.681016889220752e-05, theta_kick=-4.413677753422361e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01261893e-01 -6.32181499e+00  5.33234086e-03  1.44048479e-01]
 [ 1.80037634e-01  4.56428509e-01  4.15570734e-03 -1.15287343e-02]
 [ 1.99432515e-02  1.44199341e-01  3.84054984e-01 -5.12218637e+00]
 [ 5.28325967e-03  5.10168062e-03  2.12655419e-01 -2.30697671e-01]]
compute_tune_4x4()/ evals =  [0.08183326+0.99664603j 0.08183326-0.99664603j 0.07242871+0.99737359j
 0.07242871-0.99737359j]
compute_tune_4x4()/ angles =  [0.23696125224488657, 0.23846251065443244, 0.7615374893455675, 0.7630387477551135]
compute_tune_4x4()/  0.23696125224488657 0.23846251065443244
compute_tunes()/ 0.23696125224488657 0.23846251065443244

 Running simulation ..
Closed orbit computation: x_co=[3.12139790e-07 1.11858424e-07], y_co=[-3.00317040e-05  6.72045808e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.0742881121883563e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.859356709954367e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.7716070095842332e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.276790916419146e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 9.167523687328345e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.681016889220752e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.003695932505068042}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.016317401977531874}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.019484278239172415}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.28043595e-04  3.22733791e-05  1.82054830e-03  5.84788514e-04]
 [-2.17635779e-04 -3.10040379e-04  8.71424210e-04 -5.70398976e-04]
 [-1.86889945e-03 -1.19614188e-04 -9.26803821e-04  2.83480931e-04]
 [ 5.43378110e-04 -1.61233384e-04  2.98821896e-05  5.81802970e-04]
 [-5.16471056e-03  2.36855728e-04  1.37034331e-03  3.18975754e-05]
 [ 5.27452635e-04 -9.73245547e-05 -2.14829978e-03  6.42482497e-04]
 [-2.54723662e-03  3.15903713e-04  3.56455040e-03 -6.51791334e-04]
 [ 1.20942793e-03  1.25232162e-04  1.92531276e-03  3.01887289e-04]
 [ 1.62665859e-03 -3.13573430e-04  1.41638828e-03 -7.48533914e-04]
 [-4.79093875e-04  1.33263490e-03 -2.90845456e-03 -3.56930645e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.003695932505068042
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.220697644412738e-07, theta_kick=9.856925790535317e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5905097270101226e-06, theta_kick=-1.9070810077680844e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.016317401977531874
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.830747710106891e-07, theta_kick=8.190323520553532e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.2950758549874133e-07, theta_kick=3.950919931822388e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.13776631544012e-07, theta_kick=-2.5632622485660922e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.019484278239172415
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.3625387271583203e-07, theta_kick=-1.6337352012280997e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01261893e-01 -6.32181499e+00  5.33234086e-03  1.44048479e-01]
 [ 1.80037634e-01  4.56428509e-01  4.15570734e-03 -1.15287343e-02]
 [ 1.99432515e-02  1.44199341e-01  3.84054984e-01 -5.12218637e+00]
 [ 5.28325967e-03  5.10168062e-03  2.12655419e-01 -2.30697671e-01]]
compute_tune_4x4()/ evals =  [0.08183326+0.99664603j 0.08183326-0.99664603j 0.07242871+0.99737359j
 0.07242871-0.99737359j]
compute_tune_4x4()/ angles =  [0.23696125224488657, 0.23846251065443244, 0.7615374893455675, 0.7630387477551135]
compute_tune_4x4()/  0.23696125224488657 0.23846251065443244
compute_tunes()/ 0.23696125224488657 0.23846251065443244

 Running simulation ..
Closed orbit computation: x_co=[ 1.05767129e-09 -3.80943526e-10], y_co=[ 1.39326285e-08 -2.57463628e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 26/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.00105417e-04 -2.99675380e-04  3.98129990e-03  6.00791280e-04]
 [-2.91563171e-04 -1.34140854e-04 -3.00013994e-03 -4.23196969e-04]
 [ 3.51814393e-03  3.24604960e-04 -2.16619727e-03 -4.71836837e-04]
 [ 2.51803413e-03  8.18005731e-04  1.86428666e-03 -1.40394938e-04]
 [ 1.86732613e-03  6.10569359e-04  3.76906467e-03  7.50518573e-04]
 [-2.66482518e-03 -2.77048689e-04 -4.21963636e-03  6.57403843e-04]
 [ 2.58308305e-03 -1.32156065e-03 -4.43002320e-04  5.28372202e-05]
 [-2.33354932e-03 -4.90834334e-04  1.85222437e-03 -7.26536117e-04]
 [-1.04612619e-03  1.55441514e-05 -2.58149216e-03 -3.70898868e-04]
 [ 3.68381739e-03 -2.51242696e-04 -1.71379949e-03 -5.10945865e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005255467206113457
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.675742696951056e-05, theta_kick=5.606391424796945e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.2641713780467117e-05, theta_kick=2.714826674793102e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.024087177323921453
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.521207336925762e-06, theta_kick=-7.81917296623352e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.234443788827806e-06, theta_kick=7.475332682197132e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.2564486537843566e-06, theta_kick=2.705566837824577e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0032577575560952337
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.3066680103815518e-05, theta_kick=1.5667441096013544e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690042e-01 -6.32264291e+00  8.04325481e-03 -1.05790793e-01]
 [ 1.80017777e-01  4.56905947e-01 -5.08348774e-03  2.40743786e-02]
 [-4.95903494e-03 -1.05796131e-01  3.83834449e-01 -5.11852274e+00]
 [-2.52482264e-03  1.55339439e-02  2.12707250e-01 -2.30314773e-01]]
compute_tune_4x4()/ evals =  [0.08780721+0.99613749j 0.08780721-0.99613749j 0.06656058+0.99778239j
 0.06656058-0.99778239j]
compute_tune_4x4()/ angles =  [0.23600702792324912, 0.23939871680850275, 0.7606012831914972, 0.7639929720767509]
compute_tune_4x4()/  0.23600702792324912 0.23939871680850275
compute_tunes()/ 0.23600702792324912 0.23939871680850275

 Running simulation ..
Closed orbit computation: x_co=[ 3.78689963e-07 -7.07714458e-08], y_co=[-6.12143314e-06  4.29163973e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.675742696951056e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.2641713780467117e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.521207336925762e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.234443788827806e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.2564486537843566e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.3066680103815518e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.005255467206113457}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.024087177323921453}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0032577575560952337}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.00105417e-04 -2.99675380e-04  3.98129990e-03  6.00791280e-04]
 [-2.91563171e-04 -1.34140854e-04 -3.00013994e-03 -4.23196969e-04]
 [ 3.51814393e-03  3.24604960e-04 -2.16619727e-03 -4.71836837e-04]
 [ 2.51803413e-03  8.18005731e-04  1.86428666e-03 -1.40394938e-04]
 [ 1.86732613e-03  6.10569359e-04  3.76906467e-03  7.50518573e-04]
 [-2.66482518e-03 -2.77048689e-04 -4.21963636e-03  6.57403843e-04]
 [ 2.58308305e-03 -1.32156065e-03 -4.43002320e-04  5.28372202e-05]
 [-2.33354932e-03 -4.90834334e-04  1.85222437e-03 -7.26536117e-04]
 [-1.04612619e-03  1.55441514e-05 -2.58149216e-03 -3.70898868e-04]
 [ 3.68381739e-03 -2.51242696e-04 -1.71379949e-03 -5.10945865e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005255467206113457
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.150059556224723e-07, theta_kick=-8.573190438589554e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.4279608643843777e-06, theta_kick=1.7121788053586749e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.024087177323921453
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2089468930862846e-06, theta_kick=-2.648610439429497e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.1713430565178296e-06, theta_kick=2.6035220244886316e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0379921765748788e-06, theta_kick=-1.2445916755749643e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0032577575560952337
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.396925179477624e-07, theta_kick=2.87400347775037e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690042e-01 -6.32264291e+00  8.04325481e-03 -1.05790793e-01]
 [ 1.80017777e-01  4.56905947e-01 -5.08348774e-03  2.40743786e-02]
 [-4.95903494e-03 -1.05796131e-01  3.83834449e-01 -5.11852274e+00]
 [-2.52482264e-03  1.55339439e-02  2.12707250e-01 -2.30314773e-01]]
compute_tune_4x4()/ evals =  [0.08780721+0.99613749j 0.08780721-0.99613749j 0.06656058+0.99778239j
 0.06656058-0.99778239j]
compute_tune_4x4()/ angles =  [0.23600702792324912, 0.23939871680850275, 0.7606012831914972, 0.7639929720767509]
compute_tune_4x4()/  0.23600702792324912 0.23939871680850275
compute_tunes()/ 0.23600702792324912 0.23939871680850275

 Running simulation ..
Closed orbit computation: x_co=[ 5.35832447e-09 -4.66473873e-10], y_co=[-1.72152865e-08 -2.88393595e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 27/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.17177055e-03  9.65878933e-05  1.33296463e-03 -1.02742316e-03]
 [-2.20864831e-03  1.28709937e-04  1.80498855e-03  4.16109273e-04]
 [-3.23924978e-03  4.23695154e-04 -6.19460896e-05 -1.52516773e-04]
 [ 3.47201782e-03 -1.14720983e-03  4.85228411e-04 -4.84715725e-04]
 [ 5.95857048e-03 -5.45681438e-04 -4.64660486e-03 -1.03843614e-03]
 [ 2.16945183e-04 -1.80618883e-04  2.04542901e-04 -5.35733718e-04]
 [ 2.24062014e-04 -2.61426043e-04 -1.15449805e-03  6.04884753e-04]
 [ 1.99970768e-03 -3.30566871e-04  2.44532809e-03  7.40410454e-04]
 [-1.17784191e-03  3.13204250e-04  3.36349454e-03  5.93147527e-04]
 [ 2.65682010e-03  4.57973192e-05  3.10031162e-03 -9.44722489e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008443466779218969
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.8178734938880216e-06, theta_kick=8.174886850897284e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.6091036352225224e-05, theta_kick=3.128413429690313e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.000607073525941454
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.808578058640185e-05, theta_kick=8.163741274281786e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8347877242968428e-05, theta_kick=2.1999795178054032e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.986267191260096e-06, theta_kick=-1.0774872482796521e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007301838654206654
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.766390416636537e-05, theta_kick=-1.1710269583215968e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588846e-01 -6.31940090e+00 -8.18177394e-03 -6.37403208e-02]
 [ 1.80008527e-01  4.56133443e-01 -5.44630737e-04 -6.52981982e-03]
 [-1.35439018e-02 -6.37403085e-02  3.84034114e-01 -5.11961362e+00]
 [-3.23382779e-03 -1.66005156e-02  2.12563844e-01 -2.29832347e-01]]
compute_tune_4x4()/ evals =  [0.08833897+0.99609047j 0.08833897-0.99609047j 0.06603421+0.99781736j
 0.06603421-0.99781736j]
compute_tune_4x4()/ angles =  [0.23592206552774153, 0.23948267575973672, 0.7605173242402633, 0.7640779344722585]
compute_tune_4x4()/  0.23592206552774153 0.23948267575973672
compute_tunes()/ 0.23592206552774153 0.23948267575973672

 Running simulation ..
Closed orbit computation: x_co=[ 2.11372645e-08 -9.20479604e-08], y_co=[-7.18409286e-05  8.77829159e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.8178734938880216e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.6091036352225224e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.808578058640185e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8347877242968428e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.986267191260096e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.766390416636537e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008443466779218969}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.000607073525941454}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007301838654206654}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.17177055e-03  9.65878933e-05  1.33296463e-03 -1.02742316e-03]
 [-2.20864831e-03  1.28709937e-04  1.80498855e-03  4.16109273e-04]
 [-3.23924978e-03  4.23695154e-04 -6.19460896e-05 -1.52516773e-04]
 [ 3.47201782e-03 -1.14720983e-03  4.85228411e-04 -4.84715725e-04]
 [ 5.95857048e-03 -5.45681438e-04 -4.64660486e-03 -1.03843614e-03]
 [ 2.16945183e-04 -1.80618883e-04  2.04542901e-04 -5.35733718e-04]
 [ 2.24062014e-04 -2.61426043e-04 -1.15449805e-03  6.04884753e-04]
 [ 1.99970768e-03 -3.30566871e-04  2.44532809e-03  7.40410454e-04]
 [-1.17784191e-03  3.13204250e-04  3.36349454e-03  5.93147527e-04]
 [ 2.65682010e-03  4.57973192e-05  3.10031162e-03 -9.44722489e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008443466779218969
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.196702809671207e-08, theta_kick=-1.1027192707196637e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1238242677772588e-06, theta_kick=1.3475075824753154e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.000607073525941454
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.28415576548393e-07, theta_kick=-9.933014465397439e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.8066321062575043e-07, theta_kick=-4.564295125092124e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.568679015664643e-07, theta_kick=6.67705566887308e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007301838654206654
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.48414148627178e-07, theta_kick=-2.9785791112282475e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588846e-01 -6.31940090e+00 -8.18177394e-03 -6.37403208e-02]
 [ 1.80008527e-01  4.56133443e-01 -5.44630737e-04 -6.52981982e-03]
 [-1.35439018e-02 -6.37403085e-02  3.84034114e-01 -5.11961362e+00]
 [-3.23382779e-03 -1.66005156e-02  2.12563844e-01 -2.29832347e-01]]
compute_tune_4x4()/ evals =  [0.08833897+0.99609047j 0.08833897-0.99609047j 0.06603421+0.99781736j
 0.06603421-0.99781736j]
compute_tune_4x4()/ angles =  [0.23592206552774153, 0.23948267575973672, 0.7605173242402633, 0.7640779344722585]
compute_tune_4x4()/  0.23592206552774153 0.23948267575973672
compute_tunes()/ 0.23592206552774153 0.23948267575973672

 Running simulation ..
Closed orbit computation: x_co=[-4.85513145e-11 -3.42098718e-10], y_co=[-4.84138840e-09  4.23373442e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 28/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.63585509e-03 -2.08729796e-04 -1.61976765e-03 -1.65606655e-04]
 [-1.28472245e-03  3.91367436e-04 -3.23650475e-03 -1.05866963e-05]
 [ 1.05265611e-03 -1.57381549e-04  7.55053119e-04 -2.71852515e-04]
 [ 1.79350760e-03  1.70886050e-04  2.51450527e-03  1.19480858e-04]
 [-1.08393959e-03 -5.35213808e-04 -1.74585700e-03 -4.64890285e-04]
 [ 1.44199282e-03 -1.35720683e-04  4.01257704e-03  8.89107237e-04]
 [-9.06811752e-04 -2.82651500e-04  1.15373352e-03 -7.14418030e-04]
 [ 8.98739197e-04  4.93852229e-05 -8.02380977e-04  7.26116845e-05]
 [-5.50119439e-04  1.61911793e-04  3.32377811e-03  6.17222684e-04]
 [ 8.07338292e-05 -1.44251453e-04  2.51455055e-03  4.50173393e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004488626643039435
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00010523836785461676, theta_kick=1.2618476279382954e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.530655921712581e-05, theta_kick=5.432426922199563e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015084717642874975
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1518713715836238e-05, theta_kick=2.5801747416039972e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0783068815534598e-05, theta_kick=1.292930523739667e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.851477703674228e-06, theta_kick=7.01614193648028e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006195184754823239
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.14451501724573e-05, theta_kick=6.168467075023799e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01711956e-01 -6.32001098e+00  9.67791436e-03 -3.69866420e-02]
 [ 1.80012214e-01  4.56509444e-01 -2.90015842e-03  1.67862454e-02]
 [ 3.82694051e-03 -3.69653295e-02  3.83823162e-01 -5.11840837e+00]
 [-1.39489797e-04  1.57684738e-02  2.12595650e-01 -2.29810370e-01]]
compute_tune_4x4()/ evals =  [0.08865493+0.9960624j  0.08865493-0.9960624j  0.06575021+0.99783611j
 0.06575021-0.99783611j]
compute_tune_4x4()/ angles =  [0.23587158068582434, 0.2395279745865913, 0.7604720254134087, 0.7641284193141756]
compute_tune_4x4()/  0.23587158068582434 0.2395279745865913
compute_tunes()/ 0.23587158068582434 0.2395279745865913

 Running simulation ..
Closed orbit computation: x_co=[5.61724327e-07 3.89055194e-10], y_co=[-2.25444019e-05  7.90997094e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00010523836785461676, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.530655921712581e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.1518713715836238e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.0783068815534598e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.851477703674228e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.14451501724573e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004488626643039435}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.015084717642874975}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006195184754823239}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.63585509e-03 -2.08729796e-04 -1.61976765e-03 -1.65606655e-04]
 [-1.28472245e-03  3.91367436e-04 -3.23650475e-03 -1.05866963e-05]
 [ 1.05265611e-03 -1.57381549e-04  7.55053119e-04 -2.71852515e-04]
 [ 1.79350760e-03  1.70886050e-04  2.51450527e-03  1.19480858e-04]
 [-1.08393959e-03 -5.35213808e-04 -1.74585700e-03 -4.64890285e-04]
 [ 1.44199282e-03 -1.35720683e-04  4.01257704e-03  8.89107237e-04]
 [-9.06811752e-04 -2.82651500e-04  1.15373352e-03 -7.14418030e-04]
 [ 8.98739197e-04  4.93852229e-05 -8.02380977e-04  7.26116845e-05]
 [-5.50119439e-04  1.61911793e-04  3.32377811e-03  6.17222684e-04]
 [ 8.07338292e-05 -1.44251453e-04  2.51455055e-03  4.50173393e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004488626643039435
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.002353942945291e-07, theta_kick=2.4008977188708508e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.370790620433892e-07, theta_kick=6.439780037172482e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015084717642874975
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.898513850988057e-06, theta_kick=-2.2763895414900078e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.35994097764803e-06, theta_kick=2.8296580281759947e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.212228407142711e-07, theta_kick=-1.1045808482736607e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006195184754823239
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.691383672112936e-08, theta_kick=-4.426107916174338e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01711956e-01 -6.32001098e+00  9.67791436e-03 -3.69866420e-02]
 [ 1.80012214e-01  4.56509444e-01 -2.90015842e-03  1.67862454e-02]
 [ 3.82694051e-03 -3.69653295e-02  3.83823162e-01 -5.11840837e+00]
 [-1.39489797e-04  1.57684738e-02  2.12595650e-01 -2.29810370e-01]]
compute_tune_4x4()/ evals =  [0.08865493+0.9960624j  0.08865493-0.9960624j  0.06575021+0.99783611j
 0.06575021-0.99783611j]
compute_tune_4x4()/ angles =  [0.23587158068582434, 0.2395279745865913, 0.7604720254134087, 0.7641284193141756]
compute_tune_4x4()/  0.23587158068582434 0.2395279745865913
compute_tunes()/ 0.23587158068582434 0.2395279745865913

 Running simulation ..
Closed orbit computation: x_co=[ 3.66643831e-09 -2.59356301e-10], y_co=[-1.18271972e-07  4.31810570e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 29/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.32088174e-03 -2.45596454e-04 -2.05573684e-03 -2.63055177e-04]
 [-2.05409022e-03 -9.23025400e-06 -1.87514657e-03 -8.17982933e-04]
 [-3.96498115e-05  2.19987053e-04  3.34345291e-04 -4.07063346e-04]
 [ 4.08770155e-04  8.10607717e-04  2.13497892e-03 -1.03368029e-04]
 [ 2.35409252e-03 -3.28349888e-04  1.26889722e-03  5.73542076e-04]
 [-1.09992422e-03  3.40171079e-04  4.36167806e-04 -4.33246645e-04]
 [ 5.06040960e-03 -8.40678917e-04  8.12246841e-04 -3.37291432e-04]
 [-1.47867612e-03 -1.11935981e-04 -9.43099325e-04 -2.35990831e-05]
 [-2.20492779e-04  5.39618520e-04  5.07316139e-04 -2.88092453e-05]
 [-3.18498288e-03  8.00903886e-06  1.42244673e-03  3.17931464e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001719736585937955
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.572154750804923e-06, theta_kick=-3.0841103270217843e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.94158348674103e-05, theta_kick=8.323219787084096e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012458641059104894
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.945884654014271e-06, theta_kick=-4.731264169418225e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.042043365177737e-05, theta_kick=3.647524455850405e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.502773916451695e-05, theta_kick=1.0195145854211854e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011066204582031924
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.109076386787629e-05, theta_kick=-6.125974823678059e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531290e-01 -6.32098925e+00  9.87979986e-05 -7.52688929e-02]
 [ 1.79998419e-01  4.56194580e-01 -2.82065834e-03  1.19088817e-02]
 [-8.08652935e-03 -7.53168713e-02  3.84093947e-01 -5.12008707e+00]
 [-2.30834041e-03  4.60942856e-03  2.12619378e-01 -2.30200440e-01]]
compute_tune_4x4()/ evals =  [0.07927047+0.99685315j 0.07927047-0.99685315j 0.07500793+0.99718294j
 0.07500793-0.99718294j]
compute_tune_4x4()/ angles =  [0.23737046263853318, 0.23805089448083228, 0.7619491055191677, 0.7626295373614669]
compute_tune_4x4()/  0.23737046263853318 0.23805089448083228
compute_tunes()/ 0.23737046263853318 0.23805089448083228

 Running simulation ..
Closed orbit computation: x_co=[-2.96666266e-07 -4.69134381e-08], y_co=[-7.39824032e-05 -2.54295017e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.572154750804923e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.94158348674103e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.945884654014271e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.042043365177737e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.502773916451695e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.109076386787629e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.001719736585937955}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.012458641059104894}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.011066204582031924}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.32088174e-03 -2.45596454e-04 -2.05573684e-03 -2.63055177e-04]
 [-2.05409022e-03 -9.23025400e-06 -1.87514657e-03 -8.17982933e-04]
 [-3.96498115e-05  2.19987053e-04  3.34345291e-04 -4.07063346e-04]
 [ 4.08770155e-04  8.10607717e-04  2.13497892e-03 -1.03368029e-04]
 [ 2.35409252e-03 -3.28349888e-04  1.26889722e-03  5.73542076e-04]
 [-1.09992422e-03  3.40171079e-04  4.36167806e-04 -4.33246645e-04]
 [ 5.06040960e-03 -8.40678917e-04  8.12246841e-04 -3.37291432e-04]
 [-1.47867612e-03 -1.11935981e-04 -9.43099325e-04 -2.35990831e-05]
 [-2.20492779e-04  5.39618520e-04  5.07316139e-04 -2.88092453e-05]
 [-3.18498288e-03  8.00903886e-06  1.42244673e-03  3.17931464e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001719736585937955
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.722857124802361e-07, theta_kick=-3.2648081438256725e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.836875504665727e-07, theta_kick=-8.197670976796148e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012458641059104894
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.060703028335802e-06, theta_kick=2.4708604677174493e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.9717804006017614e-06, theta_kick=-2.3642388912300138e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.287335917397037e-07, theta_kick=7.538752334489624e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011066204582031924
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.478549416476842e-08, theta_kick=4.170911635489493e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01531290e-01 -6.32098925e+00  9.87979986e-05 -7.52688929e-02]
 [ 1.79998419e-01  4.56194580e-01 -2.82065834e-03  1.19088817e-02]
 [-8.08652935e-03 -7.53168713e-02  3.84093947e-01 -5.12008707e+00]
 [-2.30834041e-03  4.60942856e-03  2.12619378e-01 -2.30200440e-01]]
compute_tune_4x4()/ evals =  [0.07927047+0.99685315j 0.07927047-0.99685315j 0.07500793+0.99718294j
 0.07500793-0.99718294j]
compute_tune_4x4()/ angles =  [0.23737046263853318, 0.23805089448083228, 0.7619491055191677, 0.7626295373614669]
compute_tune_4x4()/  0.23737046263853318 0.23805089448083228
compute_tunes()/ 0.23737046263853318 0.23805089448083228

 Running simulation ..
Closed orbit computation: x_co=[-5.01574160e-09  6.01731956e-10], y_co=[-6.61304401e-09 -1.40300451e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 30/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.23959227e-03 -5.68411792e-05 -2.25046282e-03  1.27299836e-07]
 [ 5.74612869e-04 -2.62736746e-04 -1.01212094e-03 -5.10130703e-04]
 [-1.65317514e-03 -7.35678779e-04 -6.74097135e-03 -5.36478589e-04]
 [-1.50741133e-03 -3.18353119e-04  1.79383826e-03 -2.49081475e-04]
 [ 3.78690420e-03  6.87282890e-05  7.54985599e-04  1.14410947e-05]
 [-2.20239276e-03  2.47286560e-04  1.58376646e-03  6.80716291e-04]
 [-1.01836166e-03  3.75383185e-04 -1.57220182e-03 -1.38700420e-04]
 [ 2.63737810e-03  9.74586482e-04 -5.41165232e-04 -2.79338607e-04]
 [-2.68032884e-03  6.55682830e-05  2.13973227e-04 -6.17361019e-04]
 [-2.42006777e-03 -1.38591048e-04 -1.23919606e-03 -1.15215671e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01615231546926442
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.317480475383959e-05, theta_kick=1.5797086619728824e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.913683859899231e-05, theta_kick=-5.891691832030373e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003877881689590406
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.368161351327505e-05, theta_kick=5.2375898182295355e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6986739694746247e-05, theta_kick=-2.0367740043091622e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.779653271980767e-05, theta_kick=6.930021740388287e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0065371482088097165
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.405218187506297e-05, theta_kick=7.68009761183072e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482106e-01 -6.31913819e+00 -8.49841413e-03 -1.05738450e-01]
 [ 1.80042689e-01  4.56319713e-01 -1.72706022e-03 -4.73179757e-03]
 [-1.83562858e-02 -1.05735671e-01  3.83974858e-01 -5.12067155e+00]
 [-4.82087988e-03 -2.00114052e-02  2.12562160e-01 -2.30011415e-01]]
compute_tune_4x4()/ evals =  [0.09003027+0.99593903j 0.09003027-0.99593903j 0.06437025+0.99792608j
 0.06437025-0.99792608j]
compute_tune_4x4()/ angles =  [0.2356518091617069, 0.2397480680861746, 0.7602519319138255, 0.7643481908382931]
compute_tune_4x4()/  0.2356518091617069 0.2397480680861746
compute_tunes()/ 0.2356518091617069 0.2397480680861746

 Running simulation ..
Closed orbit computation: x_co=[1.04602555e-07 1.27773089e-07], y_co=[ 1.04633484e-07 -1.05891323e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.317480475383959e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.913683859899231e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.368161351327505e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.6986739694746247e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.779653271980767e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.405218187506297e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01615231546926442}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003877881689590406}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0065371482088097165}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.23959227e-03 -5.68411792e-05 -2.25046282e-03  1.27299836e-07]
 [ 5.74612869e-04 -2.62736746e-04 -1.01212094e-03 -5.10130703e-04]
 [-1.65317514e-03 -7.35678779e-04 -6.74097135e-03 -5.36478589e-04]
 [-1.50741133e-03 -3.18353119e-04  1.79383826e-03 -2.49081475e-04]
 [ 3.78690420e-03  6.87282890e-05  7.54985599e-04  1.14410947e-05]
 [-2.20239276e-03  2.47286560e-04  1.58376646e-03  6.80716291e-04]
 [-1.01836166e-03  3.75383185e-04 -1.57220182e-03 -1.38700420e-04]
 [ 2.63737810e-03  9.74586482e-04 -5.41165232e-04 -2.79338607e-04]
 [-2.68032884e-03  6.55682830e-05  2.13973227e-04 -6.17361019e-04]
 [-2.42006777e-03 -1.38591048e-04 -1.23919606e-03 -1.15215671e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01615231546926442
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.98071634993812e-08, theta_kick=1.076821681519355e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.306561508908807e-07, theta_kick=6.36276691574658e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003877881689590406
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.1758293313840384e-06, theta_kick=-1.4098636105008075e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.94147297367418e-07, theta_kick=9.522124904113317e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.4302734547111097e-07, theta_kick=-1.7149516881747702e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0065371482088097165
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.808603712265784e-07, theta_kick=-3.3676215285258206e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482106e-01 -6.31913819e+00 -8.49841413e-03 -1.05738450e-01]
 [ 1.80042689e-01  4.56319713e-01 -1.72706022e-03 -4.73179757e-03]
 [-1.83562858e-02 -1.05735671e-01  3.83974858e-01 -5.12067155e+00]
 [-4.82087988e-03 -2.00114052e-02  2.12562160e-01 -2.30011415e-01]]
compute_tune_4x4()/ evals =  [0.09003027+0.99593903j 0.09003027-0.99593903j 0.06437025+0.99792608j
 0.06437025-0.99792608j]
compute_tune_4x4()/ angles =  [0.2356518091617069, 0.2397480680861746, 0.7602519319138255, 0.7643481908382931]
compute_tune_4x4()/  0.2356518091617069 0.2397480680861746
compute_tunes()/ 0.2356518091617069 0.2397480680861746

 Running simulation ..
Closed orbit computation: x_co=[ 6.88271401e-10 -3.69147431e-10], y_co=[-1.21709902e-08  2.65909123e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 31/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.56089016e-03  1.38366228e-04 -1.27457233e-03  9.91023990e-05]
 [ 7.64952545e-05  3.82980439e-05 -1.17181734e-03 -3.46223138e-04]
 [-1.61710119e-03  3.94065245e-04  5.85492414e-04  3.92199157e-04]
 [-4.03130903e-04 -1.67447949e-04  3.28511689e-03  4.26429872e-04]
 [-4.09243497e-04 -3.48674785e-04  6.16509248e-05 -2.92441053e-04]
 [ 1.80546760e-03 -3.87616539e-04  3.19993533e-03 -7.19710808e-05]
 [-3.33118923e-03 -5.76309859e-05 -5.71218239e-04  1.30327765e-04]
 [ 7.10119263e-04  2.46475904e-04  1.65038801e-03 -9.13508778e-04]
 [-2.52003531e-03  2.76606885e-04  1.34153699e-03  9.69054631e-05]
 [ 3.72591908e-04  1.30315143e-04 -1.86807015e-03  3.58538600e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00784432243028014
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.952615634809975e-05, theta_kick=4.739334868654544e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.146425444812683e-05, theta_kick=-4.9717201232044225e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002500699444247822
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.983270603336626e-05, theta_kick=4.776091329352714e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.3836656197343828e-05, theta_kick=2.8581047667093273e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.9329424277855683e-05, theta_kick=3.5167083268466396e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00540167672853638
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.864364312149296e-05, theta_kick=4.633518212208832e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01614880e-01 -6.31945458e+00  7.72109411e-03  4.78064830e-02]
 [ 1.80001672e-01  4.56111343e-01  6.97330916e-05  7.88863660e-03]
 [ 1.14418299e-02  4.78068376e-02  3.84042636e-01 -5.11937067e+00]
 [ 2.65932076e-03  1.61433031e-02  2.12565208e-01 -2.29812159e-01]]
compute_tune_4x4()/ evals =  [0.08792099+0.99612745j 0.08792099-0.99612745j 0.06644248+0.99779026j
 0.06644248-0.99779026j]
compute_tune_4x4()/ angles =  [0.2359888483243101, 0.23941755548492547, 0.7605824445150745, 0.7640111516756899]
compute_tune_4x4()/  0.2359888483243101 0.23941755548492547
compute_tunes()/ 0.2359888483243101 0.23941755548492547

 Running simulation ..
Closed orbit computation: x_co=[ 7.46758430e-08 -3.88321461e-08], y_co=[-1.85512175e-05 -5.49376011e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.952615634809975e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.146425444812683e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.983270603336626e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.3836656197343828e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.9329424277855683e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.864364312149296e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00784432243028014}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.002500699444247822}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00540167672853638}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.56089016e-03  1.38366228e-04 -1.27457233e-03  9.91023990e-05]
 [ 7.64952545e-05  3.82980439e-05 -1.17181734e-03 -3.46223138e-04]
 [-1.61710119e-03  3.94065245e-04  5.85492414e-04  3.92199157e-04]
 [-4.03130903e-04 -1.67447949e-04  3.28511689e-03  4.26429872e-04]
 [-4.09243497e-04 -3.48674785e-04  6.16509248e-05 -2.92441053e-04]
 [ 1.80546760e-03 -3.87616539e-04  3.19993533e-03 -7.19710808e-05]
 [-3.33118923e-03 -5.76309859e-05 -5.71218239e-04  1.30327765e-04]
 [ 7.10119263e-04  2.46475904e-04  1.65038801e-03 -9.13508778e-04]
 [-2.52003531e-03  2.76606885e-04  1.34153699e-03  9.69054631e-05]
 [ 3.72591908e-04  1.30315143e-04 -1.86807015e-03  3.58538600e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00784432243028014
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.933517681268926e-07, theta_kick=-9.512586209190764e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.6090766343457486e-06, theta_kick=3.1283810546231164e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002500699444247822
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.910245641719091e-06, theta_kick=-4.688531652710191e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.1015885326982156e-06, theta_kick=3.7189213521750455e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.187105847758759e-07, theta_kick=-1.101568558876492e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00540167672853638
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.418378301253197e-08, theta_kick=-1.0093952336089514e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01614880e-01 -6.31945458e+00  7.72109411e-03  4.78064830e-02]
 [ 1.80001672e-01  4.56111343e-01  6.97330916e-05  7.88863660e-03]
 [ 1.14418299e-02  4.78068376e-02  3.84042636e-01 -5.11937067e+00]
 [ 2.65932076e-03  1.61433031e-02  2.12565208e-01 -2.29812159e-01]]
compute_tune_4x4()/ evals =  [0.08792099+0.99612745j 0.08792099-0.99612745j 0.06644248+0.99779026j
 0.06644248-0.99779026j]
compute_tune_4x4()/ angles =  [0.2359888483243101, 0.23941755548492547, 0.7605824445150745, 0.7640111516756899]
compute_tune_4x4()/  0.2359888483243101 0.23941755548492547
compute_tunes()/ 0.2359888483243101 0.23941755548492547

 Running simulation ..
Closed orbit computation: x_co=[ 1.27009869e-09 -2.25429611e-10], y_co=[-1.32990674e-07 -1.06185710e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 32/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.56702347e-03 -1.09777023e-04 -1.88232430e-03  5.17384140e-04]
 [ 1.32862398e-03 -7.82556161e-04  1.46344611e-03  3.42261187e-04]
 [-4.38580019e-04 -2.21429742e-04 -8.32758062e-03 -1.00113284e-03]
 [ 3.58837085e-04  4.43274733e-04 -1.08160521e-03 -2.50834277e-05]
 [ 9.21340618e-04 -1.60407673e-04  3.25295391e-03 -4.71456594e-04]
 [ 2.20076511e-03  1.53587161e-04 -6.60526740e-04  7.04663429e-04]
 [ 2.24959150e-03  2.19867411e-04 -1.59609538e-03 -8.08166185e-04]
 [-1.10536906e-03  6.64609885e-04  4.95295909e-04  7.39935693e-04]
 [ 8.54564634e-05 -4.67063445e-05  8.83382256e-05 -6.87169383e-05]
 [-1.35321012e-03  8.44066840e-04  1.55209103e-03  9.55158967e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006554021466588212
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.562837911762243e-05, theta_kick=3.072939086450922e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.5494292592758063e-05, theta_kick=3.0568616076009716e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0089968504966573
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.5491019752039065e-05, theta_kick=-3.056469181684257e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3106946317220661e-05, theta_kick=1.5715721800957135e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.493854525510882e-05, theta_kick=8.985413542515078e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008958500974334635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.4137931517136045e-05, theta_kick=5.29230406385077e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01650262e-01 -6.31933641e+00  9.83863618e-03  8.25490932e-03]
 [ 1.80002221e-01  4.56250542e-01 -1.42774596e-03  1.23716933e-02]
 [ 8.86508839e-03  8.25544758e-03  3.83912665e-01 -5.11880435e+00]
 [ 1.41725119e-03  1.63795936e-02  2.12563826e-01 -2.29755752e-01]]
compute_tune_4x4()/ evals =  [0.08898801+0.9960327j  0.08898801-0.9960327j  0.06539059+0.99785975j
 0.06539059-0.99785975j]
compute_tune_4x4()/ angles =  [0.23581835904216247, 0.23958533394457174, 0.7604146660554283, 0.7641816409578375]
compute_tune_4x4()/  0.23581835904216247 0.23958533394457174
compute_tunes()/ 0.23581835904216247 0.23958533394457174

 Running simulation ..
Closed orbit computation: x_co=[ 4.39862999e-07 -4.08547014e-08], y_co=[-1.53764506e-05 -7.07078717e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.562837911762243e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.5494292592758063e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.5491019752039065e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.3106946317220661e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.493854525510882e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.4137931517136045e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0006554021466588212}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0089968504966573}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.008958500974334635}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.56702347e-03 -1.09777023e-04 -1.88232430e-03  5.17384140e-04]
 [ 1.32862398e-03 -7.82556161e-04  1.46344611e-03  3.42261187e-04]
 [-4.38580019e-04 -2.21429742e-04 -8.32758062e-03 -1.00113284e-03]
 [ 3.58837085e-04  4.43274733e-04 -1.08160521e-03 -2.50834277e-05]
 [ 9.21340618e-04 -1.60407673e-04  3.25295391e-03 -4.71456594e-04]
 [ 2.20076511e-03  1.53587161e-04 -6.60526740e-04  7.04663429e-04]
 [ 2.24959150e-03  2.19867411e-04 -1.59609538e-03 -8.08166185e-04]
 [-1.10536906e-03  6.64609885e-04  4.95295909e-04  7.39935693e-04]
 [ 8.54564634e-05 -4.67063445e-05  8.83382256e-05 -6.87169383e-05]
 [-1.35321012e-03  8.44066840e-04  1.55209103e-03  9.55158967e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006554021466588212
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.4735460617189774e-08, theta_kick=-5.3639500512313906e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.0271335375706463e-07, theta_kick=-3.629647011547043e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0089968504966573
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.58672165009702e-07, theta_kick=5.4996518400814824e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.123868648903035e-08, theta_kick=9.740824181597064e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.5993187899971874e-07, theta_kick=-3.1166810320970797e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008958500974334635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.2679320526937406e-07, theta_kick=3.9183734915499444e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01650262e-01 -6.31933641e+00  9.83863618e-03  8.25490932e-03]
 [ 1.80002221e-01  4.56250542e-01 -1.42774596e-03  1.23716933e-02]
 [ 8.86508839e-03  8.25544758e-03  3.83912665e-01 -5.11880435e+00]
 [ 1.41725119e-03  1.63795936e-02  2.12563826e-01 -2.29755752e-01]]
compute_tune_4x4()/ evals =  [0.08898801+0.9960327j  0.08898801-0.9960327j  0.06539059+0.99785975j
 0.06539059-0.99785975j]
compute_tune_4x4()/ angles =  [0.23581835904216247, 0.23958533394457174, 0.7604146660554283, 0.7641816409578375]
compute_tune_4x4()/  0.23581835904216247 0.23958533394457174
compute_tunes()/ 0.23581835904216247 0.23958533394457174

 Running simulation ..
Closed orbit computation: x_co=[-3.31380796e-10  9.08250992e-11], y_co=[ 8.61217873e-10 -2.44255108e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 33/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.58909985e-04  6.63576808e-05 -2.42658972e-03 -1.37320136e-04]
 [ 2.74921941e-03 -8.23854667e-04  5.73283416e-03  3.71259219e-04]
 [-9.18081093e-04 -7.23939039e-05  1.87562160e-03  2.79391270e-04]
 [-2.24014099e-03  3.07854938e-04  2.45009689e-03  5.06114400e-04]
 [-5.90475553e-05 -1.02548987e-03 -1.04360918e-03 -1.11221813e-04]
 [ 3.49899478e-04 -2.72218634e-04 -2.31656240e-03 -1.45106805e-04]
 [-2.36253954e-03  7.40803925e-04  1.66322018e-03 -2.51973827e-05]
 [ 2.33037343e-03 -6.07846126e-04  1.25002047e-03  1.62618629e-04]
 [ 3.78600284e-04  4.84434989e-04  2.60112829e-03 -3.96556620e-04]
 [ 6.09997469e-04  2.07928688e-06 -1.09457944e-03 -5.85922958e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0022265520518953176
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.3088173099777864e-05, theta_kick=5.166434079751281e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.2592415938500264e-05, theta_kick=5.106990930760623e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0026725561886415832
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.078735783802846e-05, theta_kick=-4.890557672738442e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.935043331267616e-06, theta_kick=1.1912490773652997e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.512581665824782e-05, theta_kick=-4.211717582967154e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0043969417201552745
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.3569250162116548e-05, theta_kick=-2.8260417769341465e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01685908e-01 -6.32006173e+00 -2.26165757e-03 -3.53710650e-02]
 [ 1.80003121e-01  4.56105766e-01 -8.00071303e-04  8.19924983e-04]
 [-5.67005239e-03 -3.53720036e-02  3.84088305e-01 -5.11935754e+00]
 [-1.44984273e-03 -3.72661086e-03  2.12580627e-01 -2.29754675e-01]]
compute_tune_4x4()/ evals =  [0.07988305+0.99680424j 0.07988305-0.99680424j 0.0744937 +0.99722148j
 0.0744937 -0.99722148j]
compute_tune_4x4()/ angles =  [0.2372726573023802, 0.23813296706861953, 0.7618670329313805, 0.7627273426976198]
compute_tune_4x4()/  0.2372726573023802 0.23813296706861953
compute_tunes()/ 0.2372726573023802 0.23813296706861953

 Running simulation ..
Closed orbit computation: x_co=[-6.27550910e-09 -4.13798515e-08], y_co=[4.95187822e-06 1.10053673e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.3088173099777864e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.2592415938500264e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.078735783802846e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.935043331267616e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.512581665824782e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.3569250162116548e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0022265520518953176}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0026725561886415832}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0043969417201552745}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.58909985e-04  6.63576808e-05 -2.42658972e-03 -1.37320136e-04]
 [ 2.74921941e-03 -8.23854667e-04  5.73283416e-03  3.71259219e-04]
 [-9.18081093e-04 -7.23939039e-05  1.87562160e-03  2.79391270e-04]
 [-2.24014099e-03  3.07854938e-04  2.45009689e-03  5.06114400e-04]
 [-5.90475553e-05 -1.02548987e-03 -1.04360918e-03 -1.11221813e-04]
 [ 3.49899478e-04 -2.72218634e-04 -2.31656240e-03 -1.45106805e-04]
 [-2.36253954e-03  7.40803925e-04  1.66322018e-03 -2.51973827e-05]
 [ 2.33037343e-03 -6.07846126e-04  1.25002047e-03  1.62618629e-04]
 [ 3.78600284e-04  4.84434989e-04  2.60112829e-03 -3.96556620e-04]
 [ 6.09997469e-04  2.07928688e-06 -1.09457944e-03 -5.85922958e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0022265520518953176
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1612216050427247e-06, theta_kick=-1.392348396982081e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.439825565900603e-06, theta_kick=2.925442655256673e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0026725561886415832
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2126862033227255e-06, theta_kick=-2.653094013099603e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0222862921974868e-06, theta_kick=1.2257597292512965e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.4135716889668315e-07, theta_kick=-1.6949256426208206e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0043969417201552745
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.201403833616759e-08, theta_kick=9.833791785435171e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01685908e-01 -6.32006173e+00 -2.26165757e-03 -3.53710650e-02]
 [ 1.80003121e-01  4.56105766e-01 -8.00071303e-04  8.19924983e-04]
 [-5.67005239e-03 -3.53720036e-02  3.84088305e-01 -5.11935754e+00]
 [-1.44984273e-03 -3.72661086e-03  2.12580627e-01 -2.29754675e-01]]
compute_tune_4x4()/ evals =  [0.07988305+0.99680424j 0.07988305-0.99680424j 0.0744937 +0.99722148j
 0.0744937 -0.99722148j]
compute_tune_4x4()/ angles =  [0.2372726573023802, 0.23813296706861953, 0.7618670329313805, 0.7627273426976198]
compute_tune_4x4()/  0.2372726573023802 0.23813296706861953
compute_tunes()/ 0.2372726573023802 0.23813296706861953

 Running simulation ..
Closed orbit computation: x_co=[ 6.29108384e-10 -3.89260021e-11], y_co=[-8.44970348e-08 -2.11710568e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 34/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.69312394e-03 -5.41881613e-05  5.94037887e-04  1.14351852e-03]
 [-1.00836580e-03  3.54830912e-04 -1.70957945e-03  1.79812942e-04]
 [ 5.45321405e-03 -6.80810199e-04 -2.22141694e-03 -2.74763669e-05]
 [-2.09244942e-03 -1.80791002e-04 -2.25771801e-03 -4.03495709e-04]
 [ 4.02621854e-03 -4.55887489e-04  1.03948707e-04  6.25979479e-05]
 [ 1.26053016e-03 -5.09490271e-04  2.12218843e-04  5.83127801e-05]
 [ 5.65902544e-04  3.17702300e-04 -2.57168691e-03  5.38868068e-05]
 [-1.83027906e-03 -3.74408669e-04 -2.24035296e-03 -2.18843949e-04]
 [ 7.98968696e-04 -5.98503797e-05  4.44934898e-03  2.63240681e-04]
 [-2.46076761e-03 -4.09299409e-04 -3.36656847e-03 -6.07576761e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008908378333091181
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=0.00011691309203061647, theta_kick=-1.4018319635816466e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.074949683114375e-05, theta_kick=2.487942742846643e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006100590895588336
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.4476306315238684e-05, theta_kick=1.7357635962605573e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.6670262503678883e-05, theta_kick=3.197864824666462e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.855326564437278e-05, theta_kick=7.020756865353777e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0015798748899307589
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.049272638338797e-05, theta_kick=-2.457155000027134e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01674989e-01 -6.32006985e+00 -1.43142152e-03 -6.14722175e-02]
 [ 1.80020354e-01  4.56240887e-01 -1.64705927e-03  2.44440344e-03]
 [-7.82892965e-03 -6.14679478e-02  3.84038186e-01 -5.11963858e+00]
 [-2.36890055e-03 -5.21962767e-03  2.12584598e-01 -2.29798929e-01]]
compute_tune_4x4()/ evals =  [0.08019472+0.99677922j 0.08019472-0.99677922j 0.07420786+0.9972428j
 0.07420786-0.9972428j ]
compute_tune_4x4()/ angles =  [0.23722289367733618, 0.23817858589146074, 0.7618214141085393, 0.7627771063226638]
compute_tune_4x4()/  0.23722289367733618 0.23817858589146074
compute_tunes()/ 0.23722289367733618 0.23817858589146074

 Running simulation ..
Closed orbit computation: x_co=[-2.61983772e-07  1.60537165e-07], y_co=[-4.54923370e-05 -1.56738812e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 0.00011691309203061647, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.074949683114375e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.4476306315238684e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.6670262503678883e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.855326564437278e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.049272638338797e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008908378333091181}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006100590895588336}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0015798748899307589}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.69312394e-03 -5.41881613e-05  5.94037887e-04  1.14351852e-03]
 [-1.00836580e-03  3.54830912e-04 -1.70957945e-03  1.79812942e-04]
 [ 5.45321405e-03 -6.80810199e-04 -2.22141694e-03 -2.74763669e-05]
 [-2.09244942e-03 -1.80791002e-04 -2.25771801e-03 -4.03495709e-04]
 [ 4.02621854e-03 -4.55887489e-04  1.03948707e-04  6.25979479e-05]
 [ 1.26053016e-03 -5.09490271e-04  2.12218843e-04  5.83127801e-05]
 [ 5.65902544e-04  3.17702300e-04 -2.57168691e-03  5.38868068e-05]
 [-1.83027906e-03 -3.74408669e-04 -2.24035296e-03 -2.18843949e-04]
 [ 7.98968696e-04 -5.98503797e-05  4.44934898e-03  2.63240681e-04]
 [-2.46076761e-03 -4.09299409e-04 -3.36656847e-03 -6.07576761e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008908378333091181
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1014127511847679e-06, theta_kick=-1.320635330817249e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.536711556180459e-07, theta_kick=7.837763108487155e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006100590895588336
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.316052200688079e-07, theta_kick=6.374146612290063e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2081584476316624e-06, theta_kick=-1.4486274373084995e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.08266800777392e-07, theta_kick=7.293347809944169e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0015798748899307589
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.2084082650772864e-07, theta_kick=2.6479646041801e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01674989e-01 -6.32006985e+00 -1.43142152e-03 -6.14722175e-02]
 [ 1.80020354e-01  4.56240887e-01 -1.64705927e-03  2.44440344e-03]
 [-7.82892965e-03 -6.14679478e-02  3.84038186e-01 -5.11963858e+00]
 [-2.36890055e-03 -5.21962767e-03  2.12584598e-01 -2.29798929e-01]]
compute_tune_4x4()/ evals =  [0.08019472+0.99677922j 0.08019472-0.99677922j 0.07420786+0.9972428j
 0.07420786-0.9972428j ]
compute_tune_4x4()/ angles =  [0.23722289367733618, 0.23817858589146074, 0.7618214141085393, 0.7627771063226638]
compute_tune_4x4()/  0.23722289367733618 0.23817858589146074
compute_tunes()/ 0.23722289367733618 0.23817858589146074

 Running simulation ..
Closed orbit computation: x_co=[-9.13745845e-10  5.84741655e-10], y_co=[ 2.62906040e-08 -7.10865405e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 35/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.10311952e-04  2.48592611e-04  4.52532147e-03  5.49310608e-06]
 [ 1.74909879e-03  2.24335928e-04  5.60711031e-04 -5.98705543e-04]
 [ 3.70018340e-04 -2.38115658e-04  6.37408787e-04  3.71370237e-04]
 [-2.51704328e-03 -2.10670575e-04  1.33388918e-03  1.68360262e-04]
 [-2.55010783e-03  1.63183568e-04 -3.21689845e-04 -6.49215204e-04]
 [-2.48866380e-03  9.14312823e-05 -3.59689502e-03 -1.87742136e-04]
 [-4.27868643e-03 -9.77304288e-05 -9.96470496e-04 -2.31337506e-04]
 [ 1.37746350e-03 -4.27211081e-05  2.00851827e-03 -1.39754523e-05]
 [-4.29054201e-03  2.34508734e-04  1.84594141e-03 -3.25764824e-05]
 [ 2.92276703e-03  1.75229923e-04 -2.59615347e-03 -5.00535144e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016352990551791482
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.057590282334686e-05, theta_kick=3.666165794495405e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.7726148433156824e-05, theta_kick=2.125431894170127e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002047913584704249
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.663951491271506e-06, theta_kick=-7.990328578236235e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.522357490115321e-05, theta_kick=-4.223439164120142e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.142010806744096e-06, theta_kick=-7.364502058762604e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006720579247568279
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.270031366277496e-05, theta_kick=-1.111511640565385e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01454730e-01 -6.31885003e+00  3.34192808e-03  3.40883614e-02]
 [ 1.80014854e-01  4.56162181e-01  3.28840822e-05  7.93122346e-03]
 [ 6.40569996e-03  3.40849790e-02  3.83973475e-01 -5.12056282e+00]
 [ 1.95320165e-03  1.43558786e-02  2.12543108e-01 -2.30134960e-01]]
compute_tune_4x4()/ evals =  [0.08510404+0.99637207j 0.08510404-0.99637207j 0.06916894+0.99760496j
 0.06916894-0.99760496j]
compute_tune_4x4()/ angles =  [0.2364388676959893, 0.23898262384742933, 0.7610173761525707, 0.7635611323040107]
compute_tune_4x4()/  0.2364388676959893 0.23898262384742933
compute_tunes()/ 0.2364388676959893 0.23898262384742933

 Running simulation ..
Closed orbit computation: x_co=[-1.62428052e-07  1.27800671e-07], y_co=[-8.00088255e-06  1.30325956e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.057590282334686e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.7726148433156824e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.663951491271506e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.522357490115321e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.142010806744096e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.270031366277496e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.016352990551791482}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.002047913584704249}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006720579247568279}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.10311952e-04  2.48592611e-04  4.52532147e-03  5.49310608e-06]
 [ 1.74909879e-03  2.24335928e-04  5.60711031e-04 -5.98705543e-04]
 [ 3.70018340e-04 -2.38115658e-04  6.37408787e-04  3.71370237e-04]
 [-2.51704328e-03 -2.10670575e-04  1.33388918e-03  1.68360262e-04]
 [-2.55010783e-03  1.63183568e-04 -3.21689845e-04 -6.49215204e-04]
 [-2.48866380e-03  9.14312823e-05 -3.59689502e-03 -1.87742136e-04]
 [-4.27868643e-03 -9.77304288e-05 -9.96470496e-04 -2.31337506e-04]
 [ 1.37746350e-03 -4.27211081e-05  2.00851827e-03 -1.39754523e-05]
 [-4.29054201e-03  2.34508734e-04  1.84594141e-03 -3.25764824e-05]
 [ 2.92276703e-03  1.75229923e-04 -2.59615347e-03 -5.00535144e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016352990551791482
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3859747159413905e-06, theta_kick=-1.6618358335898246e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.503492685663561e-06, theta_kick=3.0017819274140824e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002047913584704249
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.7782617977102163e-06, theta_kick=-3.331240431318059e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.303722634990822e-06, theta_kick=2.7622501200387077e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.233936745794366e-06, theta_kick=-1.4795365867489683e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006720579247568279
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.436086817271055e-07, theta_kick=7.717110260392673e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01454730e-01 -6.31885003e+00  3.34192808e-03  3.40883614e-02]
 [ 1.80014854e-01  4.56162181e-01  3.28840822e-05  7.93122346e-03]
 [ 6.40569996e-03  3.40849790e-02  3.83973475e-01 -5.12056282e+00]
 [ 1.95320165e-03  1.43558786e-02  2.12543108e-01 -2.30134960e-01]]
compute_tune_4x4()/ evals =  [0.08510404+0.99637207j 0.08510404-0.99637207j 0.06916894+0.99760496j
 0.06916894-0.99760496j]
compute_tune_4x4()/ angles =  [0.2364388676959893, 0.23898262384742933, 0.7610173761525707, 0.7635611323040107]
compute_tune_4x4()/  0.2364388676959893 0.23898262384742933
compute_tunes()/ 0.2364388676959893 0.23898262384742933

 Running simulation ..
Closed orbit computation: x_co=[ 9.46972589e-10 -6.17887316e-10], y_co=[ 4.39317354e-08 -4.78415316e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 36/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.50506402e-04 -3.95394253e-04  5.62532858e-04 -3.98208464e-04]
 [-1.44605282e-03  8.08859726e-04 -9.71909462e-04 -5.58855146e-04]
 [ 5.29405722e-06 -3.53372917e-04 -4.53337974e-03 -1.35491341e-04]
 [ 1.57078456e-03 -2.82143640e-04 -2.16546140e-03 -5.82051902e-04]
 [ 2.91726441e-03 -3.25976423e-04  6.94080275e-04  1.67205286e-04]
 [-2.31890596e-04  3.87284947e-05 -1.64883670e-03 -2.93459632e-04]
 [ 1.64206251e-03  5.09273528e-06  7.49332461e-03  6.24585691e-04]
 [-1.38572700e-03 -1.62972275e-04  8.55813828e-04 -2.51931110e-04]
 [ 4.76611835e-04 -2.51341773e-05 -2.00048096e-03 -6.61438970e-04]
 [ 1.33487625e-03 -5.63532702e-04  8.17354762e-04 -2.29109416e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009009804665727981
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9568841345220472e-05, theta_kick=2.3463777077082473e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.784971183707848e-05, theta_kick=-1.053351099570642e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0010571010505984171
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1994298173799944e-05, theta_kick=1.4381614812102128e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00010054981994869016, theta_kick=1.205630174416576e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.5929715485207318e-05, theta_kick=-3.1090704507432513e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005388943710039482
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.138562164589732e-06, theta_kick=-8.559404633414268e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620667e-01 -6.31964381e+00  7.59538997e-04  1.19768012e-02]
 [ 1.80005351e-01  4.56112794e-01 -3.66694816e-05  3.82778468e-03]
 [ 1.91471524e-03  1.19754386e-02  3.84048140e-01 -5.11969804e+00]
 [ 7.32571806e-04  6.32961146e-03  2.12566151e-01 -2.29861421e-01]]
compute_tune_4x4()/ evals =  [0.08036086+0.99676584j 0.08036086-0.99676584j 0.07397856+0.99725983j
 0.07397856-0.99725983j]
compute_tune_4x4()/ angles =  [0.23719636530634458, 0.2382151805412522, 0.7617848194587478, 0.7628036346936554]
compute_tune_4x4()/  0.23719636530634458 0.2382151805412522
compute_tunes()/ 0.23719636530634458 0.2382151805412522

 Running simulation ..
Closed orbit computation: x_co=[ 1.60576622e-08 -4.31631486e-08], y_co=[-2.09784844e-05 -6.04776928e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.9568841345220472e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 8.784971183707848e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.1994298173799944e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00010054981994869016, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.5929715485207318e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.138562164589732e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009009804665727981}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0010571010505984171}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005388943710039482}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.50506402e-04 -3.95394253e-04  5.62532858e-04 -3.98208464e-04]
 [-1.44605282e-03  8.08859726e-04 -9.71909462e-04 -5.58855146e-04]
 [ 5.29405722e-06 -3.53372917e-04 -4.53337974e-03 -1.35491341e-04]
 [ 1.57078456e-03 -2.82143640e-04 -2.16546140e-03 -5.82051902e-04]
 [ 2.91726441e-03 -3.25976423e-04  6.94080275e-04  1.67205286e-04]
 [-2.31890596e-04  3.87284947e-05 -1.64883670e-03 -2.93459632e-04]
 [ 1.64206251e-03  5.09273528e-06  7.49332461e-03  6.24585691e-04]
 [-1.38572700e-03 -1.62972275e-04  8.55813828e-04 -2.51931110e-04]
 [ 4.76611835e-04 -2.51341773e-05 -2.00048096e-03 -6.61438970e-04]
 [ 1.33487625e-03 -5.63532702e-04  8.17354762e-04 -2.29109416e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009009804665727981
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3733248135155468e-06, theta_kick=1.646668124611524e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.9214894872336045e-06, theta_kick=-3.502975820192433e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0010571010505984171
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.9782952961845513e-06, theta_kick=3.5710881225201277e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.792650251110863e-06, theta_kick=-2.1494551019759065e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.016510443179401e-07, theta_kick=7.214022400727357e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005388943710039482
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.78498742380382e-07, theta_kick=-3.3393047100650826e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620667e-01 -6.31964381e+00  7.59538997e-04  1.19768012e-02]
 [ 1.80005351e-01  4.56112794e-01 -3.66694816e-05  3.82778468e-03]
 [ 1.91471524e-03  1.19754386e-02  3.84048140e-01 -5.11969804e+00]
 [ 7.32571806e-04  6.32961146e-03  2.12566151e-01 -2.29861421e-01]]
compute_tune_4x4()/ evals =  [0.08036086+0.99676584j 0.08036086-0.99676584j 0.07397856+0.99725983j
 0.07397856-0.99725983j]
compute_tune_4x4()/ angles =  [0.23719636530634458, 0.2382151805412522, 0.7617848194587478, 0.7628036346936554]
compute_tune_4x4()/  0.23719636530634458 0.2382151805412522
compute_tunes()/ 0.23719636530634458 0.2382151805412522

 Running simulation ..
Closed orbit computation: x_co=[-4.74813863e-10  2.72140262e-10], y_co=[3.60312505e-08 2.78560087e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 37/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.18830367e-05  1.29342096e-05  2.77409326e-04 -4.57249639e-04]
 [ 1.17902604e-03  2.46894732e-05 -3.03703811e-03  5.66939132e-04]
 [-2.66807594e-03  4.07089923e-04 -1.16228678e-03 -5.30471474e-04]
 [-2.04263342e-03 -7.16523502e-04  1.13806030e-03 -2.22700680e-04]
 [ 6.56417815e-04  3.29207125e-04 -2.08306541e-03 -4.43502653e-04]
 [-3.49795085e-03  1.35072929e-04 -1.10227058e-03 -1.66171014e-04]
 [-1.29246149e-03  1.12661917e-05 -4.02884422e-03 -1.27682037e-04]
 [-1.18349034e-03 -2.97910179e-04 -1.30720778e-03  3.19471001e-04]
 [ 1.39396772e-03 -8.63448316e-05 -1.33309459e-03 -1.59666479e-04]
 [-9.97984494e-04 -1.46355200e-04  1.12371847e-03 -2.15483052e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008766534346738101
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.668550058622439e-05, theta_kick=5.5977671808081736e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.4946932788066218e-05, theta_kick=2.9912311075030102e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009762627222004964
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.781439159567194e-06, theta_kick=6.932163086800851e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.771736160043144e-05, theta_kick=-4.52245357257386e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.1103747981295115e-05, theta_kick=6.127531667731462e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008782228725393107
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.120706928076726e-05, theta_kick=3.7418450275894027e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657031e-01 -6.31975150e+00 -2.43564777e-03 -3.56756250e-02]
 [ 1.80008523e-01  4.56135427e-01 -5.35590157e-04 -2.64065579e-03]
 [-5.84398176e-03 -3.56749157e-02  3.84058460e-01 -5.11954066e+00]
 [-1.67230048e-03 -8.03961657e-03  2.12571341e-01 -2.29795611e-01]]
compute_tune_4x4()/ evals =  [0.08189942+0.9966406j  0.08189942-0.9966406j  0.0724712 +0.99737051j
 0.0724712 -0.99737051j]
compute_tune_4x4()/ angles =  [0.23695068676482578, 0.23845572941236387, 0.7615442705876361, 0.7630493132351742]
compute_tune_4x4()/  0.23695068676482578 0.23845572941236387
compute_tunes()/ 0.23695068676482578 0.23845572941236387

 Running simulation ..
Closed orbit computation: x_co=[ 3.80778471e-08 -6.11523364e-09], y_co=[-2.36352324e-06  1.02703940e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.668550058622439e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.4946932788066218e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.781439159567194e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.771736160043144e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.1103747981295115e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.120706928076726e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008766534346738101}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0009762627222004964}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0008782228725393107}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.18830367e-05  1.29342096e-05  2.77409326e-04 -4.57249639e-04]
 [ 1.17902604e-03  2.46894732e-05 -3.03703811e-03  5.66939132e-04]
 [-2.66807594e-03  4.07089923e-04 -1.16228678e-03 -5.30471474e-04]
 [-2.04263342e-03 -7.16523502e-04  1.13806030e-03 -2.22700680e-04]
 [ 6.56417815e-04  3.29207125e-04 -2.08306541e-03 -4.43502653e-04]
 [-3.49795085e-03  1.35072929e-04 -1.10227058e-03 -1.66171014e-04]
 [-1.29246149e-03  1.12661917e-05 -4.02884422e-03 -1.27682037e-04]
 [-1.18349034e-03 -2.97910179e-04 -1.30720778e-03  3.19471001e-04]
 [ 1.39396772e-03 -8.63448316e-05 -1.33309459e-03 -1.59666479e-04]
 [-9.97984494e-04 -1.46355200e-04  1.12371847e-03 -2.15483052e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008766534346738101
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.69466402655794e-07, theta_kick=-9.226191689999989e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.797070824202391e-07, theta_kick=6.950906040861008e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009762627222004964
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.469827723991648e-07, theta_kick=7.757566877097985e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1348216946374751e-06, theta_kick=-1.3606939110737973e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.776305023786935e-07, theta_kick=4.527931812112353e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008782228725393107
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.810669504808329e-07, theta_kick=4.5691361178671516e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657031e-01 -6.31975150e+00 -2.43564777e-03 -3.56756250e-02]
 [ 1.80008523e-01  4.56135427e-01 -5.35590157e-04 -2.64065579e-03]
 [-5.84398176e-03 -3.56749157e-02  3.84058460e-01 -5.11954066e+00]
 [-1.67230048e-03 -8.03961657e-03  2.12571341e-01 -2.29795611e-01]]
compute_tune_4x4()/ evals =  [0.08189942+0.9966406j  0.08189942-0.9966406j  0.0724712 +0.99737051j
 0.0724712 -0.99737051j]
compute_tune_4x4()/ angles =  [0.23695068676482578, 0.23845572941236387, 0.7615442705876361, 0.7630493132351742]
compute_tune_4x4()/  0.23695068676482578 0.23845572941236387
compute_tunes()/ 0.23695068676482578 0.23845572941236387

 Running simulation ..
Closed orbit computation: x_co=[-1.54507396e-10  1.98526184e-10], y_co=[ 5.91136961e-08 -3.70212696e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 38/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.90833653e-03  1.68838600e-04 -2.98009825e-03 -2.09810682e-04]
 [-1.16882269e-03  1.29060876e-04 -2.94625436e-04 -2.57333017e-04]
 [ 3.21932398e-03 -6.13769822e-04  4.05669064e-03  1.19841445e-04]
 [-3.59624117e-03  6.50771998e-04 -8.89894652e-04 -6.76866004e-05]
 [-6.05431680e-04 -9.17020990e-05 -1.18276145e-04 -9.61058267e-05]
 [-2.15004076e-03  5.39972971e-04 -9.77409266e-04 -2.95602243e-04]
 [ 2.44964138e-03 -2.81395817e-04  2.91879255e-03  6.80592885e-04]
 [ 1.21333370e-03 -3.75882447e-04  1.47264830e-03  3.05498748e-04]
 [-9.50659372e-04 -2.40462991e-04  5.46174583e-04 -2.70969420e-04]
 [-1.06383869e-03 -4.22405247e-04  1.64503208e-03  2.07759188e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006764554357062794
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.936765743426933e-05, theta_kick=-2.3222549998034884e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.2173706331644029e-05, theta_kick=1.4596731943832148e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006904041903306565
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.334571764334218e-05, theta_kick=-2.799239386861719e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1239713050761857e-05, theta_kick=-1.3476838857292063e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.319569536419496e-05, theta_kick=-5.179326403821975e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.001001824946036963
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.01081681884096e-05, theta_kick=6.00815790456066e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636810e-01 -6.31974693e+00  6.78571748e-03  1.21381642e-02]
 [ 1.79989433e-01  4.56098248e-01 -1.02021381e-03  1.11955849e-02]
 [ 6.81352163e-03  1.21387743e-02  3.84057554e-01 -5.11905744e+00]
 [ 1.39241744e-03  1.54480819e-02  2.12576098e-01 -2.29855150e-01]]
compute_tune_4x4()/ evals =  [0.08717129+0.99619334j 0.08717129-0.99619334j 0.06716063+0.99774218j
 0.06716063-0.99774218j]
compute_tune_4x4()/ angles =  [0.23610862786416284, 0.23930300112635305, 0.760696998873647, 0.7638913721358371]
compute_tune_4x4()/  0.23610862786416284 0.23930300112635305
compute_tunes()/ 0.23610862786416284 0.23930300112635305

 Running simulation ..
Closed orbit computation: x_co=[ 1.54327973e-07 -1.08408652e-09], y_co=[3.97336624e-05 1.31769509e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.936765743426933e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.2173706331644029e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.334571764334218e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.1239713050761857e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.319569536419496e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.01081681884096e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006764554357062794}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006904041903306565}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.001001824946036963}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.90833653e-03  1.68838600e-04 -2.98009825e-03 -2.09810682e-04]
 [-1.16882269e-03  1.29060876e-04 -2.94625436e-04 -2.57333017e-04]
 [ 3.21932398e-03 -6.13769822e-04  4.05669064e-03  1.19841445e-04]
 [-3.59624117e-03  6.50771998e-04 -8.89894652e-04 -6.76866004e-05]
 [-6.05431680e-04 -9.17020990e-05 -1.18276145e-04 -9.61058267e-05]
 [-2.15004076e-03  5.39972971e-04 -9.77409266e-04 -2.95602243e-04]
 [ 2.44964138e-03 -2.81395817e-04  2.91879255e-03  6.80592885e-04]
 [ 1.21333370e-03 -3.75882447e-04  1.47264830e-03  3.05498748e-04]
 [-9.50659372e-04 -2.40462991e-04  5.46174583e-04 -2.70969420e-04]
 [-1.06383869e-03 -4.22405247e-04  1.64503208e-03  2.07759188e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006764554357062794
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.669361149436173e-09, theta_kick=-9.195852588275964e-10
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0831020993198396e-07, theta_kick=-1.2986801702681204e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006904041903306565
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.0061248689180113e-06, theta_kick=1.2063815746437627e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2028387501944236e-06, theta_kick=-1.4422489199204283e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.2129129469484195e-07, theta_kick=5.051441139947501e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.001001824946036963
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.378161235044724e-07, theta_kick=-1.652467176001919e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636810e-01 -6.31974693e+00  6.78571748e-03  1.21381642e-02]
 [ 1.79989433e-01  4.56098248e-01 -1.02021381e-03  1.11955849e-02]
 [ 6.81352163e-03  1.21387743e-02  3.84057554e-01 -5.11905744e+00]
 [ 1.39241744e-03  1.54480819e-02  2.12576098e-01 -2.29855150e-01]]
compute_tune_4x4()/ evals =  [0.08717129+0.99619334j 0.08717129-0.99619334j 0.06716063+0.99774218j
 0.06716063-0.99774218j]
compute_tune_4x4()/ angles =  [0.23610862786416284, 0.23930300112635305, 0.760696998873647, 0.7638913721358371]
compute_tune_4x4()/  0.23610862786416284 0.23930300112635305
compute_tunes()/ 0.23610862786416284 0.23930300112635305

 Running simulation ..
Closed orbit computation: x_co=[-1.66179003e-09  3.32279335e-10], y_co=[-3.80263141e-08  3.19294595e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 39/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.49189010e-03  9.67816141e-05 -2.74623313e-03 -2.05642887e-04]
 [-2.86151265e-05 -9.23595743e-05  8.71332845e-05  3.92676253e-04]
 [-6.56018594e-04 -5.38696666e-05 -6.73823390e-04 -8.34899184e-04]
 [-3.89631516e-04 -5.90077585e-05 -1.69766118e-04  9.59182063e-04]
 [-3.87029227e-03 -5.07073754e-04 -2.73407572e-04 -2.08544195e-06]
 [ 2.99178039e-03 -3.80785612e-04 -6.72679537e-04 -4.89776355e-04]
 [-2.30176806e-03 -1.37170492e-04  5.40374259e-03  5.84886226e-04]
 [-1.88777098e-03 -4.02684927e-05  3.94437241e-03  5.92387955e-04]
 [ 5.76983481e-05  1.67346055e-04 -4.65790758e-04  4.68663305e-04]
 [-6.98672808e-04 -4.83482884e-04  2.09793087e-03 -1.52400192e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.001345763615080621
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.5191388596241694e-05, theta_kick=-5.418617531410496e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.593433732445291e-05, theta_kick=-7.905775132077405e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009508350449643306
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.061293472467997e-05, theta_kick=4.869643685157368e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.949257750589836e-05, theta_kick=-5.934346265484233e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.027018268786113e-05, theta_kick=-8.425659305355553e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0026697820739966472
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0902395413042409e-05, theta_kick=-1.3072382317633404e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708879e-01 -6.32011816e+00  5.92165120e-03 -2.22791094e-02]
 [ 1.80000196e-01  4.56223694e-01 -1.81443732e-03  1.09184919e-02]
 [ 2.37904180e-03 -2.22756820e-02  3.84011366e-01 -5.11884717e+00]
 [-3.30949249e-05  1.04952613e-02  2.12588825e-01 -2.29769074e-01]]
compute_tune_4x4()/ evals =  [0.08457705+0.99641694j 0.08457705-0.99641694j 0.0698015 +0.9975609j
 0.0698015 -0.9975609j ]
compute_tune_4x4()/ angles =  [0.23652304394205173, 0.23888170500745046, 0.7611182949925496, 0.7634769560579483]
compute_tune_4x4()/  0.23652304394205173 0.23888170500745046
compute_tunes()/ 0.23652304394205173 0.23888170500745046

 Running simulation ..
Closed orbit computation: x_co=[-2.96752806e-07  9.27312565e-09], y_co=[4.59423597e-05 2.19853773e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.5191388596241694e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.593433732445291e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.061293472467997e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.949257750589836e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.027018268786113e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.0902395413042409e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.001345763615080621}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.009508350449643306}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0026697820739966472}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.49189010e-03  9.67816141e-05 -2.74623313e-03 -2.05642887e-04]
 [-2.86151265e-05 -9.23595743e-05  8.71332845e-05  3.92676253e-04]
 [-6.56018594e-04 -5.38696666e-05 -6.73823390e-04 -8.34899184e-04]
 [-3.89631516e-04 -5.90077585e-05 -1.69766118e-04  9.59182063e-04]
 [-3.87029227e-03 -5.07073754e-04 -2.73407572e-04 -2.08544195e-06]
 [ 2.99178039e-03 -3.80785612e-04 -6.72679537e-04 -4.89776355e-04]
 [-2.30176806e-03 -1.37170492e-04  5.40374259e-03  5.84886226e-04]
 [-1.88777098e-03 -4.02684927e-05  3.94437241e-03  5.92387955e-04]
 [ 5.76983481e-05  1.67346055e-04 -4.65790758e-04  4.68663305e-04]
 [-6.98672808e-04 -4.83482884e-04  2.09793087e-03 -1.52400192e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.001345763615080621
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.6110101344868944e-07, theta_kick=4.32973702039749e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.905399843058516e-08, theta_kick=-7.080796610495578e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009508350449643306
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.79456177652637e-07, theta_kick=8.146935224645719e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.417273284769316e-06, theta_kick=-1.6993639952655558e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.1099737537305544e-06, theta_kick=1.3309002949889643e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0026697820739966472
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.96613542485879e-07, theta_kick=-7.153620858332642e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708879e-01 -6.32011816e+00  5.92165120e-03 -2.22791094e-02]
 [ 1.80000196e-01  4.56223694e-01 -1.81443732e-03  1.09184919e-02]
 [ 2.37904180e-03 -2.22756820e-02  3.84011366e-01 -5.11884717e+00]
 [-3.30949249e-05  1.04952613e-02  2.12588825e-01 -2.29769074e-01]]
compute_tune_4x4()/ evals =  [0.08457705+0.99641694j 0.08457705-0.99641694j 0.0698015 +0.9975609j
 0.0698015 -0.9975609j ]
compute_tune_4x4()/ angles =  [0.23652304394205173, 0.23888170500745046, 0.7611182949925496, 0.7634769560579483]
compute_tune_4x4()/  0.23652304394205173 0.23888170500745046
compute_tunes()/ 0.23652304394205173 0.23888170500745046

 Running simulation ..
Closed orbit computation: x_co=[-1.13668825e-09  1.31446720e-10], y_co=[-1.38681436e-07  4.86120370e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 40/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.79978863e-03  8.34679035e-05  8.15884572e-04  2.73597389e-04]
 [-2.58684472e-03  9.18400735e-04 -7.92725336e-04 -5.04767817e-04]
 [-1.87873579e-03  1.36640956e-04  1.45910216e-03  5.45143343e-04]
 [ 5.25381363e-04 -1.31171905e-04 -2.57104408e-03 -5.32809015e-04]
 [-1.01230691e-03  1.44003495e-04 -3.03124301e-03  3.27858308e-04]
 [-3.06915791e-03 -3.39831854e-04  1.41611937e-04  1.91894701e-04]
 [ 1.82614780e-03  2.88105558e-04  8.13735725e-04 -6.30170868e-05]
 [-1.59708570e-03  3.84823705e-04 -8.65947706e-04  1.02452135e-04]
 [-2.22092084e-04  6.33699828e-04 -3.78439471e-03 -4.70921541e-04]
 [ 4.98519632e-03 -5.62631347e-04 -1.05153574e-03 -5.97324462e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018099492004256246
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.077861432504826e-05, theta_kick=-1.0884697424406352e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.137799269562805e-05, theta_kick=-6.1604146408628675e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00029818604993694784
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0012134632530615e-05, theta_kick=-1.2004926144531968e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8447536295600635e-05, theta_kick=2.21192901319669e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.707105787393787e-05, theta_kick=8.042072203025697e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01295876070856943
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.7665683189429656e-05, theta_kick=5.715294763002302e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01246892e-01 -6.31767524e+00  1.53591660e-02  1.28339850e-01]
 [ 1.80039573e-01  4.56292595e-01  1.25421745e-03  1.21193361e-02]
 [ 2.63678933e-02  1.28342143e-01  3.83876592e-01 -5.12101051e+00]
 [ 6.41021878e-03  3.21556987e-02  2.12524363e-01 -2.30190314e-01]]
compute_tune_4x4()/ evals =  [0.09856737+0.99513038j 0.09856737-0.99513038j 0.05579862+0.99844204j
 0.05579862-0.99844204j]
compute_tune_4x4()/ angles =  [0.23428700235405706, 0.24111475875464353, 0.7588852412453565, 0.7657129976459429]
compute_tune_4x4()/  0.23428700235405706 0.24111475875464353
compute_tunes()/ 0.23428700235405706 0.24111475875464353

 Running simulation ..
Closed orbit computation: x_co=[ 5.70675855e-08 -4.59739150e-07], y_co=[ 6.42062901e-06 -2.24499881e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.077861432504826e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.137799269562805e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.0012134632530615e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8447536295600635e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.707105787393787e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.7665683189429656e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.018099492004256246}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00029818604993694784}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.01295876070856943}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.79978863e-03  8.34679035e-05  8.15884572e-04  2.73597389e-04]
 [-2.58684472e-03  9.18400735e-04 -7.92725336e-04 -5.04767817e-04]
 [-1.87873579e-03  1.36640956e-04  1.45910216e-03  5.45143343e-04]
 [ 5.25381363e-04 -1.31171905e-04 -2.57104408e-03 -5.32809015e-04]
 [-1.01230691e-03  1.44003495e-04 -3.03124301e-03  3.27858308e-04]
 [-3.06915791e-03 -3.39831854e-04  1.41611937e-04  1.91894701e-04]
 [ 1.82614780e-03  2.88105558e-04  8.13735725e-04 -6.30170868e-05]
 [-1.59708570e-03  3.84823705e-04 -8.65947706e-04  1.02452135e-04]
 [-2.22092084e-04  6.33699828e-04 -3.78439471e-03 -4.70921541e-04]
 [ 4.98519632e-03 -5.62631347e-04 -1.05153574e-03 -5.97324462e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018099492004256246
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.76347254431017e-07, theta_kick=1.0507733318153176e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.1009985908980854e-06, theta_kick=-2.519176363404752e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00029818604993694784
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.8042961097979059e-06, theta_kick=2.1634189247328792e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.752275130064885e-07, theta_kick=-6.897194318091468e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0445366536417035e-07, theta_kick=1.2524387498229016e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01295876070856943
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.641293692806366e-08, theta_kick=9.162198651700749e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01246892e-01 -6.31767524e+00  1.53591660e-02  1.28339850e-01]
 [ 1.80039573e-01  4.56292595e-01  1.25421745e-03  1.21193361e-02]
 [ 2.63678933e-02  1.28342143e-01  3.83876592e-01 -5.12101051e+00]
 [ 6.41021878e-03  3.21556987e-02  2.12524363e-01 -2.30190314e-01]]
compute_tune_4x4()/ evals =  [0.09856737+0.99513038j 0.09856737-0.99513038j 0.05579862+0.99844204j
 0.05579862-0.99844204j]
compute_tune_4x4()/ angles =  [0.23428700235405706, 0.24111475875464353, 0.7588852412453565, 0.7657129976459429]
compute_tune_4x4()/  0.23428700235405706 0.24111475875464353
compute_tunes()/ 0.23428700235405706 0.24111475875464353

 Running simulation ..
Closed orbit computation: x_co=[-1.39949904e-11 -3.81309195e-10], y_co=[ 2.17301455e-08 -1.98223051e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 41/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.76729215e-03 -4.65517604e-04  3.49241956e-03  1.37961194e-04]
 [-2.33553089e-03  9.09779795e-05 -1.33495552e-03 -8.97658143e-04]
 [ 7.46653727e-04  1.79871818e-04  4.69802749e-03  9.28755593e-04]
 [-2.68494495e-03  1.23778686e-03 -1.98771693e-03  3.73859060e-04]
 [ 1.24532926e-03 -1.08375139e-04 -1.30529592e-03 -9.21816603e-05]
 [-2.88542310e-03  6.22965595e-04  2.85643647e-03  7.42510447e-04]
 [ 1.27075056e-03  2.77958739e-04 -5.03610285e-03  5.61980270e-05]
 [-9.32159567e-05 -3.20359269e-04 -1.06714930e-03 -5.02245003e-04]
 [ 1.46768932e-04 -2.31566127e-05  2.90200512e-03  7.40151202e-04]
 [-3.94127144e-03  7.23595850e-04  5.16777337e-03  2.74182725e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012419761434677481
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.9734135666530374e-05, theta_kick=4.764272371484734e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.6525975896815044e-05, theta_kick=6.777677196669316e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011281787363585547
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.026096688464202e-05, theta_kick=4.827441416810142e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.463059839605196e-05, theta_kick=7.74945192906781e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.4453015760081545e-06, theta_kick=-4.131046223772502e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00032026221842006467
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.154501331306897e-05, theta_kick=4.981403414977154e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01674155e-01 -6.32031552e+00 -5.72759405e-04  8.59870082e-02]
 [ 1.80046220e-01  4.56503583e-01  2.76369339e-03 -7.07919407e-03]
 [ 8.86256575e-03  8.59652291e-02  3.83932407e-01 -5.11990715e+00]
 [ 3.00460779e-03  2.78753878e-03  2.12599608e-01 -2.29875530e-01]]
compute_tune_4x4()/ evals =  [0.07823452+0.99693498j 0.07823452-0.99693498j 0.07620863+0.99709189j
 0.07620863-0.99709189j]
compute_tune_4x4()/ angles =  [0.23753585237828517, 0.2378592485228253, 0.7621407514771747, 0.7624641476217149]
compute_tune_4x4()/  0.23753585237828517 0.2378592485228253
compute_tunes()/ 0.23753585237828517 0.2378592485228253

 Running simulation ..
Closed orbit computation: x_co=[ 3.26089047e-08 -4.04105987e-08], y_co=[-5.81207836e-05  7.70517940e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.9734135666530374e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.6525975896815044e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.026096688464202e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.463059839605196e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.4453015760081545e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.154501331306897e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.012419761434677481}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.011281787363585547}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00032026221842006467}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.76729215e-03 -4.65517604e-04  3.49241956e-03  1.37961194e-04]
 [-2.33553089e-03  9.09779795e-05 -1.33495552e-03 -8.97658143e-04]
 [ 7.46653727e-04  1.79871818e-04  4.69802749e-03  9.28755593e-04]
 [-2.68494495e-03  1.23778686e-03 -1.98771693e-03  3.73859060e-04]
 [ 1.24532926e-03 -1.08375139e-04 -1.30529592e-03 -9.21816603e-05]
 [-2.88542310e-03  6.22965595e-04  2.85643647e-03  7.42510447e-04]
 [ 1.27075056e-03  2.77958739e-04 -5.03610285e-03  5.61980270e-05]
 [-9.32159567e-05 -3.20359269e-04 -1.06714930e-03 -5.02245003e-04]
 [ 1.46768932e-04 -2.31566127e-05  2.90200512e-03  7.40151202e-04]
 [-3.94127144e-03  7.23595850e-04  5.16777337e-03  2.74182725e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012419761434677481
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.740016508439747e-07, theta_kick=-9.280571022224839e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.347019990278614e-06, theta_kick=2.814165278150413e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011281787363585547
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.1175615159150925e-06, theta_kick=-4.937111186411788e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.326643144468128e-06, theta_kick=5.18780792602637e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.52900010220032e-06, theta_kick=-3.0323662795927556e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00032026221842006467
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.517647200533766e-07, theta_kick=1.0212979481453719e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01674155e-01 -6.32031552e+00 -5.72759405e-04  8.59870082e-02]
 [ 1.80046220e-01  4.56503583e-01  2.76369339e-03 -7.07919407e-03]
 [ 8.86256575e-03  8.59652291e-02  3.83932407e-01 -5.11990715e+00]
 [ 3.00460779e-03  2.78753878e-03  2.12599608e-01 -2.29875530e-01]]
compute_tune_4x4()/ evals =  [0.07823452+0.99693498j 0.07823452-0.99693498j 0.07620863+0.99709189j
 0.07620863-0.99709189j]
compute_tune_4x4()/ angles =  [0.23753585237828517, 0.2378592485228253, 0.7621407514771747, 0.7624641476217149]
compute_tune_4x4()/  0.23753585237828517 0.2378592485228253
compute_tunes()/ 0.23753585237828517 0.2378592485228253

 Running simulation ..
Closed orbit computation: x_co=[-7.20218118e-09  9.00105040e-10], y_co=[ 2.00143102e-07 -6.21210674e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 42/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.00769781e-03  2.42677643e-04 -2.69129973e-03 -9.44489756e-04]
 [-1.36367135e-03 -1.35613862e-04 -3.46470537e-03  3.39238851e-04]
 [-2.05549064e-03 -3.42466980e-04 -1.38546197e-03 -1.84695992e-05]
 [-1.39277213e-03  3.78103123e-04  2.96474199e-03  7.70758689e-04]
 [ 2.83664547e-03 -7.91876572e-04  2.31474987e-03 -2.05625635e-04]
 [ 3.60249632e-04 -8.99044807e-05 -3.47727958e-03 -2.51518376e-04]
 [ 1.00560862e-04 -3.59007587e-04 -1.48110075e-03  8.11714935e-05]
 [ 2.91559685e-03 -3.46190222e-04  2.14427961e-03  4.20054094e-04]
 [-1.57900027e-03 -3.83955085e-04 -1.24259397e-03  3.27341837e-04]
 [ 9.45628408e-04  4.89388073e-05 -6.23412983e-05 -1.84737859e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.003416063798383526
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.337239807537672e-05, theta_kick=2.8024384710514e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1266260848100262e-06, theta_kick=-1.3508670665197647e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006936446497232969
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.295963858927505e-06, theta_kick=8.74813518737722e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.7687552848773886e-05, theta_kick=-6.916954643799808e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.1757721841944119e-05, theta_kick=1.4097950888702048e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006883821183758155
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.791562315404167e-05, theta_kick=1.0541414010610567e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627419e-01 -6.32024344e+00 -5.82256893e-04  3.46937988e-02]
 [ 1.79996137e-01  4.56099096e-01  1.49335020e-03 -7.55179558e-03]
 [ 3.29298664e-03  3.47041827e-02  3.84092771e-01 -5.11954980e+00]
 [ 9.22742942e-04 -4.67352841e-03  2.12588250e-01 -2.29915075e-01]]
compute_tune_4x4()/ evals =  [0.07952935+0.99683252j 0.07952935-0.99683252j 0.07479533+0.99719891j
 0.07479533-0.99719891j]
compute_tune_4x4()/ angles =  [0.2373291295081117, 0.23808482550493676, 0.7619151744950632, 0.7626708704918883]
compute_tune_4x4()/  0.2373291295081117 0.23808482550493676
compute_tunes()/ 0.2373291295081117 0.23808482550493676

 Running simulation ..
Closed orbit computation: x_co=[-4.08114392e-07  2.70730819e-08], y_co=[ 4.22129007e-05 -1.75361443e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.337239807537672e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.1266260848100262e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.295963858927505e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.7687552848773886e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.1757721841944119e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.791562315404167e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.003416063798383526}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006936446497232969}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006883821183758155}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.00769781e-03  2.42677643e-04 -2.69129973e-03 -9.44489756e-04]
 [-1.36367135e-03 -1.35613862e-04 -3.46470537e-03  3.39238851e-04]
 [-2.05549064e-03 -3.42466980e-04 -1.38546197e-03 -1.84695992e-05]
 [-1.39277213e-03  3.78103123e-04  2.96474199e-03  7.70758689e-04]
 [ 2.83664547e-03 -7.91876572e-04  2.31474987e-03 -2.05625635e-04]
 [ 3.60249632e-04 -8.99044807e-05 -3.47727958e-03 -2.51518376e-04]
 [ 1.00560862e-04 -3.59007587e-04 -1.48110075e-03  8.11714935e-05]
 [ 2.91559685e-03 -3.46190222e-04  2.14427961e-03  4.20054094e-04]
 [-1.57900027e-03 -3.83955085e-04 -1.24259397e-03  3.27341837e-04]
 [ 9.45628408e-04  4.89388073e-05 -6.23412983e-05 -1.84737859e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.003416063798383526
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.7864496981809834e-07, theta_kick=-4.5400956584179324e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0653723344108824e-06, theta_kick=1.2774215150358594e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006936446497232969
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0755810774533094e-06, theta_kick=-1.289662182061515e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.198432536899402e-07, theta_kick=7.432153836162841e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.828629645833577e-07, theta_kick=-3.391633376376482e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006883821183758155
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.0853872980674793e-07, theta_kick=3.699495462259394e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627419e-01 -6.32024344e+00 -5.82256893e-04  3.46937988e-02]
 [ 1.79996137e-01  4.56099096e-01  1.49335020e-03 -7.55179558e-03]
 [ 3.29298664e-03  3.47041827e-02  3.84092771e-01 -5.11954980e+00]
 [ 9.22742942e-04 -4.67352841e-03  2.12588250e-01 -2.29915075e-01]]
compute_tune_4x4()/ evals =  [0.07952935+0.99683252j 0.07952935-0.99683252j 0.07479533+0.99719891j
 0.07479533-0.99719891j]
compute_tune_4x4()/ angles =  [0.2373291295081117, 0.23808482550493676, 0.7619151744950632, 0.7626708704918883]
compute_tune_4x4()/  0.2373291295081117 0.23808482550493676
compute_tunes()/ 0.2373291295081117 0.23808482550493676

 Running simulation ..
Closed orbit computation: x_co=[-1.76695744e-09  2.41500405e-10], y_co=[ 6.56721057e-08 -4.90113847e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 43/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.12964895e-03 -4.43508947e-04  2.18879480e-03  1.33076513e-04]
 [-7.21320266e-04  3.61338644e-04  3.48426783e-03 -3.45876746e-04]
 [-1.22895721e-03  6.27448523e-04  7.98627300e-04 -4.74577437e-04]
 [ 3.60329606e-03 -6.19462903e-04  1.13430608e-03  2.06490451e-04]
 [ 1.85776635e-03  1.01739259e-03  2.00730814e-03  2.59945929e-04]
 [-2.34850073e-03  5.09560073e-04 -5.08697987e-04  3.09052057e-04]
 [-2.06400423e-03 -1.16513749e-04 -7.64725277e-04  3.73146670e-05]
 [ 1.55827030e-03 -4.09388155e-04  4.62243069e-04 -2.64682030e-04]
 [ 9.79996325e-04 -2.94118641e-04 -1.10712650e-03 -4.67090645e-04]
 [ 1.94154703e-03 -4.11979392e-05 -3.16147179e-03  5.30240923e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008381088932420193
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.1014118507380295e-06, theta_kick=6.116784756566039e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.533562033710168e-06, theta_kick=5.43591145983107e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010963086351233553
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.9092528035259625e-05, theta_kick=5.886378828714325e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.535882343195019e-05, theta_kick=3.0406183454990397e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.180585493688407e-06, theta_kick=-7.410754559833682e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010929757746822177
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2026692856422295e-05, theta_kick=-1.4420457255460142e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01455362e-01 -6.32029261e+00  2.06949674e-03 -4.26120936e-02]
 [ 1.79984920e-01  4.56086396e-01 -2.23300856e-03  1.32799678e-02]
 [-2.94743591e-03 -4.26542930e-02  3.84081407e-01 -5.12019209e+00]
 [-8.48603393e-04  1.06783466e-02  2.12593931e-01 -2.30300379e-01]]
compute_tune_4x4()/ evals =  [0.08284663+0.99656231j 0.08284663-0.99656231j 0.0713594 +0.99745067j
 0.0713594 -0.99745067j]
compute_tune_4x4()/ angles =  [0.23679941892534478, 0.23863313804210542, 0.7613668619578946, 0.7632005810746552]
compute_tune_4x4()/  0.23679941892534478 0.23863313804210542
compute_tunes()/ 0.23679941892534478 0.23863313804210542

 Running simulation ..
Closed orbit computation: x_co=[-3.45572450e-07 -4.15813382e-08], y_co=[-3.85237195e-05  7.16794437e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.1014118507380295e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.533562033710168e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.9092528035259625e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.535882343195019e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.180585493688407e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.2026692856422295e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008381088932420193}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.010963086351233553}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010929757746822177}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.12964895e-03 -4.43508947e-04  2.18879480e-03  1.33076513e-04]
 [-7.21320266e-04  3.61338644e-04  3.48426783e-03 -3.45876746e-04]
 [-1.22895721e-03  6.27448523e-04  7.98627300e-04 -4.74577437e-04]
 [ 3.60329606e-03 -6.19462903e-04  1.13430608e-03  2.06490451e-04]
 [ 1.85776635e-03  1.01739259e-03  2.00730814e-03  2.59945929e-04]
 [-2.34850073e-03  5.09560073e-04 -5.08697987e-04  3.09052057e-04]
 [-2.06400423e-03 -1.16513749e-04 -7.64725277e-04  3.73146670e-05]
 [ 1.55827030e-03 -4.09388155e-04  4.62243069e-04 -2.64682030e-04]
 [ 9.79996325e-04 -2.94118641e-04 -1.10712650e-03 -4.67090645e-04]
 [ 1.94154703e-03 -4.11979392e-05 -3.16147179e-03  5.30240923e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008381088932420193
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.886260576856549e-08, theta_kick=-9.455923162887758e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.227320982137274e-07, theta_kick=1.1063905048033665e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010963086351233553
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.8137385162051713e-06, theta_kick=-2.174740725298522e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3769415364983825e-06, theta_kick=1.6510047115520455e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.0985116063354587e-07, theta_kick=-4.914269628047155e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010929757746822177
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.714791875866753e-07, theta_kick=2.056099980531385e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01455362e-01 -6.32029261e+00  2.06949674e-03 -4.26120936e-02]
 [ 1.79984920e-01  4.56086396e-01 -2.23300856e-03  1.32799678e-02]
 [-2.94743591e-03 -4.26542930e-02  3.84081407e-01 -5.12019209e+00]
 [-8.48603393e-04  1.06783466e-02  2.12593931e-01 -2.30300379e-01]]
compute_tune_4x4()/ evals =  [0.08284663+0.99656231j 0.08284663-0.99656231j 0.0713594 +0.99745067j
 0.0713594 -0.99745067j]
compute_tune_4x4()/ angles =  [0.23679941892534478, 0.23863313804210542, 0.7613668619578946, 0.7632005810746552]
compute_tune_4x4()/  0.23679941892534478 0.23863313804210542
compute_tunes()/ 0.23679941892534478 0.23863313804210542

 Running simulation ..
Closed orbit computation: x_co=[ 4.81481474e-09 -4.24482499e-10], y_co=[ 9.54049518e-08 -6.60030064e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 44/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.01212762e-04 -5.36482229e-04  1.14404883e-03  4.60066401e-04]
 [ 3.30649670e-03  7.32571396e-04 -3.11786037e-03  1.41411719e-04]
 [-5.10503489e-03 -4.08797662e-04  1.62441989e-03  3.81305603e-04]
 [-4.77225258e-04 -8.17005956e-04 -3.19747319e-04 -8.61549164e-05]
 [ 1.47010260e-03 -8.67061445e-04  1.38922418e-03 -7.76804119e-06]
 [-3.34130028e-03  4.45221454e-04 -7.85744781e-04 -7.76253964e-04]
 [-1.84110987e-03  5.12717352e-04  2.50463846e-03  6.03265463e-04]
 [-3.54993455e-03  1.01349305e-04 -5.78378219e-03 -2.17251025e-04]
 [ 3.00889472e-03 -9.89226275e-04  2.97929754e-03 -5.83616434e-04]
 [ 2.05036924e-03  5.58594978e-04 -1.25532308e-03  5.21345418e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009449255185641879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.195001188638118e-05, theta_kick=5.029964267779281e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.5867090287059538e-05, theta_kick=-3.1015614538495418e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00555160139214988
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.9572814244787058e-05, theta_kick=-3.545891699669431e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.662014783126222e-06, theta_kick=-1.0386081645007926e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5215451503356754e-05, theta_kick=1.824389885449807e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.025410607566779087
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.840898902875801e-05, theta_kick=-5.804419929926678e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00975817e-01 -6.31811284e+00  1.67079354e-02  1.61219281e-01]
 [ 1.80066320e-01  4.56359631e-01  2.53471166e-03  4.93970640e-03]
 [ 3.10233364e-02  1.61268404e-01  3.83801467e-01 -5.12300599e+00]
 [ 7.35278094e-03  2.77100805e-02  2.12531347e-01 -2.30518276e-01]]
compute_tune_4x4()/ evals =  [0.09715596+0.99526917j 0.09715596-0.99526917j 0.05717755+0.99836403j
 0.05717755-0.99836403j]
compute_tune_4x4()/ angles =  [0.23451271878576518, 0.24089494531662914, 0.7591050546833709, 0.7654872812142348]
compute_tune_4x4()/  0.23451271878576518 0.24089494531662914
compute_tunes()/ 0.23451271878576518 0.24089494531662914

 Running simulation ..
Closed orbit computation: x_co=[-3.54319947e-08  1.48058225e-08], y_co=[7.96493244e-06 4.93396446e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.195001188638118e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.5867090287059538e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.9572814244787058e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 8.662014783126222e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.5215451503356754e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.840898902875801e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009449255185641879}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00555160139214988}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.025410607566779087}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.01212762e-04 -5.36482229e-04  1.14404883e-03  4.60066401e-04]
 [ 3.30649670e-03  7.32571396e-04 -3.11786037e-03  1.41411719e-04]
 [-5.10503489e-03 -4.08797662e-04  1.62441989e-03  3.81305603e-04]
 [-4.77225258e-04 -8.17005956e-04 -3.19747319e-04 -8.61549164e-05]
 [ 1.47010260e-03 -8.67061445e-04  1.38922418e-03 -7.76804119e-06]
 [-3.34130028e-03  4.45221454e-04 -7.85744781e-04 -7.76253964e-04]
 [-1.84110987e-03  5.12717352e-04  2.50463846e-03  6.03265463e-04]
 [-3.54993455e-03  1.01349305e-04 -5.78378219e-03 -2.17251025e-04]
 [ 3.00889472e-03 -9.89226275e-04  2.97929754e-03 -5.83616434e-04]
 [ 2.05036924e-03  5.58594978e-04 -1.25532308e-03  5.21345418e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009449255185641879
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.027136729607426e-07, theta_kick=8.425801344337556e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.304603344900526e-06, theta_kick=-1.564268498003769e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00555160139214988
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.829556705885718e-06, theta_kick=2.193707329906311e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.215308972167702e-06, theta_kick=-2.6562388116299605e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.4785481196691493e-06, theta_kick=1.7728348278591207e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.025410607566779087
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.775218600729599e-07, theta_kick=-9.322779655406778e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00975817e-01 -6.31811284e+00  1.67079354e-02  1.61219281e-01]
 [ 1.80066320e-01  4.56359631e-01  2.53471166e-03  4.93970640e-03]
 [ 3.10233364e-02  1.61268404e-01  3.83801467e-01 -5.12300599e+00]
 [ 7.35278094e-03  2.77100805e-02  2.12531347e-01 -2.30518276e-01]]
compute_tune_4x4()/ evals =  [0.09715596+0.99526917j 0.09715596-0.99526917j 0.05717755+0.99836403j
 0.05717755-0.99836403j]
compute_tune_4x4()/ angles =  [0.23451271878576518, 0.24089494531662914, 0.7591050546833709, 0.7654872812142348]
compute_tune_4x4()/  0.23451271878576518 0.24089494531662914
compute_tunes()/ 0.23451271878576518 0.24089494531662914

 Running simulation ..
Closed orbit computation: x_co=[ 1.34502570e-09 -3.98021187e-10], y_co=[-9.12726836e-08  3.27541297e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 45/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 9.43934356e-04 -1.84819429e-04  5.09648930e-06 -3.59872067e-04]
 [ 1.17515948e-03  1.93443567e-04 -5.13630094e-05  7.12992623e-05]
 [-2.62746051e-03  3.71363967e-04  1.13499163e-03  1.08806605e-04]
 [-9.50473731e-04  1.25410892e-04  3.34267521e-03 -3.33706313e-04]
 [ 3.19700681e-03 -6.38031992e-04  4.92154227e-03  2.35285223e-04]
 [ 3.99008802e-03 -1.19616790e-03  1.05910732e-03  8.40529134e-04]
 [-9.16234865e-05  4.03753594e-04  2.11202299e-03 -4.18795619e-04]
 [-8.95086757e-04 -4.43102020e-04 -2.10869925e-03 -1.09744913e-04]
 [ 5.53453394e-04 -1.43875316e-03  4.20595163e-03 -9.10270516e-05]
 [-2.98925007e-05  3.56654442e-05 -3.47451166e-04 -7.39809119e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0031851874473164668
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.8090178198336587e-05, theta_kick=-3.36811805908106e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8751074148415326e-05, theta_kick=-3.4473619702060367e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008331773480035793
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.50124135366945e-05, theta_kick=-1.0193308253771193e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5973106792176437e-05, theta_kick=-3.1142732317145193e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.577517625769199e-05, theta_kick=5.488615868598541e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004640080728085613
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.09509596265643e-06, theta_kick=-9.70632464817609e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01705641e-01 -6.31992164e+00 -5.82163519e-03  1.82964822e-02]
 [ 1.80005897e-01  4.56233593e-01  1.58301705e-03 -9.28407372e-03]
 [-2.73045401e-03  1.82921679e-02  3.83990300e-01 -5.11897025e+00]
 [-2.63483287e-05 -9.01054506e-03  2.12580395e-01 -2.29739663e-01]]
compute_tune_4x4()/ evals =  [0.08386949+0.99647675j 0.08386949-0.99647675j 0.07051981+0.99751038j
 0.07051981-0.99751038j]
compute_tune_4x4()/ angles =  [0.23663605809182794, 0.23876710055927874, 0.7612328994407213, 0.763363941908172]
compute_tune_4x4()/  0.23663605809182794 0.23876710055927874
compute_tunes()/ 0.23663605809182794 0.23876710055927874

 Running simulation ..
Closed orbit computation: x_co=[-2.97954956e-07  8.65022517e-08], y_co=[ 4.70625759e-05 -6.66223116e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.8090178198336587e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8751074148415326e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.50124135366945e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.5973106792176437e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.577517625769199e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.09509596265643e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0031851874473164668}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.008331773480035793}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004640080728085613}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 9.43934356e-04 -1.84819429e-04  5.09648930e-06 -3.59872067e-04]
 [ 1.17515948e-03  1.93443567e-04 -5.13630094e-05  7.12992623e-05]
 [-2.62746051e-03  3.71363967e-04  1.13499163e-03  1.08806605e-04]
 [-9.50473731e-04  1.25410892e-04  3.34267521e-03 -3.33706313e-04]
 [ 3.19700681e-03 -6.38031992e-04  4.92154227e-03  2.35285223e-04]
 [ 3.99008802e-03 -1.19616790e-03  1.05910732e-03  8.40529134e-04]
 [-9.16234865e-05  4.03753594e-04  2.11202299e-03 -4.18795619e-04]
 [-8.95086757e-04 -4.43102020e-04 -2.10869925e-03 -1.09744913e-04]
 [ 5.53453394e-04 -1.43875316e-03  4.20595163e-03 -9.10270516e-05]
 [-2.98925007e-05  3.56654442e-05 -3.47451166e-04 -7.39809119e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0031851874473164668
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.942983394771742e-08, theta_kick=3.528747824068046e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.45656644649542e-07, theta_kick=-2.9455156009881676e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008331773480035793
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.7512610511169523e-07, theta_kick=-2.099827893858493e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4322682778987227e-08, theta_kick=2.91638118258922e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.7412766833388307e-07, theta_kick=3.28689388757174e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004640080728085613
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.727200020200121e-07, theta_kick=-5.668090691524063e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01705641e-01 -6.31992164e+00 -5.82163519e-03  1.82964822e-02]
 [ 1.80005897e-01  4.56233593e-01  1.58301705e-03 -9.28407372e-03]
 [-2.73045401e-03  1.82921679e-02  3.83990300e-01 -5.11897025e+00]
 [-2.63483287e-05 -9.01054506e-03  2.12580395e-01 -2.29739663e-01]]
compute_tune_4x4()/ evals =  [0.08386949+0.99647675j 0.08386949-0.99647675j 0.07051981+0.99751038j
 0.07051981-0.99751038j]
compute_tune_4x4()/ angles =  [0.23663605809182794, 0.23876710055927874, 0.7612328994407213, 0.763363941908172]
compute_tune_4x4()/  0.23663605809182794 0.23876710055927874
compute_tunes()/ 0.23663605809182794 0.23876710055927874

 Running simulation ..
Closed orbit computation: x_co=[8.97914670e-10 8.88041321e-12], y_co=[-5.67003005e-08 -6.03325363e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 46/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.52904750e-04  3.30091787e-04  3.13142715e-03 -1.11763004e-04]
 [-2.44430358e-03 -7.09706633e-05  2.62141146e-04  5.78566838e-04]
 [ 2.58281771e-03 -1.36126415e-03 -5.89010228e-04 -6.84989445e-04]
 [-1.43699416e-04  2.98858776e-04  3.03000445e-03  4.69015370e-04]
 [ 1.50216072e-03  5.62288936e-04  3.22705514e-03  5.13612895e-05]
 [ 4.47437544e-03 -8.74607462e-04  1.23778036e-03 -2.43849983e-04]
 [ 5.34437012e-03 -8.34728066e-04 -2.51154985e-05 -6.28733581e-05]
 [-3.48359028e-03 -7.92112555e-05 -2.32155768e-03  4.07998011e-04]
 [ 1.36402444e-03 -6.60257659e-05  1.05465345e-03 -1.72649747e-04]
 [-2.83628888e-03 -6.03106215e-04 -2.36335148e-03 -4.50075183e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007939236761243322
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.768321877426382e-06, theta_kick=-6.91643497195851e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.872148558857678e-05, theta_kick=8.23996469596874e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016774759057054306
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.551995269858557e-05, theta_kick=-4.2589759771938916e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.4703148455606826e-05, theta_kick=4.161038075124133e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4647496214506076e-05, theta_kick=2.95532753566248e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006756004442984679
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.9744557034543934e-05, theta_kick=7.163597185430524e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01481991e-01 -6.32085500e+00  7.41529456e-03 -4.40619814e-02]
 [ 1.79963196e-01  4.56192053e-01 -3.22164340e-03  2.08186572e-02]
 [ 1.22448965e-03 -4.41092510e-02  3.84056643e-01 -5.11918477e+00]
 [-2.67804779e-04  1.97936769e-02  2.12627714e-01 -2.30416482e-01]]
compute_tune_4x4()/ evals =  [0.08933702+0.99600145j 0.08933702-0.99600145j 0.0648381 +0.9978958j
 0.0648381 -0.9978958j ]
compute_tune_4x4()/ angles =  [0.23576259084939338, 0.23967345261134856, 0.7603265473886515, 0.7642374091506066]
compute_tune_4x4()/  0.23576259084939338 0.23967345261134856
compute_tunes()/ 0.23576259084939338 0.23967345261134856

 Running simulation ..
Closed orbit computation: x_co=[ 6.37243384e-07 -1.21734109e-07], y_co=[-1.36213754e-05 -5.10061652e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.768321877426382e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.872148558857678e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.551995269858557e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.4703148455606826e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.4647496214506076e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.9744557034543934e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007939236761243322}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.016774759057054306}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006756004442984679}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.52904750e-04  3.30091787e-04  3.13142715e-03 -1.11763004e-04]
 [-2.44430358e-03 -7.09706633e-05  2.62141146e-04  5.78566838e-04]
 [ 2.58281771e-03 -1.36126415e-03 -5.89010228e-04 -6.84989445e-04]
 [-1.43699416e-04  2.98858776e-04  3.03000445e-03  4.69015370e-04]
 [ 1.50216072e-03  5.62288936e-04  3.22705514e-03  5.13612895e-05]
 [ 4.47437544e-03 -8.74607462e-04  1.23778036e-03 -2.43849983e-04]
 [ 5.34437012e-03 -8.34728066e-04 -2.51154985e-05 -6.28733581e-05]
 [-3.48359028e-03 -7.92112555e-05 -2.32155768e-03  4.07998011e-04]
 [ 1.36402444e-03 -6.60257659e-05  1.05465345e-03 -1.72649747e-04]
 [-2.83628888e-03 -6.03106215e-04 -2.36335148e-03 -4.50075183e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007939236761243322
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.360643942205629e-07, theta_kick=1.0024726667258016e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.2723587124435325e-07, theta_kick=2.724643596794437e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016774759057054306
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.70770097545343e-07, theta_kick=-1.1639898734967699e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.0325031491560545e-07, theta_kick=3.636085377876857e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.82812398506188e-07, theta_kick=4.5900646964396226e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006756004442984679
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.027592864416213e-07, theta_kick=-7.227310640781405e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01481991e-01 -6.32085500e+00  7.41529456e-03 -4.40619814e-02]
 [ 1.79963196e-01  4.56192053e-01 -3.22164340e-03  2.08186572e-02]
 [ 1.22448965e-03 -4.41092510e-02  3.84056643e-01 -5.11918477e+00]
 [-2.67804779e-04  1.97936769e-02  2.12627714e-01 -2.30416482e-01]]
compute_tune_4x4()/ evals =  [0.08933702+0.99600145j 0.08933702-0.99600145j 0.0648381 +0.9978958j
 0.0648381 -0.9978958j ]
compute_tune_4x4()/ angles =  [0.23576259084939338, 0.23967345261134856, 0.7603265473886515, 0.7642374091506066]
compute_tune_4x4()/  0.23576259084939338 0.23967345261134856
compute_tunes()/ 0.23576259084939338 0.23967345261134856

 Running simulation ..
Closed orbit computation: x_co=[ 3.65794200e-09 -1.50272711e-10], y_co=[-5.34105085e-08  8.09452309e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 47/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.43542670e-03 -2.76009624e-05 -8.38436649e-04 -1.31800782e-04]
 [ 1.89666311e-03 -3.35568579e-04  5.32488816e-03 -1.63957275e-04]
 [ 3.73538902e-03 -6.92712250e-05 -1.77076318e-03 -6.01182290e-05]
 [-1.11639212e-03  5.94769232e-05 -1.52881132e-03 -9.91601865e-05]
 [-2.28307936e-03 -3.89219679e-04 -3.02021473e-03 -7.01660142e-04]
 [-1.52742076e-03  1.08184663e-04 -8.60737860e-04  2.37911379e-04]
 [ 5.78791220e-04  1.97981495e-04  3.80518636e-05  4.98440276e-04]
 [-4.83152716e-03 -1.41530495e-04 -1.94022083e-03  1.95319802e-05]
 [-4.61774969e-04  8.63991904e-04  1.38304601e-03  7.56971234e-04]
 [-8.63290452e-04 -6.21000917e-04  1.15597536e-03  8.71262442e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005649044830067023
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.267977331835027e-05, theta_kick=-3.918427782944036e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.2904629826813526e-05, theta_kick=2.7463512980072746e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015756389971719357
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.017294971562073e-05, theta_kick=7.214963079777123e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.0001012699524812329, theta_kick=-1.2142648344413836e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.335424053030894e-05, theta_kick=-1.6012236867229729e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012544106925468201
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.069324127723255e-05, theta_kick=6.078310369327281e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636379e-01 -6.31883765e+00 -1.34959643e-02  1.73618591e-02]
 [ 1.80023430e-01  4.56652383e-01  2.82313123e-03 -1.87579803e-02]
 [-9.05024578e-03  1.73374750e-02  3.83610455e-01 -5.11833287e+00]
 [-9.01122535e-04 -2.08302670e-02  2.12558949e-01 -2.29794563e-01]]
compute_tune_4x4()/ evals =  [0.09265806+0.99569799j 0.09265806-0.99569799j 0.06175789+0.99809116j
 0.06175789-0.99809116j]
compute_tune_4x4()/ angles =  [0.2352318277367965, 0.24016466830883043, 0.7598353316911696, 0.7647681722632035]
compute_tune_4x4()/  0.2352318277367965 0.24016466830883043
compute_tunes()/ 0.2352318277367965 0.24016466830883043

 Running simulation ..
Closed orbit computation: x_co=[-7.05432444e-08  2.57343706e-08], y_co=[3.07789337e-05 1.79627778e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.267977331835027e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.2904629826813526e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.017294971562073e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.0001012699524812329, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.335424053030894e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.069324127723255e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005649044830067023}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.015756389971719357}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012544106925468201}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.43542670e-03 -2.76009624e-05 -8.38436649e-04 -1.31800782e-04]
 [ 1.89666311e-03 -3.35568579e-04  5.32488816e-03 -1.63957275e-04]
 [ 3.73538902e-03 -6.92712250e-05 -1.77076318e-03 -6.01182290e-05]
 [-1.11639212e-03  5.94769232e-05 -1.52881132e-03 -9.91601865e-05]
 [-2.28307936e-03 -3.89219679e-04 -3.02021473e-03 -7.01660142e-04]
 [-1.52742076e-03  1.08184663e-04 -8.60737860e-04  2.37911379e-04]
 [ 5.78791220e-04  1.97981495e-04  3.80518636e-05  4.98440276e-04]
 [-4.83152716e-03 -1.41530495e-04 -1.94022083e-03  1.95319802e-05]
 [-4.61774969e-04  8.63991904e-04  1.38304601e-03  7.56971234e-04]
 [-8.63290452e-04 -6.21000917e-04  1.15597536e-03  8.71262442e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005649044830067023
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.342877501174359e-07, theta_kick=-7.605348783265957e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.6404988539925886e-08, theta_kick=5.564132730992411e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015756389971719357
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.700548080363134e-07, theta_kick=6.835171639198754e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.596833011064172e-07, theta_kick=-6.710813368689328e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.7655398227728996e-09, theta_kick=-3.3159863046866763e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012544106925468201
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.4353302865081474e-07, theta_kick=1.7210150197695645e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636379e-01 -6.31883765e+00 -1.34959643e-02  1.73618591e-02]
 [ 1.80023430e-01  4.56652383e-01  2.82313123e-03 -1.87579803e-02]
 [-9.05024578e-03  1.73374750e-02  3.83610455e-01 -5.11833287e+00]
 [-9.01122535e-04 -2.08302670e-02  2.12558949e-01 -2.29794563e-01]]
compute_tune_4x4()/ evals =  [0.09265806+0.99569799j 0.09265806-0.99569799j 0.06175789+0.99809116j
 0.06175789-0.99809116j]
compute_tune_4x4()/ angles =  [0.2352318277367965, 0.24016466830883043, 0.7598353316911696, 0.7647681722632035]
compute_tune_4x4()/  0.2352318277367965 0.24016466830883043
compute_tunes()/ 0.2352318277367965 0.24016466830883043

 Running simulation ..
Closed orbit computation: x_co=[ 3.51475267e-09 -2.28814694e-10], y_co=[ 4.11862610e-08 -3.52920217e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 48/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.95140140e-03 -4.97547770e-04 -5.77912553e-04  6.16581763e-04]
 [-4.33599058e-03 -3.20167918e-04 -2.60600978e-03 -8.35760779e-04]
 [ 3.05391121e-03 -1.31575648e-04  1.19412145e-03  5.98729040e-04]
 [-2.78088499e-03  6.61680634e-04  1.80645234e-03 -2.19545566e-04]
 [-3.01487637e-03  2.32866616e-04 -3.23065800e-03 -1.88782717e-04]
 [-6.06921585e-05 -7.65756066e-04  1.35254118e-03 -1.07654798e-03]
 [ 4.22210409e-03  2.91772897e-04  1.31326819e-03  2.42715105e-04]
 [ 2.73884065e-03  1.24346835e-04  6.32151522e-04  1.19351937e-04]
 [ 2.61212894e-04  1.85068333e-04  2.28688030e-03  5.97638979e-04]
 [ 2.86026291e-03 -6.52478339e-04  6.23068320e-03  2.45180422e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002398036948673638
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2969528911248216e-05, theta_kick=1.555095316068013e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.317001456014842e-05, theta_kick=-2.778171926080136e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0027564597667255526
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4213325146994252e-05, theta_kick=-1.7042311646857813e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.377641740896958e-05, theta_kick=-5.2489571620358095e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.935064495895409e-05, theta_kick=-8.315403271774334e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.02318718797561333
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.9466818656996735e-05, theta_kick=-7.130295308934347e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01191581e-01 -6.31721528e+00 -1.67211937e-02 -9.83798573e-02]
 [ 1.80031662e-01  4.56272288e-01 -5.08486658e-04 -1.05633123e-02]
 [-2.42196776e-02 -9.83591018e-02  3.83690808e-01 -5.12095840e+00]
 [-5.16827748e-03 -2.62164298e-02  2.12493198e-01 -2.30121315e-01]]
compute_tune_4x4()/ evals =  [0.09648978+0.99533398j 0.09648978-0.99533398j 0.05783532+0.99832614j
 0.05783532-0.99832614j]
compute_tune_4x4()/ angles =  [0.23461924549627208, 0.24079008292721354, 0.7592099170727864, 0.7653807545037279]
compute_tune_4x4()/  0.23461924549627208 0.24079008292721354
compute_tunes()/ 0.23461924549627208 0.24079008292721354

 Running simulation ..
Closed orbit computation: x_co=[ 1.05752786e-07 -1.59855707e-08], y_co=[4.14484354e-05 1.31985690e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.2969528911248216e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.317001456014842e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.4213325146994252e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.377641740896958e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.935064495895409e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.9466818656996735e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002398036948673638}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0027564597667255526}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.02318718797561333}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.95140140e-03 -4.97547770e-04 -5.77912553e-04  6.16581763e-04]
 [-4.33599058e-03 -3.20167918e-04 -2.60600978e-03 -8.35760779e-04]
 [ 3.05391121e-03 -1.31575648e-04  1.19412145e-03  5.98729040e-04]
 [-2.78088499e-03  6.61680634e-04  1.80645234e-03 -2.19545566e-04]
 [-3.01487637e-03  2.32866616e-04 -3.23065800e-03 -1.88782717e-04]
 [-6.06921585e-05 -7.65756066e-04  1.35254118e-03 -1.07654798e-03]
 [ 4.22210409e-03  2.91772897e-04  1.31326819e-03  2.42715105e-04]
 [ 2.73884065e-03  1.24346835e-04  6.32151522e-04  1.19351937e-04]
 [ 2.61212894e-04  1.85068333e-04  2.28688030e-03  5.97638979e-04]
 [ 2.86026291e-03 -6.52478339e-04  6.23068320e-03  2.45180422e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002398036948673638
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0321062697534388e-06, theta_kick=1.2375342518308404e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.1260952277065453e-06, theta_kick=-2.549268175233051e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0027564597667255526
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.842707300732214e-06, theta_kick=3.408513014290782e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.830289271094232e-06, theta_kick=-3.393623329509655e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.691594183162072e-06, theta_kick=2.028285074133861e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.02318718797561333
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.218581390016759e-07, theta_kick=-9.854388321887598e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01191581e-01 -6.31721528e+00 -1.67211937e-02 -9.83798573e-02]
 [ 1.80031662e-01  4.56272288e-01 -5.08486658e-04 -1.05633123e-02]
 [-2.42196776e-02 -9.83591018e-02  3.83690808e-01 -5.12095840e+00]
 [-5.16827748e-03 -2.62164298e-02  2.12493198e-01 -2.30121315e-01]]
compute_tune_4x4()/ evals =  [0.09648978+0.99533398j 0.09648978-0.99533398j 0.05783532+0.99832614j
 0.05783532-0.99832614j]
compute_tune_4x4()/ angles =  [0.23461924549627208, 0.24079008292721354, 0.7592099170727864, 0.7653807545037279]
compute_tune_4x4()/  0.23461924549627208 0.24079008292721354
compute_tunes()/ 0.23461924549627208 0.24079008292721354

 Running simulation ..
Closed orbit computation: x_co=[1.36385770e-09 1.31284026e-10], y_co=[-1.15373109e-07  3.50307156e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 49/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.74204098e-03 -1.59877758e-04  2.28858010e-03  5.22128228e-04]
 [ 3.41034765e-03  2.98716454e-04 -1.87455327e-04 -3.35512704e-04]
 [-5.96257063e-04  8.41354942e-05  5.06514363e-03  2.51381877e-04]
 [ 4.53773574e-03 -8.56274519e-05  6.59641446e-04  4.15732700e-04]
 [ 1.32571998e-03 -4.23598806e-04  7.97622909e-04 -1.21650236e-04]
 [-1.45575549e-03 -2.64691463e-05 -9.65751127e-04 -8.40456871e-04]
 [ 6.37367911e-04  2.52948373e-04  7.96245341e-04 -5.88800992e-04]
 [-3.29354619e-03 -2.12893680e-04 -5.30517257e-03 -1.43724523e-04]
 [ 1.25394879e-03  1.54237219e-04 -5.79752856e-04  1.14939264e-03]
 [ 4.11429826e-03  9.91790584e-04  2.96658519e-03  1.09527929e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006589728317112875
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.325828448021394e-05, theta_kick=6.385868700687256e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.50490802633355e-06, theta_kick=-1.1396742358613551e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012081621679395225
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.897110941462853e-05, theta_kick=-1.066797078466496e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.76432793140772e-05, theta_kick=-8.110683706759082e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.988640481478788e-05, theta_kick=-8.379642894357839e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007020994206477362
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.1012109646425983e-05, theta_kick=-2.5194310075152733e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01663173e-01 -6.31955911e+00 -1.07143273e-02  3.35380738e-03]
 [ 1.79994295e-01  4.56298714e-01  2.05474805e-03 -1.59430962e-02]
 [-8.31429560e-03  3.34839748e-03  3.83899296e-01 -5.11840768e+00]
 [-1.19498269e-03 -1.92351886e-02  2.12577117e-01 -2.29800564e-01]]
compute_tune_4x4()/ evals =  [0.09066088+0.99588182j 0.09066088-0.99588182j 0.06370626+0.99796869j
 0.06370626-0.99796869j]
compute_tune_4x4()/ angles =  [0.23555103309781558, 0.23985396337273535, 0.7601460366272647, 0.7644489669021844]
compute_tune_4x4()/  0.23555103309781558 0.23985396337273535
compute_tunes()/ 0.23555103309781558 0.23985396337273535

 Running simulation ..
Closed orbit computation: x_co=[-3.42463089e-07  5.32403284e-08], y_co=[9.29786090e-05 1.65803811e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.325828448021394e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 9.50490802633355e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.897110941462853e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.76432793140772e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.988640481478788e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.1012109646425983e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0006589728317112875}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.012081621679395225}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007020994206477362}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.74204098e-03 -1.59877758e-04  2.28858010e-03  5.22128228e-04]
 [ 3.41034765e-03  2.98716454e-04 -1.87455327e-04 -3.35512704e-04]
 [-5.96257063e-04  8.41354942e-05  5.06514363e-03  2.51381877e-04]
 [ 4.53773574e-03 -8.56274519e-05  6.59641446e-04  4.15732700e-04]
 [ 1.32571998e-03 -4.23598806e-04  7.97622909e-04 -1.21650236e-04]
 [-1.45575549e-03 -2.64691463e-05 -9.65751127e-04 -8.40456871e-04]
 [ 6.37367911e-04  2.52948373e-04  7.96245341e-04 -5.88800992e-04]
 [-3.29354619e-03 -2.12893680e-04 -5.30517257e-03 -1.43724523e-04]
 [ 1.25394879e-03  1.54237219e-04 -5.79752856e-04  1.14939264e-03]
 [ 4.11429826e-03  9.91790584e-04  2.96658519e-03  1.09527929e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006589728317112875
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.608311266502545e-06, theta_kick=-1.9284257234265356e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.9508565640797604e-06, theta_kick=3.53818805030702e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012081621679395225
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.4254998948115987e-06, theta_kick=-2.908265636598177e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.750159202714245e-07, theta_kick=8.093694867937996e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.9490012812174813e-07, theta_kick=4.735001122702194e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007020994206477362
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.4031840471218393e-07, theta_kick=-2.8815080955541573e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01663173e-01 -6.31955911e+00 -1.07143273e-02  3.35380738e-03]
 [ 1.79994295e-01  4.56298714e-01  2.05474805e-03 -1.59430962e-02]
 [-8.31429560e-03  3.34839748e-03  3.83899296e-01 -5.11840768e+00]
 [-1.19498269e-03 -1.92351886e-02  2.12577117e-01 -2.29800564e-01]]
compute_tune_4x4()/ evals =  [0.09066088+0.99588182j 0.09066088-0.99588182j 0.06370626+0.99796869j
 0.06370626-0.99796869j]
compute_tune_4x4()/ angles =  [0.23555103309781558, 0.23985396337273535, 0.7601460366272647, 0.7644489669021844]
compute_tune_4x4()/  0.23555103309781558 0.23985396337273535
compute_tunes()/ 0.23555103309781558 0.23985396337273535

 Running simulation ..
Closed orbit computation: x_co=[-1.83109482e-09  3.35543271e-10], y_co=[-2.08275789e-07 -4.30065104e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 50/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.16673840e-03 -1.41633641e-03  6.57838739e-04 -3.65305916e-04]
 [-4.79656275e-05 -7.96236144e-04 -2.44353761e-03 -3.13640729e-04]
 [ 5.10459618e-04  6.83046959e-05 -8.41351498e-04 -4.32107233e-04]
 [ 3.56324378e-03 -1.19861963e-03 -2.14785448e-03 -3.55209978e-04]
 [-5.80135264e-04  3.44137824e-05  1.96279521e-03 -4.55806128e-04]
 [-1.21413859e-05 -8.11563192e-05  3.57592313e-04  7.65956395e-04]
 [-2.38282556e-04 -2.51675220e-04  6.18028590e-04  3.55961900e-04]
 [ 1.01241596e-03 -1.68956348e-04 -5.18237380e-04 -4.22235035e-04]
 [-1.57213717e-03  2.42368812e-04  4.17678200e-04  7.43546916e-04]
 [-1.77142309e-03 -9.40838730e-04 -3.47207791e-03  2.33031496e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008035938975085845
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.095929518805972e-05, theta_kick=4.9111736079447595e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.076041339561396e-05, theta_kick=-7.285402185419984e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004912173426616153
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.423653759132904e-05, theta_kick=2.906052050456066e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3156653004193572e-05, theta_kick=1.5775321988919084e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5482931222028808e-05, theta_kick=1.8564617101472602e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005558411866638639
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.3301318451655356e-05, theta_kick=5.191991009429651e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01602754e-01 -6.31982544e+00  2.21382857e-03 -4.04370797e-03]
 [ 1.79995566e-01  4.56077526e-01 -8.41973011e-04  7.71776485e-03]
 [ 1.35445835e-03 -4.04810115e-03  3.84074565e-01 -5.11961237e+00]
 [ 3.73324623e-04  8.98503786e-03  2.12573861e-01 -2.29927878e-01]]
compute_tune_4x4()/ evals =  [0.08219597+0.99661619j 0.08219597-0.99661619j 0.07211476+0.99739634j
 0.07211476-0.99739634j]
compute_tune_4x4()/ angles =  [0.23690332925716961, 0.2385126082989793, 0.7614873917010208, 0.7630966707428304]
compute_tune_4x4()/  0.23690332925716961 0.2385126082989793
compute_tunes()/ 0.23690332925716961 0.2385126082989793

 Running simulation ..
Closed orbit computation: x_co=[ 1.65116809e-07 -3.42718875e-08], y_co=[ 5.61120250e-06 -4.85995243e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.095929518805972e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.076041339561396e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.423653759132904e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.3156653004193572e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.5482931222028808e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.3301318451655356e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008035938975085845}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004912173426616153}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005558411866638639}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.16673840e-03 -1.41633641e-03  6.57838739e-04 -3.65305916e-04]
 [-4.79656275e-05 -7.96236144e-04 -2.44353761e-03 -3.13640729e-04]
 [ 5.10459618e-04  6.83046959e-05 -8.41351498e-04 -4.32107233e-04]
 [ 3.56324378e-03 -1.19861963e-03 -2.14785448e-03 -3.55209978e-04]
 [-5.80135264e-04  3.44137824e-05  1.96279521e-03 -4.55806128e-04]
 [-1.21413859e-05 -8.11563192e-05  3.57592313e-04  7.65956395e-04]
 [-2.38282556e-04 -2.51675220e-04  6.18028590e-04  3.55961900e-04]
 [ 1.01241596e-03 -1.68956348e-04 -5.18237380e-04 -4.22235035e-04]
 [-1.57213717e-03  2.42368812e-04  4.17678200e-04  7.43546916e-04]
 [-1.77142309e-03 -9.40838730e-04 -3.47207791e-03  2.33031496e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008035938975085845
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.818333079867663e-07, theta_kick=5.777362659070264e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.992807925684059e-07, theta_kick=-5.986564564056537e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004912173426616153
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.102576906949183e-07, theta_kick=-4.919144076445453e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.075824428306763e-07, theta_kick=7.285142100664099e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.8022148509287545e-08, theta_kick=5.758036296102315e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005558411866638639
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.939655485700089e-07, theta_kick=-5.922832788583203e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01602754e-01 -6.31982544e+00  2.21382857e-03 -4.04370797e-03]
 [ 1.79995566e-01  4.56077526e-01 -8.41973011e-04  7.71776485e-03]
 [ 1.35445835e-03 -4.04810115e-03  3.84074565e-01 -5.11961237e+00]
 [ 3.73324623e-04  8.98503786e-03  2.12573861e-01 -2.29927878e-01]]
compute_tune_4x4()/ evals =  [0.08219597+0.99661619j 0.08219597-0.99661619j 0.07211476+0.99739634j
 0.07211476-0.99739634j]
compute_tune_4x4()/ angles =  [0.23690332925716961, 0.2385126082989793, 0.7614873917010208, 0.7630966707428304]
compute_tune_4x4()/  0.23690332925716961 0.2385126082989793
compute_tunes()/ 0.23690332925716961 0.2385126082989793

 Running simulation ..
Closed orbit computation: x_co=[-4.27783524e-11  7.98577238e-11], y_co=[-9.58914080e-08  1.18852365e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
Completed benchmarking for noise_level=1e-05 meters.
Running evaluation for noise_level= 2e-05
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.63292560e-03 -2.23390964e-04 -1.35388840e-03 -4.62179776e-04]
 [-1.77924571e-03  5.44874157e-04 -3.47163390e-03  6.39542505e-05]
 [-7.20447659e-04  3.96516945e-05  1.25528117e-03 -1.34068786e-03]
 [ 1.95510952e-03  1.69703918e-04  2.51553701e-03  1.38158066e-03]
 [ 1.27568112e-03  1.18917967e-04 -8.79435391e-04 -5.98413919e-05]
 [ 2.67211699e-04 -1.23156920e-04  1.57717021e-03  2.16416071e-04]
 [ 1.88299905e-03 -3.47619477e-04 -2.88411840e-03  5.98330469e-06]
 [-7.39649088e-04 -1.08745569e-04 -6.52107208e-04  1.09281841e-03]
 [ 6.70670146e-04  2.46127697e-04  1.18985831e-03 -4.21822642e-04]
 [ 1.76667162e-03  1.19600081e-04 -1.85243348e-03  1.60055044e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008722935064189958
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.4214588551484824e-05, theta_kick=-6.500533157056241e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.093395450324359e-05, theta_kick=-4.908135164487547e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015236803432801812
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.208050047845305e-05, theta_kick=2.6475350882405458e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.369767933972732e-06, theta_kick=8.836629050334744e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.156183992536386e-05, theta_kick=3.7843833627491415e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0063902095230200275
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.721626736575534e-05, theta_kick=-4.462370488401261e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647718e-01 -6.32142889e+00  2.63177118e-04 -1.07409416e-01]
 [ 1.80038683e-01  4.56543234e-01 -3.62684632e-03  1.15927478e-02]
 [-1.14372097e-02 -1.07417958e-01  3.83994135e-01 -5.11997272e+00]
 [-3.60785632e-03 -9.11116148e-05  2.12643081e-01 -2.30056297e-01]]
compute_tune_4x4()/ evals =  [0.07746143+0.99699535j 0.07746143-0.99699535j 0.07695525+0.99703455j
 0.07695525-0.99703455j]
compute_tune_4x4()/ angles =  [0.23765926888083463, 0.2377400701957517, 0.7622599298042483, 0.7623407311191653]
compute_tune_4x4()/  0.23765926888083463 0.2377400701957517
compute_tunes()/ 0.23765926888083463 0.2377400701957517

 Running simulation ..
Closed orbit computation: x_co=[-4.56950316e-07  1.47700941e-07], y_co=[-1.85955802e-05 -8.39375917e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.4214588551484824e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.093395450324359e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.208050047845305e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.369767933972732e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.156183992536386e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.721626736575534e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.008722935064189958}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.015236803432801812}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0063902095230200275}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.63292560e-03 -2.23390964e-04 -1.35388840e-03 -4.62179776e-04]
 [-1.77924571e-03  5.44874157e-04 -3.47163390e-03  6.39542505e-05]
 [-7.20447659e-04  3.96516945e-05  1.25528117e-03 -1.34068786e-03]
 [ 1.95510952e-03  1.69703918e-04  2.51553701e-03  1.38158066e-03]
 [ 1.27568112e-03  1.18917967e-04 -8.79435391e-04 -5.98413919e-05]
 [ 2.67211699e-04 -1.23156920e-04  1.57717021e-03  2.16416071e-04]
 [ 1.88299905e-03 -3.47619477e-04 -2.88411840e-03  5.98330469e-06]
 [-7.39649088e-04 -1.08745569e-04 -6.52107208e-04  1.09281841e-03]
 [ 6.70670146e-04  2.46127697e-04  1.18985831e-03 -4.21822642e-04]
 [ 1.76667162e-03  1.19600081e-04 -1.85243348e-03  1.60055044e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.008722935064189958
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.104102459567755e-06, theta_kick=1.323860392372372e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.839465151148598e-08, theta_kick=-1.0598851313077221e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015236803432801812
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8921776691525686e-06, theta_kick=-3.4678298474164104e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.2561102101806023e-06, theta_kick=3.9041986575638535e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.4162269581517094e-06, theta_kick=-1.698109410281589e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0063902095230200275
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.915393426342063e-07, theta_kick=-9.490854545583815e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647718e-01 -6.32142889e+00  2.63177118e-04 -1.07409416e-01]
 [ 1.80038683e-01  4.56543234e-01 -3.62684632e-03  1.15927478e-02]
 [-1.14372097e-02 -1.07417958e-01  3.83994135e-01 -5.11997272e+00]
 [-3.60785632e-03 -9.11116148e-05  2.12643081e-01 -2.30056297e-01]]
compute_tune_4x4()/ evals =  [0.07746143+0.99699535j 0.07746143-0.99699535j 0.07695525+0.99703455j
 0.07695525-0.99703455j]
compute_tune_4x4()/ angles =  [0.23765926888083463, 0.2377400701957517, 0.7622599298042483, 0.7623407311191653]
compute_tune_4x4()/  0.23765926888083463 0.2377400701957517
compute_tunes()/ 0.23765926888083463 0.2377400701957517

 Running simulation ..
Closed orbit computation: x_co=[ 4.45928645e-09 -1.20172201e-09], y_co=[5.61881732e-08 1.02570781e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.32786436e-03  2.98884981e-04  3.28951223e-03 -2.78144072e-04]
 [ 3.58311588e-04 -3.11681816e-04 -1.95547715e-03 -6.73951793e-05]
 [ 1.85642475e-03 -3.23678173e-04  4.33076289e-03  1.19476911e-03]
 [-1.37086147e-04 -5.85840986e-05  3.62198851e-03  5.82205097e-04]
 [ 4.75116474e-03 -2.94385986e-04  1.49460411e-03  7.61158313e-05]
 [-9.93880506e-06  4.27895259e-04  3.59005619e-04  6.29332375e-04]
 [-2.20729393e-03  1.78263994e-04  1.15365391e-03 -1.46476121e-04]
 [ 1.90713625e-03  1.51821223e-05  2.47185307e-03 -4.05552456e-05]
 [-4.56537755e-03  2.87976558e-04 -3.43172967e-03 -5.45815337e-04]
 [ 1.47064373e-03 -1.15721193e-03 -3.20419867e-03 -4.57460298e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00890756365364005
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.696712082376614e-05, theta_kick=5.6315345069237206e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.7843727328919906e-05, theta_kick=5.736642925242376e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003119004508448861
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.2747688112856025e-05, theta_kick=5.125608648698467e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.684697178728472e-07, theta_kick=2.0200153063088405e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0946807396926018e-05, theta_kick=1.3125633957370904e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007241132787193987
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.900900571809003e-05, theta_kick=4.677326562267081e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01598241e-01 -6.31972983e+00  6.44820418e-03  7.63095929e-02]
 [ 1.80018168e-01  4.56181611e-01  1.29314690e-03  2.49116627e-03]
 [ 1.35030704e-02  7.63108559e-02  3.84047074e-01 -5.11988461e+00]
 [ 3.43604440e-03  1.33000509e-02  2.12574432e-01 -2.29851896e-01]]
compute_tune_4x4()/ evals =  [0.08608133+0.99628811j 0.08608133-0.99628811j 0.06830794+0.99766428j
 0.06830794-0.99766428j]
compute_tune_4x4()/ angles =  [0.23628275438328789, 0.23911998083860314, 0.7608800191613969, 0.7637172456167121]
compute_tune_4x4()/  0.23628275438328789 0.23911998083860314
compute_tunes()/ 0.23628275438328789 0.23911998083860314

 Running simulation ..
Closed orbit computation: x_co=[1.57518862e-09 7.58950779e-08], y_co=[-3.10034845e-05  3.48538892e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.696712082376614e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.7843727328919906e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.2747688112856025e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.684697178728472e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0946807396926018e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.900900571809003e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00890756365364005}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.003119004508448861}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.007241132787193987}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.32786436e-03  2.98884981e-04  3.28951223e-03 -2.78144072e-04]
 [ 3.58311588e-04 -3.11681816e-04 -1.95547715e-03 -6.73951793e-05]
 [ 1.85642475e-03 -3.23678173e-04  4.33076289e-03  1.19476911e-03]
 [-1.37086147e-04 -5.85840986e-05  3.62198851e-03  5.82205097e-04]
 [ 4.75116474e-03 -2.94385986e-04  1.49460411e-03  7.61158313e-05]
 [-9.93880506e-06  4.27895259e-04  3.59005619e-04  6.29332375e-04]
 [-2.20729393e-03  1.78263994e-04  1.15365391e-03 -1.46476121e-04]
 [ 1.90713625e-03  1.51821223e-05  2.47185307e-03 -4.05552456e-05]
 [-4.56537755e-03  2.87976558e-04 -3.43172967e-03 -5.45815337e-04]
 [ 1.47064373e-03 -1.15721193e-03 -3.20419867e-03 -4.57460298e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00890756365364005
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.9547695420580327e-06, theta_kick=3.5428798581340656e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.779087119397606e-06, theta_kick=-6.929342902138819e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003119004508448861
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.27109638678948e-06, theta_kick=5.121205273547671e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5069933714863715e-07, theta_kick=-3.0059793814336783e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.0464682236993363e-06, theta_kick=-1.2547547749999432e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007241132787193987
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.6735270928202868e-08, theta_kick=-2.0066219530153133e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01598241e-01 -6.31972983e+00  6.44820418e-03  7.63095929e-02]
 [ 1.80018168e-01  4.56181611e-01  1.29314690e-03  2.49116627e-03]
 [ 1.35030704e-02  7.63108559e-02  3.84047074e-01 -5.11988461e+00]
 [ 3.43604440e-03  1.33000509e-02  2.12574432e-01 -2.29851896e-01]]
compute_tune_4x4()/ evals =  [0.08608133+0.99628811j 0.08608133-0.99628811j 0.06830794+0.99766428j
 0.06830794-0.99766428j]
compute_tune_4x4()/ angles =  [0.23628275438328789, 0.23911998083860314, 0.7608800191613969, 0.7637172456167121]
compute_tune_4x4()/  0.23628275438328789 0.23911998083860314
compute_tunes()/ 0.23628275438328789 0.23911998083860314

 Running simulation ..
Closed orbit computation: x_co=[1.74690893e-09 4.77575867e-10], y_co=[9.29895449e-08 6.37469165e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.38767334e-05 -2.11047619e-04 -7.02071631e-04  1.45981523e-05]
 [-4.88623513e-04 -6.38429318e-04 -1.70632865e-04 -3.21817438e-04]
 [ 1.43074503e-03 -1.29192872e-04 -1.96866288e-03 -7.04815323e-05]
 [ 2.56577382e-03 -2.71407717e-04 -2.60311395e-03 -3.61868083e-05]
 [ 1.74658888e-04  1.77924116e-04  2.24335524e-03  3.84664622e-04]
 [ 2.10813274e-03  8.56584051e-05  1.97452000e-03 -1.32837368e-04]
 [ 5.25899375e-04  1.28137535e-04  4.13362139e-04 -3.79491657e-04]
 [-1.37709999e-03  1.46052441e-04 -2.41992976e-03 -9.85668282e-04]
 [-3.18316356e-03 -7.44869696e-05  3.77390147e-03  3.66874605e-04]
 [ 2.68262895e-03 -3.04790801e-04 -8.85279923e-04  5.34630964e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0070038686687841
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.5807257831468905e-05, theta_kick=3.0943873172965056e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8160913455483e-05, theta_kick=-3.3765994825639025e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009455404050892275
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.235427828880808e-06, theta_kick=-5.078437330537366e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1142955612636437e-05, theta_kick=-1.336082304835001e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.586959550287568e-05, theta_kick=-4.300899465006689e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004754681654952058
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.0635333055954002e-05, theta_kick=1.2752164502901463e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01705493e-01 -6.31993255e+00  4.94675570e-03 -3.69939502e-02]
 [ 1.80018899e-01  4.56333887e-01 -1.96409633e-03  8.85468423e-03]
 [-6.04918336e-06 -3.69828225e-02  3.83944270e-01 -5.11917447e+00]
 [-7.79323536e-04  5.97407382e-03  2.12581738e-01 -2.29757688e-01]]
compute_tune_4x4()/ evals =  [0.08211979+0.99662247j 0.08211979-0.99662247j 0.0722877 +0.99738382j
 0.0722877 -0.99738382j]
compute_tune_4x4()/ angles =  [0.23691549501858772, 0.23848501213693996, 0.76151498786306, 0.7630845049814123]
compute_tune_4x4()/  0.23691549501858772 0.23848501213693996
compute_tunes()/ 0.23691549501858772 0.23848501213693996

 Running simulation ..
Closed orbit computation: x_co=[ 1.10400046e-07 -4.93710292e-08], y_co=[2.92098344e-05 4.16313735e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.5807257831468905e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8160913455483e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.235427828880808e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.1142955612636437e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.586959550287568e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.0635333055954002e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0070038686687841}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.009455404050892275}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004754681654952058}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.38767334e-05 -2.11047619e-04 -7.02071631e-04  1.45981523e-05]
 [-4.88623513e-04 -6.38429318e-04 -1.70632865e-04 -3.21817438e-04]
 [ 1.43074503e-03 -1.29192872e-04 -1.96866288e-03 -7.04815323e-05]
 [ 2.56577382e-03 -2.71407717e-04 -2.60311395e-03 -3.61868083e-05]
 [ 1.74658888e-04  1.77924116e-04  2.24335524e-03  3.84664622e-04]
 [ 2.10813274e-03  8.56584051e-05  1.97452000e-03 -1.32837368e-04]
 [ 5.25899375e-04  1.28137535e-04  4.13362139e-04 -3.79491657e-04]
 [-1.37709999e-03  1.46052441e-04 -2.41992976e-03 -9.85668282e-04]
 [-3.18316356e-03 -7.44869696e-05  3.77390147e-03  3.66874605e-04]
 [ 2.68262895e-03 -3.04790801e-04 -8.85279923e-04  5.34630964e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0070038686687841
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4860416437962154e-06, theta_kick=1.7818198452414687e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.339484615317975e-06, theta_kick=-5.203205332753072e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009455404050892275
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.135618471980245e-06, theta_kick=7.356837408860493e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.1135155116622666e-06, theta_kick=-6.131297501430837e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.999035394843732e-06, theta_kick=2.3969186548322143e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004754681654952058
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.772703634015805e-07, theta_kick=-8.120726489333332e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01705493e-01 -6.31993255e+00  4.94675570e-03 -3.69939502e-02]
 [ 1.80018899e-01  4.56333887e-01 -1.96409633e-03  8.85468423e-03]
 [-6.04918336e-06 -3.69828225e-02  3.83944270e-01 -5.11917447e+00]
 [-7.79323536e-04  5.97407382e-03  2.12581738e-01 -2.29757688e-01]]
compute_tune_4x4()/ evals =  [0.08211979+0.99662247j 0.08211979-0.99662247j 0.0722877 +0.99738382j
 0.0722877 -0.99738382j]
compute_tune_4x4()/ angles =  [0.23691549501858772, 0.23848501213693996, 0.76151498786306, 0.7630845049814123]
compute_tune_4x4()/  0.23691549501858772 0.23848501213693996
compute_tunes()/ 0.23691549501858772 0.23848501213693996

 Running simulation ..
Closed orbit computation: x_co=[-9.08354746e-09  6.83416462e-10], y_co=[1.64312917e-08 4.29712598e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.29921011e-03  3.35064846e-04  6.74478582e-06  4.65225839e-04]
 [-1.41591095e-03  2.13414381e-04 -1.56347255e-03  2.01724869e-04]
 [-2.88700807e-03  9.21679371e-04 -9.95395030e-04 -5.19190219e-04]
 [ 1.54036623e-03  2.55201492e-04  3.04322316e-03  5.64630962e-04]
 [ 1.71797577e-04  3.58254412e-04  1.71806038e-03  7.91250842e-04]
 [ 1.39133011e-04  2.61095826e-05  1.19900035e-03  2.57296606e-05]
 [ 7.48135089e-04  1.59233466e-04  3.90373298e-03  5.81723492e-04]
 [ 1.05704580e-03 -5.01638081e-04  2.07707707e-03 -5.49653032e-04]
 [-1.78593715e-03  2.11771425e-05 -6.53387460e-04 -7.35902223e-04]
 [-2.09689760e-03  2.80118708e-04 -1.02337606e-03 -9.03187714e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0059465619509407935
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.570971221354275e-05, theta_kick=-6.679804109742292e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.187916863995873e-07, theta_kick=5.0214698959759175e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002650222822363657
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.00012861971645379956, theta_kick=1.5421987951916263e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00013143628053700684, theta_kick=-1.5759704583196704e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.8931744015748697e-05, theta_kick=3.4690249670941572e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002804592599761312
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.7044025334335166e-05, theta_kick=-2.0436427680408523e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690150e-01 -6.31989742e+00 -7.21515013e-04  2.08191252e-02]
 [ 1.80006965e-01  4.56138594e-01  6.63172627e-04 -1.07132315e-03]
 [ 1.67449029e-03  2.08179420e-02  3.84057416e-01 -5.11936769e+00]
 [ 7.44054532e-04  1.46670654e-03  2.12574886e-01 -2.29746819e-01]]
compute_tune_4x4()/ evals =  [0.07752678+0.99699027j 0.07752678-0.99699027j 0.07685274+0.99704245j
 0.07685274-0.99704245j]
compute_tune_4x4()/ angles =  [0.237648836552955, 0.23775643334544713, 0.7622435666545528, 0.762351163447045]
compute_tune_4x4()/  0.237648836552955 0.23775643334544713
compute_tunes()/ 0.237648836552955 0.23775643334544713

 Running simulation ..
Closed orbit computation: x_co=[ 1.30449456e-07 -1.76779126e-08], y_co=[-1.00781192e-05  7.28105410e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.570971221354275e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.187916863995873e-07, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.00012861971645379956, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00013143628053700684, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.8931744015748697e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.7044025334335166e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0059465619509407935}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.002650222822363657}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002804592599761312}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.29921011e-03  3.35064846e-04  6.74478582e-06  4.65225839e-04]
 [-1.41591095e-03  2.13414381e-04 -1.56347255e-03  2.01724869e-04]
 [-2.88700807e-03  9.21679371e-04 -9.95395030e-04 -5.19190219e-04]
 [ 1.54036623e-03  2.55201492e-04  3.04322316e-03  5.64630962e-04]
 [ 1.71797577e-04  3.58254412e-04  1.71806038e-03  7.91250842e-04]
 [ 1.39133011e-04  2.61095826e-05  1.19900035e-03  2.57296606e-05]
 [ 7.48135089e-04  1.59233466e-04  3.90373298e-03  5.81723492e-04]
 [ 1.05704580e-03 -5.01638081e-04  2.07707707e-03 -5.49653032e-04]
 [-1.78593715e-03  2.11771425e-05 -6.53387460e-04 -7.35902223e-04]
 [-2.09689760e-03  2.80118708e-04 -1.02337606e-03 -9.03187714e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0059465619509407935
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.384903114144423e-07, theta_kick=-6.456701448133102e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.560433432871165e-06, theta_kick=1.8710183994341667e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.002650222822363657
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.9994678930700246e-06, theta_kick=-2.397437236478871e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.698912674734151e-07, theta_kick=8.03224835266983e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.369327431042592e-07, theta_kick=7.63706324439241e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002804592599761312
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.999427587178082e-07, theta_kick=-7.193539413616178e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690150e-01 -6.31989742e+00 -7.21515013e-04  2.08191252e-02]
 [ 1.80006965e-01  4.56138594e-01  6.63172627e-04 -1.07132315e-03]
 [ 1.67449029e-03  2.08179420e-02  3.84057416e-01 -5.11936769e+00]
 [ 7.44054532e-04  1.46670654e-03  2.12574886e-01 -2.29746819e-01]]
compute_tune_4x4()/ evals =  [0.07752678+0.99699027j 0.07752678-0.99699027j 0.07685274+0.99704245j
 0.07685274-0.99704245j]
compute_tune_4x4()/ angles =  [0.237648836552955, 0.23775643334544713, 0.7622435666545528, 0.762351163447045]
compute_tune_4x4()/  0.237648836552955 0.23775643334544713
compute_tunes()/ 0.237648836552955 0.23775643334544713

 Running simulation ..
Closed orbit computation: x_co=[-4.71327709e-10 -2.11881782e-11], y_co=[-1.81014650e-07 -1.89601872e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.09186445e-03 -5.06136173e-04 -6.53875175e-04 -2.38408433e-04]
 [-2.38099117e-03  6.03063687e-04 -5.89549255e-04 -4.38915105e-04]
 [-2.30832096e-03  4.30594632e-04  1.42156128e-03  7.66732694e-05]
 [-1.92878104e-03  6.43663892e-05  1.79818250e-04  6.86814929e-04]
 [ 7.61063981e-04  6.78868155e-06  2.49907951e-03  2.23060420e-04]
 [ 1.50088897e-03 -2.53184890e-04  3.75611597e-03 -2.35358993e-05]
 [-2.52486418e-04  3.21689119e-04  1.24680110e-03 -5.02856143e-04]
 [ 2.43128384e-03  6.06123949e-05  2.15000420e-03 -7.30499408e-05]
 [ 1.05708485e-03  5.08464030e-05  1.05666848e-03  3.43084248e-04]
 [ 1.47410117e-03 -7.37345769e-04  1.73269605e-03  6.77519382e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009577509576728361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.5761202743058545e-05, theta_kick=-5.48694039161675e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.881603881828574e-05, theta_kick=5.853226731271025e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005500741325131527
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.337602559355212e-05, theta_kick=-2.8028734241296588e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.635661331656411e-06, theta_kick=3.160257106983848e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.104074588215348e-05, theta_kick=2.5228645999267163e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0037284728911069747
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.063654650061142e-06, theta_kick=-9.668625331352364e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01584030e-01 -6.31929139e+00  8.88349282e-03  3.92858393e-02]
 [ 1.79993292e-01  4.56103266e-01 -5.11843279e-04  1.16277777e-02]
 [ 1.14589116e-02  3.92882122e-02  3.84029354e-01 -5.11922385e+00]
 [ 2.58088872e-03  1.96180916e-02  2.12563154e-01 -2.29882874e-01]]
compute_tune_4x4()/ evals =  [0.08999252+0.99594244j 0.08999252-0.99594244j 0.06434034+0.99792801j
 0.06434034-0.99792801j]
compute_tune_4x4()/ angles =  [0.2356578420275535, 0.2397528391508637, 0.7602471608491363, 0.7643421579724465]
compute_tune_4x4()/  0.2356578420275535 0.2397528391508637
compute_tunes()/ 0.2356578420275535 0.2397528391508637

 Running simulation ..
Closed orbit computation: x_co=[-2.16707963e-08 -2.96631129e-08], y_co=[-1.22693483e-05 -3.14841844e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.5761202743058545e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.881603881828574e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.337602559355212e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.635661331656411e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.104074588215348e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.063654650061142e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009577509576728361}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005500741325131527}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0037284728911069747}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.09186445e-03 -5.06136173e-04 -6.53875175e-04 -2.38408433e-04]
 [-2.38099117e-03  6.03063687e-04 -5.89549255e-04 -4.38915105e-04]
 [-2.30832096e-03  4.30594632e-04  1.42156128e-03  7.66732694e-05]
 [-1.92878104e-03  6.43663892e-05  1.79818250e-04  6.86814929e-04]
 [ 7.61063981e-04  6.78868155e-06  2.49907951e-03  2.23060420e-04]
 [ 1.50088897e-03 -2.53184890e-04  3.75611597e-03 -2.35358993e-05]
 [-2.52486418e-04  3.21689119e-04  1.24680110e-03 -5.02856143e-04]
 [ 2.43128384e-03  6.06123949e-05  2.15000420e-03 -7.30499408e-05]
 [ 1.05708485e-03  5.08464030e-05  1.05666848e-03  3.43084248e-04]
 [ 1.47410117e-03 -7.37345769e-04  1.73269605e-03  6.77519382e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009577509576728361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.307962471940686e-07, theta_kick=5.165409096780358e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.963736757644766e-07, theta_kick=3.5536318870261916e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005500741325131527
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.252395555252576e-08, theta_kick=9.894932778309114e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.974751669864413e-07, theta_kick=-9.562027313001429e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.585629232451018e-07, theta_kick=9.095454869283964e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0037284728911069747
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.5742758619577384e-07, theta_kick=5.4847288718128456e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01584030e-01 -6.31929139e+00  8.88349282e-03  3.92858393e-02]
 [ 1.79993292e-01  4.56103266e-01 -5.11843279e-04  1.16277777e-02]
 [ 1.14589116e-02  3.92882122e-02  3.84029354e-01 -5.11922385e+00]
 [ 2.58088872e-03  1.96180916e-02  2.12563154e-01 -2.29882874e-01]]
compute_tune_4x4()/ evals =  [0.08999252+0.99594244j 0.08999252-0.99594244j 0.06434034+0.99792801j
 0.06434034-0.99792801j]
compute_tune_4x4()/ angles =  [0.2356578420275535, 0.2397528391508637, 0.7602471608491363, 0.7643421579724465]
compute_tune_4x4()/  0.2356578420275535 0.2397528391508637
compute_tunes()/ 0.2356578420275535 0.2397528391508637

 Running simulation ..
Closed orbit computation: x_co=[ 2.78193966e-09 -1.77832354e-10], y_co=[1.12315626e-07 4.09981364e-11]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.73439371e-03  6.38798133e-04  3.26336578e-04  8.38027256e-04]
 [ 4.28995767e-04 -5.83994097e-04  2.21183052e-03  1.32518143e-04]
 [-7.03833448e-03  4.03329198e-04 -2.12340999e-03 -8.72339061e-04]
 [-4.18470546e-03  7.99331092e-05  2.39579870e-03  1.74246723e-04]
 [-2.09736505e-04  1.87141293e-04 -4.85740437e-03 -9.27759583e-04]
 [ 3.58665398e-03 -3.98993154e-04 -1.03003515e-03  1.53195385e-04]
 [ 1.33070252e-03 -5.59028423e-04 -1.14032533e-03 -1.90447932e-04]
 [ 5.07243531e-04  6.83777286e-05 -3.80383278e-03 -9.17057165e-04]
 [ 8.37742343e-04 -2.18364463e-04 -1.10302421e-03  1.66170287e-04]
 [ 1.50757394e-03  8.83743647e-04 -1.84790318e-03 -3.21425987e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004977479642510326
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.201613089322708e-05, theta_kick=-7.435967438190978e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.746851767012343e-05, theta_kick=2.094540996311779e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.018005914612949068
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.027730105468795e-05, theta_kick=9.625550450676487e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.89702710511341e-05, theta_kick=9.468832635372945e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.742499398455803e-05, theta_kick=2.089322342648725e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010884764041961386
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.920161317649978e-05, theta_kick=-1.069560905301495e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01448199e-01 -6.32164638e+00  4.29795863e-03 -7.71359792e-02]
 [ 1.79976078e-01  4.56263925e-01 -3.75996813e-03  1.97405617e-02]
 [-4.88816145e-03 -7.72257590e-02  3.84082848e-01 -5.11985953e+00]
 [-1.76935250e-03  1.40226784e-02  2.12653335e-01 -2.30549265e-01]]
compute_tune_4x4()/ evals =  [0.08534407+0.99635154j 0.08534407-0.99635154j 0.06883059+0.99762836j
 0.06883059-0.99762836j]
compute_tune_4x4()/ angles =  [0.23640052649891027, 0.2390366035946928, 0.7609633964053072, 0.7635994735010897]
compute_tune_4x4()/  0.23640052649891027 0.2390366035946928
compute_tunes()/ 0.23640052649891027 0.2390366035946928

 Running simulation ..
Closed orbit computation: x_co=[-1.81178896e-06  6.83456762e-08], y_co=[-1.07742638e-04 -4.91680894e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.201613089322708e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.746851767012343e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.027730105468795e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.89702710511341e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.742499398455803e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.920161317649978e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004977479642510326}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.018005914612949068}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010884764041961386}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.73439371e-03  6.38798133e-04  3.26336578e-04  8.38027256e-04]
 [ 4.28995767e-04 -5.83994097e-04  2.21183052e-03  1.32518143e-04]
 [-7.03833448e-03  4.03329198e-04 -2.12340999e-03 -8.72339061e-04]
 [-4.18470546e-03  7.99331092e-05  2.39579870e-03  1.74246723e-04]
 [-2.09736505e-04  1.87141293e-04 -4.85740437e-03 -9.27759583e-04]
 [ 3.58665398e-03 -3.98993154e-04 -1.03003515e-03  1.53195385e-04]
 [ 1.33070252e-03 -5.59028423e-04 -1.14032533e-03 -1.90447932e-04]
 [ 5.07243531e-04  6.83777286e-05 -3.80383278e-03 -9.17057165e-04]
 [ 8.37742343e-04 -2.18364463e-04 -1.10302421e-03  1.66170287e-04]
 [ 1.50757394e-03  8.83743647e-04 -1.84790318e-03 -3.21425987e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004977479642510326
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.57522426798604e-06, theta_kick=-3.087790793616686e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.881557220948916e-06, theta_kick=4.654133156766059e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.018005914612949068
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.660678015781786e-06, theta_kick=-4.389290678891377e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.157644886727566e-06, theta_kick=3.7861350298524895e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5259979591533843e-06, theta_kick=-1.8297289707652035e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010884764041961386
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.1225235585373597e-07, theta_kick=3.744023235864885e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01448199e-01 -6.32164638e+00  4.29795863e-03 -7.71359792e-02]
 [ 1.79976078e-01  4.56263925e-01 -3.75996813e-03  1.97405617e-02]
 [-4.88816145e-03 -7.72257590e-02  3.84082848e-01 -5.11985953e+00]
 [-1.76935250e-03  1.40226784e-02  2.12653335e-01 -2.30549265e-01]]
compute_tune_4x4()/ evals =  [0.08534407+0.99635154j 0.08534407-0.99635154j 0.06883059+0.99762836j
 0.06883059-0.99762836j]
compute_tune_4x4()/ angles =  [0.23640052649891027, 0.2390366035946928, 0.7609633964053072, 0.7635994735010897]
compute_tune_4x4()/  0.23640052649891027 0.2390366035946928
compute_tunes()/ 0.23640052649891027 0.2390366035946928

 Running simulation ..
Closed orbit computation: x_co=[-5.64193575e-10 -4.70979459e-10], y_co=[-3.22386886e-07 -8.01079373e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.72414762e-03  2.19999456e-04  1.46221883e-03 -8.20050335e-04]
 [ 2.26221273e-03 -1.13456604e-04 -2.54778428e-03 -1.97549142e-04]
 [ 4.63311504e-04 -2.35117166e-04 -1.06369846e-03  1.74966642e-04]
 [ 1.70525446e-03 -1.19196851e-04 -2.22317531e-03 -6.75491747e-04]
 [ 5.70339891e-03 -3.71750829e-04  2.44653173e-03  1.64379074e-04]
 [ 1.00394327e-03  2.75404750e-04  2.16000543e-03  7.63540490e-04]
 [-1.78442837e-03  8.47177703e-04  1.77629130e-03  2.19541296e-04]
 [-3.95840967e-03 -1.46667877e-04 -2.59945063e-03 -4.64434713e-04]
 [ 7.33786712e-05  3.03787413e-04 -1.04391494e-04 -2.47105435e-04]
 [-4.63841264e-03  4.21536657e-05  2.90256740e-03  1.88284756e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006206562780784462
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0312471972829853e-05, theta_kick=-1.2365041916150014e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.655199796555186e-05, theta_kick=7.979834966976998e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009098197005129195
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.3417277717118e-05, theta_kick=-2.8078197089619105e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.8429926570727332e-05, theta_kick=-3.4088551672799835e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.599621274096645e-05, theta_kick=1.9180060955591263e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01567180145804624
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.448435208009209e-05, theta_kick=-7.731916445512649e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01414381e-01 -6.31766667e+00 -1.67709757e-02 -6.44360359e-02]
 [ 1.79999269e-01  4.56263718e-01  8.76635484e-04 -1.74454626e-02]
 [-2.05763890e-02 -6.44198668e-02  3.83752706e-01 -5.11897407e+00]
 [-4.21714679e-03 -3.01672164e-02  2.12519034e-01 -2.29909748e-01]]
compute_tune_4x4()/ evals =  [0.09829778+0.99515705j 0.09829778-0.99515705j 0.05604837+0.99842805j
 0.05604837-0.99842805j]
compute_tune_4x4()/ angles =  [0.2343301183635927, 0.24107494788939246, 0.7589250521106076, 0.7656698816364074]
compute_tune_4x4()/  0.2343301183635927 0.24107494788939246
compute_tunes()/ 0.2343301183635927 0.24107494788939246

 Running simulation ..
Closed orbit computation: x_co=[ 2.49824723e-07 -1.07986268e-07], y_co=[-1.68367774e-05  7.47860425e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.0312471972829853e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.655199796555186e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.3417277717118e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.8429926570727332e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.599621274096645e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.448435208009209e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.006206562780784462}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009098197005129195}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01567180145804624}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.72414762e-03  2.19999456e-04  1.46221883e-03 -8.20050335e-04]
 [ 2.26221273e-03 -1.13456604e-04 -2.54778428e-03 -1.97549142e-04]
 [ 4.63311504e-04 -2.35117166e-04 -1.06369846e-03  1.74966642e-04]
 [ 1.70525446e-03 -1.19196851e-04 -2.22317531e-03 -6.75491747e-04]
 [ 5.70339891e-03 -3.71750829e-04  2.44653173e-03  1.64379074e-04]
 [ 1.00394327e-03  2.75404750e-04  2.16000543e-03  7.63540490e-04]
 [-1.78442837e-03  8.47177703e-04  1.77629130e-03  2.19541296e-04]
 [-3.95840967e-03 -1.46667877e-04 -2.59945063e-03 -4.64434713e-04]
 [ 7.33786712e-05  3.03787413e-04 -1.04391494e-04 -2.47105435e-04]
 [-4.63841264e-03  4.21536657e-05  2.90256740e-03  1.88284756e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006206562780784462
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.948336061795517e-06, theta_kick=2.3361282468763224e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8883736241832854e-06, theta_kick=-3.463268654365895e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009098197005129195
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.139845702361468e-06, theta_kick=3.764793138079116e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.265976230370654e-06, theta_kick=-3.9160283869941e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.9658326974160543e-06, theta_kick=2.3571073713199623e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01567180145804624
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.198313339019913e-07, theta_kick=-8.63104853977493e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01414381e-01 -6.31766667e+00 -1.67709757e-02 -6.44360359e-02]
 [ 1.79999269e-01  4.56263718e-01  8.76635484e-04 -1.74454626e-02]
 [-2.05763890e-02 -6.44198668e-02  3.83752706e-01 -5.11897407e+00]
 [-4.21714679e-03 -3.01672164e-02  2.12519034e-01 -2.29909748e-01]]
compute_tune_4x4()/ evals =  [0.09829778+0.99515705j 0.09829778-0.99515705j 0.05604837+0.99842805j
 0.05604837-0.99842805j]
compute_tune_4x4()/ angles =  [0.2343301183635927, 0.24107494788939246, 0.7589250521106076, 0.7656698816364074]
compute_tune_4x4()/  0.2343301183635927 0.24107494788939246
compute_tunes()/ 0.2343301183635927 0.24107494788939246

 Running simulation ..
Closed orbit computation: x_co=[ 1.34941683e-09 -2.67370635e-10], y_co=[9.60410373e-08 7.03424456e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.11999833e-03 -1.54621109e-04  4.32264689e-03  9.62654322e-05]
 [ 1.41554936e-03 -4.54764784e-05 -1.20464413e-03  6.75641874e-05]
 [-8.35829653e-04  2.83904651e-04 -1.14193490e-03  4.29380383e-04]
 [-3.36567862e-03  6.18318648e-04  7.75187516e-04  1.84819921e-04]
 [-1.60390518e-03  2.94919708e-04 -2.45958281e-03  2.17647463e-05]
 [ 1.18605091e-03  3.46174441e-04 -1.05289622e-03 -6.60561149e-04]
 [-1.99319400e-03 -2.98964430e-04 -1.07231359e-03 -4.06650787e-04]
 [ 1.16987471e-03 -2.41153121e-04  2.07618794e-03 -4.50474372e-04]
 [-2.58299123e-03  7.31498883e-04 -1.62480487e-03  7.70448570e-04]
 [ 2.97972044e-03  1.88865069e-04 -8.15087179e-04 -2.06402103e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009796954451156336
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=0.00010988829047176776, theta_kick=-1.3176019497143074e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.6826774837430486e-05, theta_kick=2.0175936160275583e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007522654076657868
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.6179684156238245e-06, theta_kick=-5.53711788765e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.5105147374609898e-05, theta_kick=1.8111640053788333e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0716851276117992e-06, theta_kick=1.2849907916111542e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005181647152963346
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.025433794350889e-05, theta_kick=-2.4285713291168355e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01675396e-01 -6.31971717e+00  3.12971997e-03 -4.11899434e-02]
 [ 1.80026182e-01  4.56325683e-01 -1.68862820e-03  5.50543990e-03]
 [-1.93273506e-03 -4.11785412e-02  3.83942554e-01 -5.11955893e+00]
 [-1.21075370e-03  1.27640032e-03  2.12572285e-01 -2.29784423e-01]]
compute_tune_4x4()/ evals =  [0.07918937+0.99685959j 0.07918937-0.99685959j 0.07521484+0.99716735j
 0.07521484-0.99716735j]
compute_tune_4x4()/ angles =  [0.23738341066183138, 0.23801787043446074, 0.7619821295655392, 0.7626165893381687]
compute_tune_4x4()/  0.23738341066183138 0.23801787043446074
compute_tunes()/ 0.23738341066183138 0.23801787043446074

 Running simulation ..
Closed orbit computation: x_co=[-3.05805832e-07  7.03193869e-08], y_co=[-1.16751713e-05 -9.08850107e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 0.00010988829047176776, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.6826774837430486e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.6179684156238245e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.5105147374609898e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0716851276117992e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.025433794350889e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009796954451156336}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007522654076657868}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005181647152963346}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.11999833e-03 -1.54621109e-04  4.32264689e-03  9.62654322e-05]
 [ 1.41554936e-03 -4.54764784e-05 -1.20464413e-03  6.75641874e-05]
 [-8.35829653e-04  2.83904651e-04 -1.14193490e-03  4.29380383e-04]
 [-3.36567862e-03  6.18318648e-04  7.75187516e-04  1.84819921e-04]
 [-1.60390518e-03  2.94919708e-04 -2.45958281e-03  2.17647463e-05]
 [ 1.18605091e-03  3.46174441e-04 -1.05289622e-03 -6.60561149e-04]
 [-1.99319400e-03 -2.98964430e-04 -1.07231359e-03 -4.06650787e-04]
 [ 1.16987471e-03 -2.41153121e-04  2.07618794e-03 -4.50474372e-04]
 [-2.58299123e-03  7.31498883e-04 -1.62480487e-03  7.70448570e-04]
 [ 2.97972044e-03  1.88865069e-04 -8.15087179e-04 -2.06402103e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009796954451156336
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.656981027664032e-07, theta_kick=-1.0380045982806893e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.738321738182486e-06, theta_kick=3.283350797145469e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007522654076657868
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.110174783731697e-06, theta_kick=-6.12729184294267e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.9369602290004895e-06, theta_kick=5.919601074387699e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.008870515852523e-06, theta_kick=-2.408711334981505e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005181647152963346
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.348943607875662e-07, theta_kick=1.6174341416734138e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01675396e-01 -6.31971717e+00  3.12971997e-03 -4.11899434e-02]
 [ 1.80026182e-01  4.56325683e-01 -1.68862820e-03  5.50543990e-03]
 [-1.93273506e-03 -4.11785412e-02  3.83942554e-01 -5.11955893e+00]
 [-1.21075370e-03  1.27640032e-03  2.12572285e-01 -2.29784423e-01]]
compute_tune_4x4()/ evals =  [0.07918937+0.99685959j 0.07918937-0.99685959j 0.07521484+0.99716735j
 0.07521484-0.99716735j]
compute_tune_4x4()/ angles =  [0.23738341066183138, 0.23801787043446074, 0.7619821295655392, 0.7626165893381687]
compute_tune_4x4()/  0.23738341066183138 0.23801787043446074
compute_tunes()/ 0.23738341066183138 0.23801787043446074

 Running simulation ..
Closed orbit computation: x_co=[ 4.43432866e-09 -2.35696698e-10], y_co=[-7.92773258e-08 -2.73247525e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.64660768e-03  1.66089666e-04 -6.18028086e-04  2.71881373e-04]
 [ 4.29986313e-03 -4.24651672e-05  1.56553134e-03  1.66753968e-04]
 [-6.03873855e-04 -1.02660303e-04  2.60096939e-03  2.91022879e-04]
 [ 9.32749103e-04  5.71217556e-05 -2.31499484e-03 -2.01477381e-04]
 [ 3.47315215e-03 -7.45424370e-04  3.50391741e-04  2.05270889e-04]
 [-1.85601226e-03  1.79504962e-04  3.32402588e-03  1.70264356e-04]
 [ 3.98472804e-03 -2.97571694e-04  2.85404639e-03  1.69280898e-04]
 [-4.93791374e-03  1.60248401e-04 -6.53539062e-04  2.59713727e-04]
 [-2.78632015e-03  2.56586395e-05  1.65257159e-03  1.50725489e-04]
 [-2.25387844e-03 -3.19193420e-06 -1.04588044e-03  2.00527504e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005794311363291889
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00010944414852537885, theta_kick=1.312276520662681e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.248544397765878e-05, theta_kick=-1.497051711095504e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004376686781435806
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.539512369981666e-05, theta_kick=-3.0449708842009043e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.355243553089712e-05, theta_kick=-1.6249880130290322e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.2470397295385326e-05, theta_kick=1.4952475572757365e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0010100321672449337
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.744539470641262e-05, theta_kick=5.688881345023303e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01700721e-01 -6.32001667e+00 -5.39620590e-04  3.26989940e-02]
 [ 1.80008732e-01  4.56162849e-01  1.06840169e-03 -2.61109976e-03]
 [ 3.11083002e-03  3.26969608e-02  3.84057674e-01 -5.11933509e+00]
 [ 1.13550394e-03  1.15752724e-03  2.12579967e-01 -2.29742991e-01]]
compute_tune_4x4()/ evals =  [0.07747454+0.99699433j 0.07747454-0.99699433j 0.07691386+0.99703774j
 0.07691386-0.99703774j]
compute_tune_4x4()/ angles =  [0.2376571752358822, 0.23774667672615377, 0.7622533232738462, 0.7623428247641177]
compute_tune_4x4()/  0.2376571752358822 0.23774667672615377
compute_tunes()/ 0.2376571752358822 0.23774667672615377

 Running simulation ..
Closed orbit computation: x_co=[-2.92284750e-07  6.24471626e-08], y_co=[2.66342307e-05 6.01640746e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00010944414852537885, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.248544397765878e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.539512369981666e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.355243553089712e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.2470397295385326e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.744539470641262e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005794311363291889}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004376686781435806}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0010100321672449337}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.64660768e-03  1.66089666e-04 -6.18028086e-04  2.71881373e-04]
 [ 4.29986313e-03 -4.24651672e-05  1.56553134e-03  1.66753968e-04]
 [-6.03873855e-04 -1.02660303e-04  2.60096939e-03  2.91022879e-04]
 [ 9.32749103e-04  5.71217556e-05 -2.31499484e-03 -2.01477381e-04]
 [ 3.47315215e-03 -7.45424370e-04  3.50391741e-04  2.05270889e-04]
 [-1.85601226e-03  1.79504962e-04  3.32402588e-03  1.70264356e-04]
 [ 3.98472804e-03 -2.97571694e-04  2.85404639e-03  1.69280898e-04]
 [-4.93791374e-03  1.60248401e-04 -6.53539062e-04  2.59713727e-04]
 [-2.78632015e-03  2.56586395e-05  1.65257159e-03  1.50725489e-04]
 [-2.25387844e-03 -3.19193420e-06 -1.04588044e-03  2.00527504e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005794311363291889
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4745628113597249e-07, theta_kick=1.7680562932434972e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6109318619934294e-07, theta_kick=-1.9315679160235617e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004376686781435806
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.1059990146032726e-07, theta_kick=3.724209685929564e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.909967510848143e-07, theta_kick=-1.1882423921458338e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.14976663237164e-07, theta_kick=6.174763959158898e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0010100321672449337
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.0296799730190134e-07, theta_kick=-3.632700283462718e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01700721e-01 -6.32001667e+00 -5.39620590e-04  3.26989940e-02]
 [ 1.80008732e-01  4.56162849e-01  1.06840169e-03 -2.61109976e-03]
 [ 3.11083002e-03  3.26969608e-02  3.84057674e-01 -5.11933509e+00]
 [ 1.13550394e-03  1.15752724e-03  2.12579967e-01 -2.29742991e-01]]
compute_tune_4x4()/ evals =  [0.07747454+0.99699433j 0.07747454-0.99699433j 0.07691386+0.99703774j
 0.07691386-0.99703774j]
compute_tune_4x4()/ angles =  [0.2376571752358822, 0.23774667672615377, 0.7622533232738462, 0.7623428247641177]
compute_tune_4x4()/  0.2376571752358822 0.23774667672615377
compute_tunes()/ 0.2376571752358822 0.23774667672615377

 Running simulation ..
Closed orbit computation: x_co=[-6.90019753e-12  2.05523044e-10], y_co=[1.34414366e-07 3.39811811e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.32529216e-04 -8.99707107e-04  2.15704026e-03 -1.64533665e-04]
 [-3.52857362e-04  9.62749482e-04  8.47351037e-04  4.08684845e-04]
 [ 4.73834847e-03 -7.12513578e-04 -1.86888334e-04 -6.85748931e-04]
 [ 1.76321092e-03 -8.32393795e-05 -3.57264869e-03 -1.76613111e-04]
 [ 2.24429159e-05 -6.88255231e-04 -9.16451584e-04  4.65101201e-04]
 [-1.56261621e-03 -1.06445249e-04  9.22035221e-04  3.43818628e-04]
 [ 1.32699241e-03  1.11421091e-03 -4.09879901e-03  1.03523058e-03]
 [-1.38797083e-04  2.64320320e-04  2.09626462e-03 -4.61141681e-04]
 [-1.45863964e-04 -4.26659068e-04 -6.56198389e-04  8.13275209e-04]
 [-1.69288472e-03 -2.38727692e-05 -4.42054671e-03 -6.43739255e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0016106063609502516
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.7343140079726874e-05, theta_kick=-2.079507751473065e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.5000708550408704e-06, theta_kick=2.9976790237464643e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0031906879509479118
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.045704758088236e-05, theta_kick=-4.850952230069538e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.174765599119601e-06, theta_kick=-6.20473866090969e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.0909366821163015e-05, theta_kick=-4.905187008891601e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0018825608670149242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.574411488100007e-05, theta_kick=4.285853866305965e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708864e-01 -6.32001783e+00  2.14010453e-03 -8.19329908e-03]
 [ 1.80001150e-01  4.56110879e-01 -6.18895346e-04  3.40641890e-03]
 [ 8.44427476e-04 -8.19300028e-03  3.84077237e-01 -5.11916919e+00]
 [-4.94366569e-05  3.10782450e-03  2.12579026e-01 -2.29719986e-01]]
compute_tune_4x4()/ evals =  [0.07955141+0.99683076j 0.07955141-0.99683076j 0.07482822+0.99719644j
 0.07482822-0.99719644j]
compute_tune_4x4()/ angles =  [0.23732560788114906, 0.23807957627131, 0.7619204237286901, 0.7626743921188509]
compute_tune_4x4()/  0.23732560788114906 0.23807957627131
compute_tunes()/ 0.23732560788114906 0.23807957627131

 Running simulation ..
Closed orbit computation: x_co=[ 7.56518427e-08 -2.09121237e-08], y_co=[4.36678154e-05 1.97161980e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.7343140079726874e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.5000708550408704e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.045704758088236e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.174765599119601e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.0909366821163015e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.574411488100007e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0016106063609502516}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0031906879509479118}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0018825608670149242}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.32529216e-04 -8.99707107e-04  2.15704026e-03 -1.64533665e-04]
 [-3.52857362e-04  9.62749482e-04  8.47351037e-04  4.08684845e-04]
 [ 4.73834847e-03 -7.12513578e-04 -1.86888334e-04 -6.85748931e-04]
 [ 1.76321092e-03 -8.32393795e-05 -3.57264869e-03 -1.76613111e-04]
 [ 2.24429159e-05 -6.88255231e-04 -9.16451584e-04  4.65101201e-04]
 [-1.56261621e-03 -1.06445249e-04  9.22035221e-04  3.43818628e-04]
 [ 1.32699241e-03  1.11421091e-03 -4.09879901e-03  1.03523058e-03]
 [-1.38797083e-04  2.64320320e-04  2.09626462e-03 -4.61141681e-04]
 [-1.45863964e-04 -4.26659068e-04 -6.56198389e-04  8.13275209e-04]
 [-1.69288472e-03 -2.38727692e-05 -4.42054671e-03 -6.43739255e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0016106063609502516
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.088516735300058e-07, theta_kick=9.698435907023458e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.6573742587449273e-06, theta_kick=-4.38532934989585e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0031906879509479118
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.974734230524477e-06, theta_kick=7.163931149867513e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.220052639763927e-06, theta_kick=-5.060001900273908e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0268081452318866e-06, theta_kick=1.2311816011803876e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0018825608670149242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.3802831583604724e-07, theta_kick=-4.053086694606896e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01708864e-01 -6.32001783e+00  2.14010453e-03 -8.19329908e-03]
 [ 1.80001150e-01  4.56110879e-01 -6.18895346e-04  3.40641890e-03]
 [ 8.44427476e-04 -8.19300028e-03  3.84077237e-01 -5.11916919e+00]
 [-4.94366569e-05  3.10782450e-03  2.12579026e-01 -2.29719986e-01]]
compute_tune_4x4()/ evals =  [0.07955141+0.99683076j 0.07955141-0.99683076j 0.07482822+0.99719644j
 0.07482822-0.99719644j]
compute_tune_4x4()/ angles =  [0.23732560788114906, 0.23807957627131, 0.7619204237286901, 0.7626743921188509]
compute_tune_4x4()/  0.23732560788114906 0.23807957627131
compute_tunes()/ 0.23732560788114906 0.23807957627131

 Running simulation ..
Closed orbit computation: x_co=[-3.90727720e-09  4.42627377e-10], y_co=[-1.34245714e-07  3.53052631e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.19602018e-03 -1.62855168e-04  3.64750132e-03 -4.46274675e-04]
 [ 2.95514712e-03  2.45666707e-04 -3.49664219e-04 -8.47343523e-05]
 [ 6.20384620e-04 -1.97285263e-04 -4.09507621e-03  6.69982334e-05]
 [-1.89669362e-03 -1.31649457e-04  1.04784805e-03 -1.43684128e-03]
 [-2.51178844e-03 -2.19445142e-04  6.32278604e-04  2.47752113e-04]
 [-2.82882603e-03 -1.53119838e-04 -4.25039372e-03 -4.13029920e-04]
 [ 2.23017500e-03 -3.24017931e-04  2.00920572e-03  6.45254919e-04]
 [-1.39591553e-03  7.12635858e-04  2.14594238e-03  2.34233959e-04]
 [-3.63595878e-03  3.07862917e-04  2.03006675e-03  6.21834910e-04]
 [ 5.55178541e-04 -1.72747407e-04 -6.05059113e-04 -6.06003629e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01282461461839695
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.3244949946422e-05, theta_kick=-1.1180420345330922e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.964098743027354e-05, theta_kick=-3.554065921120105e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016744554059002898
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.78882403590136e-05, theta_kick=5.741980205036915e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.65785568763112e-06, theta_kick=-5.584944227599386e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.362841401229027e-06, theta_kick=5.231210997891132e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007935787959245598
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.4971741857239246e-05, theta_kick=2.9942058082443393e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01360113e-01 -6.31795943e+00  1.84534086e-02  3.74267239e-02]
 [ 1.79948952e-01  4.56260934e-01 -2.40456905e-03  2.70233390e-02]
 [ 1.90070222e-02  3.74385779e-02  3.83773028e-01 -5.11773926e+00]
 [ 3.76246431e-03  3.83820867e-02  2.12551057e-01 -2.30265166e-01]]
compute_tune_4x4()/ evals =  [0.10267838+0.99471461j 0.10267838-0.99471461j 0.05152596+0.99867166j
 0.05152596-0.99867166j]
compute_tune_4x4()/ angles =  [0.2336293760530772, 0.2417957558828348, 0.7582042441171652, 0.7663706239469228]
compute_tune_4x4()/  0.2336293760530772 0.2417957558828348
compute_tunes()/ 0.2336293760530772 0.2417957558828348

 Running simulation ..
Closed orbit computation: x_co=[-2.85178302e-07 -1.36720018e-07], y_co=[-3.09504775e-06 -1.25133327e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.3244949946422e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.964098743027354e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.78882403590136e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.65785568763112e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.362841401229027e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.4971741857239246e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.01282461461839695}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.016744554059002898}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.007935787959245598}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.19602018e-03 -1.62855168e-04  3.64750132e-03 -4.46274675e-04]
 [ 2.95514712e-03  2.45666707e-04 -3.49664219e-04 -8.47343523e-05]
 [ 6.20384620e-04 -1.97285263e-04 -4.09507621e-03  6.69982334e-05]
 [-1.89669362e-03 -1.31649457e-04  1.04784805e-03 -1.43684128e-03]
 [-2.51178844e-03 -2.19445142e-04  6.32278604e-04  2.47752113e-04]
 [-2.82882603e-03 -1.53119838e-04 -4.25039372e-03 -4.13029920e-04]
 [ 2.23017500e-03 -3.24017931e-04  2.00920572e-03  6.45254919e-04]
 [-1.39591553e-03  7.12635858e-04  2.14594238e-03  2.34233959e-04]
 [-3.63595878e-03  3.07862917e-04  2.03006675e-03  6.21834910e-04]
 [ 5.55178541e-04 -1.72747407e-04 -6.05059113e-04 -6.06003629e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01282461461839695
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.8896292226762906e-06, theta_kick=2.265736537848025e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.244720881728441e-06, theta_kick=-3.8905424242108013e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016744554059002898
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.2368053402636953e-06, theta_kick=3.881051392161602e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.8585350165058047e-06, theta_kick=-3.427491041042563e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.2957324095567423e-06, theta_kick=1.5536319127456138e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007935787959245598
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.9734788963178585e-07, theta_kick=-3.5653130778563936e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01360113e-01 -6.31795943e+00  1.84534086e-02  3.74267239e-02]
 [ 1.79948952e-01  4.56260934e-01 -2.40456905e-03  2.70233390e-02]
 [ 1.90070222e-02  3.74385779e-02  3.83773028e-01 -5.11773926e+00]
 [ 3.76246431e-03  3.83820867e-02  2.12551057e-01 -2.30265166e-01]]
compute_tune_4x4()/ evals =  [0.10267838+0.99471461j 0.10267838-0.99471461j 0.05152596+0.99867166j
 0.05152596-0.99867166j]
compute_tune_4x4()/ angles =  [0.2336293760530772, 0.2417957558828348, 0.7582042441171652, 0.7663706239469228]
compute_tune_4x4()/  0.2336293760530772 0.2417957558828348
compute_tunes()/ 0.2336293760530772 0.2417957558828348

 Running simulation ..
Closed orbit computation: x_co=[-1.76860718e-09  7.21536151e-10], y_co=[2.84196446e-07 5.51007525e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.71553227e-03 -5.86282486e-04 -2.49603695e-05  4.46226326e-04]
 [-1.01589164e-03 -6.06884526e-04 -2.08238493e-03  2.29330586e-04]
 [ 1.53506229e-03  3.49547848e-04  1.25186724e-03  5.05762881e-05]
 [ 1.57531158e-03 -7.44761208e-04  1.94731933e-04 -2.80281039e-04]
 [-4.32503171e-04 -3.73524818e-04  1.72128620e-03 -1.06685953e-03]
 [ 1.55854558e-03 -3.38719240e-04  4.95230583e-04 -3.54734359e-04]
 [-2.59606468e-03 -7.59942019e-04 -2.89493598e-03  3.38173093e-04]
 [-3.57088892e-03  1.40967542e-04 -1.02042473e-03 -1.19344413e-04]
 [-1.83869371e-03 -2.75857425e-04  6.66009343e-05 -2.71662694e-04]
 [ 8.52540411e-04 -1.87506495e-04  1.63156028e-03  6.56116896e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.013271134674702843
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.208552516312061e-07, theta_kick=6.245250445901975e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.501239221310368e-05, theta_kick=-6.596192817928688e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01113740692645029
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8734557977592157e-06, theta_kick=-3.445381619180009e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.8371888969570432e-05, theta_kick=-2.2028586141723574e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.259999926094199e-05, theta_kick=6.3069378260092415e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.009232256450432458
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.91120251190393e-05, theta_kick=4.68967897606535e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01632967e-01 -6.31919198e+00 -6.09057291e-03  4.93555255e-02]
 [ 1.80052223e-01  4.56590164e-01  2.38255743e-03 -9.14130441e-03]
 [ 4.16930441e-04  4.93230004e-02  3.83743374e-01 -5.11981972e+00]
 [ 1.21587913e-03 -4.66693197e-03  2.12558802e-01 -2.29843270e-01]]
compute_tune_4x4()/ evals =  [0.08206443+0.99662703j 0.08206443-0.99662703j 0.07236422+0.99737827j
 0.07236422-0.99737827j]
compute_tune_4x4()/ angles =  [0.23692433633756918, 0.23847280048228553, 0.7615271995177144, 0.7630756636624308]
compute_tune_4x4()/  0.23692433633756918 0.23847280048228553
compute_tunes()/ 0.23692433633756918 0.23847280048228553

 Running simulation ..
Closed orbit computation: x_co=[-3.94783759e-07  4.14442893e-08], y_co=[ 2.08277797e-05 -9.82478251e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.208552516312061e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.501239221310368e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.8734557977592157e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.8371888969570432e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.259999926094199e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.91120251190393e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.013271134674702843}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01113740692645029}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.009232256450432458}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.71553227e-03 -5.86282486e-04 -2.49603695e-05  4.46226326e-04]
 [-1.01589164e-03 -6.06884526e-04 -2.08238493e-03  2.29330586e-04]
 [ 1.53506229e-03  3.49547848e-04  1.25186724e-03  5.05762881e-05]
 [ 1.57531158e-03 -7.44761208e-04  1.94731933e-04 -2.80281039e-04]
 [-4.32503171e-04 -3.73524818e-04  1.72128620e-03 -1.06685953e-03]
 [ 1.55854558e-03 -3.38719240e-04  4.95230583e-04 -3.54734359e-04]
 [-2.59606468e-03 -7.59942019e-04 -2.89493598e-03  3.38173093e-04]
 [-3.57088892e-03  1.40967542e-04 -1.02042473e-03 -1.19344413e-04]
 [-1.83869371e-03 -2.75857425e-04  6.66009343e-05 -2.71662694e-04]
 [ 8.52540411e-04 -1.87506495e-04  1.63156028e-03  6.56116896e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.013271134674702843
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.6148182339884947e-07, theta_kick=4.334303074984811e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.5995820739759696e-06, theta_kick=1.9179590931394788e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01113740692645029
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.9154635994408362e-06, theta_kick=-3.4957505539967127e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.212712518525903e-07, theta_kick=1.1046388950500399e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.874530502525226e-07, theta_kick=2.2476326042771005e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.009232256450432458
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1170974137251471e-06, theta_kick=-1.3394418313598378e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01632967e-01 -6.31919198e+00 -6.09057291e-03  4.93555255e-02]
 [ 1.80052223e-01  4.56590164e-01  2.38255743e-03 -9.14130441e-03]
 [ 4.16930441e-04  4.93230004e-02  3.83743374e-01 -5.11981972e+00]
 [ 1.21587913e-03 -4.66693197e-03  2.12558802e-01 -2.29843270e-01]]
compute_tune_4x4()/ evals =  [0.08206443+0.99662703j 0.08206443-0.99662703j 0.07236422+0.99737827j
 0.07236422-0.99737827j]
compute_tune_4x4()/ angles =  [0.23692433633756918, 0.23847280048228553, 0.7615271995177144, 0.7630756636624308]
compute_tune_4x4()/  0.23692433633756918 0.23847280048228553
compute_tunes()/ 0.23692433633756918 0.23847280048228553

 Running simulation ..
Closed orbit computation: x_co=[-4.60037327e-09  1.78779727e-09], y_co=[1.03488720e-07 1.33695975e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.68125973e-03  5.89998904e-05  5.61544583e-04  8.24645173e-04]
 [-1.52931693e-03  2.52529562e-04 -1.92094165e-04  4.70269558e-05]
 [ 1.28255905e-03  1.14667148e-04 -3.80684799e-03 -2.05251661e-04]
 [ 7.31722917e-05 -4.28027313e-04 -2.07406852e-03 -2.03170860e-04]
 [ 1.00434747e-03 -2.61479013e-04 -1.50065951e-03  3.17701857e-04]
 [ 1.99969107e-04  1.77310270e-04  1.81276014e-03 -8.11608638e-05]
 [-2.19430927e-03  4.06655043e-04 -6.40849710e-04  3.34150138e-05]
 [-2.57276724e-03  5.42262751e-04  5.71096816e-04  9.61025241e-04]
 [ 1.48957978e-03 -6.69954584e-04  8.19616205e-05 -5.38047087e-04]
 [ 5.78759998e-04 -3.26495973e-04 -1.45153127e-03 -1.20651135e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007849415033144833
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3285778871531368e-05, theta_kick=-1.593014876239277e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.000046442824797e-05, theta_kick=-7.194281444821871e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004743635787198773
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.112540056855928e-05, theta_kick=-4.931090268060652e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.846735453045628e-05, theta_kick=-3.4133429204792523e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6679127941926873e-05, theta_kick=-1.999890197715231e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0036803980440650403
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.979462872554708e-05, theta_kick=-8.368638595937898e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01662766e-01 -6.32003610e+00  2.99993363e-03  6.18399202e-02]
 [ 1.80015777e-01  4.56191278e-01  1.42072853e-03 -8.09955909e-04]
 [ 9.13972477e-03  6.18390650e-02  3.84060504e-01 -5.11963867e+00]
 [ 2.53692428e-03  7.28615732e-03  2.12582845e-01 -2.29799903e-01]]
compute_tune_4x4()/ evals =  [0.08182598+0.99664663j 0.08182598-0.99664663j 0.07256857+0.99736343j
 0.07256857-0.99736343j]
compute_tune_4x4()/ angles =  [0.23696241367573198, 0.23844019171587807, 0.761559808284122, 0.763037586324268]
compute_tune_4x4()/  0.23696241367573198 0.23844019171587807
compute_tunes()/ 0.23696241367573198 0.23844019171587807

 Running simulation ..
Closed orbit computation: x_co=[4.50825916e-08 2.15179310e-09], y_co=[4.04317372e-05 3.35953928e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.3285778871531368e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.000046442824797e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.112540056855928e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.846735453045628e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.6679127941926873e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.979462872554708e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007849415033144833}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004743635787198773}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0036803980440650403}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.68125973e-03  5.89998904e-05  5.61544583e-04  8.24645173e-04]
 [-1.52931693e-03  2.52529562e-04 -1.92094165e-04  4.70269558e-05]
 [ 1.28255905e-03  1.14667148e-04 -3.80684799e-03 -2.05251661e-04]
 [ 7.31722917e-05 -4.28027313e-04 -2.07406852e-03 -2.03170860e-04]
 [ 1.00434747e-03 -2.61479013e-04 -1.50065951e-03  3.17701857e-04]
 [ 1.99969107e-04  1.77310270e-04  1.81276014e-03 -8.11608638e-05]
 [-2.19430927e-03  4.06655043e-04 -6.40849710e-04  3.34150138e-05]
 [-2.57276724e-03  5.42262751e-04  5.71096816e-04  9.61025241e-04]
 [ 1.48957978e-03 -6.69954584e-04  8.19616205e-05 -5.38047087e-04]
 [ 5.78759998e-04 -3.26495973e-04 -1.45153127e-03 -1.20651135e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007849415033144833
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.003844184478515e-06, theta_kick=-1.2036469481869653e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.103034891622055e-06, theta_kick=1.3225803382367875e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004743635787198773
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.1559460491086183e-06, theta_kick=-1.3860228069171497e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.258956266579415e-06, theta_kick=2.7085735599181795e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.879877448402277e-06, theta_kick=-2.254043793569766e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0036803980440650403
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.722518006603093e-07, theta_kick=1.1657664912827011e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01662766e-01 -6.32003610e+00  2.99993363e-03  6.18399202e-02]
 [ 1.80015777e-01  4.56191278e-01  1.42072853e-03 -8.09955909e-04]
 [ 9.13972477e-03  6.18390650e-02  3.84060504e-01 -5.11963867e+00]
 [ 2.53692428e-03  7.28615732e-03  2.12582845e-01 -2.29799903e-01]]
compute_tune_4x4()/ evals =  [0.08182598+0.99664663j 0.08182598-0.99664663j 0.07256857+0.99736343j
 0.07256857-0.99736343j]
compute_tune_4x4()/ angles =  [0.23696241367573198, 0.23844019171587807, 0.761559808284122, 0.763037586324268]
compute_tune_4x4()/  0.23696241367573198 0.23844019171587807
compute_tunes()/ 0.23696241367573198 0.23844019171587807

 Running simulation ..
Closed orbit computation: x_co=[ 1.42007662e-10 -1.78413401e-10], y_co=[-4.32829701e-09 -5.09235776e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.50620286e-03  8.83528536e-04  3.17927478e-03  2.58564399e-04]
 [ 1.41393773e-03 -9.77203615e-05 -1.22663595e-03 -3.04631519e-04]
 [-4.38995484e-04 -5.63919467e-05  1.12008445e-03 -1.29596898e-04]
 [-2.02276442e-03 -8.47518148e-06 -8.79671764e-04  3.34468539e-04]
 [-1.65229347e-03 -3.36950123e-05 -2.23586592e-03 -4.54849795e-04]
 [ 8.01656820e-04  1.15601270e-03  7.76597283e-05 -9.31066332e-05]
 [-2.01452077e-04  2.12740939e-04  2.81334079e-03  9.79936580e-04]
 [-2.80625785e-03  1.55541715e-04 -2.49568025e-03 -6.45519849e-04]
 [ 2.71907302e-03  1.10679342e-04 -1.93120355e-03  6.43412174e-05]
 [ 1.97341817e-03 -5.46656663e-04 -5.74155498e-04 -2.46651315e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009973635162089857
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.157836844929148e-05, theta_kick=-3.786365194958873e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.8296382223154852e-05, theta_kick=2.193805071172768e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00217600659999282
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.9010246212618564e-05, theta_kick=-2.279400049519426e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2183240012635307e-05, theta_kick=-1.4608163186058352e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.233794092603321e-06, theta_kick=-7.474553671978273e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0068304306302468774
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.00012705313530379862, theta_kick=-1.5234148977557365e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01585623e-01 -6.31956849e+00 -7.09140606e-03 -7.62800332e-02]
 [ 1.80017967e-01  4.56178914e-01 -1.13761559e-03 -3.93530857e-03]
 [-1.40210239e-02 -7.62805609e-02  3.84038803e-01 -5.11988839e+00]
 [-3.54333361e-03 -1.50785701e-02  2.12569826e-01 -2.29859363e-01]]
compute_tune_4x4()/ evals =  [0.08716982+0.99619347j 0.08716982-0.99619347j 0.06721655+0.99773841j
 0.06721655-0.99773841j]
compute_tune_4x4()/ angles =  [0.2361088624122998, 0.2392940822240415, 0.7607059177759585, 0.7638911375877002]
compute_tune_4x4()/  0.2361088624122998 0.2392940822240415
compute_tunes()/ 0.2361088624122998 0.2392940822240415

 Running simulation ..
Closed orbit computation: x_co=[-1.29795117e-07 -3.06556754e-08], y_co=[-1.96474534e-05  8.20152165e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.157836844929148e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.8296382223154852e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.9010246212618564e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.2183240012635307e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.233794092603321e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.00012705313530379862, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009973635162089857}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00217600659999282}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0068304306302468774}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.50620286e-03  8.83528536e-04  3.17927478e-03  2.58564399e-04]
 [ 1.41393773e-03 -9.77203615e-05 -1.22663595e-03 -3.04631519e-04]
 [-4.38995484e-04 -5.63919467e-05  1.12008445e-03 -1.29596898e-04]
 [-2.02276442e-03 -8.47518148e-06 -8.79671764e-04  3.34468539e-04]
 [-1.65229347e-03 -3.36950123e-05 -2.23586592e-03 -4.54849795e-04]
 [ 8.01656820e-04  1.15601270e-03  7.76597283e-05 -9.31066332e-05]
 [-2.01452077e-04  2.12740939e-04  2.81334079e-03  9.79936580e-04]
 [-2.80625785e-03  1.55541715e-04 -2.49568025e-03 -6.45519849e-04]
 [ 2.71907302e-03  1.10679342e-04 -1.93120355e-03  6.43412174e-05]
 [ 1.97341817e-03 -5.46656663e-04 -5.74155498e-04 -2.46651315e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009973635162089857
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.537352792580772e-07, theta_kick=9.037569601413096e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.0577120870215247e-07, theta_kick=-3.66631184289799e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00217600659999282
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.4798139939191596e-07, theta_kick=-5.3714655377788494e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.730686248775405e-07, theta_kick=9.269383689823635e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.380368212073247e-07, theta_kick=-1.655113424499618e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0068304306302468774
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.194586035046019e-07, theta_kick=-5.029466483001637e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01585623e-01 -6.31956849e+00 -7.09140606e-03 -7.62800332e-02]
 [ 1.80017967e-01  4.56178914e-01 -1.13761559e-03 -3.93530857e-03]
 [-1.40210239e-02 -7.62805609e-02  3.84038803e-01 -5.11988839e+00]
 [-3.54333361e-03 -1.50785701e-02  2.12569826e-01 -2.29859363e-01]]
compute_tune_4x4()/ evals =  [0.08716982+0.99619347j 0.08716982-0.99619347j 0.06721655+0.99773841j
 0.06721655-0.99773841j]
compute_tune_4x4()/ angles =  [0.2361088624122998, 0.2392940822240415, 0.7607059177759585, 0.7638911375877002]
compute_tune_4x4()/  0.2361088624122998 0.2392940822240415
compute_tunes()/ 0.2361088624122998 0.2392940822240415

 Running simulation ..
Closed orbit computation: x_co=[ 5.89472657e-11 -4.85014852e-10], y_co=[-1.51030293e-07  5.20846504e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 15/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.71425928e-03 -1.77268969e-04 -2.45760511e-03 -1.93362478e-04]
 [ 5.68340996e-04 -3.63813102e-04 -1.88093483e-03  3.44872966e-04]
 [-3.71608088e-04 -5.08684851e-04 -2.20109236e-03 -4.59540347e-04]
 [ 5.05483106e-03 -1.10964885e-04  5.60951343e-04  6.00600801e-04]
 [-6.81738096e-04 -8.86313641e-05 -1.51367254e-03 -1.27934422e-04]
 [ 8.20357999e-04  2.46489484e-04 -7.13683579e-04  7.14484348e-05]
 [ 9.36859853e-05  1.18745596e-04  3.24442772e-03 -3.25247288e-04]
 [ 1.11649080e-03 -2.99615436e-05  1.51255836e-04 -3.83265224e-04]
 [ 1.97711907e-03 -3.23841188e-04 -1.04456127e-03 -4.49849538e-04]
 [ 3.32216425e-03 -9.89353440e-04  8.14921759e-04  3.33521125e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005181585495107061
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.376285243341904e-06, theta_kick=1.124251880220013e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.776841509701898e-05, theta_kick=8.125687957974136e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01423220154357152
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.409315417468685e-05, theta_kick=-4.087897465655718e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.8772744901752757e-05, theta_kick=-2.250922748715762e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.000346427919093e-05, theta_kick=7.194641138237277e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0028245947108147987
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.078563083429733e-06, theta_kick=9.686501103911304e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01726572e-01 -6.32046184e+00 -6.88131649e-03  5.14026028e-02]
 [ 1.80014423e-01  4.56458088e-01  2.90053321e-03 -1.45811984e-02]
 [ 2.36556530e-06  5.13861925e-02  3.83909633e-01 -5.11872730e+00]
 [ 9.48325288e-04 -1.11134508e-02  2.12608010e-01 -2.29829257e-01]]
compute_tune_4x4()/ evals =  [0.08530261+0.99635509j 0.08530261-0.99635509j 0.06910333+0.99760951j
 0.06910333-0.99760951j]
compute_tune_4x4()/ angles =  [0.23640714854562447, 0.23899309087134823, 0.7610069091286518, 0.7635928514543755]
compute_tune_4x4()/  0.23640714854562447 0.23899309087134823
compute_tunes()/ 0.23640714854562447 0.23899309087134823

 Running simulation ..
Closed orbit computation: x_co=[-3.63790043e-07  2.72153341e-08], y_co=[-1.29677596e-05 -3.93800943e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.376285243341904e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.776841509701898e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.409315417468685e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.8772744901752757e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.000346427919093e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.078563083429733e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005181585495107061}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01423220154357152}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0028245947108147987}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.71425928e-03 -1.77268969e-04 -2.45760511e-03 -1.93362478e-04]
 [ 5.68340996e-04 -3.63813102e-04 -1.88093483e-03  3.44872966e-04]
 [-3.71608088e-04 -5.08684851e-04 -2.20109236e-03 -4.59540347e-04]
 [ 5.05483106e-03 -1.10964885e-04  5.60951343e-04  6.00600801e-04]
 [-6.81738096e-04 -8.86313641e-05 -1.51367254e-03 -1.27934422e-04]
 [ 8.20357999e-04  2.46489484e-04 -7.13683579e-04  7.14484348e-05]
 [ 9.36859853e-05  1.18745596e-04  3.24442772e-03 -3.25247288e-04]
 [ 1.11649080e-03 -2.99615436e-05  1.51255836e-04 -3.83265224e-04]
 [ 1.97711907e-03 -3.23841188e-04 -1.04456127e-03 -4.49849538e-04]
 [ 3.32216425e-03 -9.89353440e-04  8.14921759e-04  3.33521125e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005181585495107061
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.698957684634066e-07, theta_kick=-9.231339947587963e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.4679688865044216e-08, theta_kick=-2.959187555591211e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01423220154357152
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.200038065747588e-07, theta_kick=8.633116552016591e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.320207681556172e-07, theta_kick=3.981053937497347e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.379041157129119e-07, theta_kick=-1.0046785620171411e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0028245947108147987
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.198458508131146e-07, theta_kick=9.83026022935606e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01726572e-01 -6.32046184e+00 -6.88131649e-03  5.14026028e-02]
 [ 1.80014423e-01  4.56458088e-01  2.90053321e-03 -1.45811984e-02]
 [ 2.36556530e-06  5.13861925e-02  3.83909633e-01 -5.11872730e+00]
 [ 9.48325288e-04 -1.11134508e-02  2.12608010e-01 -2.29829257e-01]]
compute_tune_4x4()/ evals =  [0.08530261+0.99635509j 0.08530261-0.99635509j 0.06910333+0.99760951j
 0.06910333-0.99760951j]
compute_tune_4x4()/ angles =  [0.23640714854562447, 0.23899309087134823, 0.7610069091286518, 0.7635928514543755]
compute_tune_4x4()/  0.23640714854562447 0.23899309087134823
compute_tunes()/ 0.23640714854562447 0.23899309087134823

 Running simulation ..
Closed orbit computation: x_co=[ 2.90219447e-09 -5.85612559e-10], y_co=[-3.36961973e-11 -7.12839828e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 16/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 8.61142865e-04 -6.15700638e-04  7.94715383e-05  6.17520402e-04]
 [-1.92122894e-03 -3.34651277e-04  1.44488971e-03  5.53144110e-04]
 [ 6.66784152e-05 -3.01266802e-04  5.40086546e-03  6.27387010e-04]
 [-2.73876498e-03  9.28463974e-05  1.19286899e-04  4.27715610e-04]
 [ 1.16425126e-03  4.78452549e-05 -1.37798672e-03 -5.15495705e-04]
 [ 8.90516261e-04 -3.63323645e-04 -2.28127510e-03 -1.37822792e-04]
 [-3.90832101e-03  8.96018037e-04 -2.08278981e-04 -3.71957243e-04]
 [-1.65945933e-04  1.58839058e-04  2.27030680e-03 -1.60804735e-04]
 [ 6.21574623e-04  3.66537797e-05  6.96943596e-04 -2.27337944e-04]
 [-2.97603045e-03  4.44619513e-05  3.57320491e-03  1.97202774e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004694545787395531
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.8019956914065825e-06, theta_kick=4.5587358892344793e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.988642223836596e-05, theta_kick=-7.180607357155829e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.020923015707544238
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.9397874865406555e-06, theta_kick=5.922991062557752e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.8136393643557306e-05, theta_kick=6.9707723439186305e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.303974027420727e-05, theta_kick=-3.961589175375722e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007152232753044719
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.26147697365688e-05, theta_kick=-3.9106336089036565e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01505442e-01 -6.32185283e+00  7.97393041e-03 -7.13144515e-02]
 [ 1.79964786e-01  4.56386041e-01 -4.19175607e-03  2.39425115e-02]
 [-1.27995559e-03 -7.13855245e-02  3.84021869e-01 -5.11889871e+00]
 [-1.15461885e-03  1.99958443e-02  2.12671029e-01 -2.30542705e-01]]
compute_tune_4x4()/ evals =  [0.08968531+0.99597015j 0.08968531-0.99597015j 0.06449457+0.99791806j
 0.06449457-0.99791806j]
compute_tune_4x4()/ angles =  [0.23570693455828634, 0.23972824095305215, 0.7602717590469479, 0.7642930654417137]
compute_tune_4x4()/  0.23570693455828634 0.23972824095305215
compute_tunes()/ 0.23570693455828634 0.23972824095305215

 Running simulation ..
Closed orbit computation: x_co=[-5.15842977e-07  6.06420694e-08], y_co=[-9.55722515e-06 -1.03129112e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.8019956914065825e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.988642223836596e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.9397874865406555e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.8136393643557306e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.303974027420727e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.26147697365688e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004694545787395531}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.020923015707544238}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007152232753044719}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 8.61142865e-04 -6.15700638e-04  7.94715383e-05  6.17520402e-04]
 [-1.92122894e-03 -3.34651277e-04  1.44488971e-03  5.53144110e-04]
 [ 6.66784152e-05 -3.01266802e-04  5.40086546e-03  6.27387010e-04]
 [-2.73876498e-03  9.28463974e-05  1.19286899e-04  4.27715610e-04]
 [ 1.16425126e-03  4.78452549e-05 -1.37798672e-03 -5.15495705e-04]
 [ 8.90516261e-04 -3.63323645e-04 -2.28127510e-03 -1.37822792e-04]
 [-3.90832101e-03  8.96018037e-04 -2.08278981e-04 -3.71957243e-04]
 [-1.65945933e-04  1.58839058e-04  2.27030680e-03 -1.60804735e-04]
 [ 6.21574623e-04  3.66537797e-05  6.96943596e-04 -2.27337944e-04]
 [-2.97603045e-03  4.44619513e-05  3.57320491e-03  1.97202774e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004694545787395531
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2915625380121218e-06, theta_kick=-1.5486320798665483e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.5430254307042567e-06, theta_kick=1.8501455498363815e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.020923015707544238
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.26289941547854e-06, theta_kick=-2.713301543814549e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4554545307673768e-06, theta_kick=2.944182372192908e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.8138585894029346e-06, theta_kick=-2.1748846975805569e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007152232753044719
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.623595695627701e-08, theta_kick=1.034001571352699e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01505442e-01 -6.32185283e+00  7.97393041e-03 -7.13144515e-02]
 [ 1.79964786e-01  4.56386041e-01 -4.19175607e-03  2.39425115e-02]
 [-1.27995559e-03 -7.13855245e-02  3.84021869e-01 -5.11889871e+00]
 [-1.15461885e-03  1.99958443e-02  2.12671029e-01 -2.30542705e-01]]
compute_tune_4x4()/ evals =  [0.08968531+0.99597015j 0.08968531-0.99597015j 0.06449457+0.99791806j
 0.06449457-0.99791806j]
compute_tune_4x4()/ angles =  [0.23570693455828634, 0.23972824095305215, 0.7602717590469479, 0.7642930654417137]
compute_tune_4x4()/  0.23570693455828634 0.23972824095305215
compute_tunes()/ 0.23570693455828634 0.23972824095305215

 Running simulation ..
Closed orbit computation: x_co=[-3.10609219e-09  4.00198788e-10], y_co=[ 6.21974598e-08 -8.89015238e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 17/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.74900705e-03  1.62971228e-04 -1.07737706e-03  9.19692879e-04]
 [-3.70180740e-03 -4.46720731e-05  2.31514581e-03 -2.57051314e-04]
 [-4.00324977e-03  3.93528542e-04  1.13786131e-03 -5.14576582e-04]
 [ 1.25614484e-03 -1.63539523e-05  1.57280252e-03 -6.59466434e-04]
 [ 1.46750801e-03 -6.56623912e-04 -2.43516244e-03 -5.46331881e-04]
 [-2.05270823e-03 -2.26177407e-04  2.18414638e-03 -7.64584772e-04]
 [-5.05546781e-04  6.12524448e-04  3.19964750e-03 -9.62988225e-05]
 [ 1.59864166e-03  2.77527070e-04  2.73115610e-03  7.29505526e-05]
 [-3.96924449e-03  7.67780993e-06 -9.59865829e-04  1.33827244e-05]
 [ 7.36996607e-04  7.33515043e-05 -3.25982338e-04  2.59800946e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00805464516045027
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.231057547617777e-05, theta_kick=1.4760843198015065e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.7637080168946125e-05, theta_kick=-6.9109027795781646e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011103884079736228
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.081849397999526e-05, theta_kick=1.2971781342504803e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.016568361214976e-05, theta_kick=-7.214091846631255e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.6980619826345964e-05, theta_kick=5.633153088124867e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004889767330490458
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.1858754404540435e-05, theta_kick=-6.218059778692515e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01557763e-01 -6.32016194e+00  5.75982455e-03 -1.92698082e-02]
 [ 1.79978649e-01  4.56102290e-01 -2.02836093e-03  1.49419481e-02]
 [ 2.57426742e-03 -1.92849450e-02  3.84073126e-01 -5.11930998e+00]
 [ 3.18416349e-04  1.58632438e-02  2.12593539e-01 -2.30110357e-01]]
compute_tune_4x4()/ evals =  [0.08685917+0.9962206j  0.08685917-0.9962206j  0.06739448+0.99772641j
 0.06739448-0.99772641j]
compute_tune_4x4()/ angles =  [0.23615849134783543, 0.23926569976805015, 0.7607343002319499, 0.7638415086521646]
compute_tune_4x4()/  0.23615849134783543 0.23926569976805015
compute_tunes()/ 0.23615849134783543 0.23926569976805015

 Running simulation ..
Closed orbit computation: x_co=[-6.34063248e-08  4.28777532e-08], y_co=[1.35462215e-05 4.46428936e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.231057547617777e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.7637080168946125e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.081849397999526e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.016568361214976e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.6980619826345964e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.1858754404540435e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00805464516045027}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.011103884079736228}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004889767330490458}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.74900705e-03  1.62971228e-04 -1.07737706e-03  9.19692879e-04]
 [-3.70180740e-03 -4.46720731e-05  2.31514581e-03 -2.57051314e-04]
 [-4.00324977e-03  3.93528542e-04  1.13786131e-03 -5.14576582e-04]
 [ 1.25614484e-03 -1.63539523e-05  1.57280252e-03 -6.59466434e-04]
 [ 1.46750801e-03 -6.56623912e-04 -2.43516244e-03 -5.46331881e-04]
 [-2.05270823e-03 -2.26177407e-04  2.18414638e-03 -7.64584772e-04]
 [-5.05546781e-04  6.12524448e-04  3.19964750e-03 -9.62988225e-05]
 [ 1.59864166e-03  2.77527070e-04  2.73115610e-03  7.29505526e-05]
 [-3.96924449e-03  7.67780993e-06 -9.59865829e-04  1.33827244e-05]
 [ 7.36996607e-04  7.33515043e-05 -3.25982338e-04  2.59800946e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00805464516045027
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.823895326495835e-06, theta_kick=-2.186919123000773e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.404056579676978e-06, theta_kick=2.882554294917988e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.011103884079736228
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.542232961556287e-06, theta_kick=-1.8491953495102408e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.1755199649688474e-07, theta_kick=5.006605547592396e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2025528202963824e-09, theta_kick=-1.4419060792141772e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004889767330490458
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.2353321351177947e-07, theta_kick=3.879284963760328e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01557763e-01 -6.32016194e+00  5.75982455e-03 -1.92698082e-02]
 [ 1.79978649e-01  4.56102290e-01 -2.02836093e-03  1.49419481e-02]
 [ 2.57426742e-03 -1.92849450e-02  3.84073126e-01 -5.11930998e+00]
 [ 3.18416349e-04  1.58632438e-02  2.12593539e-01 -2.30110357e-01]]
compute_tune_4x4()/ evals =  [0.08685917+0.9962206j  0.08685917-0.9962206j  0.06739448+0.99772641j
 0.06739448-0.99772641j]
compute_tune_4x4()/ angles =  [0.23615849134783543, 0.23926569976805015, 0.7607343002319499, 0.7638415086521646]
compute_tune_4x4()/  0.23615849134783543 0.23926569976805015
compute_tunes()/ 0.23615849134783543 0.23926569976805015

 Running simulation ..
Closed orbit computation: x_co=[ 1.24677931e-09 -4.92850817e-10], y_co=[-6.32917126e-08 -8.18141790e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 18/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.94737624e-05  4.92882565e-04 -9.57906221e-05  4.09710085e-04]
 [-3.57883556e-03  1.01775727e-03 -7.11159586e-04  7.00268526e-04]
 [ 7.46986996e-03 -2.40936676e-04  6.21456129e-04 -3.58023937e-04]
 [ 2.90683060e-03 -6.80538594e-05 -7.50904826e-04 -1.28184565e-03]
 [-1.42740860e-03 -5.08890354e-05  1.30855651e-03 -2.03720778e-04]
 [-7.86087024e-05  3.87224099e-04  8.07428492e-04 -3.98716076e-04]
 [-1.54047446e-03 -1.85788722e-04 -2.11934554e-04  3.82878292e-04]
 [ 8.46538392e-04 -1.46802319e-04  2.26429841e-03  1.64466379e-05]
 [ 2.51995656e-04  1.99794490e-04 -1.59415886e-03 -2.18210745e-04]
 [ 1.22966550e-03 -9.27123179e-05 -5.27231589e-04 -2.75645607e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004039321257192437
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.54618735877453e-05, theta_kick=-1.1446237831401087e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.334990271587889e-05, theta_kick=9.993966950933237e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006140404854087149
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.002997448233337e-06, theta_kick=-9.59589506405144e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.5360465546786695e-05, theta_kick=4.2398528676011936e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6369024426702878e-06, theta_kick=-1.9627076194333917e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00286493607566381
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.859846631072045e-06, theta_kick=-8.22521422167707e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01696240e-01 -6.32026435e+00  2.79570375e-04  4.66743329e-02]
 [ 1.80007497e-01  4.56167122e-01  1.49635543e-03 -4.35343368e-03]
 [ 5.29081852e-03  4.66748956e-02  3.84076391e-01 -5.11936176e+00]
 [ 1.62208101e-03  8.79255192e-04  2.12589524e-01 -2.29776218e-01]]
compute_tune_4x4()/ evals =  [0.07771561+0.99697557j 0.07771561-0.99697557j 0.07666992+0.99705653j
 0.07666992-0.99705653j]
compute_tune_4x4()/ angles =  [0.23761869159581456, 0.23778561736939435, 0.7622143826306056, 0.7623813084041855]
compute_tune_4x4()/  0.23761869159581456 0.23778561736939435
compute_tunes()/ 0.23761869159581456 0.23778561736939435

 Running simulation ..
Closed orbit computation: x_co=[ 2.21908696e-07 -4.65596257e-08], y_co=[-3.69751468e-05 -5.70617876e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.54618735877453e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.334990271587889e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.002997448233337e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.5360465546786695e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.6369024426702878e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.859846631072045e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004039321257192437}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006140404854087149}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00286493607566381}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.94737624e-05  4.92882565e-04 -9.57906221e-05  4.09710085e-04]
 [-3.57883556e-03  1.01775727e-03 -7.11159586e-04  7.00268526e-04]
 [ 7.46986996e-03 -2.40936676e-04  6.21456129e-04 -3.58023937e-04]
 [ 2.90683060e-03 -6.80538594e-05 -7.50904826e-04 -1.28184565e-03]
 [-1.42740860e-03 -5.08890354e-05  1.30855651e-03 -2.03720778e-04]
 [-7.86087024e-05  3.87224099e-04  8.07428492e-04 -3.98716076e-04]
 [-1.54047446e-03 -1.85788722e-04 -2.11934554e-04  3.82878292e-04]
 [ 8.46538392e-04 -1.46802319e-04  2.26429841e-03  1.64466379e-05]
 [ 2.51995656e-04  1.99794490e-04 -1.59415886e-03 -2.18210745e-04]
 [ 1.22966550e-03 -9.27123179e-05 -5.27231589e-04 -2.75645607e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004039321257192437
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.029608745471916e-07, theta_kick=1.082684063708118e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.859809648900747e-07, theta_kick=9.424207505016756e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006140404854087149
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.560197113636796e-06, theta_kick=-5.467847922844059e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.122014983739614e-06, theta_kick=6.141488688255726e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.236136726197327e-06, theta_kick=-2.6812120723839386e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00286493607566381
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.690124932780841e-07, theta_kick=3.2255610139988066e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01696240e-01 -6.32026435e+00  2.79570375e-04  4.66743329e-02]
 [ 1.80007497e-01  4.56167122e-01  1.49635543e-03 -4.35343368e-03]
 [ 5.29081852e-03  4.66748956e-02  3.84076391e-01 -5.11936176e+00]
 [ 1.62208101e-03  8.79255192e-04  2.12589524e-01 -2.29776218e-01]]
compute_tune_4x4()/ evals =  [0.07771561+0.99697557j 0.07771561-0.99697557j 0.07666992+0.99705653j
 0.07666992-0.99705653j]
compute_tune_4x4()/ angles =  [0.23761869159581456, 0.23778561736939435, 0.7622143826306056, 0.7623813084041855]
compute_tune_4x4()/  0.23761869159581456 0.23778561736939435
compute_tunes()/ 0.23761869159581456 0.23778561736939435

 Running simulation ..
Closed orbit computation: x_co=[-6.04136520e-09  8.18166134e-10], y_co=[2.18906929e-07 3.03866536e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 19/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.66576396e-03 -1.69841897e-04 -1.72860507e-03  4.55281011e-04]
 [-1.16549014e-04 -2.13799920e-04 -4.85370211e-04  1.49773944e-05]
 [-5.27006244e-04  4.36565476e-04 -5.67405063e-04 -3.47696359e-05]
 [ 7.06972238e-04  1.05833037e-04 -1.64962149e-03  3.80432193e-04]
 [ 4.20812158e-03  9.80481101e-05 -6.49767305e-05 -1.36365440e-04]
 [-6.87981881e-03  3.36332494e-04  8.16250168e-04  1.74570118e-04]
 [-1.69820586e-03  6.17123206e-05  7.90341320e-04  9.28407399e-05]
 [ 2.76987959e-03  3.94505918e-04  1.68541818e-03  2.10857503e-04]
 [ 6.25187641e-04  4.49652208e-04  1.63628188e-03 -3.93719024e-04]
 [-2.02670823e-05  3.24613396e-05  5.51609063e-04  4.54093777e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01024181679080709
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.533310470866585e-05, theta_kick=-5.4356098265162225e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.2246145416264442e-05, theta_kick=2.6673965395456484e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00422212021305031
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.796171385203702e-05, theta_kick=8.148865206013548e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00010014599969166442, theta_kick=-1.2007882175919956e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.78532077658315e-06, theta_kick=-9.334892544363236e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0031305935057659336
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.882039115714304e-06, theta_kick=-7.052786219430857e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01584398e-01 -6.31931361e+00 -8.13046310e-03 -4.32990141e-02]
 [ 1.79997206e-01  4.56103723e-01  2.56637442e-04 -1.03142129e-02]
 [-1.12845156e-02 -4.33014215e-02  3.84037917e-01 -5.11937589e+00]
 [-2.63673070e-03 -1.85338627e-02  2.12562722e-01 -2.29882111e-01]]
compute_tune_4x4()/ evals =  [0.08916817+0.99601658j 0.08916817-0.99601658j 0.06516939+0.99787422j
 0.06516939-0.99787422j]
compute_tune_4x4()/ angles =  [0.2357895705973597, 0.2396206134859526, 0.7603793865140474, 0.7642104294026403]
compute_tune_4x4()/  0.2357895705973597 0.2396206134859526
compute_tunes()/ 0.2357895705973597 0.2396206134859526

 Running simulation ..
Closed orbit computation: x_co=[ 1.47136460e-07 -5.32011819e-08], y_co=[1.11528431e-05 3.89939116e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.533310470866585e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.2246145416264442e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.796171385203702e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00010014599969166442, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.78532077658315e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.882039115714304e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01024181679080709}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00422212021305031}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0031305935057659336}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.66576396e-03 -1.69841897e-04 -1.72860507e-03  4.55281011e-04]
 [-1.16549014e-04 -2.13799920e-04 -4.85370211e-04  1.49773944e-05]
 [-5.27006244e-04  4.36565476e-04 -5.67405063e-04 -3.47696359e-05]
 [ 7.06972238e-04  1.05833037e-04 -1.64962149e-03  3.80432193e-04]
 [ 4.20812158e-03  9.80481101e-05 -6.49767305e-05 -1.36365440e-04]
 [-6.87981881e-03  3.36332494e-04  8.16250168e-04  1.74570118e-04]
 [-1.69820586e-03  6.17123206e-05  7.90341320e-04  9.28407399e-05]
 [ 2.76987959e-03  3.94505918e-04  1.68541818e-03  2.10857503e-04]
 [ 6.25187641e-04  4.49652208e-04  1.63628188e-03 -3.93719024e-04]
 [-2.02670823e-05  3.24613396e-05  5.51609063e-04  4.54093777e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01024181679080709
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.7187742283885735e-06, theta_kick=2.0608749710464556e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.163694092674161e-06, theta_kick=-3.793388255392025e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00422212021305031
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.290579683289208e-06, theta_kick=3.9455288527816893e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.8812162454530536e-06, theta_kick=-2.2556490616076998e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.701441454249548e-07, theta_kick=8.035280454457546e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0031305935057659336
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.985858798942168e-08, theta_kick=5.978232299622702e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01584398e-01 -6.31931361e+00 -8.13046310e-03 -4.32990141e-02]
 [ 1.79997206e-01  4.56103723e-01  2.56637442e-04 -1.03142129e-02]
 [-1.12845156e-02 -4.33014215e-02  3.84037917e-01 -5.11937589e+00]
 [-2.63673070e-03 -1.85338627e-02  2.12562722e-01 -2.29882111e-01]]
compute_tune_4x4()/ evals =  [0.08916817+0.99601658j 0.08916817-0.99601658j 0.06516939+0.99787422j
 0.06516939-0.99787422j]
compute_tune_4x4()/ angles =  [0.2357895705973597, 0.2396206134859526, 0.7603793865140474, 0.7642104294026403]
compute_tune_4x4()/  0.2357895705973597 0.2396206134859526
compute_tunes()/ 0.2357895705973597 0.2396206134859526

 Running simulation ..
Closed orbit computation: x_co=[ 9.10378607e-10 -3.30119957e-10], y_co=[5.28570732e-08 2.25435554e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 20/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.21466524e-04 -2.10733016e-04  6.69030384e-04  9.61168007e-05]
 [-3.83040030e-05 -2.12808862e-04  6.29121941e-04 -5.27731380e-04]
 [-7.89733822e-04 -1.00145834e-04 -8.90300938e-04  5.20043540e-04]
 [ 1.59353739e-03 -4.42687865e-04 -8.95022204e-04  1.96435487e-04]
 [ 4.98342794e-04  2.39230351e-04 -9.86095795e-04 -1.42164431e-04]
 [-1.07506959e-03  2.01720211e-04 -1.03734753e-03  1.07665777e-04]
 [ 3.18927466e-03 -3.30887024e-05  3.37472383e-03  9.33895600e-05]
 [ 4.77181705e-04  3.32835034e-04 -5.36971272e-04 -3.82611296e-04]
 [ 2.87870705e-04 -2.17267521e-05 -8.36843050e-04 -2.85122974e-05]
 [ 2.04459298e-03 -3.15981152e-04  1.18817869e-03  6.16573463e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.010630478559375637
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.0161817177576376e-05, theta_kick=-6.014590620223345e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.160121213990607e-05, theta_kick=-4.988141865770621e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0020997508738806064
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.074471465833068e-05, theta_kick=3.6864069686873603e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.2250392960932706e-05, theta_kick=-3.866943462487913e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.1806344910351393e-05, theta_kick=2.6146628040776957e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0028908287234879937
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.15500534411826e-05, theta_kick=1.0977195877075031e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636958e-01 -6.31961490e+00 -1.35838646e-03 -3.83396434e-02]
 [ 1.80015257e-01  4.56178939e-01 -7.54627320e-04 -1.66185210e-03]
 [-5.26010886e-03 -3.83369838e-02  3.84026109e-01 -5.11974113e+00]
 [-1.68210127e-03 -7.18844137e-03  2.12566814e-01 -2.29829135e-01]]
compute_tune_4x4()/ evals =  [0.08103159+0.99671153j 0.08103159-0.99671153j 0.07333789+0.99730715j
 0.07333789-0.99730715j]
compute_tune_4x4()/ angles =  [0.23708926674322708, 0.2383174241866265, 0.7616825758133735, 0.7629107332567729]
compute_tune_4x4()/  0.23708926674322708 0.2383174241866265
compute_tunes()/ 0.23708926674322708 0.2383174241866265

 Running simulation ..
Closed orbit computation: x_co=[3.54942723e-08 5.03808927e-08], y_co=[ 3.18955919e-05 -1.38046453e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.0161817177576376e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.160121213990607e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.074471465833068e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.2250392960932706e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.1806344910351393e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -9.15500534411826e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.010630478559375637}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0020997508738806064}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0028908287234879937}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.21466524e-04 -2.10733016e-04  6.69030384e-04  9.61168007e-05]
 [-3.83040030e-05 -2.12808862e-04  6.29121941e-04 -5.27731380e-04]
 [-7.89733822e-04 -1.00145834e-04 -8.90300938e-04  5.20043540e-04]
 [ 1.59353739e-03 -4.42687865e-04 -8.95022204e-04  1.96435487e-04]
 [ 4.98342794e-04  2.39230351e-04 -9.86095795e-04 -1.42164431e-04]
 [-1.07506959e-03  2.01720211e-04 -1.03734753e-03  1.07665777e-04]
 [ 3.18927466e-03 -3.30887024e-05  3.37472383e-03  9.33895600e-05]
 [ 4.77181705e-04  3.32835034e-04 -5.36971272e-04 -3.82611296e-04]
 [ 2.87870705e-04 -2.17267521e-05 -8.36843050e-04 -2.85122974e-05]
 [ 2.04459298e-03 -3.15981152e-04  1.18817869e-03  6.16573463e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.010630478559375637
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1093045551380048e-06, theta_kick=-1.3300979006969938e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.658638184762697e-07, theta_kick=4.3868448447480846e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0020997508738806064
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.276355425683334e-06, theta_kick=2.7294358063507086e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.5724406742617898e-06, theta_kick=-4.283490786359403e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.619195052831267e-06, theta_kick=1.9414757927518772e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0028908287234879937
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.051874764927224e-08, theta_kick=-3.6593126740697724e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636958e-01 -6.31961490e+00 -1.35838646e-03 -3.83396434e-02]
 [ 1.80015257e-01  4.56178939e-01 -7.54627320e-04 -1.66185210e-03]
 [-5.26010886e-03 -3.83369838e-02  3.84026109e-01 -5.11974113e+00]
 [-1.68210127e-03 -7.18844137e-03  2.12566814e-01 -2.29829135e-01]]
compute_tune_4x4()/ evals =  [0.08103159+0.99671153j 0.08103159-0.99671153j 0.07333789+0.99730715j
 0.07333789-0.99730715j]
compute_tune_4x4()/ angles =  [0.23708926674322708, 0.2383174241866265, 0.7616825758133735, 0.7629107332567729]
compute_tune_4x4()/  0.23708926674322708 0.2383174241866265
compute_tunes()/ 0.23708926674322708 0.2383174241866265

 Running simulation ..
Closed orbit computation: x_co=[-1.03968729e-09  2.29193260e-10], y_co=[ 3.43706869e-08 -3.08161844e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 21/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.10905489e-03 -1.01980185e-04 -6.49852434e-04  5.23017507e-04]
 [-3.75094304e-03 -8.68832258e-05 -3.17960633e-04 -4.24749228e-04]
 [ 2.28778182e-03  1.35546281e-04  7.61587413e-04  1.67535263e-04]
 [ 2.69299617e-03 -8.05033757e-04 -1.86333924e-03 -1.26633941e-04]
 [ 4.48306677e-03 -1.86721111e-04  1.85409818e-03 -6.08277071e-04]
 [-1.73309374e-04 -4.31910992e-04 -1.30500026e-03 -2.95330182e-04]
 [ 1.64900611e-03  1.42393569e-04  1.03423474e-03  3.95228262e-04]
 [-3.60411925e-03  5.51304781e-04  4.52336027e-04  3.79036041e-04]
 [-5.47907473e-04  5.12567051e-04  4.90131158e-04  3.96762167e-04]
 [ 4.39622314e-03 -8.52323173e-04  1.81839457e-03  6.40707748e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0032509100090335327
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.084616857637784e-07, theta_kick=7.295684554259057e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.261776098121693e-05, theta_kick=-6.309067523101086e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0022264960865152174
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.22229439028373e-05, theta_kick=-2.6646145907868966e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.103337542252206e-05, theta_kick=-3.721018480439134e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.5535718005459236e-05, theta_kick=6.658941549516301e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006414929651794652
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.055741613167287e-05, theta_kick=8.460099676023322e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657275e-01 -6.31994454e+00  1.56851964e-03  1.96707798e-02]
 [ 1.80001124e-01  4.56089183e-01  5.57483781e-04 -2.25445179e-03]
 [ 3.40502638e-03  1.96728691e-02  3.84077692e-01 -5.11948075e+00]
 [ 7.11628820e-04 -1.47579478e-04  2.12575472e-01 -2.29801258e-01]]
compute_tune_4x4()/ evals =  [0.07781752+0.99696762j 0.07781752-0.99696762j 0.07653665+0.99706677j
 0.07653665-0.99706677j]
compute_tune_4x4()/ angles =  [0.23760242336880782, 0.23780688943877176, 0.7621931105612283, 0.7623975766311921]
compute_tune_4x4()/  0.23760242336880782 0.23780688943877176
compute_tunes()/ 0.23760242336880782 0.23780688943877176

 Running simulation ..
Closed orbit computation: x_co=[-1.88430091e-07 -2.69166259e-08], y_co=[ 4.24811102e-05 -1.14220722e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.084616857637784e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.261776098121693e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.22229439028373e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.103337542252206e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.5535718005459236e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.055741613167287e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0032509100090335327}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0022264960865152174}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006414929651794652}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.10905489e-03 -1.01980185e-04 -6.49852434e-04  5.23017507e-04]
 [-3.75094304e-03 -8.68832258e-05 -3.17960633e-04 -4.24749228e-04]
 [ 2.28778182e-03  1.35546281e-04  7.61587413e-04  1.67535263e-04]
 [ 2.69299617e-03 -8.05033757e-04 -1.86333924e-03 -1.26633941e-04]
 [ 4.48306677e-03 -1.86721111e-04  1.85409818e-03 -6.08277071e-04]
 [-1.73309374e-04 -4.31910992e-04 -1.30500026e-03 -2.95330182e-04]
 [ 1.64900611e-03  1.42393569e-04  1.03423474e-03  3.95228262e-04]
 [-3.60411925e-03  5.51304781e-04  4.52336027e-04  3.79036041e-04]
 [-5.47907473e-04  5.12567051e-04  4.90131158e-04  3.96762167e-04]
 [ 4.39622314e-03 -8.52323173e-04  1.81839457e-03  6.40707748e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0032509100090335327
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1729678603356105e-06, theta_kick=-1.406432599047018e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.8431677252353183e-06, theta_kick=3.4090650805941e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0022264960865152174
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8867736769674343e-06, theta_kick=-3.4613502574539085e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0116954161267639e-06, theta_kick=1.2130608703464414e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.934162469061014e-09, theta_kick=9.513359334014492e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006414929651794652
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5241361088170417e-07, theta_kick=-1.827496542157288e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01657275e-01 -6.31994454e+00  1.56851964e-03  1.96707798e-02]
 [ 1.80001124e-01  4.56089183e-01  5.57483781e-04 -2.25445179e-03]
 [ 3.40502638e-03  1.96728691e-02  3.84077692e-01 -5.11948075e+00]
 [ 7.11628820e-04 -1.47579478e-04  2.12575472e-01 -2.29801258e-01]]
compute_tune_4x4()/ evals =  [0.07781752+0.99696762j 0.07781752-0.99696762j 0.07653665+0.99706677j
 0.07653665-0.99706677j]
compute_tune_4x4()/ angles =  [0.23760242336880782, 0.23780688943877176, 0.7621931105612283, 0.7623975766311921]
compute_tune_4x4()/  0.23760242336880782 0.23780688943877176
compute_tunes()/ 0.23760242336880782 0.23780688943877176

 Running simulation ..
Closed orbit computation: x_co=[-8.38828676e-10  1.65901257e-11], y_co=[1.28348034e-08 3.71085970e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 22/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.67948443e-03 -4.98762914e-04  8.75031776e-04 -3.24789559e-04]
 [ 8.34008475e-05 -6.93560254e-04  1.60639418e-03 -1.37511749e-04]
 [ 4.38273209e-03  3.20349360e-04  5.83427296e-03  2.35104208e-04]
 [ 2.80318456e-03 -4.30999258e-04  9.23492072e-04 -8.55225518e-05]
 [-1.30249466e-03  8.21154347e-04  9.36456492e-04  4.20939351e-04]
 [-1.34225603e-03 -2.45333209e-04 -9.37294369e-04  4.99097812e-04]
 [-1.87379750e-03 -1.60793166e-04  1.57799295e-03  2.38051052e-04]
 [-1.23292680e-03 -3.35358948e-06 -2.63952810e-03 -2.63790122e-04]
 [-3.20357321e-03  3.00854041e-04 -1.30057493e-03  6.35123434e-04]
 [ 4.13039799e-04 -4.38426748e-05  2.77252337e-03  6.07907137e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0018910144194499684
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00010793111614006949, theta_kick=1.2941346930638916e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.127702092950532e-05, theta_kick=4.949270119830227e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0012731761235405567
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.3981255320723504e-06, theta_kick=2.8754427456763393e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.518346650567863e-05, theta_kick=9.014780522007778e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.6574910385722723e-05, theta_kick=-3.1864317469482587e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00926628628070195
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5647849232876036e-05, theta_kick=-1.8762360001741977e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01622450e-01 -6.31955065e+00 -7.14061660e-03 -4.27039513e-02]
 [ 1.80004840e-01  4.56117580e-01 -2.10108265e-04 -4.84148782e-03]
 [-1.04177688e-02 -4.27023748e-02  3.84027626e-01 -5.11946343e+00]
 [-2.25434525e-03 -1.16977688e-02  2.12564688e-01 -2.29782288e-01]]
compute_tune_4x4()/ evals =  [0.08566271+0.99632419j 0.08566271-0.99632419j 0.06870752+0.99763685j
 0.06870752-0.99763685j]
compute_tune_4x4()/ angles =  [0.23634962625875247, 0.23905623659923173, 0.7609437634007683, 0.7636503737412476]
compute_tune_4x4()/  0.23634962625875247 0.23905623659923173
compute_tunes()/ 0.23634962625875247 0.23905623659923173

 Running simulation ..
Closed orbit computation: x_co=[-5.13895006e-08 -1.46088071e-07], y_co=[-4.99072163e-05  1.19906245e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00010793111614006949, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.127702092950532e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.3981255320723504e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.518346650567863e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.6574910385722723e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.5647849232876036e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0018910144194499684}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0012731761235405567}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00926628628070195}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.67948443e-03 -4.98762914e-04  8.75031776e-04 -3.24789559e-04]
 [ 8.34008475e-05 -6.93560254e-04  1.60639418e-03 -1.37511749e-04]
 [ 4.38273209e-03  3.20349360e-04  5.83427296e-03  2.35104208e-04]
 [ 2.80318456e-03 -4.30999258e-04  9.23492072e-04 -8.55225518e-05]
 [-1.30249466e-03  8.21154347e-04  9.36456492e-04  4.20939351e-04]
 [-1.34225603e-03 -2.45333209e-04 -9.37294369e-04  4.99097812e-04]
 [-1.87379750e-03 -1.60793166e-04  1.57799295e-03  2.38051052e-04]
 [-1.23292680e-03 -3.35358948e-06 -2.63952810e-03 -2.63790122e-04]
 [-3.20357321e-03  3.00854041e-04 -1.30057493e-03  6.35123434e-04]
 [ 4.13039799e-04 -4.38426748e-05  2.77252337e-03  6.07907137e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0018910144194499684
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.4528686181586763e-06, theta_kick=4.140119392031189e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.428038573932632e-06, theta_kick=-6.50842248744927e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0012731761235405567
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.188582270358944e-06, theta_kick=3.8232301168874776e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1341984286436128e-06, theta_kick=-1.359946591695929e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.59067620404567e-07, theta_kick=4.305355872706785e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00926628628070195
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.299205947064936e-07, theta_kick=-8.752022573041957e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01622450e-01 -6.31955065e+00 -7.14061660e-03 -4.27039513e-02]
 [ 1.80004840e-01  4.56117580e-01 -2.10108265e-04 -4.84148782e-03]
 [-1.04177688e-02 -4.27023748e-02  3.84027626e-01 -5.11946343e+00]
 [-2.25434525e-03 -1.16977688e-02  2.12564688e-01 -2.29782288e-01]]
compute_tune_4x4()/ evals =  [0.08566271+0.99632419j 0.08566271-0.99632419j 0.06870752+0.99763685j
 0.06870752-0.99763685j]
compute_tune_4x4()/ angles =  [0.23634962625875247, 0.23905623659923173, 0.7609437634007683, 0.7636503737412476]
compute_tune_4x4()/  0.23634962625875247 0.23905623659923173
compute_tunes()/ 0.23634962625875247 0.23905623659923173

 Running simulation ..
Closed orbit computation: x_co=[3.30505456e-10 2.89626252e-11], y_co=[2.89315960e-07 9.81277801e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 23/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.54479948e-04  3.05856048e-04  1.03410793e-03 -5.26576463e-04]
 [ 4.29100486e-04  1.45707965e-04  3.61293865e-03 -4.62584796e-05]
 [ 3.03998492e-04  9.78592761e-05 -3.76495250e-04 -5.07585051e-06]
 [-6.42713602e-03  1.84004739e-04 -1.32346499e-03 -5.25906163e-05]
 [ 2.64699907e-03  4.19799348e-05 -3.86032135e-03 -6.72866229e-04]
 [-1.81465759e-03  4.37271218e-04  6.04735270e-03 -1.17186954e-04]
 [-6.41119929e-06 -5.05936365e-04  1.43170493e-03 -1.93007792e-04]
 [-6.35054120e-04 -8.28420830e-05  1.52618854e-03 -1.21417966e-04]
 [ 1.28178528e-03 -1.83842652e-04 -3.83018724e-04 -1.86387551e-04]
 [-1.77136201e-04 -2.56868971e-05 -2.13567207e-03 -3.92550089e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0019265485300013862
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.7815416227573414e-05, theta_kick=3.3351730649574225e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.60704906576021e-05, theta_kick=7.922100429017351e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.017979862820611134
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.063672711716972e-05, theta_kick=9.668646987957298e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.008408113803259e-05, theta_kick=6.005269776589666e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.533928849817967e-05, theta_kick=7.834426538855429e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01164292561601215
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.611489070099038e-05, theta_kick=7.927424161280784e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627595e-01 -6.31891832e+00 -1.55341104e-02  1.21221738e-02]
 [ 1.80002793e-01  4.56649228e-01  3.13457162e-03 -2.27280218e-02]
 [-1.12675152e-02  1.20981238e-02  3.83604175e-01 -5.11762505e+00]
 [-1.41925718e-03 -2.64380766e-02  2.12570642e-01 -2.29851268e-01]]
compute_tune_4x4()/ evals =  [0.09608252+0.99537337j 0.09608252-0.99537337j 0.05830475+0.99829883j
 0.05830475-0.99829883j]
compute_tune_4x4()/ angles =  [0.23468436478430582, 0.24071524531573577, 0.7592847546842643, 0.7653156352156942]
compute_tune_4x4()/  0.23468436478430582 0.24071524531573577
compute_tunes()/ 0.23468436478430582 0.24071524531573577

 Running simulation ..
Closed orbit computation: x_co=[-2.04616223e-07 -1.51255628e-07], y_co=[-8.84969130e-05 -7.25738178e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.7815416227573414e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.60704906576021e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.063672711716972e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.008408113803259e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.533928849817967e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.611489070099038e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0019265485300013862}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.017979862820611134}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01164292561601215}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.54479948e-04  3.05856048e-04  1.03410793e-03 -5.26576463e-04]
 [ 4.29100486e-04  1.45707965e-04  3.61293865e-03 -4.62584796e-05]
 [ 3.03998492e-04  9.78592761e-05 -3.76495250e-04 -5.07585051e-06]
 [-6.42713602e-03  1.84004739e-04 -1.32346499e-03 -5.25906163e-05]
 [ 2.64699907e-03  4.19799348e-05 -3.86032135e-03 -6.72866229e-04]
 [-1.81465759e-03  4.37271218e-04  6.04735270e-03 -1.17186954e-04]
 [-6.41119929e-06 -5.05936365e-04  1.43170493e-03 -1.93007792e-04]
 [-6.35054120e-04 -8.28420830e-05  1.52618854e-03 -1.21417966e-04]
 [ 1.28178528e-03 -1.83842652e-04 -3.83018724e-04 -1.86387551e-04]
 [-1.77136201e-04 -2.56868971e-05 -2.13567207e-03 -3.92550089e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0019265485300013862
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3657787109388756e-06, theta_kick=1.637620063689764e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.80856629303998e-07, theta_kick=-1.1760840045948173e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.017979862820611134
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.727483044564051e-07, theta_kick=-1.0464580553803901e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.7396977909515687e-06, theta_kick=3.2850007361914483e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.0990305944367687e-06, theta_kick=-2.516816661599101e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01164292561601215
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.032742884401671e-07, theta_kick=7.233485708520448e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01627595e-01 -6.31891832e+00 -1.55341104e-02  1.21221738e-02]
 [ 1.80002793e-01  4.56649228e-01  3.13457162e-03 -2.27280218e-02]
 [-1.12675152e-02  1.20981238e-02  3.83604175e-01 -5.11762505e+00]
 [-1.41925718e-03 -2.64380766e-02  2.12570642e-01 -2.29851268e-01]]
compute_tune_4x4()/ evals =  [0.09608252+0.99537337j 0.09608252-0.99537337j 0.05830475+0.99829883j
 0.05830475-0.99829883j]
compute_tune_4x4()/ angles =  [0.23468436478430582, 0.24071524531573577, 0.7592847546842643, 0.7653156352156942]
compute_tune_4x4()/  0.23468436478430582 0.24071524531573577
compute_tunes()/ 0.23468436478430582 0.24071524531573577

 Running simulation ..
Closed orbit computation: x_co=[-6.07120696e-09 -2.29413338e-11], y_co=[1.69292289e-07 7.37970363e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 24/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.69268055e-04 -1.08576203e-04  5.01468230e-03  6.70979288e-04]
 [ 2.25149673e-03  3.61047445e-05  9.65002910e-05  5.59044322e-04]
 [-2.73216828e-03  2.60728058e-04  1.37913429e-03 -3.78064413e-04]
 [ 3.75944467e-03 -4.40621273e-04 -1.81399173e-03  2.43953489e-04]
 [-1.30065812e-03  5.20707469e-04 -4.99879215e-04 -3.99686353e-04]
 [-1.55060560e-03 -5.27009275e-05 -2.04930133e-03  1.12992189e-03]
 [ 1.73298124e-03 -3.23709597e-04  1.06367599e-03  1.21080464e-03]
 [-7.77263502e-04 -2.82238349e-04  7.11440347e-04 -4.00142199e-04]
 [ 1.71298418e-03 -7.56783967e-04 -3.43963724e-03  2.81455077e-04]
 [-3.78517316e-03  2.53108848e-04 -5.09448510e-03 -4.34090060e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007543324889714556
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.242350846312916e-05, theta_kick=-1.108192642069926e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2186490434917029e-05, theta_kick=-1.4612060564675677e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00941948081769506
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.3692295785477946e-05, theta_kick=5.238870662860159e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.966647816301213e-05, theta_kick=9.552310487660685e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.958659987126318e-05, theta_kick=-8.343695153572515e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02347744891868465
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2512128005867104e-05, theta_kick=1.5002512264799525e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01091416e-01 -6.31957317e+00  1.28070099e-02  1.56540912e-01]
 [ 1.80061080e-01  4.56366238e-01  3.13219929e-03 -8.50874946e-04]
 [ 2.73544949e-02  1.56630342e-01  3.83920726e-01 -5.12292726e+00]
 [ 6.68319403e-03  1.99446734e-02  2.12577095e-01 -2.30557439e-01]]
compute_tune_4x4()/ evals =  [0.09189583+0.99576863j 0.09189583-0.99576863j 0.06242323+0.99804977j
 0.06242323-0.99804977j]
compute_tune_4x4()/ angles =  [0.2353536610574807, 0.24005857122861776, 0.7599414287713823, 0.7646463389425193]
compute_tune_4x4()/  0.2353536610574807 0.24005857122861776
compute_tunes()/ 0.2353536610574807 0.24005857122861776

 Running simulation ..
Closed orbit computation: x_co=[ 4.92144351e-07 -1.33228588e-07], y_co=[-2.70961087e-05 -8.36563521e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.242350846312916e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2186490434917029e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.3692295785477946e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.966647816301213e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.958659987126318e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.2512128005867104e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007543324889714556}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00941948081769506}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.02347744891868465}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.69268055e-04 -1.08576203e-04  5.01468230e-03  6.70979288e-04]
 [ 2.25149673e-03  3.61047445e-05  9.65002910e-05  5.59044322e-04]
 [-2.73216828e-03  2.60728058e-04  1.37913429e-03 -3.78064413e-04]
 [ 3.75944467e-03 -4.40621273e-04 -1.81399173e-03  2.43953489e-04]
 [-1.30065812e-03  5.20707469e-04 -4.99879215e-04 -3.99686353e-04]
 [-1.55060560e-03 -5.27009275e-05 -2.04930133e-03  1.12992189e-03]
 [ 1.73298124e-03 -3.23709597e-04  1.06367599e-03  1.21080464e-03]
 [-7.77263502e-04 -2.82238349e-04  7.11440347e-04 -4.00142199e-04]
 [ 1.71298418e-03 -7.56783967e-04 -3.43963724e-03  2.81455077e-04]
 [-3.78517316e-03  2.53108848e-04 -5.09448510e-03 -4.34090060e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007543324889714556
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2720759974768907e-07, theta_kick=-1.5252669845573226e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1918601240065282e-06, theta_kick=1.42908513403546e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00941948081769506
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.2285352019159097e-06, theta_kick=-1.4730599323982942e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.498535794123833e-07, theta_kick=-2.99583842794819e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.482596693813524e-06, theta_kick=1.7776892205913123e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02347744891868465
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.861909533699722e-07, theta_kick=-7.028650093192583e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01091416e-01 -6.31957317e+00  1.28070099e-02  1.56540912e-01]
 [ 1.80061080e-01  4.56366238e-01  3.13219929e-03 -8.50874946e-04]
 [ 2.73544949e-02  1.56630342e-01  3.83920726e-01 -5.12292726e+00]
 [ 6.68319403e-03  1.99446734e-02  2.12577095e-01 -2.30557439e-01]]
compute_tune_4x4()/ evals =  [0.09189583+0.99576863j 0.09189583-0.99576863j 0.06242323+0.99804977j
 0.06242323-0.99804977j]
compute_tune_4x4()/ angles =  [0.2353536610574807, 0.24005857122861776, 0.7599414287713823, 0.7646463389425193]
compute_tune_4x4()/  0.2353536610574807 0.24005857122861776
compute_tunes()/ 0.2353536610574807 0.24005857122861776

 Running simulation ..
Closed orbit computation: x_co=[-3.11448480e-09 -4.16934524e-10], y_co=[-2.70976313e-07 -2.95295720e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 25/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.63803775e-05 -7.61103447e-04 -7.45531603e-04 -3.22716060e-04]
 [ 2.90669306e-04  6.08802141e-04  2.06224307e-03  1.62431508e-04]
 [ 3.87113550e-04  4.44989935e-04 -1.04169638e-03  4.29521987e-05]
 [ 2.86729524e-03  1.56994339e-04 -3.71222791e-03 -6.69627022e-04]
 [-2.15099244e-03  7.26567021e-04  1.74540985e-03  5.01519207e-04]
 [ 9.36911670e-05  2.54105320e-04  1.30083961e-03  2.44756031e-04]
 [-1.36516025e-03  8.50601498e-04  1.05696370e-03 -4.57552150e-04]
 [ 2.05530887e-04  7.46426030e-05  2.60645585e-03  1.30977474e-03]
 [ 3.74369823e-03 -1.97306107e-04 -4.74493902e-03 -1.05156701e-03]
 [ 1.69089085e-04  1.89694285e-04 -5.73404011e-04  2.23136127e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006060735964715504
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.930586649426414e-06, theta_kick=-7.110996539018394e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.0001835535451146e-05, theta_kick=-3.5973329666707753e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01124586895044388
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.842888612947775e-05, theta_kick=-8.204880919877668e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.153598367665028e-05, theta_kick=-6.1793583539499005e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.5551592172539713e-05, theta_kick=-3.063732042814222e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008928832684651977
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.82834241219642e-05, theta_kick=4.590326598792553e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01593310e-01 -6.32084075e+00 -3.72861911e-04  6.74781931e-02]
 [ 1.80000058e-01  4.56190510e-01  2.54383522e-03 -1.06086952e-02]
 [ 7.01942448e-03  6.75074850e-02  3.84091915e-01 -5.11977756e+00]
 [ 2.06287582e-03 -4.05136743e-03  2.12613220e-01 -2.30061329e-01]]
compute_tune_4x4()/ evals =  [0.07915533+0.99686229j 0.07915533-0.99686229j 0.07515857+0.9971716j
 0.07515857-0.9971716j ]
compute_tune_4x4()/ angles =  [0.23738884555746423, 0.23802685237512108, 0.7619731476248789, 0.7626111544425358]
compute_tune_4x4()/  0.23738884555746423 0.23802685237512108
compute_tunes()/ 0.23738884555746423 0.23802685237512108

 Running simulation ..
Closed orbit computation: x_co=[-6.16765984e-07 -2.80824172e-08], y_co=[8.50200492e-05 4.39485168e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.930586649426414e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.0001835535451146e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.842888612947775e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.153598367665028e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.5551592172539713e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.82834241219642e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0006060735964715504}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01124586895044388}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.008928832684651977}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.63803775e-05 -7.61103447e-04 -7.45531603e-04 -3.22716060e-04]
 [ 2.90669306e-04  6.08802141e-04  2.06224307e-03  1.62431508e-04]
 [ 3.87113550e-04  4.44989935e-04 -1.04169638e-03  4.29521987e-05]
 [ 2.86729524e-03  1.56994339e-04 -3.71222791e-03 -6.69627022e-04]
 [-2.15099244e-03  7.26567021e-04  1.74540985e-03  5.01519207e-04]
 [ 9.36911670e-05  2.54105320e-04  1.30083961e-03  2.44756031e-04]
 [-1.36516025e-03  8.50601498e-04  1.05696370e-03 -4.57552150e-04]
 [ 2.05530887e-04  7.46426030e-05  2.60645585e-03  1.30977474e-03]
 [ 3.74369823e-03 -1.97306107e-04 -4.74493902e-03 -1.05156701e-03]
 [ 1.69089085e-04  1.89694285e-04 -5.73404011e-04  2.23136127e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0006060735964715504
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.081922480124786e-06, theta_kick=-4.894378641532213e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.768827553900582e-06, theta_kick=6.917041297077838e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01124586895044388
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.5315722194069475e-06, theta_kick=-6.632563223966628e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.259650332526585e-06, theta_kick=6.30651865016774e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.76473026508178e-06, theta_kick=-4.514053240908897e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008928832684651977
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.5675962871717634e-06, theta_kick=3.0786445576072576e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01593310e-01 -6.32084075e+00 -3.72861911e-04  6.74781931e-02]
 [ 1.80000058e-01  4.56190510e-01  2.54383522e-03 -1.06086952e-02]
 [ 7.01942448e-03  6.75074850e-02  3.84091915e-01 -5.11977756e+00]
 [ 2.06287582e-03 -4.05136743e-03  2.12613220e-01 -2.30061329e-01]]
compute_tune_4x4()/ evals =  [0.07915533+0.99686229j 0.07915533-0.99686229j 0.07515857+0.9971716j
 0.07515857-0.9971716j ]
compute_tune_4x4()/ angles =  [0.23738884555746423, 0.23802685237512108, 0.7619731476248789, 0.7626111544425358]
compute_tune_4x4()/  0.23738884555746423 0.23802685237512108
compute_tunes()/ 0.23738884555746423 0.23802685237512108

 Running simulation ..
Closed orbit computation: x_co=[-7.90085312e-09  9.32729824e-10], y_co=[ 3.01645040e-07 -1.79892202e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 26/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.78344827e-03  4.09831738e-04 -3.85838557e-03 -6.56534255e-04]
 [-5.98375696e-05  2.28496042e-04  4.85798410e-03  4.86718781e-04]
 [-1.39994385e-03 -9.29705606e-05 -2.14101358e-03  3.91076091e-05]
 [-1.56772613e-03  1.85145688e-04  1.54418236e-03  6.52129650e-04]
 [-6.56030169e-04 -1.14104814e-05 -1.76525803e-03  6.12756298e-04]
 [-3.03982794e-03  5.20997011e-05  1.99194496e-03 -9.71799643e-04]
 [ 1.42917993e-03  2.97803502e-04  1.07899711e-03 -1.10689402e-03]
 [ 1.97669136e-04  7.37823072e-05 -1.58157230e-03 -3.14227112e-04]
 [-3.27830946e-03 -9.95153617e-05  1.71085745e-03  3.84018664e-04]
 [-4.47857151e-03  7.47593362e-04  2.77626874e-03 -7.47375638e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007104593415205106
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.863155549073187e-06, theta_kick=-7.030144112508384e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.0357306263678235e-05, theta_kick=7.237068123555702e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006953407776570247
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.1705971050920034e-05, theta_kick=-3.801665227016211e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.950310194774861e-05, theta_kick=8.333683438370871e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.0001151580019464243, theta_kick=-1.3807877730957642e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015911800792414235
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.63158102229538e-06, theta_kick=9.150552794305693e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01409200e-01 -6.31984533e+00 -9.18058337e-03 -1.16074373e-01]
 [ 1.80034829e-01  4.56256786e-01 -2.32083230e-03  3.15089002e-04]
 [-2.00293896e-02 -1.16103586e-01  3.84008616e-01 -5.12106851e+00]
 [-4.96219815e-03 -1.51700651e-02  2.12581206e-01 -2.30126712e-01]]
compute_tune_4x4()/ evals =  [0.08813924+0.99610816j 0.08813924-0.99610816j 0.0662255 +0.99780468j
 0.0662255 -0.99780468j]
compute_tune_4x4()/ angles =  [0.2359539775729295, 0.23945216412107795, 0.760547835878922, 0.7640460224270705]
compute_tune_4x4()/  0.2359539775729295 0.23945216412107795
compute_tunes()/ 0.2359539775729295 0.23945216412107795

 Running simulation ..
Closed orbit computation: x_co=[-1.87894357e-07 -1.39715621e-07], y_co=[1.15498312e-06 9.38316847e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.863155549073187e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.0357306263678235e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.1705971050920034e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.950310194774861e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.0001151580019464243, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.63158102229538e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007104593415205106}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006953407776570247}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.015911800792414235}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.78344827e-03  4.09831738e-04 -3.85838557e-03 -6.56534255e-04]
 [-5.98375696e-05  2.28496042e-04  4.85798410e-03  4.86718781e-04]
 [-1.39994385e-03 -9.29705606e-05 -2.14101358e-03  3.91076091e-05]
 [-1.56772613e-03  1.85145688e-04  1.54418236e-03  6.52129650e-04]
 [-6.56030169e-04 -1.14104814e-05 -1.76525803e-03  6.12756298e-04]
 [-3.03982794e-03  5.20997011e-05  1.99194496e-03 -9.71799643e-04]
 [ 1.42917993e-03  2.97803502e-04  1.07899711e-03 -1.10689402e-03]
 [ 1.97669136e-04  7.37823072e-05 -1.58157230e-03 -3.14227112e-04]
 [-3.27830946e-03 -9.95153617e-05  1.71085745e-03  3.84018664e-04]
 [-4.47857151e-03  7.47593362e-04  2.77626874e-03 -7.47375638e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007104593415205106
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.7782546784595493e-06, theta_kick=-4.5302695214232153e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.41035814051376e-06, theta_kick=5.288185356175207e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006953407776570247
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.6522282864023696e-06, theta_kick=-3.1801215090783656e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.7011304935752854e-06, theta_kick=2.039719469135901e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2279871694270336e-06, theta_kick=-1.472402820823667e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015911800792414235
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.034015051417031e-06, theta_kick=1.2398229528659833e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01409200e-01 -6.31984533e+00 -9.18058337e-03 -1.16074373e-01]
 [ 1.80034829e-01  4.56256786e-01 -2.32083230e-03  3.15089002e-04]
 [-2.00293896e-02 -1.16103586e-01  3.84008616e-01 -5.12106851e+00]
 [-4.96219815e-03 -1.51700651e-02  2.12581206e-01 -2.30126712e-01]]
compute_tune_4x4()/ evals =  [0.08813924+0.99610816j 0.08813924-0.99610816j 0.0662255 +0.99780468j
 0.0662255 -0.99780468j]
compute_tune_4x4()/ angles =  [0.2359539775729295, 0.23945216412107795, 0.760547835878922, 0.7640460224270705]
compute_tune_4x4()/  0.2359539775729295 0.23945216412107795
compute_tunes()/ 0.2359539775729295 0.23945216412107795

 Running simulation ..
Closed orbit computation: x_co=[-1.03892035e-09  1.30203308e-09], y_co=[-1.39379995e-07 -1.59075238e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 27/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.52250191e-03 -9.15721323e-04 -3.43087165e-04  5.80120835e-04]
 [-2.93047988e-03  5.95280339e-04  1.78990161e-04  1.87268189e-04]
 [ 9.67074213e-04 -3.24915643e-04  1.16341942e-03 -2.31269386e-04]
 [-3.95430140e-03  4.70164358e-04 -3.68763587e-03 -5.94073306e-04]
 [-2.86204471e-03  2.94673338e-05  1.64519084e-03  1.02586486e-04]
 [ 7.33247595e-03 -5.22342041e-04  1.21654288e-03 -2.16265760e-04]
 [ 1.53982491e-03  5.78342781e-04  4.82473763e-03  5.22678625e-04]
 [-4.44349545e-04 -2.58752603e-04 -7.26060648e-04  2.70606266e-04]
 [-3.30267213e-04 -9.99336371e-05  1.77026025e-03 -3.93862873e-04]
 [ 3.39456597e-03  2.26836536e-04 -4.23192305e-03  3.35273388e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00276722088785194
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4021916717740004e-05, theta_kick=1.6812805738180543e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.6994491142943174e-05, theta_kick=5.63481631117758e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015043050515752884
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.2283164476869376e-05, theta_kick=3.870872890555987e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.1159532996952782e-05, theta_kick=-2.5371076219437627e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.0072082505126786e-05, theta_kick=4.804793469003202e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010815480824451763
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.609570546369138e-07, theta_kick=4.328010900077847e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01646056e-01 -6.31909501e+00 -1.32054761e-02  1.04781179e-02]
 [ 1.80007954e-01  4.56521425e-01  2.62903719e-03 -1.87852480e-02]
 [-9.56012158e-03  1.04625688e-02  3.83711502e-01 -5.11817091e+00]
 [-1.16784984e-03 -2.17886426e-02  2.12567324e-01 -2.29798720e-01]]
compute_tune_4x4()/ evals =  [0.0929458 +0.99567117j 0.0929458 -0.99567117j 0.06144828+0.99811027j
 0.06144828-0.99811027j]
compute_tune_4x4()/ angles =  [0.23518583456810113, 0.24021403786198411, 0.7597859621380159, 0.7648141654318988]
compute_tune_4x4()/  0.23518583456810113 0.24021403786198411
compute_tunes()/ 0.23518583456810113 0.24021403786198411

 Running simulation ..
Closed orbit computation: x_co=[ 4.67176507e-08 -7.55339631e-08], y_co=[-3.31050472e-05  1.43243443e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.4021916717740004e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.6994491142943174e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.2283164476869376e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.1159532996952782e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.0072082505126786e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.609570546369138e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.00276722088785194}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.015043050515752884}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010815480824451763}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.52250191e-03 -9.15721323e-04 -3.43087165e-04  5.80120835e-04]
 [-2.93047988e-03  5.95280339e-04  1.78990161e-04  1.87268189e-04]
 [ 9.67074213e-04 -3.24915643e-04  1.16341942e-03 -2.31269386e-04]
 [-3.95430140e-03  4.70164358e-04 -3.68763587e-03 -5.94073306e-04]
 [-2.86204471e-03  2.94673338e-05  1.64519084e-03  1.02586486e-04]
 [ 7.33247595e-03 -5.22342041e-04  1.21654288e-03 -2.16265760e-04]
 [ 1.53982491e-03  5.78342781e-04  4.82473763e-03  5.22678625e-04]
 [-4.44349545e-04 -2.58752603e-04 -7.26060648e-04  2.70606266e-04]
 [-3.30267213e-04 -9.99336371e-05  1.77026025e-03 -3.93862873e-04]
 [ 3.39456597e-03  2.26836536e-04 -4.23192305e-03  3.35273388e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.00276722088785194
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.222339605863629e-07, theta_kick=7.460819311386803e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.357557799428255e-07, theta_kick=-5.2248757605293316e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015043050515752884
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.024982999411685e-07, theta_kick=6.025143688086692e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.674157754623019e-07, theta_kick=-9.201603898373758e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.2041846349213736e-07, theta_kick=2.642900312703355e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010815480824451763
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.396416177257709e-07, theta_kick=-7.669543670355104e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01646056e-01 -6.31909501e+00 -1.32054761e-02  1.04781179e-02]
 [ 1.80007954e-01  4.56521425e-01  2.62903719e-03 -1.87852480e-02]
 [-9.56012158e-03  1.04625688e-02  3.83711502e-01 -5.11817091e+00]
 [-1.16784984e-03 -2.17886426e-02  2.12567324e-01 -2.29798720e-01]]
compute_tune_4x4()/ evals =  [0.0929458 +0.99567117j 0.0929458 -0.99567117j 0.06144828+0.99811027j
 0.06144828-0.99811027j]
compute_tune_4x4()/ angles =  [0.23518583456810113, 0.24021403786198411, 0.7597859621380159, 0.7648141654318988]
compute_tune_4x4()/  0.23518583456810113 0.24021403786198411
compute_tunes()/ 0.23518583456810113 0.24021403786198411

 Running simulation ..
Closed orbit computation: x_co=[ 3.26782151e-09 -4.58994903e-10], y_co=[1.05055153e-08 1.02172815e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 28/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.38529351e-04  6.78534975e-05  1.14007295e-03  4.91685262e-04]
 [-5.19142504e-03 -1.00113576e-04 -3.15765199e-03 -5.31295329e-04]
 [-4.32745580e-04  2.52610862e-04 -2.60985329e-03 -1.37343051e-04]
 [-4.81860567e-04 -2.27233058e-04  9.65191232e-04  1.97648931e-05]
 [-1.01566054e-05 -3.34972134e-04  4.55087668e-03 -6.84550662e-04]
 [ 4.43582059e-03 -8.89070014e-04 -2.37448375e-03 -3.13644005e-04]
 [ 2.43145100e-03 -7.50406500e-04 -1.51196342e-03 -2.76082397e-04]
 [ 1.20942965e-03  1.56126642e-04 -3.14678973e-03  2.27294259e-04]
 [-4.27562538e-03  1.01317760e-04  1.23567662e-03 -6.09060489e-04]
 [ 1.53052160e-04  1.04312128e-04 -1.11508269e-03  4.35596147e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018893597965540597
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.273023263349913e-05, theta_kick=-6.3225532973995485e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.7243085637803315e-05, theta_kick=-4.465586100127194e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01943145274704505
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.4893835073887785e-05, theta_kick=4.183902118140251e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0546751153960257e-05, theta_kick=-1.2645951469396908e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.641220918392948e-05, theta_kick=7.963073766086248e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002418265419775451
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.172531910787416e-05, theta_kick=3.803985131844695e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01136498e-01 -6.31867661e+00  1.57863109e-02  1.17737230e-02]
 [ 1.79918053e-01  4.56119027e-01 -3.09055263e-03  3.00072154e-02]
 [ 1.40642721e-02  1.17559532e-02  3.83911844e-01 -5.11882540e+00]
 [ 2.81370404e-03  3.86204355e-02  2.12579677e-01 -2.30960167e-01]]
compute_tune_4x4()/ evals =  [0.10147295+0.9948383j  0.10147295-0.9948383j  0.05249415+0.99862123j
 0.05249415-0.99862123j]
compute_tune_4x4()/ angles =  [0.2338222341705372, 0.2416414539970398, 0.7583585460029603, 0.7661777658294628]
compute_tune_4x4()/  0.2338222341705372 0.2416414539970398
compute_tunes()/ 0.2338222341705372 0.2416414539970398

 Running simulation ..
Closed orbit computation: x_co=[ 3.36953694e-07 -2.30661261e-07], y_co=[-1.09123506e-05 -1.51364598e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.273023263349913e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.7243085637803315e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.4893835073887785e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.0546751153960257e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.641220918392948e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.172531910787416e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.018893597965540597}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01943145274704505}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002418265419775451}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.38529351e-04  6.78534975e-05  1.14007295e-03  4.91685262e-04]
 [-5.19142504e-03 -1.00113576e-04 -3.15765199e-03 -5.31295329e-04]
 [-4.32745580e-04  2.52610862e-04 -2.60985329e-03 -1.37343051e-04]
 [-4.81860567e-04 -2.27233058e-04  9.65191232e-04  1.97648931e-05]
 [-1.01566054e-05 -3.34972134e-04  4.55087668e-03 -6.84550662e-04]
 [ 4.43582059e-03 -8.89070014e-04 -2.37448375e-03 -3.13644005e-04]
 [ 2.43145100e-03 -7.50406500e-04 -1.51196342e-03 -2.76082397e-04]
 [ 1.20942965e-03  1.56126642e-04 -3.14678973e-03  2.27294259e-04]
 [-4.27562538e-03  1.01317760e-04  1.23567662e-03 -6.09060489e-04]
 [ 1.53052160e-04  1.04312128e-04 -1.11508269e-03  4.35596147e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018893597965540597
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.12953734688757e-07, theta_kick=9.74762116377296e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.1144656913994323e-07, theta_kick=4.933399176332921e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01943145274704505
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.735984343018899e-06, theta_kick=-3.280548172396669e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.386288971102432e-06, theta_kick=2.861250263706767e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.833766867201825e-07, theta_kick=-9.392981229864811e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002418265419775451
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.632301462154371e-07, theta_kick=-1.1549491881513303e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01136498e-01 -6.31867661e+00  1.57863109e-02  1.17737230e-02]
 [ 1.79918053e-01  4.56119027e-01 -3.09055263e-03  3.00072154e-02]
 [ 1.40642721e-02  1.17559532e-02  3.83911844e-01 -5.11882540e+00]
 [ 2.81370404e-03  3.86204355e-02  2.12579677e-01 -2.30960167e-01]]
compute_tune_4x4()/ evals =  [0.10147295+0.9948383j  0.10147295-0.9948383j  0.05249415+0.99862123j
 0.05249415-0.99862123j]
compute_tune_4x4()/ angles =  [0.2338222341705372, 0.2416414539970398, 0.7583585460029603, 0.7661777658294628]
compute_tune_4x4()/  0.2338222341705372 0.2416414539970398
compute_tunes()/ 0.2338222341705372 0.2416414539970398

 Running simulation ..
Closed orbit computation: x_co=[3.82617119e-09 9.57028759e-10], y_co=[1.17421624e-08 1.05460673e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 29/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.47353847e-03  4.52487511e-05  3.80210370e-04 -2.25650169e-04]
 [-2.56248540e-03 -3.31031209e-06  2.02662507e-03 -3.40019908e-04]
 [ 2.23074229e-03  5.34665983e-05 -1.24815669e-03  2.31275455e-04]
 [-2.96663908e-03 -3.14468087e-04  6.33847727e-04  5.48662847e-04]
 [-1.47417207e-03 -3.25903373e-05  2.34762319e-03  9.52872859e-05]
 [ 1.89852301e-06  9.60266809e-05 -2.26638693e-03 -6.69238277e-04]
 [ 3.12404382e-03  1.65075597e-04  4.25226178e-03  1.88459823e-04]
 [ 7.02800121e-04 -6.59280137e-05 -8.06596455e-04  2.94334409e-04]
 [-1.15047604e-03  3.95900392e-04  2.29816419e-03  1.43683649e-04]
 [ 1.52196542e-03 -3.40264567e-04 -2.15556655e-03 -1.94247514e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011040910455872009
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.63863898979147e-05, theta_kick=9.159015562899092e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.030381251281923e-05, theta_kick=-6.031616395195646e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.023002645035931548
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.03633243934567e-05, theta_kick=-7.237789719960169e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.4688066789545185e-05, theta_kick=4.159229726616531e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.1985073117630785e-05, theta_kick=-3.835130614974162e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010466806103186342
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.0805604550946496e-05, theta_kick=2.494670269563888e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01594760e-01 -6.31913169e+00  1.85401407e-02 -1.90856565e-02]
 [ 1.79977371e-01  4.56806101e-01 -4.03563367e-03  2.94841414e-02]
 [ 1.29442923e-02 -1.90468686e-02  3.83503163e-01 -5.11649476e+00]
 [ 1.64860347e-03  3.38540470e-02  2.12597522e-01 -2.30046931e-01]]
compute_tune_4x4()/ evals =  [0.10074418+0.99491236j 0.10074418-0.99491236j 0.05358961+0.99856304j
 0.05358961-0.99856304j]
compute_tune_4x4()/ angles =  [0.23393881943964975, 0.2414668608732627, 0.7585331391267374, 0.7660611805603502]
compute_tune_4x4()/  0.23393881943964975 0.2414668608732627
compute_tunes()/ 0.23393881943964975 0.2414668608732627

 Running simulation ..
Closed orbit computation: x_co=[ 1.03768410e-06 -1.27564926e-07], y_co=[4.05688950e-05 3.98166777e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.63863898979147e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.030381251281923e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.03633243934567e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.4688066789545185e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.1985073117630785e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.0805604550946496e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0011040910455872009}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.023002645035931548}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010466806103186342}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.47353847e-03  4.52487511e-05  3.80210370e-04 -2.25650169e-04]
 [-2.56248540e-03 -3.31031209e-06  2.02662507e-03 -3.40019908e-04]
 [ 2.23074229e-03  5.34665983e-05 -1.24815669e-03  2.31275455e-04]
 [-2.96663908e-03 -3.14468087e-04  6.33847727e-04  5.48662847e-04]
 [-1.47417207e-03 -3.25903373e-05  2.34762319e-03  9.52872859e-05]
 [ 1.89852301e-06  9.60266809e-05 -2.26638693e-03 -6.69238277e-04]
 [ 3.12404382e-03  1.65075597e-04  4.25226178e-03  1.88459823e-04]
 [ 7.02800121e-04 -6.59280137e-05 -8.06596455e-04  2.94334409e-04]
 [-1.15047604e-03  3.95900392e-04  2.29816419e-03  1.43683649e-04]
 [ 1.52196542e-03 -3.40264567e-04 -2.15556655e-03 -1.94247514e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011040910455872009
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.2849310597051954e-06, theta_kick=3.9387559405673446e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.005716185708104e-06, theta_kick=-7.201079679870712e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.023002645035931548
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.138768467648055e-06, theta_kick=8.559651998543628e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.012413766803154e-06, theta_kick=-6.01007270525466e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.0329827674680896e-06, theta_kick=2.437622831924698e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010466806103186342
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.211655186666256e-07, theta_kick=-8.647045917107984e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01594760e-01 -6.31913169e+00  1.85401407e-02 -1.90856565e-02]
 [ 1.79977371e-01  4.56806101e-01 -4.03563367e-03  2.94841414e-02]
 [ 1.29442923e-02 -1.90468686e-02  3.83503163e-01 -5.11649476e+00]
 [ 1.64860347e-03  3.38540470e-02  2.12597522e-01 -2.30046931e-01]]
compute_tune_4x4()/ evals =  [0.10074418+0.99491236j 0.10074418-0.99491236j 0.05358961+0.99856304j
 0.05358961-0.99856304j]
compute_tune_4x4()/ angles =  [0.23393881943964975, 0.2414668608732627, 0.7585331391267374, 0.7660611805603502]
compute_tune_4x4()/  0.23393881943964975 0.2414668608732627
compute_tunes()/ 0.23393881943964975 0.2414668608732627

 Running simulation ..
Closed orbit computation: x_co=[-1.91324752e-08  2.61760597e-09], y_co=[-8.06897018e-08  1.12499772e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 30/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.90393758e-03  2.32564040e-04  3.24137665e-05 -6.90142422e-05]
 [ 2.57205129e-03 -3.80407072e-04 -1.87690863e-03 -1.85797591e-04]
 [ 1.89612165e-03  1.95495415e-04 -6.70757044e-04  4.13827126e-04]
 [ 1.37483423e-03  3.69742772e-04  7.42957400e-05  5.47223167e-04]
 [-3.45141933e-03  5.13256465e-04 -1.73208274e-03  1.60255993e-04]
 [-1.03489096e-03 -2.54736028e-04  2.03125520e-03 -3.02943294e-04]
 [-4.00492176e-03  3.19362190e-04  9.97730431e-04 -4.13264691e-04]
 [-1.46931299e-03 -2.66536204e-04 -3.81298134e-05  3.61996295e-04]
 [-1.24306332e-03  2.41609603e-04 -2.09847191e-04  7.46755578e-05]
 [-6.09172123e-04  4.43262721e-04 -6.39061008e-04  1.47574998e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002225268363135576
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3009657855892158e-06, theta_kick=1.5599069275214115e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.3863301963585018e-05, theta_kick=2.8612996943399507e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0024281364946041463
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.126748656031769e-05, theta_kick=1.3510140340265428e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.2174717861388368e-07, theta_kick=-2.658832106960156e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3224969744333155e-05, theta_kick=-1.5857236330856331e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.002968518209805071
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.24784425973621e-05, theta_kick=-3.894287471963445e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01703597e-01 -6.31996898e+00  2.18552121e-03 -4.00358084e-03]
 [ 1.80001837e-01  4.56109276e-01 -4.51665800e-04  2.55745782e-03]
 [ 1.33586606e-03 -4.00339943e-03  3.84073509e-01 -5.11920972e+00]
 [ 6.98974723e-05  2.62097404e-03  2.12577003e-01 -2.29721761e-01]]
compute_tune_4x4()/ evals =  [0.07935233+0.99684663j 0.07935233-0.99684663j 0.07502638+0.99718155j
 0.07502638-0.99718155j]
compute_tune_4x4()/ angles =  [0.2373573921036292, 0.2380479498775024, 0.7619520501224976, 0.7626426078963708]
compute_tune_4x4()/  0.2373573921036292 0.2380479498775024
compute_tunes()/ 0.2373573921036292 0.2380479498775024

 Running simulation ..
Closed orbit computation: x_co=[-5.7823511e-08  1.2938789e-08], y_co=[-1.68929638e-05  5.04799308e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.3009657855892158e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.3863301963585018e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.126748656031769e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.2174717861388368e-07, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.3224969744333155e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.24784425973621e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002225268363135576}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0024281364946041463}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.002968518209805071}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.90393758e-03  2.32564040e-04  3.24137665e-05 -6.90142422e-05]
 [ 2.57205129e-03 -3.80407072e-04 -1.87690863e-03 -1.85797591e-04]
 [ 1.89612165e-03  1.95495415e-04 -6.70757044e-04  4.13827126e-04]
 [ 1.37483423e-03  3.69742772e-04  7.42957400e-05  5.47223167e-04]
 [-3.45141933e-03  5.13256465e-04 -1.73208274e-03  1.60255993e-04]
 [-1.03489096e-03 -2.54736028e-04  2.03125520e-03 -3.02943294e-04]
 [-4.00492176e-03  3.19362190e-04  9.97730431e-04 -4.13264691e-04]
 [-1.46931299e-03 -2.66536204e-04 -3.81298134e-05  3.61996295e-04]
 [-1.24306332e-03  2.41609603e-04 -2.09847191e-04  7.46755578e-05]
 [-6.09172123e-04  4.43262721e-04 -6.39061008e-04  1.47574998e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002225268363135576
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.0983315984321223e-06, theta_kick=-2.5159785390888583e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.3077591195866082e-06, theta_kick=2.767090016947256e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0024281364946041463
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8753852449161905e-06, theta_kick=-3.4476950989192845e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.1302128251695772e-06, theta_kick=3.753242955875986e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.9258932396770413e-06, theta_kick=-2.3092184587146868e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.002968518209805071
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2354309657394179e-06, theta_kick=1.481328212685135e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01703597e-01 -6.31996898e+00  2.18552121e-03 -4.00358084e-03]
 [ 1.80001837e-01  4.56109276e-01 -4.51665800e-04  2.55745782e-03]
 [ 1.33586606e-03 -4.00339943e-03  3.84073509e-01 -5.11920972e+00]
 [ 6.98974723e-05  2.62097404e-03  2.12577003e-01 -2.29721761e-01]]
compute_tune_4x4()/ evals =  [0.07935233+0.99684663j 0.07935233-0.99684663j 0.07502638+0.99718155j
 0.07502638-0.99718155j]
compute_tune_4x4()/ angles =  [0.2373573921036292, 0.2380479498775024, 0.7619520501224976, 0.7626426078963708]
compute_tune_4x4()/  0.2373573921036292 0.2380479498775024
compute_tunes()/ 0.2373573921036292 0.2380479498775024

 Running simulation ..
Closed orbit computation: x_co=[ 7.03248926e-10 -2.95965942e-12], y_co=[ 1.47342461e-07 -1.50197838e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 31/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.50656793e-03 -8.45142426e-04  4.65588203e-03  1.01871027e-03]
 [ 4.66617757e-04 -3.27933759e-05 -2.04974488e-03 -1.26585030e-04]
 [ 1.47637177e-03  5.87643969e-05 -5.50806046e-04 -3.23816018e-04]
 [ 2.88906640e-03 -9.05935075e-05 -3.42605066e-03  2.10451671e-04]
 [ 2.68237399e-03 -4.41573195e-04 -2.60013988e-04  3.69910681e-04]
 [ 5.02245352e-03  4.88575010e-04 -3.61761172e-03  1.22550065e-04]
 [-5.19890643e-03  5.27833994e-04  2.96515032e-03  3.32034834e-04]
 [-1.03671468e-03  4.84043470e-04  1.37515726e-03  6.75888811e-06]
 [ 2.12899901e-03 -6.17822049e-04  4.91967792e-03  2.64183594e-04]
 [-1.67545519e-03  5.72785006e-04 -1.88526579e-03 -5.20526381e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0031778027860449947
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.7692721233286625e-05, theta_kick=5.718536726195056e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.3046218215580866e-05, theta_kick=-6.360441157629704e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016312923096359126
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.2794812276263946e-05, theta_kick=1.534146134138393e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.635382928362675e-06, theta_kick=-9.155111422732245e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3425777702526856e-05, theta_kick=-1.6098012628402016e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0007385495593886437
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.258862700255064e-05, theta_kick=-6.305574249438455e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01716223e-01 -6.32087350e+00  7.43009356e-03 -5.78208425e-02]
 [ 1.80004985e-01  4.56475175e-01 -3.30681997e-03  1.72847079e-02]
 [-2.54766553e-04 -5.78113308e-02  3.83926963e-01 -5.11854251e+00]
 [-1.02598364e-03  1.35914235e-02  2.12626544e-01 -2.29927144e-01]]
compute_tune_4x4()/ evals =  [0.08665169+0.99623867j 0.08665169-0.99623867j 0.0677277 +0.99770384j
 0.0677277 -0.99770384j]
compute_tune_4x4()/ angles =  [0.23619163822484746, 0.23921254466153022, 0.7607874553384698, 0.7638083617751525]
compute_tune_4x4()/  0.23619163822484746 0.23921254466153022
compute_tunes()/ 0.23619163822484746 0.23921254466153022

 Running simulation ..
Closed orbit computation: x_co=[-3.07589706e-07  1.82131696e-08], y_co=[3.33433799e-06 6.87957564e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.7692721233286625e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.3046218215580866e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.2794812276263946e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.635382928362675e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.3425777702526856e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.258862700255064e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0031778027860449947}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.016312923096359126}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0007385495593886437}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.50656793e-03 -8.45142426e-04  4.65588203e-03  1.01871027e-03]
 [ 4.66617757e-04 -3.27933759e-05 -2.04974488e-03 -1.26585030e-04]
 [ 1.47637177e-03  5.87643969e-05 -5.50806046e-04 -3.23816018e-04]
 [ 2.88906640e-03 -9.05935075e-05 -3.42605066e-03  2.10451671e-04]
 [ 2.68237399e-03 -4.41573195e-04 -2.60013988e-04  3.69910681e-04]
 [ 5.02245352e-03  4.88575010e-04 -3.61761172e-03  1.22550065e-04]
 [-5.19890643e-03  5.27833994e-04  2.96515032e-03  3.32034834e-04]
 [-1.03671468e-03  4.84043470e-04  1.37515726e-03  6.75888811e-06]
 [ 2.12899901e-03 -6.17822049e-04  4.91967792e-03  2.64183594e-04]
 [-1.67545519e-03  5.72785006e-04 -1.88526579e-03 -5.20526381e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0031778027860449947
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5924138608879507e-06, theta_kick=1.909364135933217e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.0954777117351293e-06, theta_kick=-3.7115942479123886e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.016312923096359126
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1369695541246243e-06, theta_kick=2.562306901769589e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.180462106510391e-06, theta_kick=-1.4154184821917437e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.774418046537637e-07, theta_kick=9.32181976080868e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0007385495593886437
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.668703602388288e-07, theta_kick=-9.195064164624451e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01716223e-01 -6.32087350e+00  7.43009356e-03 -5.78208425e-02]
 [ 1.80004985e-01  4.56475175e-01 -3.30681997e-03  1.72847079e-02]
 [-2.54766553e-04 -5.78113308e-02  3.83926963e-01 -5.11854251e+00]
 [-1.02598364e-03  1.35914235e-02  2.12626544e-01 -2.29927144e-01]]
compute_tune_4x4()/ evals =  [0.08665169+0.99623867j 0.08665169-0.99623867j 0.0677277 +0.99770384j
 0.0677277 -0.99770384j]
compute_tune_4x4()/ angles =  [0.23619163822484746, 0.23921254466153022, 0.7607874553384698, 0.7638083617751525]
compute_tune_4x4()/  0.23619163822484746 0.23921254466153022
compute_tunes()/ 0.23619163822484746 0.23921254466153022

 Running simulation ..
Closed orbit computation: x_co=[-4.51646862e-09  4.12512291e-10], y_co=[1.43934699e-08 2.05742022e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 32/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.40709534e-03  3.81676627e-04 -3.19587926e-03 -6.33582839e-04]
 [ 2.21835661e-03 -2.87832994e-04 -3.09427597e-04  3.57856746e-04]
 [ 1.88986758e-04 -5.81531940e-04 -2.17364757e-03 -3.07059919e-04]
 [ 1.77270899e-03 -7.10232044e-05  2.22202515e-03  2.45723679e-04]
 [-4.51653754e-04 -1.22510793e-04 -3.17609319e-03 -5.36619506e-04]
 [ 2.79164006e-03 -8.29384979e-05  2.83569117e-03  2.14617445e-04]
 [ 4.84727888e-03 -9.50033853e-04  2.15754219e-03  4.35137180e-04]
 [ 1.25622894e-03  2.26267469e-04  1.01719722e-03 -2.83382916e-04]
 [ 2.97093424e-03 -3.76129776e-04  1.11135591e-03 -2.68680148e-04]
 [-9.35303994e-04  1.81735417e-04 -3.68123962e-03 -1.29796982e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008227644062312637
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.370114639889234e-05, theta_kick=8.837044763773907e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.0265245804223733e-05, theta_kick=-2.429879222658849e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0029137069846163106
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.8923982757723695e-05, theta_kick=-7.065207242117907e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.4206901808755466e-05, theta_kick=-1.7034609822622708e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.0517337541065746e-05, theta_kick=7.256256475853824e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011448750935524388
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.235952905347617e-06, theta_kick=-7.477142169686938e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01574960e-01 -6.31916524e+00 -5.31317236e-03 -4.88652619e-03]
 [ 1.80018156e-01  4.56208492e-01  4.61195536e-04 -2.69691252e-03]
 [-4.83501605e-03 -4.88789063e-03  3.83930272e-01 -5.11993829e+00]
 [-5.47738436e-04 -3.98345952e-03  2.12548588e-01 -2.29865271e-01]]
compute_tune_4x4()/ evals =  [0.08136095+0.9966847j 0.08136095-0.9966847j 0.07298832+0.9973328j
 0.07298832-0.9973328j]
compute_tune_4x4()/ angles =  [0.2370366736446077, 0.23837320979316426, 0.7616267902068358, 0.7629633263553923]
compute_tune_4x4()/  0.2370366736446077 0.23837320979316426
compute_tunes()/ 0.2370366736446077 0.23837320979316426

 Running simulation ..
Closed orbit computation: x_co=[-1.43245154e-07  5.93927053e-08], y_co=[1.82383116e-05 1.34101745e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.370114639889234e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.0265245804223733e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.8923982757723695e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.4206901808755466e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.0517337541065746e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.235952905347617e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008227644062312637}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0029137069846163106}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.011448750935524388}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.40709534e-03  3.81676627e-04 -3.19587926e-03 -6.33582839e-04]
 [ 2.21835661e-03 -2.87832994e-04 -3.09427597e-04  3.57856746e-04]
 [ 1.88986758e-04 -5.81531940e-04 -2.17364757e-03 -3.07059919e-04]
 [ 1.77270899e-03 -7.10232044e-05  2.22202515e-03  2.45723679e-04]
 [-4.51653754e-04 -1.22510793e-04 -3.17609319e-03 -5.36619506e-04]
 [ 2.79164006e-03 -8.29384979e-05  2.83569117e-03  2.14617445e-04]
 [ 4.84727888e-03 -9.50033853e-04  2.15754219e-03  4.35137180e-04]
 [ 1.25622894e-03  2.26267469e-04  1.01719722e-03 -2.83382916e-04]
 [ 2.97093424e-03 -3.76129776e-04  1.11135591e-03 -2.68680148e-04]
 [-9.35303994e-04  1.81735417e-04 -3.68123962e-03 -1.29796982e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008227644062312637
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6960807934052424e-06, theta_kick=-2.0336646886302104e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.232178847877739e-06, theta_kick=2.67646642735822e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0029137069846163106
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.9986624185673804e-06, theta_kick=-3.595509068597708e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.0382422108464e-06, theta_kick=4.84200435513813e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.3183129667606117e-06, theta_kick=-3.97878210316626e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011448750935524388
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.6983133448836862e-06, theta_kick=2.036341601855638e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01574960e-01 -6.31916524e+00 -5.31317236e-03 -4.88652619e-03]
 [ 1.80018156e-01  4.56208492e-01  4.61195536e-04 -2.69691252e-03]
 [-4.83501605e-03 -4.88789063e-03  3.83930272e-01 -5.11993829e+00]
 [-5.47738436e-04 -3.98345952e-03  2.12548588e-01 -2.29865271e-01]]
compute_tune_4x4()/ evals =  [0.08136095+0.9966847j 0.08136095-0.9966847j 0.07298832+0.9973328j
 0.07298832-0.9973328j]
compute_tune_4x4()/ angles =  [0.2370366736446077, 0.23837320979316426, 0.7616267902068358, 0.7629633263553923]
compute_tune_4x4()/  0.2370366736446077 0.23837320979316426
compute_tunes()/ 0.2370366736446077 0.23837320979316426

 Running simulation ..
Closed orbit computation: x_co=[-1.04031580e-09 -2.89263528e-10], y_co=[ 3.32142992e-07 -6.78931315e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 33/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.48109327e-03 -3.68373945e-04  2.08459996e-03 -4.15212744e-04]
 [-1.92158539e-03  1.28507649e-04 -2.97320091e-04 -4.40980830e-06]
 [ 8.10213065e-04 -2.09867944e-04 -2.58041490e-04 -5.94009222e-05]
 [ 5.53243895e-04 -2.65546435e-05  1.61829845e-03  6.53602489e-04]
 [ 4.46375076e-03 -6.21855755e-04  3.00869672e-03  2.58848467e-04]
 [-1.61969873e-03  3.38415480e-04  7.58189837e-04  2.81341029e-05]
 [ 2.85920181e-03 -1.67959685e-04 -4.80840316e-03 -3.58964977e-04]
 [ 2.28514804e-03  4.21076234e-04 -4.14787466e-03 -6.40290362e-04]
 [-2.92275915e-03 -1.68465375e-04 -5.20448558e-04 -8.85584156e-04]
 [ 5.09227140e-04 -3.89417242e-04  8.43717721e-04 -3.06267499e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008055989190699617
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=0.00010276738143352025, theta_kick=-1.232219571007236e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0004539879336955e-06, theta_kick=1.1995819749689893e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0018341938813251195
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.803547663804769e-05, theta_kick=-2.162521509825814e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.387475724467577e-06, theta_kick=-6.459786104708512e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.1089356457755165e-05, theta_kick=4.926768443554388e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.017249690042132323
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.6082823038631404e-05, theta_kick=3.1274286224867083e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01384832e-01 -6.31888110e+00 -6.58338310e-03 -4.35946556e-02]
 [ 1.80018554e-01  4.56154036e-01 -7.14052120e-04  1.03370144e-03]
 [-1.00639494e-02 -4.36094017e-02  3.83909327e-01 -5.12096781e+00]
 [-1.92394449e-03 -4.56758647e-03  2.12536423e-01 -2.30143532e-01]]
compute_tune_4x4()/ evals =  [0.08215694+0.9966194j  0.08215694-0.9966194j  0.07211056+0.99739665j
 0.07211056-0.99739665j]
compute_tune_4x4()/ angles =  [0.23690956189650283, 0.238513278761237, 0.761486721238763, 0.7630904381034972]
compute_tune_4x4()/  0.23690956189650283 0.238513278761237
compute_tunes()/ 0.23690956189650283 0.238513278761237

 Running simulation ..
Closed orbit computation: x_co=[1.39246930e-07 8.58006918e-08], y_co=[ 8.46813379e-06 -1.51927960e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 0.00010276738143352025, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.0004539879336955e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.803547663804769e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.387475724467577e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.1089356457755165e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.6082823038631404e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008055989190699617}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0018341938813251195}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.017249690042132323}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.48109327e-03 -3.68373945e-04  2.08459996e-03 -4.15212744e-04]
 [-1.92158539e-03  1.28507649e-04 -2.97320091e-04 -4.40980830e-06]
 [ 8.10213065e-04 -2.09867944e-04 -2.58041490e-04 -5.94009222e-05]
 [ 5.53243895e-04 -2.65546435e-05  1.61829845e-03  6.53602489e-04]
 [ 4.46375076e-03 -6.21855755e-04  3.00869672e-03  2.58848467e-04]
 [-1.61969873e-03  3.38415480e-04  7.58189837e-04  2.81341029e-05]
 [ 2.85920181e-03 -1.67959685e-04 -4.80840316e-03 -3.58964977e-04]
 [ 2.28514804e-03  4.21076234e-04 -4.14787466e-03 -6.40290362e-04]
 [-2.92275915e-03 -1.68465375e-04 -5.20448558e-04 -8.85584156e-04]
 [ 5.09227140e-04 -3.89417242e-04  8.43717721e-04 -3.06267499e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008055989190699617
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.68974433030721e-07, theta_kick=-5.6231799100213946e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.948534911924042e-06, theta_kick=2.336366675662429e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0018341938813251195
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.3411523907414783e-06, theta_kick=-2.8071298055290064e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.5252187918913204e-06, theta_kick=1.8287947199007653e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.644487718315126e-09, theta_kick=9.166028408465289e-10
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.017249690042132323
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.384760738995916e-07, theta_kick=2.8594178559092513e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01384832e-01 -6.31888110e+00 -6.58338310e-03 -4.35946556e-02]
 [ 1.80018554e-01  4.56154036e-01 -7.14052120e-04  1.03370144e-03]
 [-1.00639494e-02 -4.36094017e-02  3.83909327e-01 -5.12096781e+00]
 [-1.92394449e-03 -4.56758647e-03  2.12536423e-01 -2.30143532e-01]]
compute_tune_4x4()/ evals =  [0.08215694+0.9966194j  0.08215694-0.9966194j  0.07211056+0.99739665j
 0.07211056-0.99739665j]
compute_tune_4x4()/ angles =  [0.23690956189650283, 0.238513278761237, 0.761486721238763, 0.7630904381034972]
compute_tune_4x4()/  0.23690956189650283 0.238513278761237
compute_tunes()/ 0.23690956189650283 0.238513278761237

 Running simulation ..
Closed orbit computation: x_co=[ 1.04443029e-09 -6.00316166e-10], y_co=[-1.43580998e-07 -3.76572661e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 34/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.44965085e-03  1.39026394e-04  1.99251901e-03 -7.21949332e-04]
 [-8.24068430e-04  3.55029236e-04  5.67775700e-03  2.25733108e-04]
 [ 2.44160128e-03  5.62005409e-04 -1.71501605e-03  2.74097140e-04]
 [-5.25856478e-04 -3.81100943e-04  3.66005890e-03  5.41467133e-04]
 [ 5.08266410e-04  1.65652289e-04 -2.14703725e-03  1.08716691e-04]
 [ 1.86303951e-03  5.00569823e-05 -3.49604282e-03 -6.15858043e-04]
 [ 5.32414343e-06 -3.25002370e-05  5.12283420e-03  2.90368679e-04]
 [ 3.21403767e-03 -7.14716259e-04  1.35992585e-03 -6.50545048e-04]
 [-2.47033905e-03  5.89410972e-04  1.17118170e-03  7.37723029e-05]
 [ 1.57976723e-03  3.38633460e-05 -2.14727001e-03 -2.45028144e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0027159170297111524
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1798996095773347e-05, theta_kick=-1.4147440272043e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.0300080888246203e-05, theta_kick=3.6330937066594425e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005666051754336761
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.960485159512308e-05, theta_kick=8.345883603937901e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.838383038237394e-05, theta_kick=-8.19947856627157e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.551302973514238e-06, theta_kick=7.855258766892197e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008339314060476456
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.145937996255578e-05, theta_kick=-4.971135654043541e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01616777e-01 -6.32014854e+00 -1.23918358e-03 -3.99508330e-02]
 [ 1.79999978e-01  4.56097402e-01 -1.33386741e-03  5.39202663e-03]
 [-5.33875113e-03 -3.99610018e-02  3.84085936e-01 -5.11969216e+00]
 [-1.32668634e-03  1.30275975e-03  2.12583682e-01 -2.29904376e-01]]
compute_tune_4x4()/ evals =  [0.07724589+0.99701207j 0.07724589-0.99701207j 0.0770852 +0.99702451j
 0.0770852 -0.99702451j]
compute_tune_4x4()/ angles =  [0.23769367563751997, 0.23771932613776725, 0.7622806738622327, 0.76230632436248]
compute_tune_4x4()/  0.23769367563751997 0.23771932613776725
compute_tunes()/ 0.23769367563751997 0.23771932613776725

 Running simulation ..
Closed orbit computation: x_co=[-2.87578923e-07 -5.91384988e-09], y_co=[-2.21663016e-05  6.84736706e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.1798996095773347e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.0300080888246203e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.960485159512308e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.838383038237394e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.551302973514238e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.145937996255578e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0027159170297111524}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005666051754336761}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.008339314060476456}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.44965085e-03  1.39026394e-04  1.99251901e-03 -7.21949332e-04]
 [-8.24068430e-04  3.55029236e-04  5.67775700e-03  2.25733108e-04]
 [ 2.44160128e-03  5.62005409e-04 -1.71501605e-03  2.74097140e-04]
 [-5.25856478e-04 -3.81100943e-04  3.66005890e-03  5.41467133e-04]
 [ 5.08266410e-04  1.65652289e-04 -2.14703725e-03  1.08716691e-04]
 [ 1.86303951e-03  5.00569823e-05 -3.49604282e-03 -6.15858043e-04]
 [ 5.32414343e-06 -3.25002370e-05  5.12283420e-03  2.90368679e-04]
 [ 3.21403767e-03 -7.14716259e-04  1.35992585e-03 -6.50545048e-04]
 [-2.47033905e-03  5.89410972e-04  1.17118170e-03  7.37723029e-05]
 [ 1.57976723e-03  3.38633460e-05 -2.14727001e-03 -2.45028144e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0027159170297111524
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.4745253571258413e-06, theta_kick=-2.967049010562382e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.672684112603793e-06, theta_kick=3.2046488143720423e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005666051754336761
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.874017763420227e-06, theta_kick=-2.247017810797703e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.4062528341293176e-06, theta_kick=1.6861500602888144e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2332713627416627e-06, theta_kick=-1.4787387674328384e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008339314060476456
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.202163959818935e-07, theta_kick=3.8395150735794707e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01616777e-01 -6.32014854e+00 -1.23918358e-03 -3.99508330e-02]
 [ 1.79999978e-01  4.56097402e-01 -1.33386741e-03  5.39202663e-03]
 [-5.33875113e-03 -3.99610018e-02  3.84085936e-01 -5.11969216e+00]
 [-1.32668634e-03  1.30275975e-03  2.12583682e-01 -2.29904376e-01]]
compute_tune_4x4()/ evals =  [0.07724589+0.99701207j 0.07724589-0.99701207j 0.0770852 +0.99702451j
 0.0770852 -0.99702451j]
compute_tune_4x4()/ angles =  [0.23769367563751997, 0.23771932613776725, 0.7622806738622327, 0.76230632436248]
compute_tune_4x4()/  0.23769367563751997 0.23771932613776725
compute_tunes()/ 0.23769367563751997 0.23771932613776725

 Running simulation ..
Closed orbit computation: x_co=[-1.59736281e-09  1.90138532e-10], y_co=[-5.36525018e-08 -6.76784283e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 35/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.70418216e-03 -2.39181197e-04 -2.61026364e-04 -1.45405678e-04]
 [ 1.00805221e-03 -1.16289521e-04  6.36666978e-03  4.45294758e-04]
 [ 3.34626121e-03  4.24101524e-04 -2.43779052e-04 -4.60722123e-05]
 [ 1.87975566e-03  5.41248800e-04 -8.99463173e-04 -1.06669212e-04]
 [ 1.84188900e-03  3.36075163e-04  2.85636845e-03  4.57029698e-04]
 [ 2.67484206e-03  2.11182885e-05 -3.47620103e-03  1.28743530e-04]
 [-1.50265845e-03  3.91891300e-04 -6.95803724e-03 -8.88741425e-04]
 [-3.39924326e-03  3.32992868e-04 -3.35688262e-03  1.01476340e-05]
 [-2.17492961e-03  3.71833724e-04 -1.69014779e-03 -6.95351196e-05]
 [ 1.12909350e-03 -4.90704760e-05 -1.86728501e-03 -1.06761879e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010119713745877064
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.6336180091962244e-05, theta_kick=3.1578070864713088e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.8240919972166112e-05, theta_kick=3.3861925649495633e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006478412869909659
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.19693884132547e-05, theta_kick=5.032287586258223e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0305846916527274e-05, theta_kick=-1.2357098224366505e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.837045508450519e-05, theta_kick=-4.600761938667003e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.014993056104039107
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.5759273513727406e-05, theta_kick=-6.685746696115537e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01511609e-01 -6.31844655e+00 -8.56046108e-03 -1.34401029e-03]
 [ 1.80035208e-01  4.56377134e-01  1.09779653e-03 -6.85576447e-03]
 [-7.08286916e-03 -1.34703749e-03  3.83754926e-01 -5.12014619e+00]
 [-7.69006923e-04 -8.64054305e-03  2.12526330e-01 -2.29902047e-01]]
compute_tune_4x4()/ evals =  [0.08492572+0.99638729j 0.08492572-0.99638729j 0.06943349+0.99758658j
 0.06943349-0.99758658j]
compute_tune_4x4()/ angles =  [0.2364673520201613, 0.2389404189872139, 0.761059581012786, 0.7635326479798387]
compute_tune_4x4()/  0.2364673520201613 0.2389404189872139
compute_tunes()/ 0.2364673520201613 0.2389404189872139

 Running simulation ..
Closed orbit computation: x_co=[ 2.34853087e-07 -9.61231610e-08], y_co=[-2.71051853e-05  1.23019327e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.6336180091962244e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.8240919972166112e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.19693884132547e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.0305846916527274e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.837045508450519e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.5759273513727406e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.010119713745877064}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006478412869909659}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.014993056104039107}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.70418216e-03 -2.39181197e-04 -2.61026364e-04 -1.45405678e-04]
 [ 1.00805221e-03 -1.16289521e-04  6.36666978e-03  4.45294758e-04]
 [ 3.34626121e-03  4.24101524e-04 -2.43779052e-04 -4.60722123e-05]
 [ 1.87975566e-03  5.41248800e-04 -8.99463173e-04 -1.06669212e-04]
 [ 1.84188900e-03  3.36075163e-04  2.85636845e-03  4.57029698e-04]
 [ 2.67484206e-03  2.11182885e-05 -3.47620103e-03  1.28743530e-04]
 [-1.50265845e-03  3.91891300e-04 -6.95803724e-03 -8.88741425e-04]
 [-3.39924326e-03  3.32992868e-04 -3.35688262e-03  1.01476340e-05]
 [-2.17492961e-03  3.71833724e-04 -1.69014779e-03 -6.95351196e-05]
 [ 1.12909350e-03 -4.90704760e-05 -1.86728501e-03 -1.06761879e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010119713745877064
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6524769097005232e-07, theta_kick=-1.981381991413063e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.50697586873239e-07, theta_kick=1.0200184153100553e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006478412869909659
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.9268203950370013e-06, theta_kick=-2.3103301528767553e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0195057995577616e-06, theta_kick=1.222425813956464e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.7606451656047663e-07, theta_kick=5.708192679283133e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.014993056104039107
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.184593613674439e-07, theta_kick=-9.813635699217033e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01511609e-01 -6.31844655e+00 -8.56046108e-03 -1.34401029e-03]
 [ 1.80035208e-01  4.56377134e-01  1.09779653e-03 -6.85576447e-03]
 [-7.08286916e-03 -1.34703749e-03  3.83754926e-01 -5.12014619e+00]
 [-7.69006923e-04 -8.64054305e-03  2.12526330e-01 -2.29902047e-01]]
compute_tune_4x4()/ evals =  [0.08492572+0.99638729j 0.08492572-0.99638729j 0.06943349+0.99758658j
 0.06943349-0.99758658j]
compute_tune_4x4()/ angles =  [0.2364673520201613, 0.2389404189872139, 0.761059581012786, 0.7635326479798387]
compute_tune_4x4()/  0.2364673520201613 0.2389404189872139
compute_tunes()/ 0.2364673520201613 0.2389404189872139

 Running simulation ..
Closed orbit computation: x_co=[-6.42983371e-10  4.35791372e-10], y_co=[-1.80018333e-07 -1.39512823e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 36/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 8.07662225e-04  1.46808030e-04 -1.90635833e-03  3.32845524e-05]
 [-4.79090298e-05 -4.16783665e-04  2.69119514e-03 -2.09925199e-04]
 [-5.23490325e-03 -1.60704170e-04 -6.34860365e-04  7.86671456e-04]
 [ 5.03802211e-03 -7.76540871e-04  1.49471184e-04  2.80586377e-04]
 [-3.52408733e-03 -5.56559802e-05 -1.31726979e-03 -1.33014409e-04]
 [-1.73873713e-03  1.71978389e-04  1.08943225e-03  1.31872832e-06]
 [ 1.01229686e-04  6.32865008e-04  2.87760280e-03 -2.61905636e-04]
 [-7.77620465e-04  1.85504390e-04 -9.05291968e-04  7.44245771e-04]
 [ 9.60747080e-04 -3.39294868e-05 -9.24489643e-04  1.19243201e-04]
 [-2.03861417e-03  1.87991846e-04 -2.31355779e-03  4.36741790e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010968202599250387
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.362675434014054e-05, theta_kick=1.1226200128728524e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3119524321823995e-06, theta_kick=-2.7721179565286767e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012513941004761346
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.044617201452663e-05, theta_kick=8.446761087806427e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.1251275596037908e-05, theta_kick=1.349070278413448e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.903643279566527e-05, theta_kick=-9.476765677484756e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010857147475523281
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-0.0001260722472448943, theta_kick=1.5116536808570552e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642065e-01 -6.31908182e+00 -8.70562261e-03  3.70358157e-02]
 [ 1.80045062e-01  4.56612591e-01  2.48650076e-03 -1.21962877e-02]
 [-3.03753450e-03  3.70057850e-02  3.83695951e-01 -5.11938375e+00]
 [ 4.47544457e-04 -1.00899030e-02  2.12557304e-01 -2.29808253e-01]]
compute_tune_4x4()/ evals =  [0.08567859+0.99632283j 0.08567859-0.99632283j 0.06875052+0.99763388j
 0.06875052-0.99763388j]
compute_tune_4x4()/ angles =  [0.23634708982905153, 0.23904937665997847, 0.7609506233400215, 0.7636529101709485]
compute_tune_4x4()/  0.23634708982905153 0.23904937665997847
compute_tunes()/ 0.23634708982905153 0.23904937665997847

 Running simulation ..
Closed orbit computation: x_co=[-6.10917929e-07  4.44421069e-09], y_co=[1.45185604e-05 6.91985294e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.362675434014054e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.3119524321823995e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.044617201452663e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.1251275596037908e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.903643279566527e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -0.0001260722472448943, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.010968202599250387}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.012513941004761346}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010857147475523281}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 8.07662225e-04  1.46808030e-04 -1.90635833e-03  3.32845524e-05]
 [-4.79090298e-05 -4.16783665e-04  2.69119514e-03 -2.09925199e-04]
 [-5.23490325e-03 -1.60704170e-04 -6.34860365e-04  7.86671456e-04]
 [ 5.03802211e-03 -7.76540871e-04  1.49471184e-04  2.80586377e-04]
 [-3.52408733e-03 -5.56559802e-05 -1.31726979e-03 -1.33014409e-04]
 [-1.73873713e-03  1.71978389e-04  1.08943225e-03  1.31872832e-06]
 [ 1.01229686e-04  6.32865008e-04  2.87760280e-03 -2.61905636e-04]
 [-7.77620465e-04  1.85504390e-04 -9.05291968e-04  7.44245771e-04]
 [ 9.60747080e-04 -3.39294868e-05 -9.24489643e-04  1.19243201e-04]
 [-2.03861417e-03  1.87991846e-04 -2.31355779e-03  4.36741790e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.010968202599250387
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4669266712084253e-06, theta_kick=-1.7589002738819723e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.89378924021589e-06, theta_kick=3.469762181758877e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012513941004761346
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.951775159038998e-06, theta_kick=-4.738327106581103e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.3858717371513423e-06, theta_kick=4.0597876108549955e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.9332482013581715e-06, theta_kick=-2.3180373345107582e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010857147475523281
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.38521474331425e-07, theta_kick=7.656112729587772e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642065e-01 -6.31908182e+00 -8.70562261e-03  3.70358157e-02]
 [ 1.80045062e-01  4.56612591e-01  2.48650076e-03 -1.21962877e-02]
 [-3.03753450e-03  3.70057850e-02  3.83695951e-01 -5.11938375e+00]
 [ 4.47544457e-04 -1.00899030e-02  2.12557304e-01 -2.29808253e-01]]
compute_tune_4x4()/ evals =  [0.08567859+0.99632283j 0.08567859-0.99632283j 0.06875052+0.99763388j
 0.06875052-0.99763388j]
compute_tune_4x4()/ angles =  [0.23634708982905153, 0.23904937665997847, 0.7609506233400215, 0.7636529101709485]
compute_tune_4x4()/  0.23634708982905153 0.23904937665997847
compute_tunes()/ 0.23634708982905153 0.23904937665997847

 Running simulation ..
Closed orbit computation: x_co=[-5.96723968e-09  6.24555735e-10], y_co=[ 1.86558209e-07 -2.84562068e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 37/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.80424319e-03  1.06508944e-04 -2.89527428e-03 -3.04532409e-04]
 [-3.35780344e-03  4.81661814e-04  3.44737970e-03  5.19126551e-04]
 [-1.47500842e-03 -4.10037361e-04  6.30278557e-03  4.71663538e-06]
 [ 1.28591679e-03 -6.62568336e-05  1.06989042e-03 -1.76379348e-04]
 [-6.81607919e-04  2.79204004e-04  1.36579417e-03 -5.02275629e-05]
 [ 1.29376754e-03 -4.88368859e-04  2.42117486e-03  2.07896591e-04]
 [-1.40689486e-04  1.27665009e-04 -1.19657835e-03  4.58673056e-04]
 [-2.78342498e-03  1.38136788e-04  4.48096649e-03 -2.73334184e-04]
 [ 1.01888701e-03 -2.48808314e-04 -3.04467306e-03 -9.22757624e-05]
 [-6.81153143e-04  2.61470200e-04 -8.03310991e-04  2.76321483e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011174601726451922
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.844000586141004e-05, theta_kick=4.6091013385121145e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.497958675409362e-05, theta_kick=8.990334572667553e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011824628736520194
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00010383330976938581, theta_kick=-1.2450004528242391e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.695538866283329e-05, theta_kick=5.630127776684027e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00011562498603908438, theta_kick=-1.3863870880758492e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0056483144709246124
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.727710669853422e-05, theta_kick=2.0715901006085244e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01676705e-01 -6.31995842e+00 -2.46500775e-03 -2.23082014e-02]
 [ 1.80001547e-01  4.56091902e-01 -4.13884582e-04  3.06985881e-04]
 [-4.41735659e-03 -2.23089312e-02  3.84080088e-01 -5.11937098e+00]
 [-9.64538550e-04 -2.60972387e-03  2.12576136e-01 -2.29759669e-01]]
compute_tune_4x4()/ evals =  [0.07946759+0.99683745j 0.07946759-0.99683745j 0.07490022+0.99719103j
 0.07490022-0.99719103j]
compute_tune_4x4()/ angles =  [0.23733899057644284, 0.2380680857784826, 0.7619319142215174, 0.7626610094235572]
compute_tune_4x4()/  0.23733899057644284 0.2380680857784826
compute_tunes()/ 0.23733899057644284 0.2380680857784826

 Running simulation ..
Closed orbit computation: x_co=[ 2.96537578e-09 -1.62357858e-08], y_co=[4.30450090e-05 1.51319052e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.844000586141004e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.497958675409362e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00010383330976938581, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.695538866283329e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00011562498603908438, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.727710669853422e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0011174601726451922}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0011824628736520194}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0056483144709246124}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.80424319e-03  1.06508944e-04 -2.89527428e-03 -3.04532409e-04]
 [-3.35780344e-03  4.81661814e-04  3.44737970e-03  5.19126551e-04]
 [-1.47500842e-03 -4.10037361e-04  6.30278557e-03  4.71663538e-06]
 [ 1.28591679e-03 -6.62568336e-05  1.06989042e-03 -1.76379348e-04]
 [-6.81607919e-04  2.79204004e-04  1.36579417e-03 -5.02275629e-05]
 [ 1.29376754e-03 -4.88368859e-04  2.42117486e-03  2.07896591e-04]
 [-1.40689486e-04  1.27665009e-04 -1.19657835e-03  4.58673056e-04]
 [-2.78342498e-03  1.38136788e-04  4.48096649e-03 -2.73334184e-04]
 [ 1.01888701e-03 -2.48808314e-04 -3.04467306e-03 -9.22757624e-05]
 [-6.81153143e-04  2.61470200e-04 -8.03310991e-04  2.76321483e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011174601726451922
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4788542252044287e-06, theta_kick=1.773201859913556e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.958788104292685e-07, theta_kick=-5.9457735181664156e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011824628736520194
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.013342077260252e-07, theta_kick=-1.080733628983997e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3128154219217e-06, theta_kick=1.5741150873426784e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.295389981763452e-07, theta_kick=-8.747447087064615e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0056483144709246124
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.261624928314674e-07, theta_kick=-2.7117733857507677e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01676705e-01 -6.31995842e+00 -2.46500775e-03 -2.23082014e-02]
 [ 1.80001547e-01  4.56091902e-01 -4.13884582e-04  3.06985881e-04]
 [-4.41735659e-03 -2.23089312e-02  3.84080088e-01 -5.11937098e+00]
 [-9.64538550e-04 -2.60972387e-03  2.12576136e-01 -2.29759669e-01]]
compute_tune_4x4()/ evals =  [0.07946759+0.99683745j 0.07946759-0.99683745j 0.07490022+0.99719103j
 0.07490022-0.99719103j]
compute_tune_4x4()/ angles =  [0.23733899057644284, 0.2380680857784826, 0.7619319142215174, 0.7626610094235572]
compute_tune_4x4()/  0.23733899057644284 0.2380680857784826
compute_tunes()/ 0.23733899057644284 0.2380680857784826

 Running simulation ..
Closed orbit computation: x_co=[ 1.28389816e-10 -2.59125405e-10], y_co=[7.43921561e-08 1.22171141e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 38/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.33201054e-03 -2.21198840e-04  2.91243114e-03  1.58147464e-04]
 [ 1.53709766e-03 -5.88998616e-04  3.52146007e-03  1.20336800e-03]
 [ 6.86683417e-04 -4.99263010e-04  7.66836544e-05  3.05804460e-04]
 [ 5.92554209e-03 -3.38080662e-04 -1.23469334e-03 -1.62007013e-04]
 [ 2.05434781e-03  1.79185392e-04 -2.75992883e-03 -4.46741260e-04]
 [-2.83554266e-03  3.44891753e-04 -2.67950948e-03 -4.54036857e-04]
 [ 3.78815018e-03 -6.10311724e-05 -3.06056648e-03  1.17953662e-03]
 [ 4.38518842e-03 -5.94804836e-04  3.40658855e-03 -3.53221859e-04]
 [ 3.04345503e-03  1.48202115e-04  8.58743556e-04 -2.03011592e-04]
 [-1.58735666e-03 -2.04283764e-04  7.48351935e-04  2.36798439e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009920744940012561
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4876426599831989e-05, theta_kick=1.7837395238900646e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.9439523648086888e-05, theta_kick=3.5299096556011556e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0027412285397578583
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.518511256850193e-05, theta_kick=1.1413053143842982e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5343383458179947e-05, theta_kick=-3.0387670345489947e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.197998842917186e-05, theta_kick=7.431633820759841e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.015008245686662609
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.8142735285943603e-06, theta_kick=2.1753822252837255e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01397100e-01 -6.31897757e+00  1.18588755e-02  1.11731191e-01]
 [ 1.80031940e-01  4.56230586e-01  1.57969602e-03  5.50526656e-03]
 [ 2.17288254e-02  1.11737739e-01  3.83960862e-01 -5.12073219e+00]
 [ 5.22832727e-03  2.17676940e-02  2.12554757e-01 -2.30035876e-01]]
compute_tune_4x4()/ evals =  [0.09232213+0.99572919j 0.09232213-0.99572919j 0.06205711+0.9980726j
 0.06205711-0.9980726j ]
compute_tune_4x4()/ angles =  [0.23528552328563263, 0.2401169542816603, 0.7598830457183396, 0.7647144767143674]
compute_tune_4x4()/  0.23528552328563263 0.2401169542816603
compute_tunes()/ 0.23528552328563263 0.2401169542816603

 Running simulation ..
Closed orbit computation: x_co=[1.45281557e-07 6.53756455e-08], y_co=[-6.23823605e-05 -1.44953847e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.4876426599831989e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.9439523648086888e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.518511256850193e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.5343383458179947e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.197998842917186e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.8142735285943603e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009920744940012561}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0027412285397578583}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.015008245686662609}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.33201054e-03 -2.21198840e-04  2.91243114e-03  1.58147464e-04]
 [ 1.53709766e-03 -5.88998616e-04  3.52146007e-03  1.20336800e-03]
 [ 6.86683417e-04 -4.99263010e-04  7.66836544e-05  3.05804460e-04]
 [ 5.92554209e-03 -3.38080662e-04 -1.23469334e-03 -1.62007013e-04]
 [ 2.05434781e-03  1.79185392e-04 -2.75992883e-03 -4.46741260e-04]
 [-2.83554266e-03  3.44891753e-04 -2.67950948e-03 -4.54036857e-04]
 [ 3.78815018e-03 -6.10311724e-05 -3.06056648e-03  1.17953662e-03]
 [ 4.38518842e-03 -5.94804836e-04  3.40658855e-03 -3.53221859e-04]
 [ 3.04345503e-03  1.48202115e-04  8.58743556e-04 -2.03011592e-04]
 [-1.58735666e-03 -2.04283764e-04  7.48351935e-04  2.36798439e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009920744940012561
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.049825531833039e-07, theta_kick=4.855893192839252e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.9142545152408255e-08, theta_kick=3.494300816547469e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0027412285397578583
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.102327871184251e-06, theta_kick=-2.5207702204838365e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.1376508311670606e-06, theta_kick=4.961199031286596e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.4369165045787743e-06, theta_kick=-2.9219545812744275e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.015008245686662609
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.1726285976289477e-06, theta_kick=1.4060258102965102e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01397100e-01 -6.31897757e+00  1.18588755e-02  1.11731191e-01]
 [ 1.80031940e-01  4.56230586e-01  1.57969602e-03  5.50526656e-03]
 [ 2.17288254e-02  1.11737739e-01  3.83960862e-01 -5.12073219e+00]
 [ 5.22832727e-03  2.17676940e-02  2.12554757e-01 -2.30035876e-01]]
compute_tune_4x4()/ evals =  [0.09232213+0.99572919j 0.09232213-0.99572919j 0.06205711+0.9980726j
 0.06205711-0.9980726j ]
compute_tune_4x4()/ angles =  [0.23528552328563263, 0.2401169542816603, 0.7598830457183396, 0.7647144767143674]
compute_tune_4x4()/  0.23528552328563263 0.2401169542816603
compute_tunes()/ 0.23528552328563263 0.2401169542816603

 Running simulation ..
Closed orbit computation: x_co=[-1.13818406e-09  4.02939917e-10], y_co=[ 5.69024925e-08 -4.78227335e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 39/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.39682268e-03 -1.16069182e-03  4.21376798e-03  6.44109113e-05]
 [ 3.81745450e-04 -4.36856974e-04 -4.86764358e-04  4.92532022e-04]
 [ 3.17895120e-04  1.01455863e-04  6.27002441e-04 -4.18962755e-04]
 [ 1.07267521e-03 -1.53837681e-04 -8.50407220e-04 -2.76907273e-04]
 [-1.92970662e-03 -6.09823861e-04  1.92597122e-03  4.21432814e-05]
 [-1.93962954e-04  3.95271249e-04  2.05991028e-03  5.20397367e-04]
 [ 4.12851164e-03 -2.68019054e-04 -5.38267611e-03 -4.95124430e-04]
 [-8.68752571e-04 -1.40776940e-04 -3.09835687e-03  3.12684036e-06]
 [ 5.70083973e-03 -2.29389469e-04  3.22087991e-03  3.62466330e-04]
 [-3.56543522e-04  1.93391558e-04 -1.59378229e-03 -5.15110546e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0043425224091813465
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0350476880280962e-05, theta_kick=-1.2410611230170018e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.104414555336837e-05, theta_kick=8.518460365069993e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013034717065228612
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.88258678320076e-05, theta_kick=-4.655367640644694e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00012550041905357384, theta_kick=-1.5047972456850196e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.4609896420622296e-05, theta_kick=-2.9508191789014973e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011307195978364125
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.272878395499219e-06, theta_kick=-2.7252667163319843e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642638e-01 -6.31903471e+00  1.18726686e-02 -9.11634828e-03]
 [ 1.80015627e-01  4.56477979e-01 -2.28346383e-03  1.59228049e-02]
 [ 8.62895142e-03 -9.10459679e-03  3.83739633e-01 -5.11858659e+00]
 [ 1.00508407e-03  1.84354323e-02  2.12559595e-01 -2.29772771e-01]]
compute_tune_4x4()/ evals =  [0.09084118+0.99586539j 0.09084118-0.99586539j 0.06355992+0.99797802j
 0.06355992-0.99797802j]
compute_tune_4x4()/ angles =  [0.23552221839332474, 0.23987730070951888, 0.7601226992904812, 0.7644777816066752]
compute_tune_4x4()/  0.23552221839332474 0.23987730070951888
compute_tunes()/ 0.23552221839332474 0.23987730070951888

 Running simulation ..
Closed orbit computation: x_co=[ 2.02919880e-07 -8.86392989e-08], y_co=[6.43033001e-05 1.28781374e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.0350476880280962e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.104414555336837e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.88258678320076e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00012550041905357384, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.4609896420622296e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.272878395499219e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0043425224091813465}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.013034717065228612}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011307195978364125}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.39682268e-03 -1.16069182e-03  4.21376798e-03  6.44109113e-05]
 [ 3.81745450e-04 -4.36856974e-04 -4.86764358e-04  4.92532022e-04]
 [ 3.17895120e-04  1.01455863e-04  6.27002441e-04 -4.18962755e-04]
 [ 1.07267521e-03 -1.53837681e-04 -8.50407220e-04 -2.76907273e-04]
 [-1.92970662e-03 -6.09823861e-04  1.92597122e-03  4.21432814e-05]
 [-1.93962954e-04  3.95271249e-04  2.05991028e-03  5.20397367e-04]
 [ 4.12851164e-03 -2.68019054e-04 -5.38267611e-03 -4.95124430e-04]
 [-8.68752571e-04 -1.40776940e-04 -3.09835687e-03  3.12684036e-06]
 [ 5.70083973e-03 -2.29389469e-04  3.22087991e-03  3.62466330e-04]
 [-3.56543522e-04  1.93391558e-04 -1.59378229e-03 -5.15110546e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0043425224091813465
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.7050548948605635e-06, theta_kick=-2.0444249739378639e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.7278799726583451e-06, theta_kick=2.0717931010418745e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.013034717065228612
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.28713249049407e-06, theta_kick=-1.5433202862058653e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.446326757327401e-07, theta_kick=6.530350707457271e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.880159758967868e-08, theta_kick=-9.448608052687693e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011307195978364125
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.158864739661571e-07, theta_kick=1.3895224267098254e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642638e-01 -6.31903471e+00  1.18726686e-02 -9.11634828e-03]
 [ 1.80015627e-01  4.56477979e-01 -2.28346383e-03  1.59228049e-02]
 [ 8.62895142e-03 -9.10459679e-03  3.83739633e-01 -5.11858659e+00]
 [ 1.00508407e-03  1.84354323e-02  2.12559595e-01 -2.29772771e-01]]
compute_tune_4x4()/ evals =  [0.09084118+0.99586539j 0.09084118-0.99586539j 0.06355992+0.99797802j
 0.06355992-0.99797802j]
compute_tune_4x4()/ angles =  [0.23552221839332474, 0.23987730070951888, 0.7601226992904812, 0.7644777816066752]
compute_tune_4x4()/  0.23552221839332474 0.23987730070951888
compute_tunes()/ 0.23552221839332474 0.23987730070951888

 Running simulation ..
Closed orbit computation: x_co=[-1.09365478e-09 -1.44296961e-10], y_co=[-6.74005058e-08 -9.50227819e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 40/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.63070821e-03  6.74614313e-04 -1.54251534e-03  6.04838754e-05]
 [ 3.43463520e-03 -1.11741379e-04  3.05417772e-03  3.65813730e-04]
 [-2.02217720e-03 -3.47175841e-04 -6.47117340e-05  8.05587879e-04]
 [ 2.84727291e-03 -1.64099895e-04 -2.26843629e-03 -6.27752954e-04]
 [ 5.03287256e-04 -5.41297185e-04  1.19554480e-03  2.36356445e-04]
 [-2.33695481e-03 -5.66450381e-04  2.61868319e-03  1.12218684e-04]
 [ 1.85885459e-03  8.28667907e-05  1.46368117e-03 -2.94572251e-05]
 [ 2.07740942e-03 -3.76583254e-04  3.62162880e-03  6.87708756e-05]
 [-1.24834644e-03  2.69253725e-04 -1.72043801e-04  1.87434739e-04]
 [ 4.41322858e-03 -5.77753919e-04 -4.37934445e-05 -1.17978574e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004941073830583982
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0504714375868517e-05, theta_kick=-1.2595547790774194e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.3103311747742298e-05, theta_kick=2.770174007894275e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007235293305491282
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1805193483574115e-05, theta_kick=2.614524743674701e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00010459442621011284, theta_kick=-1.254126525328927e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00010005399559051369, theta_kick=1.199685053801409e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006396572822705917
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.0604788431157246e-05, theta_kick=-7.266742166621615e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01689295e-01 -6.31972451e+00  5.66234729e-03 -1.50892491e-02]
 [ 1.80011068e-01  4.56242121e-01 -1.37240786e-03  7.72012724e-03]
 [ 2.94975312e-03 -1.50850595e-02  3.83968843e-01 -5.11915432e+00]
 [ 5.67517012e-05  7.50887744e-03  2.12572132e-01 -2.29738828e-01]]
compute_tune_4x4()/ evals =  [0.08312351+0.99653925j 0.08312351-0.99653925j 0.07126791+0.99745721j
 0.07126791-0.99745721j]
compute_tune_4x4()/ angles =  [0.23675519924535657, 0.2386477366892787, 0.7613522633107213, 0.7632448007546434]
compute_tune_4x4()/  0.23675519924535657 0.2386477366892787
compute_tunes()/ 0.23675519924535657 0.2386477366892787

 Running simulation ..
Closed orbit computation: x_co=[-1.04536573e-07  3.80679520e-09], y_co=[-1.37040856e-05  1.04846569e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.0504714375868517e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.3103311747742298e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.1805193483574115e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00010459442621011284, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00010005399559051369, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.0604788431157246e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004941073830583982}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007235293305491282}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006396572822705917}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.63070821e-03  6.74614313e-04 -1.54251534e-03  6.04838754e-05]
 [ 3.43463520e-03 -1.11741379e-04  3.05417772e-03  3.65813730e-04]
 [-2.02217720e-03 -3.47175841e-04 -6.47117340e-05  8.05587879e-04]
 [ 2.84727291e-03 -1.64099895e-04 -2.26843629e-03 -6.27752954e-04]
 [ 5.03287256e-04 -5.41297185e-04  1.19554480e-03  2.36356445e-04]
 [-2.33695481e-03 -5.66450381e-04  2.61868319e-03  1.12218684e-04]
 [ 1.85885459e-03  8.28667907e-05  1.46368117e-03 -2.94572251e-05]
 [ 2.07740942e-03 -3.76583254e-04  3.62162880e-03  6.87708756e-05]
 [-1.24834644e-03  2.69253725e-04 -1.72043801e-04  1.87434739e-04]
 [ 4.41322858e-03 -5.77753919e-04 -4.37934445e-05 -1.17978574e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004941073830583982
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4261035151019852e-06, theta_kick=1.7099517736838036e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.541218725857856e-07, theta_kick=-1.1440280253582448e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007235293305491282
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.095086389709465e-06, theta_kick=-1.3130497853704408e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.0568518754281416e-06, theta_kick=3.6652804168308975e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.6657981566655213e-06, theta_kick=-1.9973546677540573e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006396572822705917
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.36919057224989e-07, theta_kick=4.0397862664867287e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01689295e-01 -6.31972451e+00  5.66234729e-03 -1.50892491e-02]
 [ 1.80011068e-01  4.56242121e-01 -1.37240786e-03  7.72012724e-03]
 [ 2.94975312e-03 -1.50850595e-02  3.83968843e-01 -5.11915432e+00]
 [ 5.67517012e-05  7.50887744e-03  2.12572132e-01 -2.29738828e-01]]
compute_tune_4x4()/ evals =  [0.08312351+0.99653925j 0.08312351-0.99653925j 0.07126791+0.99745721j
 0.07126791-0.99745721j]
compute_tune_4x4()/ angles =  [0.23675519924535657, 0.2386477366892787, 0.7613522633107213, 0.7632448007546434]
compute_tune_4x4()/  0.23675519924535657 0.2386477366892787
compute_tunes()/ 0.23675519924535657 0.2386477366892787

 Running simulation ..
Closed orbit computation: x_co=[2.51864799e-09 4.32369208e-11], y_co=[-8.99892990e-08  3.99843731e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 41/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.97124227e-04 -1.47008196e-04 -2.51264930e-03 -3.65811615e-05]
 [ 1.63802300e-03 -3.48369733e-04  4.14743773e-03  2.48758484e-04]
 [-1.53449758e-03  8.69509798e-04 -1.04087379e-03  2.33066451e-04]
 [ 1.83605318e-03 -2.54845197e-04  3.68206586e-04 -1.72763743e-04]
 [ 2.08817153e-03 -5.26843375e-04 -8.84512597e-04 -5.75998782e-04]
 [ 1.85337036e-03 -8.40625375e-04  9.12780167e-04 -4.44652314e-04]
 [ 2.38106281e-03 -6.05498660e-05  1.09439318e-03  1.32575540e-05]
 [-4.47152991e-03  8.97804574e-04 -1.24710874e-03 -5.92617818e-04]
 [ 3.86358203e-03  3.72694805e-04 -2.22873811e-03 -7.09176319e-04]
 [ 1.67527621e-03 -9.76584515e-05 -2.69359752e-03  5.46066783e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01762338000375961
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.369128026603673e-05, theta_kick=5.238748898258128e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.974930653143126e-05, theta_kick=3.5670537889142067e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01985565444358542
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1430423977588643e-06, theta_kick=1.3705508434314334e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.0020598329220202e-05, theta_kick=3.5995826962412385e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.2141973635462208e-05, theta_kick=2.654905951067024e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00035442408554643
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.7827687923380214e-05, theta_kick=-6.933757366522308e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01190147e-01 -6.31865144e+00 -1.67785118e-02 -1.38292244e-02]
 [ 1.79917693e-01  4.56163605e-01  3.14459303e-03 -3.04736597e-02]
 [-1.50901808e-02 -1.38217073e-02  3.83879924e-01 -5.11832457e+00]
 [-2.95993486e-03 -3.94760873e-02  2.12581301e-01 -2.30840118e-01]]
compute_tune_4x4()/ evals =  [0.10232206+0.99475132j 0.10232206-0.99475132j 0.05168457+0.99866346j
 0.05168457-0.99866346j]
compute_tune_4x4()/ angles =  [0.23368638595180233, 0.24177047903363624, 0.7582295209663638, 0.7663136140481976]
compute_tune_4x4()/  0.23368638595180233 0.24177047903363624
compute_tunes()/ 0.23368638595180233 0.24177047903363624

 Running simulation ..
Closed orbit computation: x_co=[ 5.23501107e-07 -7.31040421e-08], y_co=[-4.74835594e-05  6.08156114e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.369128026603673e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.974930653143126e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.1430423977588643e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.0020598329220202e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.2141973635462208e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.7827687923380214e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01762338000375961}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01985565444358542}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00035442408554643}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.97124227e-04 -1.47008196e-04 -2.51264930e-03 -3.65811615e-05]
 [ 1.63802300e-03 -3.48369733e-04  4.14743773e-03  2.48758484e-04]
 [-1.53449758e-03  8.69509798e-04 -1.04087379e-03  2.33066451e-04]
 [ 1.83605318e-03 -2.54845197e-04  3.68206586e-04 -1.72763743e-04]
 [ 2.08817153e-03 -5.26843375e-04 -8.84512597e-04 -5.75998782e-04]
 [ 1.85337036e-03 -8.40625375e-04  9.12780167e-04 -4.44652314e-04]
 [ 2.38106281e-03 -6.05498660e-05  1.09439318e-03  1.32575540e-05]
 [-4.47152991e-03  8.97804574e-04 -1.24710874e-03 -5.92617818e-04]
 [ 3.86358203e-03  3.72694805e-04 -2.22873811e-03 -7.09176319e-04]
 [ 1.67527621e-03 -9.76584515e-05 -2.69359752e-03  5.46066783e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01762338000375961
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.0387976176575912e-06, theta_kick=-3.643632682448103e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.302510953316571e-06, theta_kick=6.357910147183849e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01985565444358542
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.173678314210673e-06, theta_kick=-7.402472591747895e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.765440222190928e-06, theta_kick=5.713942132550441e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.9761360143999546e-06, theta_kick=-2.369461436059917e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00035442408554643
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.297334334784713e-07, theta_kick=1.1147853692205177e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01190147e-01 -6.31865144e+00 -1.67785118e-02 -1.38292244e-02]
 [ 1.79917693e-01  4.56163605e-01  3.14459303e-03 -3.04736597e-02]
 [-1.50901808e-02 -1.38217073e-02  3.83879924e-01 -5.11832457e+00]
 [-2.95993486e-03 -3.94760873e-02  2.12581301e-01 -2.30840118e-01]]
compute_tune_4x4()/ evals =  [0.10232206+0.99475132j 0.10232206-0.99475132j 0.05168457+0.99866346j
 0.05168457-0.99866346j]
compute_tune_4x4()/ angles =  [0.23368638595180233, 0.24177047903363624, 0.7582295209663638, 0.7663136140481976]
compute_tune_4x4()/  0.23368638595180233 0.24177047903363624
compute_tunes()/ 0.23368638595180233 0.24177047903363624

 Running simulation ..
Closed orbit computation: x_co=[-1.55756212e-08  3.34932255e-09], y_co=[-1.86366279e-08 -1.35264549e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 42/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.09991491e-03  2.75700550e-04  5.75594402e-03 -3.80416081e-04]
 [-1.12732192e-03 -3.79157415e-04  1.57755277e-04  5.05068202e-04]
 [ 1.20364753e-03  4.25835237e-04 -2.43563320e-04  2.92027359e-04]
 [ 6.82336525e-04  1.28271598e-04 -9.53130551e-04 -1.46362149e-04]
 [-1.33888035e-03  1.46547131e-04  1.36213194e-03  7.62561573e-04]
 [ 2.40591699e-03 -5.50991979e-04 -2.66223604e-03 -5.19619113e-04]
 [ 1.87060925e-03  5.74834859e-05 -1.54486331e-03  2.23053863e-05]
 [ 1.87676327e-03 -1.14382683e-04 -3.15638332e-03 -8.52801194e-04]
 [ 2.22543991e-03 -1.00557965e-03  1.24486193e-03  3.95156407e-04]
 [-4.23253213e-03  4.80489492e-04  9.81086712e-04 -2.13269057e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02170330054993584
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.398598490060266e-05, theta_kick=-8.871197971872423e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.77387475872557e-06, theta_kick=9.321168338280072e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010113242852069135
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.051279888319452e-05, theta_kick=9.653787526406904e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.563256173993347e-05, theta_kick=3.0734405986036988e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.2705856732883774e-05, theta_kick=2.722517656134406e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00242270402439812
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9338471754860198e-06, theta_kick=3.517793153381839e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01174066e-01 -6.31728462e+00  1.52015317e-02  7.07898365e-02]
 [ 1.79977440e-01  4.56116423e-01 -9.44148060e-04  2.20296958e-02]
 [ 1.99982116e-02  7.08116809e-02  3.83892850e-01 -5.12001301e+00]
 [ 4.68469823e-03  3.66759078e-02  2.12519105e-01 -2.30539078e-01]]
compute_tune_4x4()/ evals =  [0.10042359+0.99494477j 0.10042359-0.99494477j 0.05372447+0.9985558j
 0.05372447-0.9985558j ]
compute_tune_4x4()/ angles =  [0.23399010160876016, 0.24144536638808634, 0.7585546336119137, 0.7660098983912398]
compute_tune_4x4()/  0.23399010160876016 0.24144536638808634
compute_tunes()/ 0.23399010160876016 0.24144536638808634

 Running simulation ..
Closed orbit computation: x_co=[-3.31796296e-07 -1.98757395e-07], y_co=[-5.71420724e-05 -1.04671552e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.398598490060266e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.77387475872557e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.051279888319452e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.563256173993347e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.2705856732883774e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9338471754860198e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.02170330054993584}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.010113242852069135}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00242270402439812}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.09991491e-03  2.75700550e-04  5.75594402e-03 -3.80416081e-04]
 [-1.12732192e-03 -3.79157415e-04  1.57755277e-04  5.05068202e-04]
 [ 1.20364753e-03  4.25835237e-04 -2.43563320e-04  2.92027359e-04]
 [ 6.82336525e-04  1.28271598e-04 -9.53130551e-04 -1.46362149e-04]
 [-1.33888035e-03  1.46547131e-04  1.36213194e-03  7.62561573e-04]
 [ 2.40591699e-03 -5.50991979e-04 -2.66223604e-03 -5.19619113e-04]
 [ 1.87060925e-03  5.74834859e-05 -1.54486331e-03  2.23053863e-05]
 [ 1.87676327e-03 -1.14382683e-04 -3.15638332e-03 -8.52801194e-04]
 [ 2.22543991e-03 -1.00557965e-03  1.24486193e-03  3.95156407e-04]
 [-4.23253213e-03  4.80489492e-04  9.81086712e-04 -2.13269057e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02170330054993584
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.3126897843465586e-06, theta_kick=2.7730020695173774e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.3527591605260466e-06, theta_kick=-5.219122011930294e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010113242852069135
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.607280906463457e-06, theta_kick=6.723340788389287e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.164446237796193e-06, theta_kick=-7.391402984757552e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.288599935918398e-06, theta_kick=5.142192687547989e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00242270402439812
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.8396657800943526e-06, theta_kick=-2.2058284902500748e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01174066e-01 -6.31728462e+00  1.52015317e-02  7.07898365e-02]
 [ 1.79977440e-01  4.56116423e-01 -9.44148060e-04  2.20296958e-02]
 [ 1.99982116e-02  7.08116809e-02  3.83892850e-01 -5.12001301e+00]
 [ 4.68469823e-03  3.66759078e-02  2.12519105e-01 -2.30539078e-01]]
compute_tune_4x4()/ evals =  [0.10042359+0.99494477j 0.10042359-0.99494477j 0.05372447+0.9985558j
 0.05372447-0.9985558j ]
compute_tune_4x4()/ angles =  [0.23399010160876016, 0.24144536638808634, 0.7585546336119137, 0.7660098983912398]
compute_tune_4x4()/  0.23399010160876016 0.24144536638808634
compute_tunes()/ 0.23399010160876016 0.24144536638808634

 Running simulation ..
Closed orbit computation: x_co=[-6.71801164e-09  8.86003134e-10], y_co=[-2.61909710e-07  4.42514201e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 43/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.73815154e-03 -3.16975852e-04 -4.23154304e-03 -3.10063317e-04]
 [ 3.25118014e-03 -2.86787481e-06  4.95887665e-04  2.57487121e-04]
 [-1.39052174e-03 -4.26124890e-04  2.64265837e-03 -4.84502140e-04]
 [-3.91214165e-03 -4.09298034e-04  3.30074317e-04 -2.10733747e-04]
 [ 7.61853661e-04  1.30733710e-04 -5.44835406e-05  2.24280632e-04]
 [ 8.93563431e-04 -3.27561148e-04  4.68881359e-03  5.20092027e-05]
 [-1.73315496e-03 -2.86169528e-04 -2.42149076e-03 -1.52105600e-04]
 [-1.97064234e-03  2.60242412e-04 -3.55117375e-03 -3.02231159e-04]
 [-3.81650531e-03  2.88086231e-05  3.76080882e-03  7.22996241e-05]
 [ 8.67134388e-04 -5.23559005e-04  2.23285983e-03 -1.91860673e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.031091953617728804
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.557147559192778e-06, theta_kick=6.663229018676643e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.798294412572265e-06, theta_kick=1.174852367477397e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0021755456905912848
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.2239435025396064e-05, theta_kick=-3.865629564786352e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.840759520371814e-05, theta_kick=9.401365684123675e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.803571821763235e-05, theta_kick=1.175485148696361e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009522937224284253
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.277460442113892e-05, theta_kick=-2.7307607626286877e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00859041e-01 -6.31575116e+00  1.71220831e-02  1.75279230e-01]
 [ 1.80109432e-01  4.56665268e-01  2.16145783e-03  1.42725844e-02]
 [ 3.28881451e-02  1.75279817e-01  3.83679977e-01 -5.12365763e+00]
 [ 8.48097719e-03  4.11109182e-02  2.12481547e-01 -2.30786652e-01]]
compute_tune_4x4()/ evals =  [0.10338762+0.99464114j 0.10338762-0.99464114j 0.05096216+0.99870058j
 0.05096216-0.99870058j]
compute_tune_4x4()/ angles =  [0.23351589405195206, 0.24188560530582923, 0.7581143946941707, 0.766484105948048]
compute_tune_4x4()/  0.23351589405195206 0.24188560530582923
compute_tunes()/ 0.23351589405195206 0.24188560530582923

 Running simulation ..
Closed orbit computation: x_co=[ 1.54343552e-07 -3.84647629e-07], y_co=[-6.19997466e-05 -1.12068237e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.557147559192778e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -9.798294412572265e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.2239435025396064e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.840759520371814e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -9.803571821763235e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.277460442113892e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.031091953617728804}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0021755456905912848}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.009522937224284253}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.73815154e-03 -3.16975852e-04 -4.23154304e-03 -3.10063317e-04]
 [ 3.25118014e-03 -2.86787481e-06  4.95887665e-04  2.57487121e-04]
 [-1.39052174e-03 -4.26124890e-04  2.64265837e-03 -4.84502140e-04]
 [-3.91214165e-03 -4.09298034e-04  3.30074317e-04 -2.10733747e-04]
 [ 7.61853661e-04  1.30733710e-04 -5.44835406e-05  2.24280632e-04]
 [ 8.93563431e-04 -3.27561148e-04  4.68881359e-03  5.20092027e-05]
 [-1.73315496e-03 -2.86169528e-04 -2.42149076e-03 -1.52105600e-04]
 [-1.97064234e-03  2.60242412e-04 -3.55117375e-03 -3.02231159e-04]
 [-3.81650531e-03  2.88086231e-05  3.76080882e-03  7.22996241e-05]
 [ 8.67134388e-04 -5.23559005e-04  2.23285983e-03 -1.91860673e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.031091953617728804
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.449637595030467e-07, theta_kick=-1.133047103185631e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.872867541347493e-06, theta_kick=2.2456386512538315e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0021755456905912848
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.0562726452697595e-06, theta_kick=-2.4655482717221004e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.4948373106252063e-06, theta_kick=2.991403807072885e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5091390035575406e-06, theta_kick=-1.8095144486647456e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009522937224284253
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.886140084060193e-07, theta_kick=4.659628182072912e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00859041e-01 -6.31575116e+00  1.71220831e-02  1.75279230e-01]
 [ 1.80109432e-01  4.56665268e-01  2.16145783e-03  1.42725844e-02]
 [ 3.28881451e-02  1.75279817e-01  3.83679977e-01 -5.12365763e+00]
 [ 8.48097719e-03  4.11109182e-02  2.12481547e-01 -2.30786652e-01]]
compute_tune_4x4()/ evals =  [0.10338762+0.99464114j 0.10338762-0.99464114j 0.05096216+0.99870058j
 0.05096216-0.99870058j]
compute_tune_4x4()/ angles =  [0.23351589405195206, 0.24188560530582923, 0.7581143946941707, 0.766484105948048]
compute_tune_4x4()/  0.23351589405195206 0.24188560530582923
compute_tunes()/ 0.23351589405195206 0.24188560530582923

 Running simulation ..
Closed orbit computation: x_co=[ 4.71270558e-10 -1.60586256e-10], y_co=[-1.91920937e-07 -9.11088867e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 44/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.87816441e-03 -5.69446772e-04  2.63185615e-04 -6.65671129e-04]
 [ 9.54188401e-04 -8.23858426e-05 -5.12064641e-03 -9.67165533e-05]
 [ 2.79064565e-03 -4.88222295e-05  1.47312693e-03 -9.87084541e-05]
 [-9.68160255e-04  9.99622106e-04  1.75714546e-03  3.11794049e-04]
 [ 2.79223315e-04 -8.07294522e-05 -1.50664920e-03 -8.10769225e-04]
 [-4.14580683e-03 -3.28016317e-04  1.36902394e-03  1.98024019e-04]
 [-3.61892850e-06 -1.01397020e-03 -5.49694750e-04 -1.20375293e-05]
 [-3.43719161e-03 -2.96348372e-04  1.38885130e-03  4.90045591e-04]
 [ 3.75968322e-03 -5.09655382e-04 -1.20598499e-03 -8.24776903e-05]
 [-2.37844510e-04 -2.26647995e-04 -3.95527751e-03  1.94422493e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-7.498692365047437e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.464502242962314e-06, theta_kick=-7.751181424965375e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.423937510079338e-05, theta_kick=4.105429904871931e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0031676805469780527
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.462270987716062e-05, theta_kick=4.151393186907386e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.018978316506842e-05, theta_kick=-3.619868594640302e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00011443445133427515, theta_kick=-1.3721121290103769e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002964490237699189
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.505762241315363e-05, theta_kick=8.999691341808587e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01697804e-01 -6.32010378e+00 -2.11104369e-04 -2.12805971e-02]
 [ 1.80000100e-01  4.56095432e-01 -7.39024908e-04  2.82171185e-03]
 [-2.48018069e-03 -2.12814193e-02  3.84093723e-01 -5.11925958e+00]
 [-6.93268470e-04  6.32546655e-04  2.12581716e-01 -2.29747745e-01]]
compute_tune_4x4()/ evals =  [0.07737606+0.99700198j 0.07737606-0.99700198j 0.07699574+0.99703142j
 0.07699574-0.99703142j]
compute_tune_4x4()/ angles =  [0.23767289623461446, 0.23773360651080286, 0.7622663934891971, 0.7623271037653856]
compute_tune_4x4()/  0.23767289623461446 0.23773360651080286
compute_tunes()/ 0.23767289623461446 0.23773360651080286

 Running simulation ..
Closed orbit computation: x_co=[ 7.71326322e-10 -1.42791052e-08], y_co=[4.22020381e-05 8.80494168e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.464502242962314e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.423937510079338e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.462270987716062e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.018978316506842e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00011443445133427515, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.505762241315363e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -7.498692365047437e-05}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0031676805469780527}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002964490237699189}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.87816441e-03 -5.69446772e-04  2.63185615e-04 -6.65671129e-04]
 [ 9.54188401e-04 -8.23858426e-05 -5.12064641e-03 -9.67165533e-05]
 [ 2.79064565e-03 -4.88222295e-05  1.47312693e-03 -9.87084541e-05]
 [-9.68160255e-04  9.99622106e-04  1.75714546e-03  3.11794049e-04]
 [ 2.79223315e-04 -8.07294522e-05 -1.50664920e-03 -8.10769225e-04]
 [-4.14580683e-03 -3.28016317e-04  1.36902394e-03  1.98024019e-04]
 [-3.61892850e-06 -1.01397020e-03 -5.49694750e-04 -1.20375293e-05]
 [-3.43719161e-03 -2.96348372e-04  1.38885130e-03  4.90045591e-04]
 [ 3.75968322e-03 -5.09655382e-04 -1.20598499e-03 -8.24776903e-05]
 [-2.37844510e-04 -2.26647995e-04 -3.95527751e-03  1.94422493e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-7.498692365047437e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.482354743949172e-07, theta_kick=5.374511992663995e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3886137357018279e-06, theta_kick=-1.6650001175792823e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0031676805469780527
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.0086457177555466e-07, theta_kick=3.607479419959475e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0421048227464246e-06, theta_kick=1.2495228930785305e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.064030457384731e-06, theta_kick=-1.2758125539915634e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002964490237699189
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.0357608348397895e-07, theta_kick=4.8390290919410693e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01697804e-01 -6.32010378e+00 -2.11104369e-04 -2.12805971e-02]
 [ 1.80000100e-01  4.56095432e-01 -7.39024908e-04  2.82171185e-03]
 [-2.48018069e-03 -2.12814193e-02  3.84093723e-01 -5.11925958e+00]
 [-6.93268470e-04  6.32546655e-04  2.12581716e-01 -2.29747745e-01]]
compute_tune_4x4()/ evals =  [0.07737606+0.99700198j 0.07737606-0.99700198j 0.07699574+0.99703142j
 0.07699574-0.99703142j]
compute_tune_4x4()/ angles =  [0.23767289623461446, 0.23773360651080286, 0.7622663934891971, 0.7623271037653856]
compute_tune_4x4()/  0.23767289623461446 0.23773360651080286
compute_tunes()/ 0.23767289623461446 0.23773360651080286

 Running simulation ..
Closed orbit computation: x_co=[9.06728636e-11 5.49987944e-11], y_co=[ 2.08498328e-07 -2.42491847e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 45/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.75910005e-03  8.01560804e-04  1.07225215e-04 -6.90196848e-04]
 [-1.58647062e-03 -2.09459654e-04 -3.81829123e-06  3.40419662e-04]
 [-2.18870025e-04  4.79017754e-04 -4.50411538e-03 -2.90101178e-04]
 [-1.72012966e-03 -5.64910241e-05  2.34080579e-03 -1.12945124e-05]
 [ 3.03772355e-05 -1.55469906e-04  2.23435437e-03  4.52298495e-04]
 [ 5.14712123e-05 -2.48243007e-04  3.21573049e-04  6.58195259e-04]
 [-2.50185870e-03 -5.19861972e-04 -2.45792379e-03  4.01726896e-05]
 [ 3.51038997e-05  7.05200943e-05  1.18981947e-03 -2.90801607e-04]
 [-8.69968078e-04 -2.74941635e-04  4.19661714e-03  3.07008130e-04]
 [ 1.89257526e-03 -2.06258876e-04  1.19077673e-03 -4.20593639e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011405079479895002
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4283882341889612e-06, theta_kick=1.7126912378347384e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.9746365008211207e-05, theta_kick=2.3676634628576654e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009427077106619166
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.802518572624044e-05, theta_kick=-1.0554550975261218e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.7832726743335322e-05, theta_kick=2.138211034575858e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.291568741894525e-06, theta_kick=9.941902903037023e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0013366538680963558
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.432350116086567e-05, theta_kick=-4.115516936010296e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01679935e-01 -6.32006875e+00 -1.06758828e-03  6.94483925e-02]
 [ 1.80036349e-01  4.56409057e-01  2.28852707e-03 -5.88624263e-03]
 [ 6.66844439e-03  6.94314189e-02  3.83950378e-01 -5.11974100e+00]
 [ 2.39466422e-03  2.04162943e-03  2.12587846e-01 -2.29826740e-01]]
compute_tune_4x4()/ evals =  [0.07767562+0.99697869j 0.07767562-0.99697869j 0.07675076+0.99705031j
 0.07675076-0.99705031j]
compute_tune_4x4()/ angles =  [0.23762507647070097, 0.2377727119694454, 0.7622272880305546, 0.762374923529299]
compute_tune_4x4()/  0.23762507647070097 0.2377727119694454
compute_tunes()/ 0.23762507647070097 0.2377727119694454

 Running simulation ..
Closed orbit computation: x_co=[-1.39699040e-07  4.66928567e-08], y_co=[1.62631932e-05 1.84488512e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.4283882341889612e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.9746365008211207e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.802518572624044e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.7832726743335322e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.291568741894525e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.432350116086567e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011405079479895002}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009427077106619166}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0013366538680963558}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.75910005e-03  8.01560804e-04  1.07225215e-04 -6.90196848e-04]
 [-1.58647062e-03 -2.09459654e-04 -3.81829123e-06  3.40419662e-04]
 [-2.18870025e-04  4.79017754e-04 -4.50411538e-03 -2.90101178e-04]
 [-1.72012966e-03 -5.64910241e-05  2.34080579e-03 -1.12945124e-05]
 [ 3.03772355e-05 -1.55469906e-04  2.23435437e-03  4.52298495e-04]
 [ 5.14712123e-05 -2.48243007e-04  3.21573049e-04  6.58195259e-04]
 [-2.50185870e-03 -5.19861972e-04 -2.45792379e-03  4.01726896e-05]
 [ 3.51038997e-05  7.05200943e-05  1.18981947e-03 -2.90801607e-04]
 [-8.69968078e-04 -2.74941635e-04  4.19661714e-03  3.07008130e-04]
 [ 1.89257526e-03 -2.06258876e-04  1.19077673e-03 -4.20593639e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011405079479895002
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.038680374908662e-06, theta_kick=-2.444454477626142e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.862103029304628e-06, theta_kick=2.2327315962850894e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009427077106619166
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.43489402469413e-07, theta_kick=-8.914717683567081e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.026723408209614e-07, theta_kick=8.425305756429802e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.8598478184480943e-07, theta_kick=-4.628102766321897e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0013366538680963558
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.3168822694252952e-06, theta_kick=1.5789913905201352e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01679935e-01 -6.32006875e+00 -1.06758828e-03  6.94483925e-02]
 [ 1.80036349e-01  4.56409057e-01  2.28852707e-03 -5.88624263e-03]
 [ 6.66844439e-03  6.94314189e-02  3.83950378e-01 -5.11974100e+00]
 [ 2.39466422e-03  2.04162943e-03  2.12587846e-01 -2.29826740e-01]]
compute_tune_4x4()/ evals =  [0.07767562+0.99697869j 0.07767562-0.99697869j 0.07675076+0.99705031j
 0.07675076-0.99705031j]
compute_tune_4x4()/ angles =  [0.23762507647070097, 0.2377727119694454, 0.7622272880305546, 0.762374923529299]
compute_tune_4x4()/  0.23762507647070097 0.2377727119694454
compute_tunes()/ 0.23762507647070097 0.2377727119694454

 Running simulation ..
Closed orbit computation: x_co=[-1.32949513e-09 -1.27413235e-09], y_co=[-3.54027029e-08 -1.82660910e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 46/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 8.20531788e-04  2.35943159e-04  2.58115975e-03 -1.60758944e-04]
 [-1.92709539e-03 -6.27463226e-04  5.83659275e-04 -5.61268175e-05]
 [ 1.57140930e-03 -1.50604260e-05  3.79023002e-03 -5.41321457e-05]
 [ 3.46533348e-03  1.34563198e-04  5.34484566e-04  1.05016115e-04]
 [-2.30151564e-03 -9.02058983e-05  2.88049568e-03 -1.34036666e-04]
 [-1.12959949e-03 -4.29728034e-04  2.04845183e-03  1.42573647e-04]
 [-1.90287007e-03 -8.91975369e-05 -1.40455527e-03 -6.21030823e-04]
 [-1.62992618e-04 -6.50050035e-04 -1.00691521e-03  2.57550730e-05]
 [-3.70098446e-03  1.46915249e-04  1.64444007e-03  4.84553417e-04]
 [-4.38601431e-04 -2.68375609e-04 -2.19328845e-03 -3.01080721e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008420523898819601
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.45100473652526e-05, theta_kick=8.934035033239963e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.6551615534480165e-05, theta_kick=-6.780751485697975e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012366003876905741
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.21530772857236e-05, theta_kick=8.65142545228524e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.814717643630086e-06, theta_kick=-1.0569178120404033e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.194241222803298e-05, theta_kick=-6.228090666503163e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00812378675079827
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.885265168331356e-05, theta_kick=-2.2605038724849923e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01494499e-01 -6.32038579e+00  4.53407463e-03 -3.48783187e-02]
 [ 1.79977146e-01  4.56103056e-01 -2.39198515e-03  1.56579988e-02]
 [-1.12170600e-04 -3.49124547e-02  3.84082049e-01 -5.11969686e+00]
 [-3.09066952e-04  1.46526739e-02  2.12601340e-01 -2.30268453e-01]]
compute_tune_4x4()/ evals =  [0.08574416+0.99631719j 0.08574416-0.99631719j 0.06846692+0.99765339j
 0.06846692-0.99765339j]
compute_tune_4x4()/ angles =  [0.2363366160911196, 0.23909461986617056, 0.7609053801338295, 0.7636633839088804]
compute_tune_4x4()/  0.2363366160911196 0.23909461986617056
compute_tunes()/ 0.2363366160911196 0.23909461986617056

 Running simulation ..
Closed orbit computation: x_co=[-3.80677456e-07  4.41816009e-08], y_co=[-3.95715461e-06  1.06356333e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.45100473652526e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.6551615534480165e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.21530772857236e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 8.814717643630086e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.194241222803298e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.885265168331356e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.008420523898819601}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.012366003876905741}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00812378675079827}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 8.20531788e-04  2.35943159e-04  2.58115975e-03 -1.60758944e-04]
 [-1.92709539e-03 -6.27463226e-04  5.83659275e-04 -5.61268175e-05]
 [ 1.57140930e-03 -1.50604260e-05  3.79023002e-03 -5.41321457e-05]
 [ 3.46533348e-03  1.34563198e-04  5.34484566e-04  1.05016115e-04]
 [-2.30151564e-03 -9.02058983e-05  2.88049568e-03 -1.34036666e-04]
 [-1.12959949e-03 -4.29728034e-04  2.04845183e-03  1.42573647e-04]
 [-1.90287007e-03 -8.91975369e-05 -1.40455527e-03 -6.21030823e-04]
 [-1.62992618e-04 -6.50050035e-04 -1.00691521e-03  2.57550730e-05]
 [-3.70098446e-03  1.46915249e-04  1.64444007e-03  4.84553417e-04]
 [-4.38601431e-04 -2.68375609e-04 -2.19328845e-03 -3.01080721e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.008420523898819601
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1346351455033502e-06, theta_kick=-1.3604702316428175e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.244306890629728e-06, theta_kick=3.890046033306469e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012366003876905741
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.877042142221869e-06, theta_kick=-5.847757033840954e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.490120277538569e-06, theta_kick=5.383823159626403e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.2184633230213385e-06, theta_kick=-2.660020996990194e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00812378675079827
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.445794477800642e-08, theta_kick=7.728750110631525e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01494499e-01 -6.32038579e+00  4.53407463e-03 -3.48783187e-02]
 [ 1.79977146e-01  4.56103056e-01 -2.39198515e-03  1.56579988e-02]
 [-1.12170600e-04 -3.49124547e-02  3.84082049e-01 -5.11969686e+00]
 [-3.09066952e-04  1.46526739e-02  2.12601340e-01 -2.30268453e-01]]
compute_tune_4x4()/ evals =  [0.08574416+0.99631719j 0.08574416-0.99631719j 0.06846692+0.99765339j
 0.06846692-0.99765339j]
compute_tune_4x4()/ angles =  [0.2363366160911196, 0.23909461986617056, 0.7609053801338295, 0.7636633839088804]
compute_tune_4x4()/  0.2363366160911196 0.23909461986617056
compute_tunes()/ 0.2363366160911196 0.23909461986617056

 Running simulation ..
Closed orbit computation: x_co=[ 4.42076491e-09 -6.58515749e-10], y_co=[-7.71932645e-08  2.70343612e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 47/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.86477585e-03  1.18373339e-04  9.54964458e-04 -1.87317531e-04]
 [-2.80731144e-03  5.22199139e-04 -3.12966159e-03 -3.00921969e-05]
 [-8.15510308e-04 -2.45942527e-04  2.37036123e-03 -2.04034060e-06]
 [ 2.25134389e-04 -5.90573006e-04  2.59349938e-03  3.87084931e-04]
 [ 2.31332497e-03 -2.50578198e-04  1.25485496e-03 -1.67958514e-04]
 [-4.01752269e-04  6.47733388e-04  1.59870866e-03  4.00035875e-04]
 [ 5.13646692e-03 -3.16195889e-04  2.51123247e-03  1.08573472e-03]
 [ 2.05674967e-03 -6.07762449e-05 -1.03591972e-03  1.44611793e-04]
 [ 7.46212385e-03 -9.11509375e-05  2.07912064e-03  3.71631095e-04]
 [-4.27389226e-04 -1.35019773e-04  1.91581771e-03  4.64435623e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0030079398477166875
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.00822046079213e-05, theta_kick=1.208894268150314e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.3828486153703715e-05, theta_kick=-4.056162774090559e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01204332556049499
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.0001129522285978003, theta_kick=1.354339720693661e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00010040238384495324, theta_kick=1.203862360057939e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.977383702617662e-05, theta_kick=5.96807034024264e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00010447902194638044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.196387556085557e-06, theta_kick=-9.827777079931024e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01714012e-01 -6.32056927e+00  4.82036194e-03 -4.81462535e-02]
 [ 1.80005215e-01  4.56307701e-01 -2.49673549e-03  1.22827178e-02]
 [-1.31931694e-03 -4.81427831e-02  3.84008087e-01 -5.11892450e+00]
 [-1.02832864e-03  8.71262392e-03  2.12607221e-01 -2.29837109e-01]]
compute_tune_4x4()/ evals =  [0.08328229+0.996526j   0.08328229-0.996526j   0.07110004+0.99746919j
 0.07110004-0.99746919j]
compute_tune_4x4()/ angles =  [0.23672984147769136, 0.23867452078160464, 0.7613254792183953, 0.7632701585223086]
compute_tune_4x4()/  0.23672984147769136 0.23867452078160464
compute_tunes()/ 0.23672984147769136 0.23867452078160464

 Running simulation ..
Closed orbit computation: x_co=[-5.67282731e-07  1.05296536e-07], y_co=[-1.10093970e-04 -1.09680294e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.00822046079213e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.3828486153703715e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.0001129522285978003, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00010040238384495324, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.977383702617662e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 8.196387556085557e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0030079398477166875}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01204332556049499}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00010447902194638044}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.86477585e-03  1.18373339e-04  9.54964458e-04 -1.87317531e-04]
 [-2.80731144e-03  5.22199139e-04 -3.12966159e-03 -3.00921969e-05]
 [-8.15510308e-04 -2.45942527e-04  2.37036123e-03 -2.04034060e-06]
 [ 2.25134389e-04 -5.90573006e-04  2.59349938e-03  3.87084931e-04]
 [ 2.31332497e-03 -2.50578198e-04  1.25485496e-03 -1.67958514e-04]
 [-4.01752269e-04  6.47733388e-04  1.59870866e-03  4.00035875e-04]
 [ 5.13646692e-03 -3.16195889e-04  2.51123247e-03  1.08573472e-03]
 [ 2.05674967e-03 -6.07762449e-05 -1.03591972e-03  1.44611793e-04]
 [ 7.46212385e-03 -9.11509375e-05  2.07912064e-03  3.71631095e-04]
 [-4.27389226e-04 -1.35019773e-04  1.91581771e-03  4.64435623e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0030079398477166875
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9224646166787684e-06, theta_kick=2.305107410733173e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.584205729618269e-06, theta_kick=-4.297597530407966e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01204332556049499
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.974026846203076e-06, theta_kick=4.765007716740704e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.630945806272121e-06, theta_kick=-3.1546030146200547e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6928902999177763e-06, theta_kick=2.0298391668920996e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00010447902194638044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.061971419107596e-06, theta_kick=-1.2733436896231742e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01714012e-01 -6.32056927e+00  4.82036194e-03 -4.81462535e-02]
 [ 1.80005215e-01  4.56307701e-01 -2.49673549e-03  1.22827178e-02]
 [-1.31931694e-03 -4.81427831e-02  3.84008087e-01 -5.11892450e+00]
 [-1.02832864e-03  8.71262392e-03  2.12607221e-01 -2.29837109e-01]]
compute_tune_4x4()/ evals =  [0.08328229+0.996526j   0.08328229-0.996526j   0.07110004+0.99746919j
 0.07110004-0.99746919j]
compute_tune_4x4()/ angles =  [0.23672984147769136, 0.23867452078160464, 0.7613254792183953, 0.7632701585223086]
compute_tune_4x4()/  0.23672984147769136 0.23867452078160464
compute_tunes()/ 0.23672984147769136 0.23867452078160464

 Running simulation ..
Closed orbit computation: x_co=[-8.23823660e-09  8.85847824e-10], y_co=[-3.92204581e-07  4.08983390e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 48/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.30940743e-03  2.50244214e-04 -2.08554227e-03  5.55795101e-04]
 [ 9.88106602e-05 -3.29303321e-04 -4.13023166e-04 -5.67881795e-04]
 [-6.62099846e-04  5.57455489e-04  2.05000031e-03  5.52919060e-04]
 [ 2.97825283e-03  6.38247057e-04 -1.74300803e-04 -1.63231545e-04]
 [-1.46700322e-03 -3.94226392e-04  1.16138264e-03 -4.22373778e-04]
 [-1.52869022e-03  7.15855012e-04 -1.24865064e-03  3.66186025e-04]
 [-7.24454121e-04 -3.38485902e-04  1.49329568e-03  5.04862902e-04]
 [-1.57040223e-03  8.96677673e-05  4.16272214e-03  4.02823073e-04]
 [ 1.01342849e-03  3.23519146e-04 -1.97874494e-03 -5.74182743e-04]
 [ 2.49343780e-03 -2.42420321e-04  9.98646682e-04  3.36379376e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00406201525336752
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.686989992469458e-05, theta_kick=-2.0227644762545053e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.522653608366806e-05, theta_kick=-7.820907100109254e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01598162473396136
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.975073760096528e-05, theta_kick=4.766263005890506e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.756666943300188e-05, theta_kick=3.3053473883447863e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3020594836265462e-05, theta_kick=-1.5612183126200407e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003431896886170208
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.977956794106868e-05, theta_kick=9.565870377565274e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01606428e-01 -6.32086850e+00 -7.54289385e-03  4.40648577e-02]
 [ 1.79976052e-01  4.56264158e-01  3.09848599e-03 -1.90617736e-02]
 [-1.32757270e-03  4.40853809e-02  3.84028785e-01 -5.11872781e+00]
 [ 3.66482835e-04 -1.76285079e-02  2.12626401e-01 -2.30149203e-01]]
compute_tune_4x4()/ evals =  [0.08846389+0.99607938j 0.08846389-0.99607938j 0.06580477+0.99783252j
 0.06580477-0.99783252j]
compute_tune_4x4()/ angles =  [0.2359021057051681, 0.23951927280976476, 0.7604807271902352, 0.7640978942948319]
compute_tune_4x4()/  0.2359021057051681 0.23951927280976476
compute_tunes()/ 0.2359021057051681 0.23951927280976476

 Running simulation ..
Closed orbit computation: x_co=[-4.34803359e-07  5.95656324e-08], y_co=[ 1.29093255e-05 -1.12982088e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.686989992469458e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.522653608366806e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.975073760096528e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.756666943300188e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.3020594836265462e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.977956794106868e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00406201525336752}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01598162473396136}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.003431896886170208}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.30940743e-03  2.50244214e-04 -2.08554227e-03  5.55795101e-04]
 [ 9.88106602e-05 -3.29303321e-04 -4.13023166e-04 -5.67881795e-04]
 [-6.62099846e-04  5.57455489e-04  2.05000031e-03  5.52919060e-04]
 [ 2.97825283e-03  6.38247057e-04 -1.74300803e-04 -1.63231545e-04]
 [-1.46700322e-03 -3.94226392e-04  1.16138264e-03 -4.22373778e-04]
 [-1.52869022e-03  7.15855012e-04 -1.24865064e-03  3.66186025e-04]
 [-7.24454121e-04 -3.38485902e-04  1.49329568e-03  5.04862902e-04]
 [-1.57040223e-03  8.96677673e-05  4.16272214e-03  4.02823073e-04]
 [ 1.01342849e-03  3.23519146e-04 -1.97874494e-03 -5.74182743e-04]
 [ 2.49343780e-03 -2.42420321e-04  9.98646682e-04  3.36379376e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00406201525336752
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.2369812298901193e-06, theta_kick=2.682224664087192e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.016858714334256e-06, theta_kick=-4.816364738237045e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01598162473396136
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1328725824187005e-06, theta_kick=2.5573944785400767e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.101935067124213e-06, theta_kick=-1.3212616072814883e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0121098757426645e-06, theta_kick=1.213557823020511e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003431896886170208
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2710783174494175e-06, theta_kick=-1.5240707286653198e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01606428e-01 -6.32086850e+00 -7.54289385e-03  4.40648577e-02]
 [ 1.79976052e-01  4.56264158e-01  3.09848599e-03 -1.90617736e-02]
 [-1.32757270e-03  4.40853809e-02  3.84028785e-01 -5.11872781e+00]
 [ 3.66482835e-04 -1.76285079e-02  2.12626401e-01 -2.30149203e-01]]
compute_tune_4x4()/ evals =  [0.08846389+0.99607938j 0.08846389-0.99607938j 0.06580477+0.99783252j
 0.06580477-0.99783252j]
compute_tune_4x4()/ angles =  [0.2359021057051681, 0.23951927280976476, 0.7604807271902352, 0.7640978942948319]
compute_tune_4x4()/  0.2359021057051681 0.23951927280976476
compute_tunes()/ 0.2359021057051681 0.23951927280976476

 Running simulation ..
Closed orbit computation: x_co=[ 4.31494802e-09 -8.17928726e-10], y_co=[4.28485211e-08 3.70505855e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 49/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.46581106e-03 -5.84729312e-04  5.36048651e-04  2.30399313e-04]
 [-3.04696387e-03  7.30466855e-04 -6.19042203e-04 -2.89631159e-04]
 [ 1.80578412e-03 -4.37899746e-04  2.93177781e-03  3.69338555e-04]
 [ 1.08609643e-03 -4.52591165e-04  6.41488591e-04  1.98227082e-04]
 [-1.13950500e-03  2.92599254e-04  4.04936954e-03  3.75820523e-04]
 [ 4.76774171e-03 -2.59710657e-04  2.35010711e-04 -5.87179974e-04]
 [-2.29780690e-03 -2.08540054e-04 -3.41244242e-04  5.28280940e-04]
 [ 2.98504426e-03 -4.78818389e-04 -1.16841090e-03  2.32514487e-04]
 [ 2.03372252e-03 -2.31165507e-04 -1.28636583e-03 -4.10794759e-04]
 [-9.74874055e-04 -4.79321415e-05 -1.05569549e-04  3.94340893e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004031027524304541
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.966784965657013e-06, theta_kick=-1.1950550187607875e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.4787274596831655e-06, theta_kick=4.1711251159929917e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002928011422556646
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1210545503490288e-05, theta_kick=2.543224213419075e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00011702568779799754, theta_kick=1.403182029198228e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.345382512312976e-06, theta_kick=-5.210277133166441e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010841146382253988
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0831120418728893e-05, theta_kick=-1.2986920917633289e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01574988e-01 -6.31916721e+00  9.80030584e-03  5.33242053e-02]
 [ 1.80005135e-01  4.56138360e-01  4.24516896e-05  8.12609087e-03]
 [ 1.37245557e-02  5.33201576e-02  3.83982483e-01 -5.11944998e+00]
 [ 2.96971182e-03  1.71750533e-02  2.12555155e-01 -2.29809595e-01]]
compute_tune_4x4()/ evals =  [0.08932366+0.99600265j 0.08932366-0.99600265j 0.06504447+0.99788237j
 0.06504447-0.99788237j]
compute_tune_4x4()/ angles =  [0.23576472522404246, 0.23964053741909477, 0.7603594625809053, 0.7642352747759575]
compute_tune_4x4()/  0.23576472522404246 0.23964053741909477
compute_tunes()/ 0.23576472522404246 0.23964053741909477

 Running simulation ..
Closed orbit computation: x_co=[-4.84511930e-08  2.72646939e-08], y_co=[-6.85996523e-05 -6.33915540e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.966784965657013e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.4787274596831655e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.1210545503490288e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00011702568779799754, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.345382512312976e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.0831120418728893e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004031027524304541}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.002928011422556646}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010841146382253988}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.46581106e-03 -5.84729312e-04  5.36048651e-04  2.30399313e-04]
 [-3.04696387e-03  7.30466855e-04 -6.19042203e-04 -2.89631159e-04]
 [ 1.80578412e-03 -4.37899746e-04  2.93177781e-03  3.69338555e-04]
 [ 1.08609643e-03 -4.52591165e-04  6.41488591e-04  1.98227082e-04]
 [-1.13950500e-03  2.92599254e-04  4.04936954e-03  3.75820523e-04]
 [ 4.76774171e-03 -2.59710657e-04  2.35010711e-04 -5.87179974e-04]
 [-2.29780690e-03 -2.08540054e-04 -3.41244242e-04  5.28280940e-04]
 [ 2.98504426e-03 -4.78818389e-04 -1.16841090e-03  2.32514487e-04]
 [ 2.03372252e-03 -2.31165507e-04 -1.28636583e-03 -4.10794759e-04]
 [-9.74874055e-04 -4.79321415e-05 -1.05569549e-04  3.94340893e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004031027524304541
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.7880319876739186e-06, theta_kick=-2.1439176303465926e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.344648869674808e-06, theta_kick=4.0103598416844027e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.002928011422556646
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.103960770808477e-06, theta_kick=-4.920803381282498e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.7604845441658225e-06, theta_kick=4.508962461779663e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.1073845795604982e-06, theta_kick=-2.526833404092459e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010841146382253988
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.509236825563898e-07, theta_kick=7.804819872703942e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01574988e-01 -6.31916721e+00  9.80030584e-03  5.33242053e-02]
 [ 1.80005135e-01  4.56138360e-01  4.24516896e-05  8.12609087e-03]
 [ 1.37245557e-02  5.33201576e-02  3.83982483e-01 -5.11944998e+00]
 [ 2.96971182e-03  1.71750533e-02  2.12555155e-01 -2.29809595e-01]]
compute_tune_4x4()/ evals =  [0.08932366+0.99600265j 0.08932366-0.99600265j 0.06504447+0.99788237j
 0.06504447-0.99788237j]
compute_tune_4x4()/ angles =  [0.23576472522404246, 0.23964053741909477, 0.7603594625809053, 0.7642352747759575]
compute_tune_4x4()/  0.23576472522404246 0.23964053741909477
compute_tunes()/ 0.23576472522404246 0.23964053741909477

 Running simulation ..
Closed orbit computation: x_co=[ 1.16159372e-09 -6.09084784e-11], y_co=[ 7.82021564e-09 -3.89169999e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 50/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.54586456e-03 -3.91953980e-04 -3.34662781e-04  1.20055964e-04]
 [ 1.20531973e-03  4.60534835e-04  4.26102183e-04 -2.39341481e-04]
 [-2.20833785e-03  3.17110342e-04  3.48861342e-04  8.02849409e-05]
 [ 1.33609323e-03 -6.09936279e-04  1.34725190e-04 -3.70837626e-04]
 [ 3.54019016e-04  6.59900144e-05 -1.57113650e-03 -3.06247724e-05]
 [-2.20959794e-03  1.48028945e-05  8.54106321e-04  4.99227121e-04]
 [ 2.96111886e-03 -4.24153325e-04 -2.73805529e-03  6.76815973e-04]
 [ 7.60657148e-04 -5.77971149e-04  3.45963253e-04 -1.83633543e-04]
 [-2.22747313e-03 -8.70400800e-05  2.97931069e-03 -6.48624136e-04]
 [-2.44993679e-03  6.10002358e-04  1.25096965e-03  4.86241435e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004792029967935114
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.684556698229861e-05, theta_kick=3.218884491259814e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5880815389525207e-05, theta_kick=-1.904169518923155e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004136081363378254
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.5485354471998773e-05, theta_kick=-5.453865146000198e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.2637853710469456e-05, theta_kick=5.112439090585501e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.910501048152714e-05, theta_kick=2.2907626419249626e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010126673102791368
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.0772321895322344e-05, theta_kick=3.6897171802786294e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01578007e-01 -6.31987165e+00  2.29731752e-03  3.42768359e-02]
 [ 1.80002279e-01  4.56090989e-01  1.01665425e-03 -4.11034221e-03]
 [ 5.58025903e-03  3.42866150e-02  3.84060117e-01 -5.11991317e+00]
 [ 1.21358217e-03 -4.80412716e-04  2.12572832e-01 -2.29938355e-01]]
compute_tune_4x4()/ evals =  [0.07798134+0.99695482j 0.07798134-0.99695482j 0.07633603+0.99708215j
 0.07633603-0.99708215j]
compute_tune_4x4()/ angles =  [0.23757627092368902, 0.23783891272463772, 0.7621610872753622, 0.762423729076311]
compute_tune_4x4()/  0.23757627092368902 0.23783891272463772
compute_tunes()/ 0.23757627092368902 0.23783891272463772

 Running simulation ..
Closed orbit computation: x_co=[-1.84732466e-07  9.02145850e-09], y_co=[ 7.11970513e-06 -4.79072867e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.684556698229861e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.5880815389525207e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.5485354471998773e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.2637853710469456e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.910501048152714e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.0772321895322344e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004792029967935114}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004136081363378254}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010126673102791368}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.54586456e-03 -3.91953980e-04 -3.34662781e-04  1.20055964e-04]
 [ 1.20531973e-03  4.60534835e-04  4.26102183e-04 -2.39341481e-04]
 [-2.20833785e-03  3.17110342e-04  3.48861342e-04  8.02849409e-05]
 [ 1.33609323e-03 -6.09936279e-04  1.34725190e-04 -3.70837626e-04]
 [ 3.54019016e-04  6.59900144e-05 -1.57113650e-03 -3.06247724e-05]
 [-2.20959794e-03  1.48028945e-05  8.54106321e-04  4.99227121e-04]
 [ 2.96111886e-03 -4.24153325e-04 -2.73805529e-03  6.76815973e-04]
 [ 7.60657148e-04 -5.77971149e-04  3.45963253e-04 -1.83633543e-04]
 [-2.22747313e-03 -8.70400800e-05  2.97931069e-03 -6.48624136e-04]
 [-2.44993679e-03  6.10002358e-04  1.25096965e-03  4.86241435e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004792029967935114
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.3453146050567597e-06, theta_kick=1.613082830747403e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.261997730895939e-06, theta_kick=-1.5131827637183293e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004136081363378254
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.28597605274506e-07, theta_kick=1.1134234684668887e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.140100819760548e-07, theta_kick=-6.163174286148906e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.837667558799208e-07, theta_kick=5.800545426795146e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010126673102791368
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.2279813123354095e-08, theta_kick=-6.2685463033687384e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01578007e-01 -6.31987165e+00  2.29731752e-03  3.42768359e-02]
 [ 1.80002279e-01  4.56090989e-01  1.01665425e-03 -4.11034221e-03]
 [ 5.58025903e-03  3.42866150e-02  3.84060117e-01 -5.11991317e+00]
 [ 1.21358217e-03 -4.80412716e-04  2.12572832e-01 -2.29938355e-01]]
compute_tune_4x4()/ evals =  [0.07798134+0.99695482j 0.07798134-0.99695482j 0.07633603+0.99708215j
 0.07633603-0.99708215j]
compute_tune_4x4()/ angles =  [0.23757627092368902, 0.23783891272463772, 0.7621610872753622, 0.762423729076311]
compute_tune_4x4()/  0.23757627092368902 0.23783891272463772
compute_tunes()/ 0.23757627092368902 0.23783891272463772

 Running simulation ..
Closed orbit computation: x_co=[-5.29861921e-10  2.27308728e-10], y_co=[-1.85755379e-08  4.27100319e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
Completed benchmarking for noise_level=2e-05 meters.
Running evaluation for noise_level= 3.0000000000000004e-05
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.77894395e-04  5.30216647e-04  2.13803380e-03  1.01384748e-04]
 [ 4.33130274e-03 -7.55674208e-04  4.23330782e-04  2.63075494e-04]
 [ 2.33014823e-03 -4.18546639e-04 -2.10868253e-03  4.29315223e-04]
 [ 4.35138107e-03 -2.86126410e-05 -9.08708115e-04  3.27361658e-04]
 [ 1.08262590e-03 -2.40534289e-04  2.47190550e-03 -2.35665006e-04]
 [-4.69316535e-05  1.36158930e-04 -1.03853774e-03 -2.15826923e-04]
 [ 1.40847203e-03  1.00741024e-04  1.79443454e-03  8.86068843e-04]
 [-1.85489615e-03 -6.23075312e-04 -1.70800904e-03 -8.96104269e-06]
 [ 7.64383621e-05  4.58292583e-04 -3.16078135e-03  3.28541887e-06]
 [ 5.77520898e-04 -8.21068743e-05  8.70484428e-04  5.25107762e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009272470318023522
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.748771636093848e-05, theta_kick=-8.092031123351065e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.5925260630741364e-05, theta_kick=-3.1085362969307904e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0036039723591030854
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.995453627041183e-05, theta_kick=3.5916616068226703e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.704609093575438e-05, theta_kick=4.441965694132276e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.0943574116855275e-06, theta_kick=8.50640147141842e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009034994639023505
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.433795304534436e-05, theta_kick=-7.714362650400196e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01549523e-01 -6.31959838e+00  1.13317808e-04  9.53871934e-03]
 [ 1.80002160e-01  4.56091831e-01  6.73553663e-04 -5.84385935e-03]
 [ 1.12698846e-03  9.54624088e-03  3.84041012e-01 -5.12003066e+00]
 [ 4.17922869e-05 -5.93448262e-03  2.12564011e-01 -2.29994105e-01]]
compute_tune_4x4()/ evals =  [0.07977046+0.99681326j 0.07977046-0.99681326j 0.07452415+0.99721921j
 0.07452415-0.99721921j]
compute_tune_4x4()/ angles =  [0.23729063366261627, 0.23812810706125934, 0.7618718929387407, 0.7627093663373837]
compute_tune_4x4()/  0.23729063366261627 0.23812810706125934
compute_tunes()/ 0.23729063366261627 0.23812810706125934

 Running simulation ..
Closed orbit computation: x_co=[1.72433378e-07 2.08089030e-08], y_co=[-4.00430168e-05 -6.27708552e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.748771636093848e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.5925260630741364e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.995453627041183e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.704609093575438e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.0943574116855275e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.433795304534436e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009272470318023522}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0036039723591030854}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.009034994639023505}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.77894395e-04  5.30216647e-04  2.13803380e-03  1.01384748e-04]
 [ 4.33130274e-03 -7.55674208e-04  4.23330782e-04  2.63075494e-04]
 [ 2.33014823e-03 -4.18546639e-04 -2.10868253e-03  4.29315223e-04]
 [ 4.35138107e-03 -2.86126410e-05 -9.08708115e-04  3.27361658e-04]
 [ 1.08262590e-03 -2.40534289e-04  2.47190550e-03 -2.35665006e-04]
 [-4.69316535e-05  1.36158930e-04 -1.03853774e-03 -2.15826923e-04]
 [ 1.40847203e-03  1.00741024e-04  1.79443454e-03  8.86068843e-04]
 [-1.85489615e-03 -6.23075312e-04 -1.70800904e-03 -8.96104269e-06]
 [ 7.64383621e-05  4.58292583e-04 -3.16078135e-03  3.28541887e-06]
 [ 5.77520898e-04 -8.21068743e-05  8.70484428e-04  5.25107762e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009272470318023522
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4585901871218558e-06, theta_kick=-1.748904515790669e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.6389760529132347e-06, theta_kick=4.3632692088462346e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0036039723591030854
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.1365662526188827e-06, theta_kick=-3.760860954444017e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.158456216815626e-07, theta_kick=9.782295976928354e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.798448629666788e-08, theta_kick=1.0549670960518351e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009034994639023505
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.719464809022932e-07, theta_kick=-4.459778255920238e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01549523e-01 -6.31959838e+00  1.13317808e-04  9.53871934e-03]
 [ 1.80002160e-01  4.56091831e-01  6.73553663e-04 -5.84385935e-03]
 [ 1.12698846e-03  9.54624088e-03  3.84041012e-01 -5.12003066e+00]
 [ 4.17922869e-05 -5.93448262e-03  2.12564011e-01 -2.29994105e-01]]
compute_tune_4x4()/ evals =  [0.07977046+0.99681326j 0.07977046-0.99681326j 0.07452415+0.99721921j
 0.07452415-0.99721921j]
compute_tune_4x4()/ angles =  [0.23729063366261627, 0.23812810706125934, 0.7618718929387407, 0.7627093663373837]
compute_tune_4x4()/  0.23729063366261627 0.23812810706125934
compute_tunes()/ 0.23729063366261627 0.23812810706125934

 Running simulation ..
Closed orbit computation: x_co=[-6.65969180e-10  3.03900214e-11], y_co=[-9.22940747e-08  4.14417608e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.33821127e-03 -5.01467557e-05  3.78423361e-04 -1.43574544e-05]
 [-7.39526825e-04  4.59319499e-04  1.95857174e-03 -5.68074191e-04]
 [ 3.06827612e-03 -5.96031261e-04  3.08054148e-03  3.44007167e-04]
 [ 4.74790994e-03 -3.62632588e-04  3.74779199e-03  2.99470805e-04]
 [-1.55963564e-03  3.71834662e-04  1.08518066e-03  6.45688484e-04]
 [ 2.12970497e-03 -3.24297715e-04  4.78100899e-03  6.04990548e-04]
 [-5.98406582e-03  6.75209380e-04  1.75863317e-03 -4.92788220e-05]
 [-2.90531153e-03 -1.71845088e-04  7.70685090e-04  1.61178217e-04]
 [ 1.63860038e-03 -1.75428711e-05 -3.49183591e-03 -8.35558460e-04]
 [ 9.80742505e-05 -1.30444064e-05  3.55227630e-03  5.65632480e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0012138000566556822
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.993818656284106e-05, theta_kick=-5.9877764680761e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.1228001452269483e-06, theta_kick=-2.5453172473580725e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01905125020944617
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.766706022414315e-05, theta_kick=-5.71545987464573e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.000108944411667e-05, theta_kick=-4.79628113386708e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.95843045104685e-05, theta_kick=2.3482317994037396e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0008819522267630635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.898204257312604e-05, theta_kick=9.470244085151724e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686109e-01 -6.32130619e+00  8.58325240e-03 -6.43840703e-02]
 [ 1.79993589e-01  4.56524981e-01 -3.82471799e-03  2.08437063e-02]
 [-3.33590285e-05 -6.43856458e-02  3.83921517e-01 -5.11831765e+00]
 [-1.03708660e-03  1.71056956e-02  2.12648325e-01 -2.30084351e-01]]
compute_tune_4x4()/ evals =  [0.08873243+0.9960555j  0.08873243-0.9960555j  0.06560558+0.99784563j
 0.06560558-0.99784563j]
compute_tune_4x4()/ angles =  [0.23585919675570652, 0.23955104218642342, 0.7604489578135766, 0.7641408032442935]
compute_tune_4x4()/  0.23585919675570652 0.23955104218642342
compute_tunes()/ 0.23585919675570652 0.23955104218642342

 Running simulation ..
Closed orbit computation: x_co=[ 1.15428720e-06 -1.12168292e-07], y_co=[ 5.84747407e-05 -9.96787897e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.993818656284106e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.1228001452269483e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.766706022414315e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.000108944411667e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.95843045104685e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.898204257312604e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0012138000566556822}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01905125020944617}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0008819522267630635}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.33821127e-03 -5.01467557e-05  3.78423361e-04 -1.43574544e-05]
 [-7.39526825e-04  4.59319499e-04  1.95857174e-03 -5.68074191e-04]
 [ 3.06827612e-03 -5.96031261e-04  3.08054148e-03  3.44007167e-04]
 [ 4.74790994e-03 -3.62632588e-04  3.74779199e-03  2.99470805e-04]
 [-1.55963564e-03  3.71834662e-04  1.08518066e-03  6.45688484e-04]
 [ 2.12970497e-03 -3.24297715e-04  4.78100899e-03  6.04990548e-04]
 [-5.98406582e-03  6.75209380e-04  1.75863317e-03 -4.92788220e-05]
 [-2.90531153e-03 -1.71845088e-04  7.70685090e-04  1.61178217e-04]
 [ 1.63860038e-03 -1.75428711e-05 -3.49183591e-03 -8.35558460e-04]
 [ 9.80742505e-05 -1.30444064e-05  3.55227630e-03  5.65632480e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0012138000566556822
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5661200487639306e-06, theta_kick=1.8778368658562186e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.133639709529335e-07, theta_kick=-7.354464798228234e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01905125020944617
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.2089929133287463e-06, theta_kick=3.8477032457863603e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.988403892808574e-06, theta_kick=-9.57839684199486e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.261517711360357e-06, theta_kick=7.507795334006669e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0008819522267630635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.12035063447989e-06, theta_kick=-3.7414178181607674e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686109e-01 -6.32130619e+00  8.58325240e-03 -6.43840703e-02]
 [ 1.79993589e-01  4.56524981e-01 -3.82471799e-03  2.08437063e-02]
 [-3.33590285e-05 -6.43856458e-02  3.83921517e-01 -5.11831765e+00]
 [-1.03708660e-03  1.71056956e-02  2.12648325e-01 -2.30084351e-01]]
compute_tune_4x4()/ evals =  [0.08873243+0.9960555j  0.08873243-0.9960555j  0.06560558+0.99784563j
 0.06560558-0.99784563j]
compute_tune_4x4()/ angles =  [0.23585919675570652, 0.23955104218642342, 0.7604489578135766, 0.7641408032442935]
compute_tune_4x4()/  0.23585919675570652 0.23955104218642342
compute_tunes()/ 0.23585919675570652 0.23955104218642342

 Running simulation ..
Closed orbit computation: x_co=[-7.08445663e-09  6.53911413e-10], y_co=[-3.17981829e-07  1.95464717e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.24725326e-05 -3.37827556e-04  1.54142470e-03  3.10479539e-04]
 [ 3.32428388e-03 -6.94195714e-04 -4.41300432e-03  2.16022548e-04]
 [-1.88446221e-03  9.67938130e-05 -5.28174915e-04 -8.52269981e-06]
 [-6.08100384e-04 -6.25054663e-04 -1.48200558e-03 -4.51783858e-05]
 [-2.38706480e-03  2.62831381e-04  4.05774824e-04 -1.93270095e-04]
 [ 1.85232892e-03 -1.30786732e-04 -3.22998754e-03 -6.86186544e-04]
 [ 1.63644484e-03 -4.90151609e-04  2.11913057e-03  3.61862994e-04]
 [-2.70867868e-03  3.51621033e-05  4.66250913e-03  7.34883759e-05]
 [ 2.09092783e-04  6.47802313e-05 -7.33156781e-05  6.84444848e-04]
 [-2.32037294e-03 -3.32690308e-04  5.03392648e-03 -4.24669398e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011898271742495118
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.902322568356359e-05, theta_kick=-2.280956336922752e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.8319193654681025e-05, theta_kick=2.1965402476438573e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01466107697924488
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.870452955902358e-05, theta_kick=-2.2427434724530668e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.2013615487799296e-06, theta_kick=1.440477699842746e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.389074641591641e-05, theta_kick=-5.262665640147109e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010967665283959394
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.605085922033288e-06, theta_kick=-9.118784172177407e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01525029e-01 -6.32136708e+00  1.05986434e-03 -8.34921826e-02]
 [ 1.79997547e-01  4.56255544e-01 -3.27155183e-03  1.41960346e-02]
 [-8.19998732e-03 -8.35524629e-02  3.84090195e-01 -5.12004922e+00]
 [-2.46799325e-03  6.32881676e-03  2.12636157e-01 -2.30283110e-01]]
compute_tune_4x4()/ evals =  [0.08047223+0.99675685j 0.08047223-0.99675685j 0.07379657+0.99727332j
 0.07379657-0.99727332j]
compute_tune_4x4()/ angles =  [0.23717858283512788, 0.23824422476970453, 0.7617557752302955, 0.7628214171648722]
compute_tune_4x4()/  0.23717858283512788 0.23824422476970453
compute_tunes()/ 0.23717858283512788 0.23824422476970453

 Running simulation ..
Closed orbit computation: x_co=[-1.68902109e-07  2.36467172e-08], y_co=[1.52356111e-05 3.89387064e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.902322568356359e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.8319193654681025e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.870452955902358e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.2013615487799296e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.389074641591641e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.605085922033288e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0011898271742495118}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01466107697924488}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010967665283959394}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.24725326e-05 -3.37827556e-04  1.54142470e-03  3.10479539e-04]
 [ 3.32428388e-03 -6.94195714e-04 -4.41300432e-03  2.16022548e-04]
 [-1.88446221e-03  9.67938130e-05 -5.28174915e-04 -8.52269981e-06]
 [-6.08100384e-04 -6.25054663e-04 -1.48200558e-03 -4.51783858e-05]
 [-2.38706480e-03  2.62831381e-04  4.05774824e-04 -1.93270095e-04]
 [ 1.85232892e-03 -1.30786732e-04 -3.22998754e-03 -6.86186544e-04]
 [ 1.63644484e-03 -4.90151609e-04  2.11913057e-03  3.61862994e-04]
 [-2.70867868e-03  3.51621033e-05  4.66250913e-03  7.34883759e-05]
 [ 2.09092783e-04  6.47802313e-05 -7.33156781e-05  6.84444848e-04]
 [-2.32037294e-03 -3.32690308e-04  5.03392648e-03 -4.24669398e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011898271742495118
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5885636122355083e-06, theta_kick=1.9047475429281172e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.9793183721029856e-06, theta_kick=-2.3732772026863704e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01466107697924488
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.565262608761941e-07, theta_kick=7.871996894804379e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.450049684781804e-06, theta_kick=2.937701758491555e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.760209132309581e-06, theta_kick=-3.309594606246708e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010967665283959394
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2035394306520516e-06, theta_kick=1.4430890621531755e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01525029e-01 -6.32136708e+00  1.05986434e-03 -8.34921826e-02]
 [ 1.79997547e-01  4.56255544e-01 -3.27155183e-03  1.41960346e-02]
 [-8.19998732e-03 -8.35524629e-02  3.84090195e-01 -5.12004922e+00]
 [-2.46799325e-03  6.32881676e-03  2.12636157e-01 -2.30283110e-01]]
compute_tune_4x4()/ evals =  [0.08047223+0.99675685j 0.08047223-0.99675685j 0.07379657+0.99727332j
 0.07379657-0.99727332j]
compute_tune_4x4()/ angles =  [0.23717858283512788, 0.23824422476970453, 0.7617557752302955, 0.7628214171648722]
compute_tune_4x4()/  0.23717858283512788 0.23824422476970453
compute_tunes()/ 0.23717858283512788 0.23824422476970453

 Running simulation ..
Closed orbit computation: x_co=[ 9.46126481e-10 -1.13264086e-09], y_co=[2.36881805e-07 7.54259916e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.41634696e-03  1.82546306e-04 -3.03118644e-03  1.95396921e-04]
 [-1.05641700e-03 -3.67649522e-04  3.41363160e-04 -1.01823619e-04]
 [-2.47227610e-03  2.68337091e-04  1.30317154e-04  4.40450221e-04]
 [ 5.08303292e-04  5.19624311e-04  2.37936146e-03  3.45555435e-04]
 [ 2.02526477e-03  2.87796302e-05  3.78040998e-03 -1.57478924e-04]
 [ 1.44454792e-03 -5.02110311e-04  9.86076805e-04 -1.77148282e-04]
 [-1.88895054e-03 -3.03959862e-04 -8.34648762e-04  4.35858152e-04]
 [-1.12199072e-03 -3.82705134e-04  1.05118393e-03 -4.69364992e-04]
 [-5.29093001e-04 -4.19280879e-04 -3.37617075e-03 -6.03785209e-04]
 [-9.89879009e-05 -3.58144325e-05 -1.91108779e-03 -5.90101550e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007476534049701187
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.255579813188411e-05, theta_kick=-8.699713197031622e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.4218077677636584e-05, theta_kick=-4.102876263700992e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01283530351545158
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.963166578836462e-05, theta_kick=1.074717397930875e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.5002164145597984e-06, theta_kick=2.997853555086533e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.3528442121953805e-05, theta_kick=1.6221111130182774e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.023282499947240794
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.156646298837052e-05, theta_kick=-7.382050564462273e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01106376e-01 -6.31514818e+00 -2.38754866e-02 -9.04467329e-02]
 [ 1.80004235e-01  4.56474195e-01  1.24452834e-03 -2.43475709e-02]
 [-2.91533585e-02 -9.03936900e-02  3.83367252e-01 -5.11886309e+00]
 [-5.92317783e-03 -4.21663777e-02  2.12452561e-01 -2.30091244e-01]]
compute_tune_4x4()/ evals =  [0.10688794+0.99427107j 0.10688794-0.99427107j 0.04743397+0.99887438j
 0.04743397-0.99887438j]
compute_tune_4x4()/ angles =  [0.23295569427585172, 0.24244781551614453, 0.7575521844838555, 0.7670443057241483]
compute_tune_4x4()/  0.23295569427585172 0.24244781551614453
compute_tunes()/ 0.23295569427585172 0.24244781551614453

 Running simulation ..
Closed orbit computation: x_co=[ 9.61065288e-07 -3.04471831e-08], y_co=[-5.06579881e-05 -6.04793959e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.255579813188411e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.4218077677636584e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.963166578836462e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.5002164145597984e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.3528442121953805e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.156646298837052e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007476534049701187}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01283530351545158}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.023282499947240794}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.41634696e-03  1.82546306e-04 -3.03118644e-03  1.95396921e-04]
 [-1.05641700e-03 -3.67649522e-04  3.41363160e-04 -1.01823619e-04]
 [-2.47227610e-03  2.68337091e-04  1.30317154e-04  4.40450221e-04]
 [ 5.08303292e-04  5.19624311e-04  2.37936146e-03  3.45555435e-04]
 [ 2.02526477e-03  2.87796302e-05  3.78040998e-03 -1.57478924e-04]
 [ 1.44454792e-03 -5.02110311e-04  9.86076805e-04 -1.77148282e-04]
 [-1.88895054e-03 -3.03959862e-04 -8.34648762e-04  4.35858152e-04]
 [-1.12199072e-03 -3.82705134e-04  1.05118393e-03 -4.69364992e-04]
 [-5.29093001e-04 -4.19280879e-04 -3.37617075e-03 -6.03785209e-04]
 [-9.89879009e-05 -3.58144325e-05 -1.91108779e-03 -5.90101550e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007476534049701187
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.7725761434110218e-06, theta_kick=-3.3244231178828803e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.065625451170663e-06, theta_kick=7.272913143327584e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01283530351545158
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.555314827471015e-06, theta_kick=-6.661031504383235e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.613775361694405e-06, theta_kick=3.1340150055101365e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.1519119481974193e-06, theta_kick=-1.3811857681361106e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.023282499947240794
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.8046249017478455e-06, theta_kick=2.1638131586520995e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01106376e-01 -6.31514818e+00 -2.38754866e-02 -9.04467329e-02]
 [ 1.80004235e-01  4.56474195e-01  1.24452834e-03 -2.43475709e-02]
 [-2.91533585e-02 -9.03936900e-02  3.83367252e-01 -5.11886309e+00]
 [-5.92317783e-03 -4.21663777e-02  2.12452561e-01 -2.30091244e-01]]
compute_tune_4x4()/ evals =  [0.10688794+0.99427107j 0.10688794-0.99427107j 0.04743397+0.99887438j
 0.04743397-0.99887438j]
compute_tune_4x4()/ angles =  [0.23295569427585172, 0.24244781551614453, 0.7575521844838555, 0.7670443057241483]
compute_tune_4x4()/  0.23295569427585172 0.24244781551614453
compute_tunes()/ 0.23295569427585172 0.24244781551614453

 Running simulation ..
Closed orbit computation: x_co=[-1.74462063e-08  2.11688652e-09], y_co=[ 4.31869840e-07 -8.11476054e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.05355304e-03 -1.16015406e-04  2.93411727e-03 -3.67966194e-05]
 [-2.53553208e-03  5.53256086e-04 -1.01970254e-03  1.36378759e-04]
 [-2.71451871e-04  2.66352388e-05 -6.00034032e-03 -8.53371841e-04]
 [-1.70354551e-03  4.03559169e-04 -4.82860120e-04 -7.17878085e-04]
 [-1.68158153e-03  6.43231996e-05 -2.24740683e-03  3.19781724e-04]
 [-1.76735983e-03  2.86304951e-05 -5.72924471e-03 -3.97935628e-04]
 [ 2.04430719e-03 -4.63880552e-04  5.70371442e-04  1.07886803e-03]
 [ 5.04279285e-03 -9.80154689e-04 -6.13353637e-05  5.61051015e-04]
 [-7.60704512e-04 -6.34194139e-04 -1.84592543e-03 -6.52553133e-05]
 [ 8.12828258e-04  5.35685955e-06  3.71669504e-03  2.64891966e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006701638567916873
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.128360924420577e-05, theta_kick=9.746210588970549e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.023894795478488e-05, theta_kick=-4.824801264271065e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003288662432810616
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.137785561571401e-05, theta_kick=-3.7623229517562377e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.1525957948972e-05, theta_kick=8.576231484187271e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.947868947665427e-05, theta_kick=-7.1317186648768525e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004609431439798579
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.9009096513781524e-05, theta_kick=-4.677337449012123e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01640709e-01 -6.31986386e+00  1.45482336e-03 -9.04179876e-04]
 [ 1.79998460e-01  4.56083362e-01 -5.42641422e-04  5.52558027e-03]
 [ 1.08030536e-03 -9.06044470e-04  3.84077876e-01 -5.11949316e+00]
 [ 3.42278657e-04  6.69993719e-03  2.12574043e-01 -2.29846376e-01]]
compute_tune_4x4()/ evals =  [0.08083876+0.99672719j 0.08083876-0.99672719j 0.07349831+0.99729534j
 0.07349831-0.99729534j]
compute_tune_4x4()/ angles =  [0.2371200569554945, 0.23829182273894658, 0.7617081772610534, 0.7628799430445055]
compute_tune_4x4()/  0.2371200569554945 0.23829182273894658
compute_tunes()/ 0.2371200569554945 0.23829182273894658

 Running simulation ..
Closed orbit computation: x_co=[-5.74359885e-08  3.02645064e-08], y_co=[-8.94924214e-07  9.70575963e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.128360924420577e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.023894795478488e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.137785561571401e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -7.1525957948972e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.947868947665427e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.9009096513781524e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006701638567916873}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003288662432810616}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004609431439798579}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.05355304e-03 -1.16015406e-04  2.93411727e-03 -3.67966194e-05]
 [-2.53553208e-03  5.53256086e-04 -1.01970254e-03  1.36378759e-04]
 [-2.71451871e-04  2.66352388e-05 -6.00034032e-03 -8.53371841e-04]
 [-1.70354551e-03  4.03559169e-04 -4.82860120e-04 -7.17878085e-04]
 [-1.68158153e-03  6.43231996e-05 -2.24740683e-03  3.19781724e-04]
 [-1.76735983e-03  2.86304951e-05 -5.72924471e-03 -3.97935628e-04]
 [ 2.04430719e-03 -4.63880552e-04  5.70371442e-04  1.07886803e-03]
 [ 5.04279285e-03 -9.80154689e-04 -6.13353637e-05  5.61051015e-04]
 [-7.60704512e-04 -6.34194139e-04 -1.84592543e-03 -6.52553133e-05]
 [ 8.12828258e-04  5.35685955e-06  3.71669504e-03  2.64891966e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006701638567916873
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.7578804550993533e-07, theta_kick=-5.7048776873611655e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.557741889154632e-07, theta_kick=1.1460092148081686e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003288662432810616
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.4488980203405054e-06, theta_kick=-5.334396122202658e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.547458565306374e-06, theta_kick=9.04968680315448e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.723324931964617e-06, theta_kick=-5.66344431492425e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004609431439798579
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.8069520538674535e-06, theta_kick=2.16660350160576e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01640709e-01 -6.31986386e+00  1.45482336e-03 -9.04179876e-04]
 [ 1.79998460e-01  4.56083362e-01 -5.42641422e-04  5.52558027e-03]
 [ 1.08030536e-03 -9.06044470e-04  3.84077876e-01 -5.11949316e+00]
 [ 3.42278657e-04  6.69993719e-03  2.12574043e-01 -2.29846376e-01]]
compute_tune_4x4()/ evals =  [0.08083876+0.99672719j 0.08083876-0.99672719j 0.07349831+0.99729534j
 0.07349831-0.99729534j]
compute_tune_4x4()/ angles =  [0.2371200569554945, 0.23829182273894658, 0.7617081772610534, 0.7628799430445055]
compute_tune_4x4()/  0.2371200569554945 0.23829182273894658
compute_tunes()/ 0.2371200569554945 0.23829182273894658

 Running simulation ..
Closed orbit computation: x_co=[ 2.39316085e-09 -7.78770269e-10], y_co=[ 1.64781159e-07 -1.01362500e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.93715812e-05 -3.95411149e-04  4.39994751e-04 -2.66316143e-04]
 [-4.73561225e-04 -1.48260998e-04 -6.26880203e-05 -1.70627741e-04]
 [ 2.28199627e-03  5.92030858e-04  1.76537388e-04 -7.79498588e-05]
 [ 1.92480977e-03  5.87875535e-04  6.71922533e-04 -1.01064516e-03]
 [-4.66487535e-03  6.41873867e-05 -1.22112567e-03 -6.89938522e-04]
 [ 2.37854579e-03 -2.36388723e-04 -2.19804927e-03  1.80225392e-04]
 [-2.75428366e-03  1.88642689e-05  1.95857670e-03  9.57256395e-04]
 [ 5.15944274e-03 -5.24348788e-04  1.80223273e-03 -3.10872851e-04]
 [ 1.00355363e-03 -3.90397021e-04 -3.25138873e-04  3.14712895e-04]
 [ 5.06387775e-04  4.57983626e-04  2.90576574e-05  3.79544057e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01996443213251224
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.3967892449964035e-05, theta_kick=5.271915739901823e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.4985105428385755e-05, theta_kick=1.7967705243524749e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0007679261905732809
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.083039720449858e-05, theta_kick=7.29379350742881e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.649393605830543e-05, theta_kick=5.574797873123204e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.5146108731094038e-06, theta_kick=-4.214150678853089e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011843908531596127
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.390636337581485e-05, theta_kick=5.264538172399859e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01301909e-01 -6.31806483e+00 -9.48199305e-04 -3.15370949e-02]
 [ 1.80035196e-01  4.56263670e-01 -2.31462247e-04 -6.71879052e-03]
 [-4.18792183e-03 -3.15228890e-02  3.83843544e-01 -5.12164976e+00]
 [-1.69221005e-03 -1.25156240e-02  2.12514274e-01 -2.30361436e-01]]
compute_tune_4x4()/ evals =  [0.08318168+0.9965344j  0.08318168-0.9965344j  0.07104026+0.99747345j
 0.07104026-0.99747345j]
compute_tune_4x4()/ angles =  [0.23674591001932366, 0.2386840604089066, 0.7613159395910933, 0.7632540899806763]
compute_tune_4x4()/  0.23674591001932366 0.2386840604089066
compute_tunes()/ 0.23674591001932366 0.2386840604089066

 Running simulation ..
Closed orbit computation: x_co=[2.27143491e-08 1.79962284e-07], y_co=[-4.57978523e-05 -3.40152180e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.3967892449964035e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.4985105428385755e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.083039720449858e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.649393605830543e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.5146108731094038e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.390636337581485e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01996443213251224}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0007679261905732809}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011843908531596127}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.93715812e-05 -3.95411149e-04  4.39994751e-04 -2.66316143e-04]
 [-4.73561225e-04 -1.48260998e-04 -6.26880203e-05 -1.70627741e-04]
 [ 2.28199627e-03  5.92030858e-04  1.76537388e-04 -7.79498588e-05]
 [ 1.92480977e-03  5.87875535e-04  6.71922533e-04 -1.01064516e-03]
 [-4.66487535e-03  6.41873867e-05 -1.22112567e-03 -6.89938522e-04]
 [ 2.37854579e-03 -2.36388723e-04 -2.19804927e-03  1.80225392e-04]
 [-2.75428366e-03  1.88642689e-05  1.95857670e-03  9.57256395e-04]
 [ 5.15944274e-03 -5.24348788e-04  1.80223273e-03 -3.10872851e-04]
 [ 1.00355363e-03 -3.90397021e-04 -3.25138873e-04  3.14712895e-04]
 [ 5.06387775e-04  4.57983626e-04  2.90576574e-05  3.79544057e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01996443213251224
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.6604711842628088e-06, theta_kick=-3.1900050537632304e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.861319961233204e-08, theta_kick=4.62986792091261e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0007679261905732809
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.90041923686192e-06, theta_kick=2.278674170845494e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.6243584969227747e-06, theta_kick=-3.1467045828537505e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.699242275392415e-07, theta_kick=8.032643556260761e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011843908531596127
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.2797297327385198e-07, theta_kick=-2.73348172747275e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01301909e-01 -6.31806483e+00 -9.48199305e-04 -3.15370949e-02]
 [ 1.80035196e-01  4.56263670e-01 -2.31462247e-04 -6.71879052e-03]
 [-4.18792183e-03 -3.15228890e-02  3.83843544e-01 -5.12164976e+00]
 [-1.69221005e-03 -1.25156240e-02  2.12514274e-01 -2.30361436e-01]]
compute_tune_4x4()/ evals =  [0.08318168+0.9965344j  0.08318168-0.9965344j  0.07104026+0.99747345j
 0.07104026-0.99747345j]
compute_tune_4x4()/ angles =  [0.23674591001932366, 0.2386840604089066, 0.7613159395910933, 0.7632540899806763]
compute_tune_4x4()/  0.23674591001932366 0.2386840604089066
compute_tunes()/ 0.23674591001932366 0.2386840604089066

 Running simulation ..
Closed orbit computation: x_co=[-9.57183224e-10  1.62439351e-10], y_co=[ 1.67560578e-07 -1.48283813e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.20047971e-03  9.38065850e-05 -1.70242914e-03 -7.29351208e-04]
 [-2.01526094e-03  3.01265031e-04  7.02007553e-04  7.68821974e-04]
 [ 3.48830799e-04  6.80115285e-04  3.74014533e-03 -6.95007140e-05]
 [ 1.84294204e-03  1.24831850e-04 -3.51950241e-03 -2.57006724e-05]
 [ 6.44295250e-04  2.90020497e-04  5.65059599e-04 -4.39447594e-04]
 [ 1.13439159e-03  1.07872813e-04 -1.06317650e-03  4.54393853e-04]
 [ 1.21609538e-03 -1.55691877e-04 -1.13629737e-03  5.14551365e-04]
 [-2.26102617e-04 -5.02354311e-04 -1.02739886e-03 -8.88428967e-04]
 [-2.34465967e-03 -1.50338466e-04 -2.95869170e-03 -1.93038527e-04]
 [ 2.29112205e-03 -2.57723400e-04  5.17079388e-04  4.61342877e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004887654233764824
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.027876650515576e-05, theta_kick=-6.0286132846378e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.865327816283853e-06, theta_kick=1.182889924804678e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004102213048800267
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.1670323048093122e-06, theta_kick=-3.7973908973468246e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.3776100760611748e-05, theta_kick=-1.6518063156425399e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.8046421138456114e-05, theta_kick=3.3628714229595265e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.025945330289061052
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5700789513517025e-05, theta_kick=-1.8825837390180297e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01034455e-01 -6.31614405e+00  2.00947034e-02  1.16273414e-01]
 [ 1.80037979e-01  4.56335426e-01  4.64686597e-04  1.39790248e-02]
 [ 2.88938065e-02  1.16235411e-01  3.83558141e-01 -5.12119855e+00]
 [ 6.20823157e-03  3.28267586e-02  2.12464711e-01 -2.30215007e-01]]
compute_tune_4x4()/ evals =  [0.10098365+0.99488809j 0.10098365-0.99488809j 0.0533384 +0.99857649j
 0.0533384 -0.99857649j]
compute_tune_4x4()/ angles =  [0.2339005106150502, 0.24150689907606346, 0.7584931009239365, 0.7660994893849498]
compute_tune_4x4()/  0.2339005106150502 0.24150689907606346
compute_tunes()/ 0.2339005106150502 0.24150689907606346

 Running simulation ..
Closed orbit computation: x_co=[-8.19535322e-08 -1.08892187e-07], y_co=[-5.82895408e-06 -5.02143605e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.027876650515576e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -9.865327816283853e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.1670323048093122e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.3776100760611748e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.8046421138456114e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.5700789513517025e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004887654233764824}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004102213048800267}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.025945330289061052}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.20047971e-03  9.38065850e-05 -1.70242914e-03 -7.29351208e-04]
 [-2.01526094e-03  3.01265031e-04  7.02007553e-04  7.68821974e-04]
 [ 3.48830799e-04  6.80115285e-04  3.74014533e-03 -6.95007140e-05]
 [ 1.84294204e-03  1.24831850e-04 -3.51950241e-03 -2.57006724e-05]
 [ 6.44295250e-04  2.90020497e-04  5.65059599e-04 -4.39447594e-04]
 [ 1.13439159e-03  1.07872813e-04 -1.06317650e-03  4.54393853e-04]
 [ 1.21609538e-03 -1.55691877e-04 -1.13629737e-03  5.14551365e-04]
 [-2.26102617e-04 -5.02354311e-04 -1.02739886e-03 -8.88428967e-04]
 [-2.34465967e-03 -1.50338466e-04 -2.95869170e-03 -1.93038527e-04]
 [ 2.29112205e-03 -2.57723400e-04  5.17079388e-04  4.61342877e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004887654233764824
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.4249711955530044e-07, theta_kick=-2.9076317062940967e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.126239296999398e-07, theta_kick=3.7484785460905615e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004102213048800267
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.42731113669346e-07, theta_kick=-4.109475010119535e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.609040423463606e-07, theta_kick=3.128337636412944e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.949050351250685e-07, theta_kick=-5.93409758587291e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.025945330289061052
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.904521813766632e-07, theta_kick=9.477819073046723e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01034455e-01 -6.31614405e+00  2.00947034e-02  1.16273414e-01]
 [ 1.80037979e-01  4.56335426e-01  4.64686597e-04  1.39790248e-02]
 [ 2.88938065e-02  1.16235411e-01  3.83558141e-01 -5.12119855e+00]
 [ 6.20823157e-03  3.28267586e-02  2.12464711e-01 -2.30215007e-01]]
compute_tune_4x4()/ evals =  [0.10098365+0.99488809j 0.10098365-0.99488809j 0.0533384 +0.99857649j
 0.0533384 -0.99857649j]
compute_tune_4x4()/ angles =  [0.2339005106150502, 0.24150689907606346, 0.7584931009239365, 0.7660994893849498]
compute_tune_4x4()/  0.2339005106150502 0.24150689907606346
compute_tunes()/ 0.2339005106150502 0.24150689907606346

 Running simulation ..
Closed orbit computation: x_co=[ 1.26934092e-09 -4.68014950e-10], y_co=[ 3.04973919e-07 -2.80448678e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.83456655e-04 -4.30595971e-04 -2.65290198e-03  2.53584350e-04]
 [-2.99665924e-03 -4.38975081e-04  3.57582542e-03 -7.44598516e-05]
 [-1.69201647e-03  8.17839456e-05 -7.89855259e-05  1.25733559e-04]
 [-2.08166047e-03  1.03806859e-03  2.90269998e-03  8.85031625e-04]
 [-9.56117560e-04  1.81251612e-05 -3.38798697e-03 -1.06000353e-03]
 [-1.77619962e-03 -4.44890642e-05  1.75245800e-03  2.15531848e-04]
 [ 8.81348441e-04 -2.53122183e-04 -9.26010633e-04 -1.53884218e-04]
 [ 3.82235832e-04  3.20152969e-04  9.37010919e-04 -7.77055187e-04]
 [ 2.98233728e-05 -6.24566867e-05 -2.07407653e-03  1.55630102e-04]
 [ 5.59961153e-03 -9.92885573e-04 -6.54374258e-04  4.72717815e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0015146555155669459
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.5017800205148252e-05, theta_kick=2.999728377459402e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.445158485579704e-05, theta_kick=2.931837026610242e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007447255070359681
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.10357918590048e-05, theta_kick=-7.318421099329316e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.7697276030962504e-05, theta_kick=3.3210076108652818e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.466979147775802e-05, theta_kick=1.135126420609738e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007086994580030242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.68012084863355e-05, theta_kick=-6.810678619752721e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636119e-01 -6.32036420e+00 -3.95895504e-05 -4.49437297e-02]
 [ 1.79998858e-01  4.56120302e-01 -1.68424366e-03  7.21099533e-03]
 [-4.90880242e-03 -4.49552301e-02  3.84093998e-01 -5.11955952e+00]
 [-1.37576028e-03  2.87932800e-03  2.12592802e-01 -2.29906021e-01]]
compute_tune_4x4()/ evals =  [0.07844897+0.99691813j 0.07844897-0.99691813j 0.07588711+0.99711642j
 0.07588711-0.99711642j]
compute_tune_4x4()/ angles =  [0.2375016168286492, 0.23791056849475506, 0.7620894315052449, 0.7624983831713508]
compute_tune_4x4()/  0.2375016168286492 0.23791056849475506
compute_tunes()/ 0.2375016168286492 0.23791056849475506

 Running simulation ..
Closed orbit computation: x_co=[ 8.44571017e-08 -1.34825297e-08], y_co=[-3.65944189e-05 -2.87791142e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.5017800205148252e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.445158485579704e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.10357918590048e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.7697276030962504e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -9.466979147775802e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.68012084863355e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0015146555155669459}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007447255070359681}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007086994580030242}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.83456655e-04 -4.30595971e-04 -2.65290198e-03  2.53584350e-04]
 [-2.99665924e-03 -4.38975081e-04  3.57582542e-03 -7.44598516e-05]
 [-1.69201647e-03  8.17839456e-05 -7.89855259e-05  1.25733559e-04]
 [-2.08166047e-03  1.03806859e-03  2.90269998e-03  8.85031625e-04]
 [-9.56117560e-04  1.81251612e-05 -3.38798697e-03 -1.06000353e-03]
 [-1.77619962e-03 -4.44890642e-05  1.75245800e-03  2.15531848e-04]
 [ 8.81348441e-04 -2.53122183e-04 -9.26010633e-04 -1.53884218e-04]
 [ 3.82235832e-04  3.20152969e-04  9.37010919e-04 -7.77055187e-04]
 [ 2.98233728e-05 -6.24566867e-05 -2.07407653e-03  1.55630102e-04]
 [ 5.59961153e-03 -9.92885573e-04 -6.54374258e-04  4.72717815e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0015146555155669459
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.74094244383132e-06, theta_kick=9.281681253598908e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.231311956280443e-05, theta_kick=-1.4763893653605136e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007447255070359681
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1298017071120287e-05, theta_kick=1.3546747571469566e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.30495134688247e-06, theta_kick=-8.758911523601631e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.5401249341923284e-06, theta_kick=4.2447429980926244e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007086994580030242
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.3051190532484667e-06, theta_kick=-2.763924478071752e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01636119e-01 -6.32036420e+00 -3.95895504e-05 -4.49437297e-02]
 [ 1.79998858e-01  4.56120302e-01 -1.68424366e-03  7.21099533e-03]
 [-4.90880242e-03 -4.49552301e-02  3.84093998e-01 -5.11955952e+00]
 [-1.37576028e-03  2.87932800e-03  2.12592802e-01 -2.29906021e-01]]
compute_tune_4x4()/ evals =  [0.07844897+0.99691813j 0.07844897-0.99691813j 0.07588711+0.99711642j
 0.07588711-0.99711642j]
compute_tune_4x4()/ angles =  [0.2375016168286492, 0.23791056849475506, 0.7620894315052449, 0.7624983831713508]
compute_tune_4x4()/  0.2375016168286492 0.23791056849475506
compute_tunes()/ 0.2375016168286492 0.23791056849475506

 Running simulation ..
Closed orbit computation: x_co=[-8.68811350e-09  9.20849365e-10], y_co=[-3.82505261e-08  2.72445575e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.59830989e-03  2.18749602e-04 -6.75771370e-04 -5.40651539e-04]
 [-7.80914336e-04  1.39062115e-04 -5.63783724e-04 -6.86793488e-04]
 [ 3.02682869e-04 -2.03525206e-04 -1.03868780e-03 -5.84124731e-04]
 [ 3.36128683e-03 -2.38482764e-04  4.85061564e-05 -4.61734121e-04]
 [ 6.31952943e-04 -1.17634043e-03  1.49912228e-03 -2.95985547e-04]
 [-5.68624319e-03  1.30568765e-04 -3.65423299e-03 -5.88256237e-04]
 [-1.71308293e-03 -1.33736353e-04 -1.73490234e-03 -4.32009714e-04]
 [ 3.41251134e-03 -4.62109882e-04 -1.63849521e-03  4.46655341e-04]
 [ 2.81491768e-03 -9.68824678e-04  7.06977648e-04  3.40199436e-04]
 [-9.87924916e-04  3.84668459e-04  4.69259794e-03 -4.05539151e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011290494595480262
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.048596251555351e-05, theta_kick=4.854419239532968e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.184355534163089e-05, theta_kick=-5.01719972750655e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.025809300617750323
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.195829052394638e-05, theta_kick=8.628069786636576e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.6377937320989725e-05, theta_kick=5.560889188058089e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.8522023105729284e-05, theta_kick=-2.220860261997828e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02299591471953543
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.032849469374951e-05, theta_kick=6.034575881559236e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00937515e-01 -6.31324255e+00  3.17566683e-02  6.71610238e-02]
 [ 1.79935271e-01  4.56946295e-01 -3.63396755e-03  4.07226183e-02]
 [ 3.30033770e-02  6.71501627e-02  3.82834962e-01 -5.11510624e+00]
 [ 6.24529034e-03  5.92862945e-02  2.12446837e-01 -2.30452873e-01]]
compute_tune_4x4()/ evals =  [0.11807219+0.99300501j 0.11807219-0.99300501j 0.03612325+0.99934734j
 0.03612325-0.99934734j]
compute_tune_4x4()/ angles =  [0.23116428883652373, 0.24424955546902322, 0.7557504445309768, 0.7688357111634763]
compute_tune_4x4()/  0.23116428883652373 0.24424955546902322
compute_tunes()/ 0.23116428883652373 0.24424955546902322

 Running simulation ..
Closed orbit computation: x_co=[1.41371143e-07 6.84842523e-08], y_co=[-2.68270366e-05 -2.96923827e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.048596251555351e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.184355534163089e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.195829052394638e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.6377937320989725e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.8522023105729284e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.032849469374951e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011290494595480262}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.025809300617750323}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.02299591471953543}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.59830989e-03  2.18749602e-04 -6.75771370e-04 -5.40651539e-04]
 [-7.80914336e-04  1.39062115e-04 -5.63783724e-04 -6.86793488e-04]
 [ 3.02682869e-04 -2.03525206e-04 -1.03868780e-03 -5.84124731e-04]
 [ 3.36128683e-03 -2.38482764e-04  4.85061564e-05 -4.61734121e-04]
 [ 6.31952943e-04 -1.17634043e-03  1.49912228e-03 -2.95985547e-04]
 [-5.68624319e-03  1.30568765e-04 -3.65423299e-03 -5.88256237e-04]
 [-1.71308293e-03 -1.33736353e-04 -1.73490234e-03 -4.32009714e-04]
 [ 3.41251134e-03 -4.62109882e-04 -1.63849521e-03  4.46655341e-04]
 [ 2.81491768e-03 -9.68824678e-04  7.06977648e-04  3.40199436e-04]
 [-9.87924916e-04  3.84668459e-04  4.69259794e-03 -4.05539151e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011290494595480262
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.782724729416842e-06, theta_kick=-5.73466690706731e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.909281737480598e-06, theta_kick=5.886413521614613e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.025809300617750323
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2857992499097273e-06, theta_kick=-2.7407593069348333e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3854417890749694e-06, theta_kick=1.6611968342248905e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2765520065705355e-06, theta_kick=-1.5306338878765078e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02299591471953543
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.557856307263411e-06, theta_kick=1.8679283288626277e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00937515e-01 -6.31324255e+00  3.17566683e-02  6.71610238e-02]
 [ 1.79935271e-01  4.56946295e-01 -3.63396755e-03  4.07226183e-02]
 [ 3.30033770e-02  6.71501627e-02  3.82834962e-01 -5.11510624e+00]
 [ 6.24529034e-03  5.92862945e-02  2.12446837e-01 -2.30452873e-01]]
compute_tune_4x4()/ evals =  [0.11807219+0.99300501j 0.11807219-0.99300501j 0.03612325+0.99934734j
 0.03612325-0.99934734j]
compute_tune_4x4()/ angles =  [0.23116428883652373, 0.24424955546902322, 0.7557504445309768, 0.7688357111634763]
compute_tune_4x4()/  0.23116428883652373 0.24424955546902322
compute_tunes()/ 0.23116428883652373 0.24424955546902322

 Running simulation ..
Closed orbit computation: x_co=[-4.81294107e-09 -2.46520236e-09], y_co=[-1.35503894e-07 -2.39831321e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.04638958e-03  2.48540959e-04 -1.10556628e-03  4.90410520e-04]
 [ 4.06685030e-03 -3.78292087e-04 -3.48052068e-04  5.59766520e-05]
 [-6.45494931e-03  4.57970209e-04  9.21271979e-05 -1.84700629e-04]
 [ 8.50279762e-05 -4.04427961e-04 -1.31118063e-03 -3.40895079e-04]
 [-2.28333096e-03  2.50587452e-04  2.40204505e-04 -2.15646581e-04]
 [-6.48372384e-03  1.04827383e-03  9.25071106e-04  2.87525683e-04]
 [-2.67792470e-04  3.60424528e-04 -2.09547866e-03  4.85577302e-04]
 [-1.38713384e-03  4.65233321e-04 -2.03249636e-05 -9.17137939e-05]
 [-1.04278313e-03  4.89207082e-04  6.95647147e-05 -2.73740274e-04]
 [ 3.52025677e-04 -1.57289370e-04  2.02874017e-03 -3.01836696e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007042958986005817
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.066853193245456e-05, theta_kick=7.274385252270721e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=0.0001246162901099032, theta_kick=-1.4941962069849174e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0009357681802853986
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.0856191818009313e-05, theta_kick=2.5007358732261646e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=0.00011112017778301664, theta_kick=-1.3323727420904695e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.7340292927800054e-05, theta_kick=3.278203993598822e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.013467854795093657
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.5835810666637815e-05, theta_kick=1.8987732833125906e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01477767e-01 -6.31885482e+00 -1.16175828e-02 -8.26053755e-02]
 [ 1.80014614e-01  4.56163585e-01 -6.70881677e-04 -7.95208061e-03]
 [-1.83737942e-02 -8.26022292e-02  3.83957218e-01 -5.11996972e+00]
 [-4.19764625e-03 -2.08830281e-02  2.12547672e-01 -2.29907406e-01]]
compute_tune_4x4()/ evals =  [0.09181025+0.99577652j 0.09181025-0.99577652j 0.06255757+0.99804136j
 0.06255757-0.99804136j]
compute_tune_4x4()/ angles =  [0.23536733935371856, 0.24003714848148217, 0.7599628515185178, 0.7646326606462814]
compute_tune_4x4()/  0.23536733935371856 0.24003714848148217
compute_tunes()/ 0.23536733935371856 0.24003714848148217

 Running simulation ..
Closed orbit computation: x_co=[3.72169681e-08 8.58354986e-08], y_co=[7.56863455e-05 1.28864051e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.066853193245456e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 0.0001246162901099032, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.0856191818009313e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 0.00011112017778301664, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.7340292927800054e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.5835810666637815e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007042958986005817}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0009357681802853986}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.013467854795093657}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.04638958e-03  2.48540959e-04 -1.10556628e-03  4.90410520e-04]
 [ 4.06685030e-03 -3.78292087e-04 -3.48052068e-04  5.59766520e-05]
 [-6.45494931e-03  4.57970209e-04  9.21271979e-05 -1.84700629e-04]
 [ 8.50279762e-05 -4.04427961e-04 -1.31118063e-03 -3.40895079e-04]
 [-2.28333096e-03  2.50587452e-04  2.40204505e-04 -2.15646581e-04]
 [-6.48372384e-03  1.04827383e-03  9.25071106e-04  2.87525683e-04]
 [-2.67792470e-04  3.60424528e-04 -2.09547866e-03  4.85577302e-04]
 [-1.38713384e-03  4.65233321e-04 -2.03249636e-05 -9.17137939e-05]
 [-1.04278313e-03  4.89207082e-04  6.95647147e-05 -2.73740274e-04]
 [ 3.52025677e-04 -1.57289370e-04  2.02874017e-03 -3.01836696e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007042958986005817
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.5255461222901887e-06, theta_kick=-1.829187201365258e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.5219305951887567e-06, theta_kick=3.023889674686114e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0009357681802853986
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.04717521882784e-06, theta_kick=-3.6536777414698237e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.5243290942715815e-06, theta_kick=5.424840818042353e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.5687077314450123e-06, theta_kick=-3.079977221110479e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.013467854795093657
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.568441680882534e-07, theta_kick=9.074846348248443e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01477767e-01 -6.31885482e+00 -1.16175828e-02 -8.26053755e-02]
 [ 1.80014614e-01  4.56163585e-01 -6.70881677e-04 -7.95208061e-03]
 [-1.83737942e-02 -8.26022292e-02  3.83957218e-01 -5.11996972e+00]
 [-4.19764625e-03 -2.08830281e-02  2.12547672e-01 -2.29907406e-01]]
compute_tune_4x4()/ evals =  [0.09181025+0.99577652j 0.09181025-0.99577652j 0.06255757+0.99804136j
 0.06255757-0.99804136j]
compute_tune_4x4()/ angles =  [0.23536733935371856, 0.24003714848148217, 0.7599628515185178, 0.7646326606462814]
compute_tune_4x4()/  0.23536733935371856 0.24003714848148217
compute_tunes()/ 0.23536733935371856 0.24003714848148217

 Running simulation ..
Closed orbit computation: x_co=[-6.72255641e-10 -3.60878732e-10], y_co=[-4.48325666e-07 -6.88320990e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.89722900e-04 -1.27427327e-05  2.48807272e-03  4.75594327e-04]
 [-3.41025560e-03  5.09605651e-04 -1.36276546e-03  4.19522799e-04]
 [ 3.48587505e-04 -4.62333230e-04 -2.19766597e-03 -4.73219796e-04]
 [-9.82912076e-04 -4.41417473e-04 -1.89181921e-03 -7.46360195e-05]
 [-1.10650655e-03  1.60295864e-04 -1.44243960e-03 -3.09578065e-04]
 [ 3.47823155e-03  7.24878400e-05 -1.91532271e-03  3.58130884e-04]
 [ 5.05628310e-03 -3.06658710e-04 -7.71784636e-04 -8.97695015e-04]
 [ 1.12033952e-03 -5.46083805e-04 -2.67249824e-03 -1.26256787e-04]
 [ 2.75375980e-03 -7.60927401e-04 -7.08889792e-05  8.76623815e-05]
 [-7.29152422e-03  6.01628433e-04  1.17394687e-04 -5.07660863e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004698458065511232
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.8890529744775112e-05, theta_kick=2.2650455945755694e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.1570489514247264e-05, theta_kick=-3.7854204810015114e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010964944166453492
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.3325319460843904e-05, theta_kick=-1.597755941674673e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.003210866649628e-05, theta_kick=-8.397113334408154e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.820303397049223e-06, theta_kick=-8.177800396215961e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0061887282951096426
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.453290054872661e-05, theta_kick=1.1334850468635849e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01658228e-01 -6.32083082e+00 -1.70154203e-04 -7.73412381e-02]
 [ 1.80015176e-01  4.56285899e-01 -2.60673949e-03  8.62514631e-03]
 [-8.52877254e-03 -7.73521870e-02  3.84062561e-01 -5.11965417e+00]
 [-2.59427169e-03  2.81807909e-04  2.12614110e-01 -2.29930347e-01]]
compute_tune_4x4()/ evals =  [0.07732438+0.99700599j 0.07732438-0.99700599j 0.07705556+0.9970268j
 0.07705556-0.9970268j ]
compute_tune_4x4()/ angles =  [0.23768114542573845, 0.23772405818229395, 0.7622759418177061, 0.7623188545742615]
compute_tune_4x4()/  0.23768114542573845 0.23772405818229395
compute_tunes()/ 0.23768114542573845 0.23772405818229395

 Running simulation ..
Closed orbit computation: x_co=[ 8.02412500e-07 -6.37522623e-08], y_co=[ 7.52872967e-05 -1.91999597e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.8890529744775112e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.1570489514247264e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.3325319460843904e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.003210866649628e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.820303397049223e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -9.453290054872661e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004698458065511232}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.010964944166453492}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0061887282951096426}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.89722900e-04 -1.27427327e-05  2.48807272e-03  4.75594327e-04]
 [-3.41025560e-03  5.09605651e-04 -1.36276546e-03  4.19522799e-04]
 [ 3.48587505e-04 -4.62333230e-04 -2.19766597e-03 -4.73219796e-04]
 [-9.82912076e-04 -4.41417473e-04 -1.89181921e-03 -7.46360195e-05]
 [-1.10650655e-03  1.60295864e-04 -1.44243960e-03 -3.09578065e-04]
 [ 3.47823155e-03  7.24878400e-05 -1.91532271e-03  3.58130884e-04]
 [ 5.05628310e-03 -3.06658710e-04 -7.71784636e-04 -8.97695015e-04]
 [ 1.12033952e-03 -5.46083805e-04 -2.67249824e-03 -1.26256787e-04]
 [ 2.75375980e-03 -7.60927401e-04 -7.08889792e-05  8.76623815e-05]
 [-7.29152422e-03  6.01628433e-04  1.17394687e-04 -5.07660863e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004698458065511232
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.35671278390203e-06, theta_kick=2.825787302409378e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.2704282996484365e-06, theta_kick=-2.722328959218721e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010964944166453492
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.6183296874917764e-06, theta_kick=1.9404381871492849e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.081734650115655e-07, theta_kick=-7.292228678993062e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.349726143178728e-07, theta_kick=6.41452293636405e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0061887282951096426
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0296868270260186e-06, theta_kick=-1.2346332489658536e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01658228e-01 -6.32083082e+00 -1.70154203e-04 -7.73412381e-02]
 [ 1.80015176e-01  4.56285899e-01 -2.60673949e-03  8.62514631e-03]
 [-8.52877254e-03 -7.73521870e-02  3.84062561e-01 -5.11965417e+00]
 [-2.59427169e-03  2.81807909e-04  2.12614110e-01 -2.29930347e-01]]
compute_tune_4x4()/ evals =  [0.07732438+0.99700599j 0.07732438-0.99700599j 0.07705556+0.9970268j
 0.07705556-0.9970268j ]
compute_tune_4x4()/ angles =  [0.23768114542573845, 0.23772405818229395, 0.7622759418177061, 0.7623188545742615]
compute_tune_4x4()/  0.23768114542573845 0.23772405818229395
compute_tunes()/ 0.23768114542573845 0.23772405818229395

 Running simulation ..
Closed orbit computation: x_co=[-3.10733013e-09 -5.65243857e-10], y_co=[-2.88962736e-07  1.49768374e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 9.75042547e-04 -3.05378686e-04  1.30858257e-04 -5.11877394e-04]
 [ 1.57856520e-03 -1.56568411e-04  3.25737968e-04  8.89501883e-05]
 [-1.81701959e-04 -1.55075144e-05  8.96645375e-04 -3.30960136e-05]
 [-4.33823141e-03  4.55996538e-04 -7.09935248e-04  1.38378282e-04]
 [ 3.69085254e-03 -2.24453741e-04 -1.67143966e-03  9.22645059e-05]
 [-6.68449878e-03  2.78398522e-04  2.83161959e-03 -2.86505784e-04]
 [-2.81023123e-04  9.94534606e-06 -3.32705099e-03 -3.31872173e-04]
 [-7.18296071e-04  3.79198133e-04 -3.25296904e-03 -7.25565508e-04]
 [-2.03837805e-03 -3.29797274e-04 -6.66991869e-04  7.58136128e-04]
 [-8.38177134e-04  4.94080716e-04  1.53497947e-03  9.39045854e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005875658878944257
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.9973490825807257e-05, theta_kick=-2.3948967029790865e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.822862507989217e-05, theta_kick=-8.18086886652303e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01264147596956243
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.062091987530888e-05, theta_kick=1.0865789266535873e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.389091662788259e-05, theta_kick=5.2626860492022996e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.587243761162055e-05, theta_kick=7.89835312360275e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004345549102803749
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.0701390752090374e-05, theta_kick=-6.079287522026237e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01720310e-01 -6.32015794e+00 -6.74763278e-03  4.33138362e-02]
 [ 1.80017041e-01  4.56423597e-01  2.55665778e-03 -1.28749123e-02]
 [-7.67066449e-04  4.32975682e-02  3.83904211e-01 -5.11884716e+00]
 [ 7.29919266e-04 -1.00907207e-02  2.12594664e-01 -2.29785771e-01]]
compute_tune_4x4()/ evals =  [0.08478442+0.99639932j 0.08478442-0.99639932j 0.06962644+0.99757313j
 0.06962644-0.99757313j]
compute_tune_4x4()/ angles =  [0.2364899214221416, 0.23890963431864579, 0.7610903656813542, 0.7635100785778584]
compute_tune_4x4()/  0.2364899214221416 0.23890963431864579
compute_tunes()/ 0.2364899214221416 0.23890963431864579

 Running simulation ..
Closed orbit computation: x_co=[ 6.82069394e-07 -1.49777854e-07], y_co=[-7.60183897e-05 -1.11407120e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.9973490825807257e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.822862507989217e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.062091987530888e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.389091662788259e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.587243761162055e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.0701390752090374e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005875658878944257}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01264147596956243}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004345549102803749}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 9.75042547e-04 -3.05378686e-04  1.30858257e-04 -5.11877394e-04]
 [ 1.57856520e-03 -1.56568411e-04  3.25737968e-04  8.89501883e-05]
 [-1.81701959e-04 -1.55075144e-05  8.96645375e-04 -3.30960136e-05]
 [-4.33823141e-03  4.55996538e-04 -7.09935248e-04  1.38378282e-04]
 [ 3.69085254e-03 -2.24453741e-04 -1.67143966e-03  9.22645059e-05]
 [-6.68449878e-03  2.78398522e-04  2.83161959e-03 -2.86505784e-04]
 [-2.81023123e-04  9.94534606e-06 -3.32705099e-03 -3.31872173e-04]
 [-7.18296071e-04  3.79198133e-04 -3.25296904e-03 -7.25565508e-04]
 [-2.03837805e-03 -3.29797274e-04 -6.66991869e-04  7.58136128e-04]
 [-8.38177134e-04  4.94080716e-04  1.53497947e-03  9.39045854e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005875658878944257
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1687498977365989e-07, theta_kick=-1.4013751031842469e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.945859945420519e-07, theta_kick=8.328347421948354e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01264147596956243
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.335874760262782e-07, theta_kick=9.995027486134519e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.7238776839295607e-06, theta_kick=-4.465069458973682e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.0617876326922793e-06, theta_kick=3.6711985755051517e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004345549102803749
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.7059143613895868e-06, theta_kick=-2.045455506644755e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01720310e-01 -6.32015794e+00 -6.74763278e-03  4.33138362e-02]
 [ 1.80017041e-01  4.56423597e-01  2.55665778e-03 -1.28749123e-02]
 [-7.67066449e-04  4.32975682e-02  3.83904211e-01 -5.11884716e+00]
 [ 7.29919266e-04 -1.00907207e-02  2.12594664e-01 -2.29785771e-01]]
compute_tune_4x4()/ evals =  [0.08478442+0.99639932j 0.08478442-0.99639932j 0.06962644+0.99757313j
 0.06962644-0.99757313j]
compute_tune_4x4()/ angles =  [0.2364899214221416, 0.23890963431864579, 0.7610903656813542, 0.7635100785778584]
compute_tune_4x4()/  0.2364899214221416 0.23890963431864579
compute_tunes()/ 0.2364899214221416 0.23890963431864579

 Running simulation ..
Closed orbit computation: x_co=[ 3.82569400e-09 -6.34189685e-11], y_co=[-2.13906221e-07  7.07764400e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.77500919e-03  1.50725022e-04  1.47472040e-03  2.19979973e-04]
 [-1.03754061e-03  1.87568131e-04  1.12606091e-03  5.20857814e-04]
 [-2.57794510e-03  3.51030659e-04 -1.12918606e-03 -3.00601551e-04]
 [-1.86168652e-03 -6.01214909e-04 -4.48063978e-04  6.98307322e-04]
 [ 3.27514149e-03 -6.45739569e-04  3.75444643e-03 -1.06987363e-03]
 [-1.11156769e-03 -1.56514002e-04 -1.55182237e-03  2.82308335e-04]
 [-1.83990580e-03  1.10595119e-04  1.38331173e-03 -9.68194825e-05]
 [ 2.04960651e-03  5.40989979e-04 -3.73321974e-04  5.75115959e-04]
 [ 3.20179728e-03  1.49950817e-04  2.74195114e-03 -6.74449068e-04]
 [ 2.64303761e-04  2.98042501e-04 -4.14630192e-03 -3.41446247e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002087843969976951
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.8404002277096298e-05, theta_kick=3.405746746929956e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.828520279462854e-06, theta_kick=-8.187652747401235e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0066827765193100234
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.852928474622585e-05, theta_kick=-9.415956718143737e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.1089005536746088e-05, theta_kick=2.5286511140958574e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.530874521626375e-05, theta_kick=5.432689031721321e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01547854654082552
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.182585565895297e-05, theta_kick=-1.4179645898922817e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482796e-01 -6.31825729e+00  1.38008744e-02  5.35585624e-02]
 [ 1.80008614e-01  4.56240287e-01 -5.89237189e-04  1.27748782e-02]
 [ 1.69905702e-02  5.35443990e-02  3.83814445e-01 -5.11935162e+00]
 [ 3.39841223e-03  2.29438519e-02  2.12529130e-01 -2.29848590e-01]]
compute_tune_4x4()/ evals =  [0.09371819+0.99559876j 0.09371819-0.99559876j 0.06064348+0.99815949j
 0.06064348-0.99815949j]
compute_tune_4x4()/ angles =  [0.23506236549326903, 0.24034236438980244, 0.7596576356101976, 0.7649376345067309]
compute_tune_4x4()/  0.23506236549326903 0.24034236438980244
compute_tunes()/ 0.23506236549326903 0.24034236438980244

 Running simulation ..
Closed orbit computation: x_co=[ 2.20023393e-07 -9.32036521e-08], y_co=[ 1.15234325e-05 -2.40782490e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.8404002277096298e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.828520279462854e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.852928474622585e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.1089005536746088e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.530874521626375e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.182585565895297e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.002087843969976951}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0066827765193100234}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.01547854654082552}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.77500919e-03  1.50725022e-04  1.47472040e-03  2.19979973e-04]
 [-1.03754061e-03  1.87568131e-04  1.12606091e-03  5.20857814e-04]
 [-2.57794510e-03  3.51030659e-04 -1.12918606e-03 -3.00601551e-04]
 [-1.86168652e-03 -6.01214909e-04 -4.48063978e-04  6.98307322e-04]
 [ 3.27514149e-03 -6.45739569e-04  3.75444643e-03 -1.06987363e-03]
 [-1.11156769e-03 -1.56514002e-04 -1.55182237e-03  2.82308335e-04]
 [-1.83990580e-03  1.10595119e-04  1.38331173e-03 -9.68194825e-05]
 [ 2.04960651e-03  5.40989979e-04 -3.73321974e-04  5.75115959e-04]
 [ 3.20179728e-03  1.49950817e-04  2.74195114e-03 -6.74449068e-04]
 [ 2.64303761e-04  2.98042501e-04 -4.14630192e-03 -3.41446247e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002087843969976951
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.116609922228816e-06, theta_kick=-2.5378949370677865e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.4255628452250413e-06, theta_kick=2.908341116512489e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0066827765193100234
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.5402717374187096e-08, theta_kick=-4.244919020684726e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.0768540654128016e-06, theta_kick=-2.49022616887742e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5138977734952385e-06, theta_kick=1.8152203928752106e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01547854654082552
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.6023172305885995e-07, theta_kick=-3.120276275186572e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482796e-01 -6.31825729e+00  1.38008744e-02  5.35585624e-02]
 [ 1.80008614e-01  4.56240287e-01 -5.89237189e-04  1.27748782e-02]
 [ 1.69905702e-02  5.35443990e-02  3.83814445e-01 -5.11935162e+00]
 [ 3.39841223e-03  2.29438519e-02  2.12529130e-01 -2.29848590e-01]]
compute_tune_4x4()/ evals =  [0.09371819+0.99559876j 0.09371819-0.99559876j 0.06064348+0.99815949j
 0.06064348-0.99815949j]
compute_tune_4x4()/ angles =  [0.23506236549326903, 0.24034236438980244, 0.7596576356101976, 0.7649376345067309]
compute_tune_4x4()/  0.23506236549326903 0.24034236438980244
compute_tunes()/ 0.23506236549326903 0.24034236438980244

 Running simulation ..
Closed orbit computation: x_co=[-2.10437213e-09 -4.45301695e-10], y_co=[-2.06564499e-07 -6.83296115e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.96443851e-03 -2.32816418e-04 -8.02519530e-04 -5.91995492e-05]
 [-2.49560428e-03  4.05479365e-04 -2.14229100e-03  3.33574885e-04]
 [ 1.34571204e-03  4.52708566e-04 -2.89090947e-03 -7.52264746e-04]
 [-8.90602056e-04  5.29804651e-04 -4.13723436e-03 -2.70702779e-04]
 [-1.60224123e-03 -2.96326951e-04  7.04243470e-04  1.27757579e-04]
 [ 2.70233277e-03 -5.31717120e-04  2.80297961e-04  9.18892525e-05]
 [-8.65573979e-04 -2.36720947e-04  2.71289621e-03  2.41827360e-05]
 [-4.37423087e-04 -5.35938428e-04  1.72627395e-03  6.16218334e-04]
 [ 1.54887082e-03  4.43543040e-04  3.24146921e-03  6.73377932e-04]
 [ 7.90995934e-04 -1.85380568e-04 -4.19286295e-03 -3.95045606e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00010184006829571534
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.961593024523137e-05, theta_kick=9.546249602125384e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.796806946158706e-05, theta_kick=-3.3534767620941294e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01731616466806603
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.058379183104595e-05, theta_kick=4.866149342556563e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.066779265617149e-05, theta_kick=-9.672371862971908e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.411085189711467e-05, theta_kick=4.090019489164891e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010003537010266543
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.1831928237181875e-05, theta_kick=-5.015805593934558e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01543060e-01 -6.32184799e+00 -2.56504010e-03  9.17613712e-02]
 [ 1.79997724e-01  4.56363049e-01  3.79998506e-03 -1.69795244e-02]
 [ 7.87753273e-03  9.18286388e-02  3.84070515e-01 -5.11982691e+00]
 [ 2.58042910e-03 -8.65517018e-03  2.12658523e-01 -2.30347524e-01]]
compute_tune_4x4()/ evals =  [0.08219808+0.99661601j 0.08219808-0.99661601j 0.0720734 +0.99739933j
 0.0720734 -0.99739933j]
compute_tune_4x4()/ angles =  [0.23690299176792518, 0.23851920705880805, 0.761480792941192, 0.7630970082320748]
compute_tune_4x4()/  0.23690299176792518 0.23851920705880805
compute_tunes()/ 0.23690299176792518 0.23851920705880805

 Running simulation ..
Closed orbit computation: x_co=[7.30555753e-08 3.08716099e-08], y_co=[3.84520660e-06 1.03119906e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.961593024523137e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.796806946158706e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.058379183104595e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 8.066779265617149e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.411085189711467e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.1831928237181875e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00010184006829571534}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01731616466806603}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010003537010266543}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.96443851e-03 -2.32816418e-04 -8.02519530e-04 -5.91995492e-05]
 [-2.49560428e-03  4.05479365e-04 -2.14229100e-03  3.33574885e-04]
 [ 1.34571204e-03  4.52708566e-04 -2.89090947e-03 -7.52264746e-04]
 [-8.90602056e-04  5.29804651e-04 -4.13723436e-03 -2.70702779e-04]
 [-1.60224123e-03 -2.96326951e-04  7.04243470e-04  1.27757579e-04]
 [ 2.70233277e-03 -5.31717120e-04  2.80297961e-04  9.18892525e-05]
 [-8.65573979e-04 -2.36720947e-04  2.71289621e-03  2.41827360e-05]
 [-4.37423087e-04 -5.35938428e-04  1.72627395e-03  6.16218334e-04]
 [ 1.54887082e-03  4.43543040e-04  3.24146921e-03  6.73377932e-04]
 [ 7.90995934e-04 -1.85380568e-04 -4.19286295e-03 -3.95045606e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00010184006829571534
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.1181685398598255e-06, theta_kick=-2.539763778252466e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.2803422259695943e-06, theta_kick=3.933253756257273e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01731616466806603
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.725556764515509e-06, theta_kick=-4.4670827397739157e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.4496915645977703e-06, theta_kick=4.136309985270719e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.7872896076163595e-06, theta_kick=-2.143027488724524e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010003537010266543
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2002751563407752e-06, theta_kick=1.4391750744312125e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01543060e-01 -6.32184799e+00 -2.56504010e-03  9.17613712e-02]
 [ 1.79997724e-01  4.56363049e-01  3.79998506e-03 -1.69795244e-02]
 [ 7.87753273e-03  9.18286388e-02  3.84070515e-01 -5.11982691e+00]
 [ 2.58042910e-03 -8.65517018e-03  2.12658523e-01 -2.30347524e-01]]
compute_tune_4x4()/ evals =  [0.08219808+0.99661601j 0.08219808-0.99661601j 0.0720734 +0.99739933j
 0.0720734 -0.99739933j]
compute_tune_4x4()/ angles =  [0.23690299176792518, 0.23851920705880805, 0.761480792941192, 0.7630970082320748]
compute_tune_4x4()/  0.23690299176792518 0.23851920705880805
compute_tunes()/ 0.23690299176792518 0.23851920705880805

 Running simulation ..
Closed orbit computation: x_co=[-9.44738357e-09  8.92350874e-10], y_co=[ 4.58388375e-08 -1.25081317e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 15/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.10713643e-04 -3.52438228e-04 -1.17653801e-03  8.89505019e-04]
 [-1.04546125e-03 -4.20070815e-05  2.20988712e-03 -7.11327029e-04]
 [ 2.15382613e-03 -1.20511409e-04  1.18037684e-03  3.02377015e-04]
 [ 1.47146194e-03 -1.90353321e-04 -3.45788731e-03  2.53683950e-04]
 [ 8.51568336e-04 -3.64339587e-04 -1.33637606e-03 -7.00732012e-04]
 [ 1.90673791e-03 -1.21278306e-05  5.49830900e-05 -3.11862861e-04]
 [ 9.98010585e-04  4.33564208e-05  2.79368434e-03 -5.02774397e-04]
 [ 1.14185460e-03  1.02337901e-04 -3.59780887e-03 -6.18771302e-04]
 [ 8.21577078e-04  8.29593310e-05 -1.25695200e-03  1.85905144e-04]
 [ 3.06772231e-03 -4.79813269e-04  2.40002797e-03  7.25527313e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017287971720042154
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.1394095475669422e-05, theta_kick=-2.565232545714987e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.481618019819321e-05, theta_kick=4.174591006357484e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0003802979064054878
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.169178712385015e-05, theta_kick=-9.795152652564472e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00010319655533650132, theta_kick=1.2373655275864735e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.2148456339668674e-05, theta_kick=3.85472087804801e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012058307670956635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.5343024092280702e-05, theta_kick=3.0387239452255125e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01565022e-01 -6.31936049e+00  8.35773577e-03  5.62535815e-02]
 [ 1.80009208e-01  4.56130985e-01  4.92073840e-04  4.51686859e-03]
 [ 1.28738831e-02  5.62524114e-02  3.83999331e-01 -5.11976117e+00]
 [ 2.82185741e-03  1.31122957e-02  2.12558479e-01 -2.29840815e-01]]
compute_tune_4x4()/ evals =  [0.08684321+0.99622199j 0.08684321-0.99622199j 0.06751903+0.99771799j
 0.06751903-0.99771799j]
compute_tune_4x4()/ angles =  [0.23616104096065535, 0.23924583156155577, 0.7607541684384442, 0.7638389590393446]
compute_tune_4x4()/  0.23616104096065535 0.23924583156155577
compute_tunes()/ 0.23616104096065535 0.23924583156155577

 Running simulation ..
Closed orbit computation: x_co=[ 6.66512939e-09 -4.43377294e-08], y_co=[-2.41683096e-05 -1.08346845e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.1394095475669422e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.481618019819321e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.169178712385015e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00010319655533650132, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.2148456339668674e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.5343024092280702e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0017287971720042154}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0003802979064054878}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012058307670956635}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.10713643e-04 -3.52438228e-04 -1.17653801e-03  8.89505019e-04]
 [-1.04546125e-03 -4.20070815e-05  2.20988712e-03 -7.11327029e-04]
 [ 2.15382613e-03 -1.20511409e-04  1.18037684e-03  3.02377015e-04]
 [ 1.47146194e-03 -1.90353321e-04 -3.45788731e-03  2.53683950e-04]
 [ 8.51568336e-04 -3.64339587e-04 -1.33637606e-03 -7.00732012e-04]
 [ 1.90673791e-03 -1.21278306e-05  5.49830900e-05 -3.11862861e-04]
 [ 9.98010585e-04  4.33564208e-05  2.79368434e-03 -5.02774397e-04]
 [ 1.14185460e-03  1.02337901e-04 -3.59780887e-03 -6.18771302e-04]
 [ 8.21577078e-04  8.29593310e-05 -1.25695200e-03  1.85905144e-04]
 [ 3.06772231e-03 -4.79813269e-04  2.40002797e-03  7.25527313e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017287971720042154
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.474227249854772e-06, theta_kick=4.1657291950822573e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.964005174375454e-06, theta_kick=-7.151066607849562e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0003802979064054878
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.4361682155331845e-06, theta_kick=6.518170233617109e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.561591337405276e-06, theta_kick=-3.07144439689287e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.363741006610966e-07, theta_kick=6.431327284947526e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012058307670956635
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.705878051330725e-08, theta_kick=-2.0454119695179644e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01565022e-01 -6.31936049e+00  8.35773577e-03  5.62535815e-02]
 [ 1.80009208e-01  4.56130985e-01  4.92073840e-04  4.51686859e-03]
 [ 1.28738831e-02  5.62524114e-02  3.83999331e-01 -5.11976117e+00]
 [ 2.82185741e-03  1.31122957e-02  2.12558479e-01 -2.29840815e-01]]
compute_tune_4x4()/ evals =  [0.08684321+0.99622199j 0.08684321-0.99622199j 0.06751903+0.99771799j
 0.06751903-0.99771799j]
compute_tune_4x4()/ angles =  [0.23616104096065535, 0.23924583156155577, 0.7607541684384442, 0.7638389590393446]
compute_tune_4x4()/  0.23616104096065535 0.23924583156155577
compute_tunes()/ 0.23616104096065535 0.23924583156155577

 Running simulation ..
Closed orbit computation: x_co=[-1.59399670e-11  5.02998074e-10], y_co=[1.86236617e-07 8.51037402e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 16/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.48483265e-03 -5.45079882e-04  3.34045258e-03  8.43111139e-05]
 [ 4.19330807e-03 -6.02906158e-04 -7.91447710e-04 -1.41904629e-04]
 [-1.26534527e-03 -4.56179468e-04  9.91875688e-04 -2.43684838e-04]
 [-2.21777001e-04  4.03898167e-04  8.82194368e-04  9.02109223e-04]
 [ 1.73153993e-03  2.27506794e-05  6.35997063e-04  1.39340868e-04]
 [-5.23916030e-03  1.02808438e-03  2.40494198e-03 -2.24765302e-04]
 [ 3.90201318e-03  1.33626759e-04  1.83149638e-03  1.83616144e-04]
 [-6.32936591e-04  5.44425349e-04 -4.92596890e-04  2.84418291e-04]
 [-2.55837121e-03  8.70981404e-04 -2.51633724e-04 -3.34945282e-04]
 [-1.04345847e-03 -3.85186612e-04  2.81119185e-04 -4.62799417e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004228751981380442
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.2695420183312053e-06, theta_kick=2.721266274571826e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0357923744299842e-05, theta_kick=-1.2419540300327002e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.02063846031391258
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.7272132530063305e-05, theta_kick=3.2700313054474566e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.6123968482697214e-05, theta_kick=-3.132362116045506e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.234079256556733e-06, theta_kick=-6.275857967933517e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0016621825555646268
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.990066510360226e-06, theta_kick=9.580390382997528e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01704782e-01 -6.32178397e+00  7.70381342e-03 -8.48140655e-02]
 [ 1.80010514e-01  4.56689127e-01 -4.29814770e-03  2.10618926e-02]
 [-2.96028862e-03 -8.48102574e-02  3.83883161e-01 -5.11851007e+00]
 [-1.87440923e-03  1.46328164e-02  2.12667927e-01 -2.30123765e-01]]
compute_tune_4x4()/ evals =  [0.08724445+0.99618693j 0.08724445-0.99618693j 0.06712742+0.99774441j
 0.06712742-0.99774441j]
compute_tune_4x4()/ angles =  [0.23609693919885047, 0.23930829896873507, 0.7606917010312649, 0.7639030608011496]
compute_tune_4x4()/  0.23609693919885047 0.23930829896873507
compute_tunes()/ 0.23609693919885047 0.23930829896873507

 Running simulation ..
Closed orbit computation: x_co=[-5.29804688e-08  2.95642074e-10], y_co=[6.27077528e-06 1.07095201e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.2695420183312053e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.0357923744299842e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.7272132530063305e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.6123968482697214e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.234079256556733e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.990066510360226e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004228751981380442}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.02063846031391258}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0016621825555646268}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.48483265e-03 -5.45079882e-04  3.34045258e-03  8.43111139e-05]
 [ 4.19330807e-03 -6.02906158e-04 -7.91447710e-04 -1.41904629e-04]
 [-1.26534527e-03 -4.56179468e-04  9.91875688e-04 -2.43684838e-04]
 [-2.21777001e-04  4.03898167e-04  8.82194368e-04  9.02109223e-04]
 [ 1.73153993e-03  2.27506794e-05  6.35997063e-04  1.39340868e-04]
 [-5.23916030e-03  1.02808438e-03  2.40494198e-03 -2.24765302e-04]
 [ 3.90201318e-03  1.33626759e-04  1.83149638e-03  1.83616144e-04]
 [-6.32936591e-04  5.44425349e-04 -4.92596890e-04  2.84418291e-04]
 [-2.55837121e-03  8.70981404e-04 -2.51633724e-04 -3.34945282e-04]
 [-1.04345847e-03 -3.85186612e-04  2.81119185e-04 -4.62799417e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004228751981380442
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.118636646364139e-07, theta_kick=7.336475560982589e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1216139650739935e-06, theta_kick=-1.3448573463684672e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.02063846031391258
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.4793254881630725e-06, theta_kick=4.171842174642032e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.736926241642627e-06, theta_kick=-6.878790423350462e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.7761565151547168e-06, theta_kick=4.527753744674485e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0016621825555646268
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2349764485000596e-06, theta_kick=-1.4807832294133176e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01704782e-01 -6.32178397e+00  7.70381342e-03 -8.48140655e-02]
 [ 1.80010514e-01  4.56689127e-01 -4.29814770e-03  2.10618926e-02]
 [-2.96028862e-03 -8.48102574e-02  3.83883161e-01 -5.11851007e+00]
 [-1.87440923e-03  1.46328164e-02  2.12667927e-01 -2.30123765e-01]]
compute_tune_4x4()/ evals =  [0.08724445+0.99618693j 0.08724445-0.99618693j 0.06712742+0.99774441j
 0.06712742-0.99774441j]
compute_tune_4x4()/ angles =  [0.23609693919885047, 0.23930829896873507, 0.7606917010312649, 0.7639030608011496]
compute_tune_4x4()/  0.23609693919885047 0.23930829896873507
compute_tunes()/ 0.23609693919885047 0.23930829896873507

 Running simulation ..
Closed orbit computation: x_co=[-7.19381935e-09  7.16661818e-10], y_co=[-8.09370501e-08  5.06798061e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 17/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.26563997e-03  2.72522449e-04  3.91072648e-04  1.73150060e-04]
 [ 1.04989077e-04  4.54807988e-04 -2.55942650e-03 -9.11054259e-04]
 [-4.48776591e-03  3.39467305e-04 -4.24634719e-03  5.48705702e-04]
 [-4.28421640e-03  6.03373966e-04  2.67556512e-03 -1.32862716e-04]
 [-2.44043331e-03 -7.37113806e-04  5.58020028e-04 -1.49144753e-04]
 [-3.64067325e-03  9.41505737e-04 -2.95299999e-03 -4.45957382e-04]
 [-4.55364474e-03  4.57074708e-04 -3.79831053e-03 -7.58115894e-04]
 [-1.42744078e-03  5.76435161e-04 -1.48352804e-03 -3.91309215e-04]
 [ 1.53855494e-03 -2.34123132e-04  5.85247839e-04  8.25466306e-04]
 [ 2.89006309e-05 -6.83144320e-04  6.24958922e-04  3.85809502e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005933220180065942
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2497578511276124e-05, theta_kick=-1.4985066873340498e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.8296421353033096e-06, theta_kick=4.5918850157015555e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014240813626986417
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.392460958492552e-05, theta_kick=2.868650708816907e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.0816495297724476e-05, theta_kick=-3.6950137374350556e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00010624360068513277, theta_kick=1.2739007478086517e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0015972436479089515
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.287063088264328e-05, theta_kick=-6.339387575739362e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01599006e-01 -6.32034612e+00 -8.54524400e-03  2.35660891e-02]
 [ 1.79973187e-01  4.56198775e-01  2.60117884e-03 -1.84383770e-02]
 [-4.36363314e-03  2.35760807e-02  3.84024520e-01 -5.11865434e+00]
 [-4.53974156e-04 -1.96070302e-02  2.12607024e-01 -2.30084602e-01]]
compute_tune_4x4()/ evals =  [0.08980445+0.99595942j 0.08980445-0.99595942j 0.06446539+0.99791994j
 0.06446539-0.99791994j]
compute_tune_4x4()/ angles =  [0.23568789618201738, 0.23973289429042832, 0.7602671057095717, 0.7643121038179826]
compute_tune_4x4()/  0.23568789618201738 0.23973289429042832
compute_tunes()/ 0.23568789618201738 0.23973289429042832

 Running simulation ..
Closed orbit computation: x_co=[2.11503033e-07 1.59516097e-08], y_co=[-4.40910508e-05 -5.65015052e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.2497578511276124e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.8296421353033096e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.392460958492552e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.0816495297724476e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00010624360068513277, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.287063088264328e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.005933220180065942}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.014240813626986417}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0015972436479089515}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.26563997e-03  2.72522449e-04  3.91072648e-04  1.73150060e-04]
 [ 1.04989077e-04  4.54807988e-04 -2.55942650e-03 -9.11054259e-04]
 [-4.48776591e-03  3.39467305e-04 -4.24634719e-03  5.48705702e-04]
 [-4.28421640e-03  6.03373966e-04  2.67556512e-03 -1.32862716e-04]
 [-2.44043331e-03 -7.37113806e-04  5.58020028e-04 -1.49144753e-04]
 [-3.64067325e-03  9.41505737e-04 -2.95299999e-03 -4.45957382e-04]
 [-4.55364474e-03  4.57074708e-04 -3.79831053e-03 -7.58115894e-04]
 [-1.42744078e-03  5.76435161e-04 -1.48352804e-03 -3.91309215e-04]
 [ 1.53855494e-03 -2.34123132e-04  5.85247839e-04  8.25466306e-04]
 [ 2.89006309e-05 -6.83144320e-04  6.24958922e-04  3.85809502e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.005933220180065942
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.0036274114677965e-06, theta_kick=-4.800499908254468e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.0436705625642374e-06, theta_kick=7.246588405806057e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014240813626986417
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.0529433279709795e-06, theta_kick=-7.257706800429101e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.2921218094266e-06, theta_kick=7.54449079910874e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.533828969130189e-06, theta_kick=-5.436231525443483e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0015972436479089515
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.198927701720851e-06, theta_kick=2.6365970519966955e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01599006e-01 -6.32034612e+00 -8.54524400e-03  2.35660891e-02]
 [ 1.79973187e-01  4.56198775e-01  2.60117884e-03 -1.84383770e-02]
 [-4.36363314e-03  2.35760807e-02  3.84024520e-01 -5.11865434e+00]
 [-4.53974156e-04 -1.96070302e-02  2.12607024e-01 -2.30084602e-01]]
compute_tune_4x4()/ evals =  [0.08980445+0.99595942j 0.08980445-0.99595942j 0.06446539+0.99791994j
 0.06446539-0.99791994j]
compute_tune_4x4()/ angles =  [0.23568789618201738, 0.23973289429042832, 0.7602671057095717, 0.7643121038179826]
compute_tune_4x4()/  0.23568789618201738 0.23973289429042832
compute_tunes()/ 0.23568789618201738 0.23973289429042832

 Running simulation ..
Closed orbit computation: x_co=[-6.08158043e-09  1.17552966e-09], y_co=[ 1.14901052e-07 -1.17013308e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 18/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.70788718e-03  1.45392897e-04  6.30406611e-03  2.75349942e-04]
 [-2.49241453e-03 -4.32311177e-04 -2.79038782e-03 -5.07413106e-04]
 [-7.82236081e-04 -1.68584294e-04 -2.52542475e-03  2.91411736e-04]
 [-1.20800602e-03 -6.38549635e-04 -2.19284920e-03  6.94450324e-04]
 [-1.25084060e-03  1.26690933e-03 -4.76957870e-03 -2.64588667e-04]
 [-1.83370975e-03  2.83506373e-04  1.20825896e-03  5.89508533e-04]
 [ 1.56353808e-03 -5.81205374e-05  1.33474278e-03 -2.02790372e-04]
 [-4.39755352e-03  4.37268179e-04 -3.93299074e-03 -6.61636633e-04]
 [ 3.90618996e-03 -8.51471243e-04 -1.47957141e-03 -2.60852779e-04]
 [-1.09411871e-03 -2.63423696e-04 -7.82074382e-04 -3.60359218e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0029701658231818164
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.926981610516973e-05, theta_kick=-9.504749214430658e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.595886293518059e-05, theta_kick=3.1125653396662755e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004233852306868484
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.0809600542961804e-05, theta_kick=3.6941870303965625e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.99368384971175e-06, theta_kick=-2.3905019508598335e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00011074045409668843, theta_kick=1.3278197122152135e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01869902165396934
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.2924321442728794e-05, theta_kick=2.7487123968478877e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01406705e-01 -6.31808587e+00  1.25578792e-02  5.30650530e-02]
 [ 1.80023244e-01  4.56261923e-01 -1.96820110e-04  8.57172068e-03]
 [ 1.59310869e-02  5.30517728e-02  3.83769565e-01 -5.12021671e+00]
 [ 3.08577163e-03  1.76882192e-02  2.12516102e-01 -2.29946793e-01]]
compute_tune_4x4()/ evals =  [0.09078405+0.9958706j  0.09078405-0.9958706j  0.06355494+0.99797834j
 0.06355494-0.99797834j]
compute_tune_4x4()/ angles =  [0.2355313482189699, 0.23987809476934016, 0.7601219052306598, 0.7644686517810301]
compute_tune_4x4()/  0.2355313482189699 0.23987809476934016
compute_tunes()/ 0.2355313482189699 0.23987809476934016

 Running simulation ..
Closed orbit computation: x_co=[-4.25324619e-08 -2.44982191e-08], y_co=[-4.80183460e-05 -1.81294573e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 7.926981610516973e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.595886293518059e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.0809600542961804e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.99368384971175e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00011074045409668843, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.2924321442728794e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0029701658231818164}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004233852306868484}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.01869902165396934}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.70788718e-03  1.45392897e-04  6.30406611e-03  2.75349942e-04]
 [-2.49241453e-03 -4.32311177e-04 -2.79038782e-03 -5.07413106e-04]
 [-7.82236081e-04 -1.68584294e-04 -2.52542475e-03  2.91411736e-04]
 [-1.20800602e-03 -6.38549635e-04 -2.19284920e-03  6.94450324e-04]
 [-1.25084060e-03  1.26690933e-03 -4.76957870e-03 -2.64588667e-04]
 [-1.83370975e-03  2.83506373e-04  1.20825896e-03  5.89508533e-04]
 [ 1.56353808e-03 -5.81205374e-05  1.33474278e-03 -2.02790372e-04]
 [-4.39755352e-03  4.37268179e-04 -3.93299074e-03 -6.61636633e-04]
 [ 3.90618996e-03 -8.51471243e-04 -1.47957141e-03 -2.60852779e-04]
 [-1.09411871e-03 -2.63423696e-04 -7.82074382e-04 -3.60359218e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0029701658231818164
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.9259494664990107e-06, theta_kick=3.5083235031444163e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.0473823780316867e-06, theta_kick=-3.653926133149882e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004233852306868484
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.2099157323466598e-06, theta_kick=2.649772114156577e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.996544231865108e-06, theta_kick=-2.3939316566874624e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6678686229200206e-06, theta_kick=1.9998372346972993e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01869902165396934
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.370636152450063e-06, theta_kick=-2.8424819451840717e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01406705e-01 -6.31808587e+00  1.25578792e-02  5.30650530e-02]
 [ 1.80023244e-01  4.56261923e-01 -1.96820110e-04  8.57172068e-03]
 [ 1.59310869e-02  5.30517728e-02  3.83769565e-01 -5.12021671e+00]
 [ 3.08577163e-03  1.76882192e-02  2.12516102e-01 -2.29946793e-01]]
compute_tune_4x4()/ evals =  [0.09078405+0.9958706j  0.09078405-0.9958706j  0.06355494+0.99797834j
 0.06355494-0.99797834j]
compute_tune_4x4()/ angles =  [0.2355313482189699, 0.23987809476934016, 0.7601219052306598, 0.7644686517810301]
compute_tune_4x4()/  0.2355313482189699 0.23987809476934016
compute_tunes()/ 0.2355313482189699 0.23987809476934016

 Running simulation ..
Closed orbit computation: x_co=[-2.03958217e-09  8.91786608e-10], y_co=[-3.76761557e-07  2.24755865e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 19/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.00198853e-03  1.05646622e-03 -2.54561009e-03 -2.67247615e-04]
 [-7.01768521e-03  4.85231318e-04  5.44200650e-06  1.73416354e-04]
 [ 2.47723338e-04 -7.19121023e-05 -9.71414677e-04 -1.73703856e-04]
 [-7.90883233e-04 -1.80151056e-05 -2.78295111e-03 -1.26242383e-04]
 [-1.86852423e-04  1.06663523e-04 -5.45512112e-03  8.26060009e-05]
 [ 1.75795465e-03 -3.47398962e-04 -5.94758621e-04  6.76430042e-04]
 [ 2.40379996e-03 -6.28134258e-04  3.67687284e-03 -3.69462176e-05]
 [-2.39481662e-03  5.89047962e-04  4.77746673e-03  2.81324614e-04]
 [-6.19529046e-04 -1.71587764e-04 -5.90595638e-04 -4.99903843e-04]
 [-2.37055839e-03  4.10229015e-04  6.85819310e-04  1.46696015e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01074939169539826
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.145324467225487e-05, theta_kick=6.1694376360061794e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.084189486606492e-05, theta_kick=-9.69324737302128e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0035874778356161834
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.158483426630042e-05, theta_kick=-4.986178097101336e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.36762938098905e-06, theta_kick=1.1232140097550509e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.557830299573107e-05, theta_kick=1.026116052914542e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0014036650210710797
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5857084638732005e-05, theta_kick=-1.9013241126128856e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01592229e-01 -6.31949823e+00  5.19809698e-03  2.84002643e-02]
 [ 1.79998733e-01  4.56094889e-01 -2.95076904e-04  8.58420436e-03]
 [ 7.29250473e-03  2.84014214e-02  3.84055798e-01 -5.11957294e+00]
 [ 1.83170876e-03  1.44017625e-02  2.12565695e-01 -2.29910814e-01]]
compute_tune_4x4()/ evals =  [0.08598249+0.99629665j 0.08598249-0.99629665j 0.06834133+0.997662j
 0.06834133-0.997662j  ]
compute_tune_4x4()/ angles =  [0.23629854304333006, 0.23911465535870438, 0.7608853446412956, 0.7637014569566699]
compute_tune_4x4()/  0.23629854304333006 0.23911465535870438
compute_tunes()/ 0.23629854304333006 0.23911465535870438

 Running simulation ..
Closed orbit computation: x_co=[ 1.84244067e-07 -5.82436457e-08], y_co=[ 8.09787642e-06 -7.37396591e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.145324467225487e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 8.084189486606492e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.158483426630042e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.36762938098905e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.557830299573107e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.5857084638732005e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.01074939169539826}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0035874778356161834}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0014036650210710797}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.00198853e-03  1.05646622e-03 -2.54561009e-03 -2.67247615e-04]
 [-7.01768521e-03  4.85231318e-04  5.44200650e-06  1.73416354e-04]
 [ 2.47723338e-04 -7.19121023e-05 -9.71414677e-04 -1.73703856e-04]
 [-7.90883233e-04 -1.80151056e-05 -2.78295111e-03 -1.26242383e-04]
 [-1.86852423e-04  1.06663523e-04 -5.45512112e-03  8.26060009e-05]
 [ 1.75795465e-03 -3.47398962e-04 -5.94758621e-04  6.76430042e-04]
 [ 2.40379996e-03 -6.28134258e-04  3.67687284e-03 -3.69462176e-05]
 [-2.39481662e-03  5.89047962e-04  4.77746673e-03  2.81324614e-04]
 [-6.19529046e-04 -1.71587764e-04 -5.90595638e-04 -4.99903843e-04]
 [-2.37055839e-03  4.10229015e-04  6.85819310e-04  1.46696015e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01074939169539826
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.6758465826094418e-06, theta_kick=2.0094031085464553e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5661893636964135e-06, theta_kick=-1.8779199770683338e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0035874778356161834
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.3038290354096214e-06, theta_kick=1.5633400717897309e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.9998620436185295e-06, theta_kick=-2.397909837816976e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5675934529499563e-06, theta_kick=1.8796035329140917e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0014036650210710797
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.2182297735892593e-07, theta_kick=-2.6597409624335175e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01592229e-01 -6.31949823e+00  5.19809698e-03  2.84002643e-02]
 [ 1.79998733e-01  4.56094889e-01 -2.95076904e-04  8.58420436e-03]
 [ 7.29250473e-03  2.84014214e-02  3.84055798e-01 -5.11957294e+00]
 [ 1.83170876e-03  1.44017625e-02  2.12565695e-01 -2.29910814e-01]]
compute_tune_4x4()/ evals =  [0.08598249+0.99629665j 0.08598249-0.99629665j 0.06834133+0.997662j
 0.06834133-0.997662j  ]
compute_tune_4x4()/ angles =  [0.23629854304333006, 0.23911465535870438, 0.7608853446412956, 0.7637014569566699]
compute_tune_4x4()/  0.23629854304333006 0.23911465535870438
compute_tunes()/ 0.23629854304333006 0.23911465535870438

 Running simulation ..
Closed orbit computation: x_co=[1.30000704e-09 4.06340493e-10], y_co=[2.16082337e-07 5.08570542e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 20/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.35131891e-03  3.83113648e-04  3.64239480e-03 -3.41066939e-05]
 [-1.56954367e-03  3.06025985e-04 -2.35447017e-03 -3.12263705e-04]
 [-2.77880125e-03 -1.02611074e-05 -2.19452029e-03  5.97339530e-04]
 [-3.25021084e-03 -2.10988797e-04  3.74183230e-03 -1.88083411e-04]
 [-2.44633779e-03  8.95341897e-04 -1.78895844e-03 -2.49264034e-04]
 [ 2.29034270e-04  1.52918272e-04  2.78713651e-03 -3.53230181e-04]
 [-1.62365986e-03  4.15417714e-04 -1.56880575e-04 -5.07760414e-04]
 [ 2.67655108e-03  9.00544319e-04  5.00342271e-04  7.47618644e-06]
 [-1.37665455e-03  3.13065269e-05 -7.01975203e-04 -5.13809242e-04]
 [-2.26831987e-03  5.41513006e-04  8.30115631e-04  2.84490118e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018208149187164936
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.954381389296907e-05, theta_kick=-8.338564953787012e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.3944059573486117e-05, theta_kick=1.6719452092739616e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007733394458060439
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.9651963867549626e-05, theta_kick=-3.55538203724984e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.3834261137330953e-05, theta_kick=-1.6587799636474683e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.0528215400014832e-05, theta_kick=2.4614102666529265e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006397323979367538
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.1285468816485153e-05, theta_kick=-4.950283053265429e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01471282e-01 -6.31945174e+00  7.28184183e-03  1.24981984e-01]
 [ 1.80068558e-01  4.56504114e-01  2.56639272e-03  1.24602131e-03]
 [ 1.94559592e-02  1.24969845e-01  3.83930175e-01 -5.12120727e+00]
 [ 5.34199315e-03  1.82930343e-02  2.12576351e-01 -2.30083177e-01]]
compute_tune_4x4()/ evals =  [0.08872904+0.9960558j 0.08872904-0.9960558j 0.06571088+0.9978387j
 0.06571088-0.9978387j]
compute_tune_4x4()/ angles =  [0.23585973925485693, 0.2395342483115006, 0.7604657516884994, 0.7641402607451431]
compute_tune_4x4()/  0.23585973925485693 0.2395342483115006
compute_tunes()/ 0.23585973925485693 0.2395342483115006

 Running simulation ..
Closed orbit computation: x_co=[ 1.61220797e-07 -1.06327168e-07], y_co=[ 2.28265263e-06 -4.12314887e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.954381389296907e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.3944059573486117e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.9651963867549626e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.3834261137330953e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.0528215400014832e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.1285468816485153e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.018208149187164936}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.007733394458060439}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006397323979367538}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.35131891e-03  3.83113648e-04  3.64239480e-03 -3.41066939e-05]
 [-1.56954367e-03  3.06025985e-04 -2.35447017e-03 -3.12263705e-04]
 [-2.77880125e-03 -1.02611074e-05 -2.19452029e-03  5.97339530e-04]
 [-3.25021084e-03 -2.10988797e-04  3.74183230e-03 -1.88083411e-04]
 [-2.44633779e-03  8.95341897e-04 -1.78895844e-03 -2.49264034e-04]
 [ 2.29034270e-04  1.52918272e-04  2.78713651e-03 -3.53230181e-04]
 [-1.62365986e-03  4.15417714e-04 -1.56880575e-04 -5.07760414e-04]
 [ 2.67655108e-03  9.00544319e-04  5.00342271e-04  7.47618644e-06]
 [-1.37665455e-03  3.13065269e-05 -7.01975203e-04 -5.13809242e-04]
 [-2.26831987e-03  5.41513006e-04  8.30115631e-04  2.84490118e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.018208149187164936
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.556204519670881e-07, theta_kick=5.463060652452172e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.2094394449147904e-06, theta_kick=-2.649201027604806e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007733394458060439
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.842201579990956e-06, theta_kick=5.805981888802741e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.156212509938099e-06, theta_kick=-4.983455182541378e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6942048223706103e-06, theta_kick=3.2304529551283123e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006397323979367538
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.496623859348613e-07, theta_kick=-5.39162119892272e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01471282e-01 -6.31945174e+00  7.28184183e-03  1.24981984e-01]
 [ 1.80068558e-01  4.56504114e-01  2.56639272e-03  1.24602131e-03]
 [ 1.94559592e-02  1.24969845e-01  3.83930175e-01 -5.12120727e+00]
 [ 5.34199315e-03  1.82930343e-02  2.12576351e-01 -2.30083177e-01]]
compute_tune_4x4()/ evals =  [0.08872904+0.9960558j 0.08872904-0.9960558j 0.06571088+0.9978387j
 0.06571088-0.9978387j]
compute_tune_4x4()/ angles =  [0.23585973925485693, 0.2395342483115006, 0.7604657516884994, 0.7641402607451431]
compute_tune_4x4()/  0.23585973925485693 0.2395342483115006
compute_tunes()/ 0.23585973925485693 0.2395342483115006

 Running simulation ..
Closed orbit computation: x_co=[ 6.77646829e-09 -2.26176911e-09], y_co=[-6.12507168e-07 -6.98679933e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 21/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.75733414e-05  1.66003612e-04  1.31391296e-03  2.56852738e-04]
 [ 1.96326172e-03  2.81322279e-04 -3.73758793e-04  4.76731980e-04]
 [-3.62238196e-04 -4.98365660e-04  5.35893829e-04 -1.89687367e-04]
 [-6.02797337e-03  6.09058775e-04  5.23769031e-03 -1.03370763e-04]
 [ 4.98960899e-04  8.66226528e-04  3.11832495e-03  3.04514636e-04]
 [-1.47187123e-03 -1.72931038e-04 -1.01689020e-03 -5.25978797e-04]
 [ 9.87269252e-04  1.18305933e-04 -6.14293539e-04 -1.03555267e-04]
 [ 1.72624085e-03  1.26753507e-04 -1.28563175e-03 -3.03178651e-04]
 [-3.20795406e-03  2.55602845e-04 -1.53568957e-03 -7.35243003e-04]
 [-1.55084240e-03 -3.22761305e-04  8.36142790e-04  1.16654985e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.02557117370541218
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.759314178670376e-05, theta_kick=9.303709654932346e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.001751867766439e-05, theta_kick=-9.59440156620498e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0077754050855548046
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.980165433359975e-05, theta_kick=4.7723681137144825e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.575003095163336e-05, theta_kick=-6.684638478144069e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6878331049071432e-05, theta_kick=3.2228130261451153e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00982371593628082
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.2696478689369054e-05, theta_kick=3.92043081978541e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01000139e-01 -6.31721656e+00 -7.95542033e-03 -4.27798813e-02]
 [ 1.80003300e-01  4.56133691e-01  8.17450190e-04 -1.77873530e-02]
 [-1.10878397e-02 -4.27675442e-02  3.83864694e-01 -5.12223866e+00]
 [-3.04853213e-03 -2.76748703e-02  2.12500651e-01 -2.30955143e-01]]
compute_tune_4x4()/ evals =  [0.09305848+0.99566064j 0.09305848-0.99566064j 0.06096307+0.99814002j
 0.06096307-0.99814002j]
compute_tune_4x4()/ angles =  [0.23516782205483755, 0.24029140644817892, 0.7597085935518211, 0.7648321779451625]
compute_tune_4x4()/  0.23516782205483755 0.24029140644817892
compute_tunes()/ 0.23516782205483755 0.24029140644817892

 Running simulation ..
Closed orbit computation: x_co=[-2.74038646e-07 -5.55306060e-08], y_co=[2.97033301e-05 1.15853915e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.759314178670376e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 8.001751867766439e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.980165433359975e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.575003095163336e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.6878331049071432e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.2696478689369054e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.02557117370541218}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0077754050855548046}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00982371593628082}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.75733414e-05  1.66003612e-04  1.31391296e-03  2.56852738e-04]
 [ 1.96326172e-03  2.81322279e-04 -3.73758793e-04  4.76731980e-04]
 [-3.62238196e-04 -4.98365660e-04  5.35893829e-04 -1.89687367e-04]
 [-6.02797337e-03  6.09058775e-04  5.23769031e-03 -1.03370763e-04]
 [ 4.98960899e-04  8.66226528e-04  3.11832495e-03  3.04514636e-04]
 [-1.47187123e-03 -1.72931038e-04 -1.01689020e-03 -5.25978797e-04]
 [ 9.87269252e-04  1.18305933e-04 -6.14293539e-04 -1.03555267e-04]
 [ 1.72624085e-03  1.26753507e-04 -1.28563175e-03 -3.03178651e-04]
 [-3.20795406e-03  2.55602845e-04 -1.53568957e-03 -7.35243003e-04]
 [-1.55084240e-03 -3.22761305e-04  8.36142790e-04  1.16654985e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.02557117370541218
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.321662874464774e-07, theta_kick=-1.5847235158392106e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.2160822121338607e-06, theta_kick=3.856203581798163e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0077754050855548046
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.547544343278838e-06, theta_kick=-4.253639148752666e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.1927487248897e-06, theta_kick=2.629188226283772e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.69717305450893e-07, theta_kick=-4.433049603500491e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00982371593628082
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.381311836650057e-07, theta_kick=-6.452395371290675e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01000139e-01 -6.31721656e+00 -7.95542033e-03 -4.27798813e-02]
 [ 1.80003300e-01  4.56133691e-01  8.17450190e-04 -1.77873530e-02]
 [-1.10878397e-02 -4.27675442e-02  3.83864694e-01 -5.12223866e+00]
 [-3.04853213e-03 -2.76748703e-02  2.12500651e-01 -2.30955143e-01]]
compute_tune_4x4()/ evals =  [0.09305848+0.99566064j 0.09305848-0.99566064j 0.06096307+0.99814002j
 0.06096307-0.99814002j]
compute_tune_4x4()/ angles =  [0.23516782205483755, 0.24029140644817892, 0.7597085935518211, 0.7648321779451625]
compute_tune_4x4()/  0.23516782205483755 0.24029140644817892
compute_tunes()/ 0.23516782205483755 0.24029140644817892

 Running simulation ..
Closed orbit computation: x_co=[-1.62537780e-09 -2.56960656e-10], y_co=[-3.71992040e-07  1.19414634e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 22/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.50024752e-03 -1.61335506e-04 -3.05536242e-04  5.75923056e-04]
 [-2.90300252e-03  2.96478864e-05  5.04321844e-04 -4.96636586e-04]
 [-1.30119559e-03  2.88758392e-04 -3.76198212e-03 -1.43238908e-04]
 [-9.48419221e-04  3.59846236e-04 -1.24934486e-03  7.65030764e-05]
 [ 3.33771839e-03  2.22360143e-05  3.45034349e-03  2.51261189e-04]
 [-9.31501362e-04 -3.56373441e-04  9.71387263e-05 -8.46813983e-05]
 [ 9.48054989e-04 -8.29491628e-05  1.73447381e-04  3.21074347e-04]
 [-3.94520128e-03 -2.04309410e-04  2.93856559e-03  1.93783451e-04]
 [-3.33369733e-03 -6.93894304e-05 -2.73220393e-04  6.06383603e-04]
 [ 5.40048826e-05  2.24425128e-04  2.92082608e-03  5.55676304e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007237522301308367
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.8630094221168684e-05, theta_kick=-3.4328560217258003e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.3290989942226845e-05, theta_kick=-6.389790208641335e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009003213902492316
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.341344300672374e-05, theta_kick=-5.205435165466177e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.6851725385096056e-05, theta_kick=3.2196229069270525e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.408840975526145e-05, theta_kick=-5.286366218269668e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002204122782067276
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.51455696745562e-06, theta_kick=1.1408311802073392e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01665231e-01 -6.31982519e+00 -3.78069067e-03 -4.19178886e-02]
 [ 1.80006521e-01  4.56122480e-01 -5.80153459e-04 -2.87420174e-03]
 [-7.61091339e-03 -4.19177728e-02  3.84071344e-01 -5.11944759e+00]
 [-1.98484794e-03 -9.16421736e-03  2.12574265e-01 -2.29773338e-01]]
compute_tune_4x4()/ evals =  [0.08301409+0.99654837j 0.08301409-0.99654837j 0.07136354+0.99745037j
 0.07136354-0.99745037j]
compute_tune_4x4()/ angles =  [0.23677267516745742, 0.23863247752326025, 0.7613675224767398, 0.7632273248325425]
compute_tune_4x4()/  0.23677267516745742 0.23863247752326025
compute_tunes()/ 0.23677267516745742 0.23863247752326025

 Running simulation ..
Closed orbit computation: x_co=[1.92200940e-08 1.61059862e-08], y_co=[ 4.19881493e-05 -3.82825312e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.8630094221168684e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.3290989942226845e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.341344300672374e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.6851725385096056e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.408840975526145e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -9.51455696745562e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007237522301308367}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0009003213902492316}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002204122782067276}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.50024752e-03 -1.61335506e-04 -3.05536242e-04  5.75923056e-04]
 [-2.90300252e-03  2.96478864e-05  5.04321844e-04 -4.96636586e-04]
 [-1.30119559e-03  2.88758392e-04 -3.76198212e-03 -1.43238908e-04]
 [-9.48419221e-04  3.59846236e-04 -1.24934486e-03  7.65030764e-05]
 [ 3.33771839e-03  2.22360143e-05  3.45034349e-03  2.51261189e-04]
 [-9.31501362e-04 -3.56373441e-04  9.71387263e-05 -8.46813983e-05]
 [ 9.48054989e-04 -8.29491628e-05  1.73447381e-04  3.21074347e-04]
 [-3.94520128e-03 -2.04309410e-04  2.93856559e-03  1.93783451e-04]
 [-3.33369733e-03 -6.93894304e-05 -2.73220393e-04  6.06383603e-04]
 [ 5.40048826e-05  2.24425128e-04  2.92082608e-03  5.55676304e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007237522301308367
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.867784925662426e-06, theta_kick=4.6376196565162917e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.276301723981562e-06, theta_kick=-6.326484295053418e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009003213902492316
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.752955865199127e-06, theta_kick=4.499935292421851e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.95997901140699e-06, theta_kick=-2.3500885815422289e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.3504844501258727e-07, theta_kick=5.2163945485714264e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002204122782067276
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.4674042005439236e-06, theta_kick=-1.7594728495229225e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01665231e-01 -6.31982519e+00 -3.78069067e-03 -4.19178886e-02]
 [ 1.80006521e-01  4.56122480e-01 -5.80153459e-04 -2.87420174e-03]
 [-7.61091339e-03 -4.19177728e-02  3.84071344e-01 -5.11944759e+00]
 [-1.98484794e-03 -9.16421736e-03  2.12574265e-01 -2.29773338e-01]]
compute_tune_4x4()/ evals =  [0.08301409+0.99654837j 0.08301409-0.99654837j 0.07136354+0.99745037j
 0.07136354-0.99745037j]
compute_tune_4x4()/ angles =  [0.23677267516745742, 0.23863247752326025, 0.7613675224767398, 0.7632273248325425]
compute_tune_4x4()/  0.23677267516745742 0.23863247752326025
compute_tunes()/ 0.23677267516745742 0.23863247752326025

 Running simulation ..
Closed orbit computation: x_co=[ 5.52421421e-11 -1.37279860e-09], y_co=[1.42166496e-07 2.38489271e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 23/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.49474578e-03 -2.13908730e-05 -1.93537759e-03 -6.24129974e-04]
 [-5.41921092e-03  5.45816035e-04 -1.12535916e-03 -5.64611852e-04]
 [ 6.10123793e-03 -6.72090590e-04  4.85946679e-03  9.08935211e-04]
 [-3.76580677e-04  6.89211808e-04 -1.18671884e-03 -1.60126259e-04]
 [-8.43005865e-04 -2.11477997e-04 -1.99814568e-03 -7.34324372e-04]
 [ 1.45894317e-03 -3.91868565e-04 -5.07895157e-03  1.73480956e-04]
 [-8.77243909e-04  1.84579229e-05 -2.52910724e-03 -2.22810525e-04]
 [-1.49466836e-03 -1.65131089e-05  6.52542511e-04  7.74098498e-05]
 [-2.25613404e-03 -5.86471615e-05 -2.35030740e-03 -6.15501807e-04]
 [-4.14599847e-03  2.69523760e-04  7.50457081e-04 -9.14737168e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002245929343091354
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.701116556707975e-05, theta_kick=9.233928516435068e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.511499142588817e-05, theta_kick=-6.6084948495849844e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005170101629297197
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.420644244289311e-05, theta_kick=8.897631660694414e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.276474702736207e-05, theta_kick=-7.525729329443375e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.0783537375754115e-05, theta_kick=7.288174837645896e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0034685911438408342
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.00013277279753399438, theta_kick=-1.5919957999961753e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686510e-01 -6.31985312e+00 -5.65104145e-03 -8.66841555e-03]
 [ 1.79996731e-01  4.56115676e-01  7.75341444e-04 -7.84398377e-03]
 [-5.51788216e-03 -8.66859970e-03  3.84055313e-01 -5.11903061e+00]
 [-1.01472799e-03 -1.08454527e-02  2.12576233e-01 -2.29746313e-01]]
compute_tune_4x4()/ evals =  [0.08460794+0.99641432j 0.08460794-0.99641432j 0.06976115+0.99756372j
 0.06976115-0.99756372j]
compute_tune_4x4()/ angles =  [0.2365181107714687, 0.23888814350871626, 0.7611118564912838, 0.7634818892285313]
compute_tune_4x4()/  0.2365181107714687 0.23888814350871626
compute_tunes()/ 0.2365181107714687 0.23888814350871626

 Running simulation ..
Closed orbit computation: x_co=[ 3.04130473e-07 -6.38669377e-08], y_co=[-4.36407868e-05  1.12562544e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.701116556707975e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.511499142588817e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.420644244289311e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.276474702736207e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.0783537375754115e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.00013277279753399438, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002245929343091354}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.005170101629297197}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0034685911438408342}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.49474578e-03 -2.13908730e-05 -1.93537759e-03 -6.24129974e-04]
 [-5.41921092e-03  5.45816035e-04 -1.12535916e-03 -5.64611852e-04]
 [ 6.10123793e-03 -6.72090590e-04  4.85946679e-03  9.08935211e-04]
 [-3.76580677e-04  6.89211808e-04 -1.18671884e-03 -1.60126259e-04]
 [-8.43005865e-04 -2.11477997e-04 -1.99814568e-03 -7.34324372e-04]
 [ 1.45894317e-03 -3.91868565e-04 -5.07895157e-03  1.73480956e-04]
 [-8.77243909e-04  1.84579229e-05 -2.52910724e-03 -2.22810525e-04]
 [-1.49466836e-03 -1.65131089e-05  6.52542511e-04  7.74098498e-05]
 [-2.25613404e-03 -5.86471615e-05 -2.35030740e-03 -6.15501807e-04]
 [-4.14599847e-03  2.69523760e-04  7.50457081e-04 -9.14737168e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002245929343091354
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6075646184736793e-06, theta_kick=-1.9275304643462826e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.8955128641077076e-06, theta_kick=3.47182887165885e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005170101629297197
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.4894849758752915e-06, theta_kick=-2.9849861563188926e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.2961453003265623e-06, theta_kick=1.5541269843142022e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.118974758178026e-07, theta_kick=-1.0933993848833088e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0034685911438408342
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.453500680009161e-07, theta_kick=-6.538952510681259e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686510e-01 -6.31985312e+00 -5.65104145e-03 -8.66841555e-03]
 [ 1.79996731e-01  4.56115676e-01  7.75341444e-04 -7.84398377e-03]
 [-5.51788216e-03 -8.66859970e-03  3.84055313e-01 -5.11903061e+00]
 [-1.01472799e-03 -1.08454527e-02  2.12576233e-01 -2.29746313e-01]]
compute_tune_4x4()/ evals =  [0.08460794+0.99641432j 0.08460794-0.99641432j 0.06976115+0.99756372j
 0.06976115-0.99756372j]
compute_tune_4x4()/ angles =  [0.2365181107714687, 0.23888814350871626, 0.7611118564912838, 0.7634818892285313]
compute_tune_4x4()/  0.2365181107714687 0.23888814350871626
compute_tunes()/ 0.2365181107714687 0.23888814350871626

 Running simulation ..
Closed orbit computation: x_co=[ 1.59145676e-09 -3.51013919e-10], y_co=[-1.25911390e-07  6.40690713e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 24/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.27060965e-03  2.86097038e-04 -2.53448919e-05 -6.40442422e-04]
 [ 2.48698997e-03  1.54741965e-04 -8.24734849e-05  1.55450977e-04]
 [ 3.43719613e-05  2.19681475e-04  2.16360228e-03 -8.51441399e-04]
 [ 1.12600236e-03 -2.85115088e-04  2.97417636e-03  1.33827414e-05]
 [-1.94089733e-03  1.70433482e-04 -1.04068692e-03  1.81152969e-04]
 [-1.94543230e-03  6.68201821e-04  3.68041189e-03 -2.57726685e-04]
 [-3.21755339e-03  3.30816994e-04 -1.30434640e-03  3.13133176e-04]
 [-5.10655943e-04  1.39203038e-04 -1.76370985e-03  3.65635578e-04]
 [ 9.68511405e-04 -5.27856257e-04  4.39846529e-04  3.19134557e-04]
 [-1.60973513e-03 -4.61893057e-04  1.26254774e-04  8.26606748e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0074975580246127585
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0679994297641702e-05, theta_kick=1.280571501212473e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.204713422022339e-07, theta_kick=-6.240647227397475e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003795459799990089
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.0010209895728549e-05, theta_kick=1.2002618312685462e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.975603407724877e-06, theta_kick=8.364010952389339e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.694132499166415e-05, theta_kick=-1.042459199501269e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008819016651861238
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.979259422526425e-05, theta_kick=-5.970319398989748e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01565926e-01 -6.31908359e+00  1.03569774e-02  5.67978287e-02]
 [ 1.80001584e-01  4.56130572e-01 -5.99178861e-05  1.01362471e-02]
 [ 1.45525427e-02  5.67959897e-02  3.83993131e-01 -5.11935295e+00]
 [ 3.24750754e-03  2.01222218e-02  2.12555550e-01 -2.29835538e-01]]
compute_tune_4x4()/ evals =  [0.09089681+0.99586032j 0.09089681-0.99586032j 0.06346431+0.99798411j
 0.06346431-0.99798411j]
compute_tune_4x4()/ angles =  [0.23551332781654222, 0.23989254861330822, 0.7601074513866918, 0.7644866721834578]
compute_tune_4x4()/  0.23551332781654222 0.23989254861330822
compute_tunes()/ 0.23551332781654222 0.23989254861330822

 Running simulation ..
Closed orbit computation: x_co=[-1.90607396e-07  1.27584363e-07], y_co=[6.31291152e-06 1.23659343e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.0679994297641702e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.204713422022339e-07, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.0010209895728549e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.975603407724877e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.694132499166415e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.979259422526425e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0074975580246127585}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003795459799990089}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.008819016651861238}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.27060965e-03  2.86097038e-04 -2.53448919e-05 -6.40442422e-04]
 [ 2.48698997e-03  1.54741965e-04 -8.24734849e-05  1.55450977e-04]
 [ 3.43719613e-05  2.19681475e-04  2.16360228e-03 -8.51441399e-04]
 [ 1.12600236e-03 -2.85115088e-04  2.97417636e-03  1.33827414e-05]
 [-1.94089733e-03  1.70433482e-04 -1.04068692e-03  1.81152969e-04]
 [-1.94543230e-03  6.68201821e-04  3.68041189e-03 -2.57726685e-04]
 [-3.21755339e-03  3.30816994e-04 -1.30434640e-03  3.13133176e-04]
 [-5.10655943e-04  1.39203038e-04 -1.76370985e-03  3.65635578e-04]
 [ 9.68511405e-04 -5.27856257e-04  4.39846529e-04  3.19134557e-04]
 [-1.60973513e-03 -4.61893057e-04  1.26254774e-04  8.26606748e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0074975580246127585
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.087922516840603e-06, theta_kick=-2.503497658604832e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.401391113173724e-06, theta_kick=5.277433552997953e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003795459799990089
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.306705311697515e-06, theta_kick=-7.561976967055595e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.663885356213898e-06, theta_kick=6.791211653459163e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9954005754797224e-06, theta_kick=-3.591597996004342e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008819016651861238
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.5143738639288555e-06, theta_kick=1.8157912432186647e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01565926e-01 -6.31908359e+00  1.03569774e-02  5.67978287e-02]
 [ 1.80001584e-01  4.56130572e-01 -5.99178861e-05  1.01362471e-02]
 [ 1.45525427e-02  5.67959897e-02  3.83993131e-01 -5.11935295e+00]
 [ 3.24750754e-03  2.01222218e-02  2.12555550e-01 -2.29835538e-01]]
compute_tune_4x4()/ evals =  [0.09089681+0.99586032j 0.09089681-0.99586032j 0.06346431+0.99798411j
 0.06346431-0.99798411j]
compute_tune_4x4()/ angles =  [0.23551332781654222, 0.23989254861330822, 0.7601074513866918, 0.7644866721834578]
compute_tune_4x4()/  0.23551332781654222 0.23989254861330822
compute_tunes()/ 0.23551332781654222 0.23989254861330822

 Running simulation ..
Closed orbit computation: x_co=[ 4.26920698e-09 -8.87248684e-10], y_co=[ 3.27857994e-07 -9.19345814e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 25/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.63929981e-04 -2.40361431e-04 -9.74355211e-04 -1.08486587e-03]
 [-1.08923354e-03 -1.61661363e-04 -2.60903690e-04  4.00867251e-04]
 [ 1.90493524e-03 -2.46514961e-04  1.95930954e-03  7.40460111e-04]
 [-1.98357366e-04 -4.17309435e-04 -3.64582249e-03 -5.96712100e-04]
 [ 2.82152646e-03 -2.47634390e-04 -3.61851828e-03 -2.86295369e-04]
 [-3.14539839e-03  2.81155698e-04  7.24630593e-04  1.84944042e-04]
 [-2.31042688e-03  4.78441270e-04  6.99924636e-04  2.74088090e-04]
 [ 1.36455193e-04 -4.89490911e-04 -3.59339683e-03 -2.07572329e-04]
 [ 1.40160542e-03 -3.24022202e-04 -2.20854789e-03 -3.07981360e-04]
 [ 2.46220589e-03 -6.81635463e-05  3.19448911e-03  3.95555912e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0016726366334491127
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.628948001776484e-06, theta_kick=-6.749320450923417e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.1194317431753857e-05, theta_kick=2.541278406557559e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008304902162314066
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00010401674178068363, theta_kick=-1.2471998716584791e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.600898789984499e-05, theta_kick=3.1185755115315067e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.825081060069242e-05, theta_kick=4.586416114879275e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0034837805005473723
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0613722792168013e-06, theta_kick=-1.2726252983506612e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01707377e-01 -6.32000928e+00 -5.68992343e-03  1.67353181e-02]
 [ 1.80001566e-01  4.56204421e-01  1.55937779e-03 -9.62549715e-03]
 [-2.79293501e-03  1.67323457e-02  3.84014301e-01 -5.11891753e+00]
 [-1.04195789e-04 -9.64154856e-03  2.12583543e-01 -2.29747422e-01]]
compute_tune_4x4()/ evals =  [0.08409028+0.99645814j 0.08409028-0.99645814j 0.07029168+0.99752648j
 0.07029168-0.99752648j]
compute_tune_4x4()/ angles =  [0.23660079364727304, 0.23880349778444554, 0.7611965022155545, 0.763399206352727]
compute_tune_4x4()/  0.23660079364727304 0.23880349778444554
compute_tunes()/ 0.23660079364727304 0.23880349778444554

 Running simulation ..
Closed orbit computation: x_co=[-3.31267434e-07  5.45181830e-08], y_co=[ 1.88221752e-05 -4.40070516e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.628948001776484e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.1194317431753857e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00010401674178068363, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.600898789984499e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.825081060069242e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.0613722792168013e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0016726366334491127}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.008304902162314066}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0034837805005473723}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.63929981e-04 -2.40361431e-04 -9.74355211e-04 -1.08486587e-03]
 [-1.08923354e-03 -1.61661363e-04 -2.60903690e-04  4.00867251e-04]
 [ 1.90493524e-03 -2.46514961e-04  1.95930954e-03  7.40460111e-04]
 [-1.98357366e-04 -4.17309435e-04 -3.64582249e-03 -5.96712100e-04]
 [ 2.82152646e-03 -2.47634390e-04 -3.61851828e-03 -2.86295369e-04]
 [-3.14539839e-03  2.81155698e-04  7.24630593e-04  1.84944042e-04]
 [-2.31042688e-03  4.78441270e-04  6.99924636e-04  2.74088090e-04]
 [ 1.36455193e-04 -4.89490911e-04 -3.59339683e-03 -2.07572329e-04]
 [ 1.40160542e-03 -3.24022202e-04 -2.20854789e-03 -3.07981360e-04]
 [ 2.46220589e-03 -6.81635463e-05  3.19448911e-03  3.95555912e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0016726366334491127
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.526528449266811e-06, theta_kick=-1.8303650483716112e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0926455242851578e-06, theta_kick=1.3101230958858283e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.008304902162314066
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.730772238487852e-07, theta_kick=-6.871411542015182e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.2390397592433621e-06, theta_kick=1.4856552918821082e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.1915957155953965e-06, theta_kick=-2.6278057247563657e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0034837805005473723
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.030114126320779e-06, theta_kick=2.434183223252564e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01707377e-01 -6.32000928e+00 -5.68992343e-03  1.67353181e-02]
 [ 1.80001566e-01  4.56204421e-01  1.55937779e-03 -9.62549715e-03]
 [-2.79293501e-03  1.67323457e-02  3.84014301e-01 -5.11891753e+00]
 [-1.04195789e-04 -9.64154856e-03  2.12583543e-01 -2.29747422e-01]]
compute_tune_4x4()/ evals =  [0.08409028+0.99645814j 0.08409028-0.99645814j 0.07029168+0.99752648j
 0.07029168-0.99752648j]
compute_tune_4x4()/ angles =  [0.23660079364727304, 0.23880349778444554, 0.7611965022155545, 0.763399206352727]
compute_tune_4x4()/  0.23660079364727304 0.23880349778444554
compute_tunes()/ 0.23660079364727304 0.23880349778444554

 Running simulation ..
Closed orbit computation: x_co=[-2.52508866e-09  2.88173590e-10], y_co=[ 5.93296031e-07 -8.65353732e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 26/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.11787773e-03  8.42302202e-05  3.55683949e-03 -3.18679505e-04]
 [ 6.62961295e-05 -1.21345184e-04  1.78958929e-04 -3.98153032e-04]
 [ 4.54952082e-03 -3.02832188e-04  1.75632895e-03  6.50183780e-04]
 [-7.40379975e-04  7.88852089e-04 -7.31174856e-04  1.60050548e-04]
 [ 1.10408107e-03 -3.51663421e-04  8.81379896e-04  9.97309993e-05]
 [-4.55851417e-03  6.95256115e-04 -1.89591311e-03 -4.48721146e-04]
 [-5.94898435e-04 -4.69745291e-04  3.27504192e-03  6.54651608e-04]
 [-5.30663129e-04 -1.43530062e-05 -2.58103116e-03  1.39325017e-04]
 [ 1.68809573e-03  5.84860961e-04  1.21485480e-03  2.98105925e-04]
 [ 2.34160714e-03  2.01711503e-04  1.82673491e-03  8.74270569e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02811505324050731
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.299625254712202e-05, theta_kick=5.155412459624314e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.3462576209252328e-06, theta_kick=4.0122887949651066e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007583804732992345
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.9978086101697916e-05, theta_kick=-7.1915981992670346e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.376175733006379e-05, theta_kick=1.1242387495187359e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.259490082394987e-05, theta_kick=3.9082512515211715e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010682853875946162
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.0237931212190374e-05, theta_kick=-4.8246793530083514e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00797366e-01 -6.31469128e+00  2.15841661e-02  1.39172105e-01]
 [ 1.80016823e-01  4.56296161e-01  1.66429415e-04  2.43320260e-02]
 [ 3.25924579e-02  1.39208306e-01  3.83678576e-01 -5.12136825e+00]
 [ 7.78996098e-03  4.86754153e-02  2.12454540e-01 -2.30818104e-01]]
compute_tune_4x4()/ evals =  [0.10871637+0.99407281j 0.10871637-0.99407281j 0.04546327+0.99896601j
 0.04546327-0.99896601j]
compute_tune_4x4()/ angles =  [0.23266298602479438, 0.2427618014136245, 0.7572381985863755, 0.7673370139752056]
compute_tune_4x4()/  0.23266298602479438 0.2427618014136245
compute_tunes()/ 0.23266298602479438 0.2427618014136245

 Running simulation ..
Closed orbit computation: x_co=[ 9.89403433e-08 -8.65916531e-08], y_co=[-3.92854243e-05 -1.42376427e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.299625254712202e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.3462576209252328e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.9978086101697916e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.376175733006379e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.259490082394987e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.0237931212190374e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.02811505324050731}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007583804732992345}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010682853875946162}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.11787773e-03  8.42302202e-05  3.55683949e-03 -3.18679505e-04]
 [ 6.62961295e-05 -1.21345184e-04  1.78958929e-04 -3.98153032e-04]
 [ 4.54952082e-03 -3.02832188e-04  1.75632895e-03  6.50183780e-04]
 [-7.40379975e-04  7.88852089e-04 -7.31174856e-04  1.60050548e-04]
 [ 1.10408107e-03 -3.51663421e-04  8.81379896e-04  9.97309993e-05]
 [-4.55851417e-03  6.95256115e-04 -1.89591311e-03 -4.48721146e-04]
 [-5.94898435e-04 -4.69745291e-04  3.27504192e-03  6.54651608e-04]
 [-5.30663129e-04 -1.43530062e-05 -2.58103116e-03  1.39325017e-04]
 [ 1.68809573e-03  5.84860961e-04  1.21485480e-03  2.98105925e-04]
 [ 2.34160714e-03  2.01711503e-04  1.82673491e-03  8.74270569e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02811505324050731
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4100875217574145e-06, theta_kick=1.690747995040219e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.4898212941795029e-06, theta_kick=-1.7863517882654957e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007583804732992345
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.5261438597308756e-06, theta_kick=1.8299039110473222e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7240104851982935e-06, theta_kick=-2.0671534399825653e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.288455313602816e-07, theta_kick=1.1137207411722885e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010682853875946162
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.144645521080337e-07, theta_kick=-9.765736433095608e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00797366e-01 -6.31469128e+00  2.15841661e-02  1.39172105e-01]
 [ 1.80016823e-01  4.56296161e-01  1.66429415e-04  2.43320260e-02]
 [ 3.25924579e-02  1.39208306e-01  3.83678576e-01 -5.12136825e+00]
 [ 7.78996098e-03  4.86754153e-02  2.12454540e-01 -2.30818104e-01]]
compute_tune_4x4()/ evals =  [0.10871637+0.99407281j 0.10871637-0.99407281j 0.04546327+0.99896601j
 0.04546327-0.99896601j]
compute_tune_4x4()/ angles =  [0.23266298602479438, 0.2427618014136245, 0.7572381985863755, 0.7673370139752056]
compute_tune_4x4()/  0.23266298602479438 0.2427618014136245
compute_tunes()/ 0.23266298602479438 0.2427618014136245

 Running simulation ..
Closed orbit computation: x_co=[-2.45739892e-09  2.82309734e-09], y_co=[1.33117346e-08 1.16312363e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 27/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.54273765e-03  5.99416467e-05 -7.30351250e-04  1.80536310e-04]
 [-5.42328676e-04  3.77237402e-04  3.41920539e-03 -5.65089395e-04]
 [-6.09308109e-04  3.39020429e-04  1.71544093e-03 -1.66830746e-04]
 [-6.54393012e-04  3.21896629e-04 -2.20483250e-04  2.78709441e-05]
 [-3.10353789e-03  2.54649727e-04 -1.00143493e-03 -3.31221287e-04]
 [ 1.84931073e-04  1.24849721e-04 -7.56412549e-04 -1.49498597e-04]
 [ 9.97277707e-04 -8.56567713e-04 -2.74623820e-04 -5.66700106e-04]
 [ 2.24030113e-04 -2.64693533e-04  2.81621022e-03  9.17491360e-04]
 [-4.28404072e-03  1.07460452e-03  3.63506992e-04  6.00663166e-04]
 [-4.26008576e-03  8.37174607e-04  2.67780627e-04 -3.64954216e-07]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0026526536032225856
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.711943281943717e-06, theta_kick=-1.0445947793717502e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1044522048596038e-05, theta_kick=1.3242797501369387e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0017861366487783735
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.8597383364895728e-05, theta_kick=-2.229896240625068e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.273112535511506e-05, theta_kick=2.7255474590165518e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.294906283389756e-05, theta_kick=7.547829488160168e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003321951342700003
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.1786598650616661e-06, theta_kick=1.4132575268829466e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01693362e-01 -6.32002703e+00  2.21077451e-03  3.00807677e-02]
 [ 1.80002483e-01  4.56101116e-01  6.00814891e-04  8.69666884e-05]
 [ 5.05481294e-03  3.00810434e-02  3.84088523e-01 -5.11930350e+00]
 [ 1.28965558e-03  4.13733923e-03  2.12579315e-01 -2.29739096e-01]]
compute_tune_4x4()/ evals =  [0.08004592+0.99679118j 0.08004592-0.99679118j 0.07433267+0.9972335j
 0.07433267-0.9972335j ]
compute_tune_4x4()/ angles =  [0.2372466518343572, 0.23815866663090898, 0.761841333369091, 0.7627533481656428]
compute_tune_4x4()/  0.2372466518343572 0.23815866663090898
compute_tunes()/ 0.2372466518343572 0.23815866663090898

 Running simulation ..
Closed orbit computation: x_co=[-1.96893442e-08 -2.13657856e-08], y_co=[-2.45833343e-05 -7.60218396e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 8.711943281943717e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.1044522048596038e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.8597383364895728e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.273112535511506e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.294906283389756e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.1786598650616661e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0026526536032225856}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0017861366487783735}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.003321951342700003}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.54273765e-03  5.99416467e-05 -7.30351250e-04  1.80536310e-04]
 [-5.42328676e-04  3.77237402e-04  3.41920539e-03 -5.65089395e-04]
 [-6.09308109e-04  3.39020429e-04  1.71544093e-03 -1.66830746e-04]
 [-6.54393012e-04  3.21896629e-04 -2.20483250e-04  2.78709441e-05]
 [-3.10353789e-03  2.54649727e-04 -1.00143493e-03 -3.31221287e-04]
 [ 1.84931073e-04  1.24849721e-04 -7.56412549e-04 -1.49498597e-04]
 [ 9.97277707e-04 -8.56567713e-04 -2.74623820e-04 -5.66700106e-04]
 [ 2.24030113e-04 -2.64693533e-04  2.81621022e-03  9.17491360e-04]
 [-4.28404072e-03  1.07460452e-03  3.63506992e-04  6.00663166e-04]
 [-4.26008576e-03  8.37174607e-04  2.67780627e-04 -3.64954216e-07]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0026526536032225856
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.750066475344396e-06, theta_kick=-2.098395552559666e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.8036769578282035e-06, theta_kick=3.361714164579352e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0017861366487783735
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.776524292864275e-06, theta_kick=-8.125307603050112e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.777855000865081e-06, theta_kick=1.0524978424721926e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.65659634642324e-06, theta_kick=-6.782471856461296e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.003321951342700003
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.3404003075740486e-06, theta_kick=2.8062280295131105e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01693362e-01 -6.32002703e+00  2.21077451e-03  3.00807677e-02]
 [ 1.80002483e-01  4.56101116e-01  6.00814891e-04  8.69666884e-05]
 [ 5.05481294e-03  3.00810434e-02  3.84088523e-01 -5.11930350e+00]
 [ 1.28965558e-03  4.13733923e-03  2.12579315e-01 -2.29739096e-01]]
compute_tune_4x4()/ evals =  [0.08004592+0.99679118j 0.08004592-0.99679118j 0.07433267+0.9972335j
 0.07433267-0.9972335j ]
compute_tune_4x4()/ angles =  [0.2372466518343572, 0.23815866663090898, 0.761841333369091, 0.7627533481656428]
compute_tune_4x4()/  0.2372466518343572 0.23815866663090898
compute_tunes()/ 0.2372466518343572 0.23815866663090898

 Running simulation ..
Closed orbit computation: x_co=[-1.91756885e-09 -2.68682806e-11], y_co=[ 5.87727768e-07 -1.35491502e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 28/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.30079696e-03  9.61546791e-04 -1.49840694e-03  2.21938608e-04]
 [-1.55006763e-03  4.15776714e-04  3.95226899e-03 -8.85646494e-05]
 [ 5.08060206e-03  9.12576205e-05 -5.78209177e-03 -9.87726676e-04]
 [ 3.53135161e-03 -3.04375285e-05 -8.49364288e-04  1.62586021e-04]
 [ 1.03348810e-03 -9.68201532e-05  9.43442940e-04 -3.89065095e-04]
 [ 2.09245726e-03 -1.06894200e-04 -2.95474211e-03 -7.02623665e-04]
 [-1.36847050e-03  1.60866564e-04  4.57599698e-04 -2.19881178e-04]
 [ 1.43160464e-03  1.41691861e-04 -3.95977002e-03 -4.08907515e-05]
 [ 1.38224498e-03 -6.74876374e-05 -2.92012144e-03  1.47689581e-04]
 [-5.08847144e-03  3.34624657e-04  5.75938057e-04  7.19142170e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0186264813368445
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.182687380639604e-05, theta_kick=-2.617124295956201e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0013473610079632e-05, theta_kick=1.2006531628994085e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0033739503161671664
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.42313459264589e-06, theta_kick=-5.303504803012949e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.1072485244519996e-05, theta_kick=-1.3276326425435339e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.9779542388728506e-05, theta_kick=7.167792061034387e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0126162564202461
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.312179153410695e-05, theta_kick=-2.772389803812096e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01281302e-01 -6.31831542e+00 -1.25410080e-03 -1.51508307e-02]
 [ 1.80019380e-01  4.56171459e-01  3.69077107e-04 -8.86101938e-03]
 [-2.65873500e-03 -1.51334472e-02  3.83897287e-01 -5.12154913e+00]
 [-1.17342346e-03 -1.29619455e-02  2.12522309e-01 -2.30426612e-01]]
compute_tune_4x4()/ evals =  [0.08349911+0.99650785j 0.08349911-0.99650785j 0.07068131+0.99749895j
 0.07068131-0.99749895j]
compute_tune_4x4()/ angles =  [0.2366952134577939, 0.2387413324408184, 0.7612586675591816, 0.7633047865422061]
compute_tune_4x4()/  0.2366952134577939 0.2387413324408184
compute_tunes()/ 0.2366952134577939 0.2387413324408184

 Running simulation ..
Closed orbit computation: x_co=[-4.41885321e-08  6.51665777e-08], y_co=[-1.94630033e-05 -4.96138044e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.182687380639604e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.0013473610079632e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.42313459264589e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.1072485244519996e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.9779542388728506e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.312179153410695e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0186264813368445}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0033739503161671664}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0126162564202461}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.30079696e-03  9.61546791e-04 -1.49840694e-03  2.21938608e-04]
 [-1.55006763e-03  4.15776714e-04  3.95226899e-03 -8.85646494e-05]
 [ 5.08060206e-03  9.12576205e-05 -5.78209177e-03 -9.87726676e-04]
 [ 3.53135161e-03 -3.04375285e-05 -8.49364288e-04  1.62586021e-04]
 [ 1.03348810e-03 -9.68201532e-05  9.43442940e-04 -3.89065095e-04]
 [ 2.09245726e-03 -1.06894200e-04 -2.95474211e-03 -7.02623665e-04]
 [-1.36847050e-03  1.60866564e-04  4.57599698e-04 -2.19881178e-04]
 [ 1.43160464e-03  1.41691861e-04 -3.95977002e-03 -4.08907515e-05]
 [ 1.38224498e-03 -6.74876374e-05 -2.92012144e-03  1.47689581e-04]
 [-5.08847144e-03  3.34624657e-04  5.75938057e-04  7.19142170e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0186264813368445
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2638287915871425e-06, theta_kick=1.5153782743832213e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8435645902294026e-06, theta_kick=-3.4095409366545896e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0033739503161671664
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.641886643839446e-06, theta_kick=3.1677214905271103e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.246021027690603e-07, theta_kick=-7.489214227202919e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.977298112039799e-07, theta_kick=-8.366042966628476e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0126162564202461
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.2617619218793256e-07, theta_kick=2.7119376461893538e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01281302e-01 -6.31831542e+00 -1.25410080e-03 -1.51508307e-02]
 [ 1.80019380e-01  4.56171459e-01  3.69077107e-04 -8.86101938e-03]
 [-2.65873500e-03 -1.51334472e-02  3.83897287e-01 -5.12154913e+00]
 [-1.17342346e-03 -1.29619455e-02  2.12522309e-01 -2.30426612e-01]]
compute_tune_4x4()/ evals =  [0.08349911+0.99650785j 0.08349911-0.99650785j 0.07068131+0.99749895j
 0.07068131-0.99749895j]
compute_tune_4x4()/ angles =  [0.2366952134577939, 0.2387413324408184, 0.7612586675591816, 0.7633047865422061]
compute_tune_4x4()/  0.2366952134577939 0.2387413324408184
compute_tunes()/ 0.2366952134577939 0.2387413324408184

 Running simulation ..
Closed orbit computation: x_co=[ 1.82150232e-09 -6.41677873e-10], y_co=[1.50531451e-07 4.32836576e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 29/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.92700992e-05 -1.48806511e-04 -5.90937720e-04  2.50614515e-04]
 [-8.71044317e-04 -2.44824864e-04 -1.17260098e-03  2.47406617e-04]
 [ 2.43643166e-03 -5.42618190e-04 -4.32896914e-03 -4.27759240e-04]
 [ 4.83831357e-03 -1.23849261e-04 -6.22281745e-04  1.16319889e-03]
 [ 5.04250778e-03 -1.06298807e-04 -2.40289085e-03 -8.19177916e-04]
 [ 1.02492682e-03  4.56739302e-04  9.77637197e-04  5.83048404e-04]
 [-2.31646186e-03  6.84901930e-04  6.83716410e-04  2.31353705e-04]
 [-1.17732375e-04  2.67038258e-04 -1.77907407e-03 -2.68972984e-04]
 [-7.61015415e-04  4.96452038e-04  5.15361078e-03  1.00482921e-03]
 [ 2.54245528e-03  8.52103663e-04  1.58035880e-03  3.05716384e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.034029433724098314
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.719874932157915e-05, theta_kick=-6.858345261699676e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.065532845104205e-06, theta_kick=6.073764478814895e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006605682130585808
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.0419612871516305e-05, theta_kick=2.448388414854229e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.641979353179088e-05, theta_kick=3.167832652513656e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.439242371855617e-05, theta_kick=-1.0118969141780735e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006478520982808651
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.820647845158786e-05, theta_kick=-6.979175776105078e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00582229e-01 -6.31376409e+00 -2.08213349e-02 -1.49099472e-01]
 [ 1.80040297e-01  4.56385837e-01 -4.42953864e-04 -2.47608732e-02]
 [-3.30542432e-02 -1.49153012e-01  3.83623366e-01 -5.12291399e+00]
 [-8.18473972e-03 -5.05317522e-02  2.12429029e-01 -2.31229798e-01]]
compute_tune_4x4()/ evals =  [0.10917319+0.99402274j 0.10917319-0.99402274j 0.04492539+0.99899034j
 0.04492539-0.99899034j]
compute_tune_4x4()/ angles =  [0.23258984450274045, 0.24284749406468145, 0.7571525059353186, 0.7674101554972595]
compute_tune_4x4()/  0.23258984450274045 0.24284749406468145
compute_tunes()/ 0.23258984450274045 0.24284749406468145

 Running simulation ..
Closed orbit computation: x_co=[ 5.14981107e-07 -1.70052460e-07], y_co=[-1.01941907e-05  5.42173737e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.719874932157915e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.065532845104205e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.0419612871516305e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.641979353179088e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.439242371855617e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.820647845158786e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.034029433724098314}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006605682130585808}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006478520982808651}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.92700992e-05 -1.48806511e-04 -5.90937720e-04  2.50614515e-04]
 [-8.71044317e-04 -2.44824864e-04 -1.17260098e-03  2.47406617e-04]
 [ 2.43643166e-03 -5.42618190e-04 -4.32896914e-03 -4.27759240e-04]
 [ 4.83831357e-03 -1.23849261e-04 -6.22281745e-04  1.16319889e-03]
 [ 5.04250778e-03 -1.06298807e-04 -2.40289085e-03 -8.19177916e-04]
 [ 1.02492682e-03  4.56739302e-04  9.77637197e-04  5.83048404e-04]
 [-2.31646186e-03  6.84901930e-04  6.83716410e-04  2.31353705e-04]
 [-1.17732375e-04  2.67038258e-04 -1.77907407e-03 -2.68972984e-04]
 [-7.61015415e-04  4.96452038e-04  5.15361078e-03  1.00482921e-03]
 [ 2.54245528e-03  8.52103663e-04  1.58035880e-03  3.05716384e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.034029433724098314
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6457870272650909e-06, theta_kick=-1.973360570657091e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.476506448417528e-06, theta_kick=4.1684620399169354e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006605682130585808
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0483620036060033e-06, theta_kick=-1.2570254883640713e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.554155071465835e-07, theta_kick=-6.659640913295634e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0932606758145907e-06, theta_kick=1.310860685715528e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006478520982808651
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.57466917368255e-07, theta_kick=-3.087125214660626e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.00582229e-01 -6.31376409e+00 -2.08213349e-02 -1.49099472e-01]
 [ 1.80040297e-01  4.56385837e-01 -4.42953864e-04 -2.47608732e-02]
 [-3.30542432e-02 -1.49153012e-01  3.83623366e-01 -5.12291399e+00]
 [-8.18473972e-03 -5.05317522e-02  2.12429029e-01 -2.31229798e-01]]
compute_tune_4x4()/ evals =  [0.10917319+0.99402274j 0.10917319-0.99402274j 0.04492539+0.99899034j
 0.04492539-0.99899034j]
compute_tune_4x4()/ angles =  [0.23258984450274045, 0.24284749406468145, 0.7571525059353186, 0.7674101554972595]
compute_tune_4x4()/  0.23258984450274045 0.24284749406468145
compute_tunes()/ 0.23258984450274045 0.24284749406468145

 Running simulation ..
Closed orbit computation: x_co=[1.48978304e-10 1.21334208e-09], y_co=[-6.65886585e-07 -1.04556925e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 30/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.23628056e-03 -6.91992043e-04  9.01998676e-04 -6.12021287e-04]
 [ 4.27085954e-03 -4.70417041e-04  8.00156617e-03  6.25330754e-04]
 [-3.59282046e-03  6.29263225e-04  6.80594824e-06 -1.29624471e-04]
 [-3.70087778e-03 -3.57191330e-04  1.77513994e-03  4.83225432e-04]
 [ 2.31750486e-03 -8.15454487e-05 -3.87506211e-04 -1.02627536e-04]
 [-1.01681791e-03  2.42016868e-04  1.90857332e-03  1.83122048e-04]
 [-3.85097619e-03 -1.14227084e-04 -1.56076870e-03  4.82374017e-04]
 [-4.75869916e-03  4.95224155e-04  3.37228781e-03 -1.60252628e-04]
 [-7.65403781e-04 -2.14367617e-04  2.41857307e-03  3.79853698e-04]
 [ 1.44196678e-03  1.64864057e-04 -1.08347625e-03  2.92157453e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004407189791505707
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.532145351076814e-05, theta_kick=9.03132568311281e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0189433001179488e-06, theta_kick=-1.2217513559633254e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005116237072256671
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.384623168866173e-06, theta_kick=-1.0053478662274893e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.3901926042645356e-05, theta_kick=-5.26400611945677e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.788655541836466e-07, theta_kick=3.343702921604134e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008745061094091563
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.621318134816156e-05, theta_kick=-4.342096700644749e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01616172e-01 -6.32010885e+00  4.59085316e-03  6.96759362e-02]
 [ 1.80012634e-01  4.56158767e-01  1.55126158e-03 -1.41446853e-03]
 [ 1.12786717e-02  6.96829464e-02  3.84071219e-01 -5.11983438e+00]
 [ 2.87284240e-03  7.59033554e-03  2.12584716e-01 -2.29863512e-01]]
compute_tune_4x4()/ evals =  [0.08266883+0.99657707j 0.08266883-0.99657707j 0.07170632+0.99742579j
 0.07170632-0.99742579j]
compute_tune_4x4()/ angles =  [0.23682781490783877, 0.23857778142246502, 0.761422218577535, 0.7631721850921612]
compute_tune_4x4()/  0.23682781490783877 0.23857778142246502
compute_tunes()/ 0.23682781490783877 0.23857778142246502

 Running simulation ..
Closed orbit computation: x_co=[-2.36395776e-08  8.02348246e-08], y_co=[1.34500862e-05 1.21741295e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.532145351076814e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.0189433001179488e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.384623168866173e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.3901926042645356e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.788655541836466e-07, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.621318134816156e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004407189791505707}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.005116237072256671}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.008745061094091563}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.23628056e-03 -6.91992043e-04  9.01998676e-04 -6.12021287e-04]
 [ 4.27085954e-03 -4.70417041e-04  8.00156617e-03  6.25330754e-04]
 [-3.59282046e-03  6.29263225e-04  6.80594824e-06 -1.29624471e-04]
 [-3.70087778e-03 -3.57191330e-04  1.77513994e-03  4.83225432e-04]
 [ 2.31750486e-03 -8.15454487e-05 -3.87506211e-04 -1.02627536e-04]
 [-1.01681791e-03  2.42016868e-04  1.90857332e-03  1.83122048e-04]
 [-3.85097619e-03 -1.14227084e-04 -1.56076870e-03  4.82374017e-04]
 [-4.75869916e-03  4.95224155e-04  3.37228781e-03 -1.60252628e-04]
 [-7.65403781e-04 -2.14367617e-04  2.41857307e-03  3.79853698e-04]
 [ 1.44196678e-03  1.64864057e-04 -1.08347625e-03  2.92157453e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004407189791505707
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.1662068972518761e-06, theta_kick=-1.3983259499192263e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.636902820509341e-07, theta_kick=-4.360783325185789e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005116237072256671
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.4159515931759443e-08, theta_kick=-2.896816863669244e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.316062668205121e-06, theta_kick=2.777046284173118e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.71895995009698e-06, theta_kick=-3.2601352847174434e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.008745061094091563
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.417223783333068e-06, theta_kick=1.6993046411809357e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01616172e-01 -6.32010885e+00  4.59085316e-03  6.96759362e-02]
 [ 1.80012634e-01  4.56158767e-01  1.55126158e-03 -1.41446853e-03]
 [ 1.12786717e-02  6.96829464e-02  3.84071219e-01 -5.11983438e+00]
 [ 2.87284240e-03  7.59033554e-03  2.12584716e-01 -2.29863512e-01]]
compute_tune_4x4()/ evals =  [0.08266883+0.99657707j 0.08266883-0.99657707j 0.07170632+0.99742579j
 0.07170632-0.99742579j]
compute_tune_4x4()/ angles =  [0.23682781490783877, 0.23857778142246502, 0.761422218577535, 0.7631721850921612]
compute_tune_4x4()/  0.23682781490783877 0.23857778142246502
compute_tunes()/ 0.23682781490783877 0.23857778142246502

 Running simulation ..
Closed orbit computation: x_co=[ 1.1928612e-09 -5.4133111e-10], y_co=[ 2.65406944e-07 -1.05461594e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 31/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.57264631e-03  1.17352179e-04  2.27521342e-03  7.18523706e-04]
 [-3.06241690e-03 -3.96525081e-05 -1.04240710e-03 -3.29590409e-04]
 [-1.06962522e-03  4.55477283e-04  1.39606089e-03 -1.60877347e-04]
 [-4.44757592e-04  1.24451016e-07 -2.82412190e-03 -1.07239175e-04]
 [-2.24427290e-04  2.02541504e-04 -1.88931468e-03 -1.05334527e-04]
 [ 2.83150032e-03 -2.45988563e-04  2.32361570e-03  6.15292329e-04]
 [-1.16021183e-03  1.72023337e-05  1.98832921e-03  7.79602869e-04]
 [ 1.67810996e-03 -2.82166597e-04 -2.57976859e-03 -4.90642521e-04]
 [-2.41187038e-03 -6.39592815e-05  5.28380555e-04 -4.57886853e-04]
 [-1.85584966e-03  4.59340863e-04  5.46808549e-03  7.82547206e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006304102348157681
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.0659396190947554e-05, theta_kick=4.87521458978041e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.1049243655114e-05, theta_kick=7.320034020297014e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015305693559898442
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.0030011266713025e-05, theta_kick=3.6007113428640807e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.481517661503239e-05, theta_kick=4.174470672960384e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.071834060201787e-05, theta_kick=-4.882282246454072e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012029511363325432
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.009190572762959e-05, theta_kick=-6.006207974323425e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482482e-01 -6.31807223e+00  1.76843194e-02  3.15430008e-02]
 [ 1.79975908e-01  4.56370480e-01 -2.23813849e-03  2.35417359e-02]
 [ 1.77454898e-02  3.15448295e-02  3.83702658e-01 -5.11775077e+00]
 [ 3.29348018e-03  3.32934994e-02  2.12544655e-01 -2.29963197e-01]]
compute_tune_4x4()/ evals =  [0.10009729+0.99497765j 0.10009729-0.99497765j 0.05421644+0.99852921j
 0.05421644-0.99852921j]
compute_tune_4x4()/ angles =  [0.23404229756942618, 0.24136695270857775, 0.7586330472914222, 0.7659577024305738]
compute_tune_4x4()/  0.23404229756942618 0.24136695270857775
compute_tunes()/ 0.23404229756942618 0.24136695270857775

 Running simulation ..
Closed orbit computation: x_co=[-7.11361601e-07  2.77850081e-07], y_co=[-5.17331047e-05  1.27955155e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.0659396190947554e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.1049243655114e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.0030011266713025e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.481517661503239e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.071834060201787e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.009190572762959e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006304102348157681}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.015305693559898442}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012029511363325432}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.57264631e-03  1.17352179e-04  2.27521342e-03  7.18523706e-04]
 [-3.06241690e-03 -3.96525081e-05 -1.04240710e-03 -3.29590409e-04]
 [-1.06962522e-03  4.55477283e-04  1.39606089e-03 -1.60877347e-04]
 [-4.44757592e-04  1.24451016e-07 -2.82412190e-03 -1.07239175e-04]
 [-2.24427290e-04  2.02541504e-04 -1.88931468e-03 -1.05334527e-04]
 [ 2.83150032e-03 -2.45988563e-04  2.32361570e-03  6.15292329e-04]
 [-1.16021183e-03  1.72023337e-05  1.98832921e-03  7.79602869e-04]
 [ 1.67810996e-03 -2.82166597e-04 -2.57976859e-03 -4.90642521e-04]
 [-2.41187038e-03 -6.39592815e-05  5.28380555e-04 -4.57886853e-04]
 [-1.85584966e-03  4.59340863e-04  5.46808549e-03  7.82547206e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006304102348157681
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.026459891286879e-07, theta_kick=-6.026914537015107e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.6302049204823939e-06, theta_kick=1.954677038326762e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015305693559898442
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.352237884784172e-07, theta_kick=-1.1213685114474968e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.671563488831508e-07, theta_kick=-1.0397530902431551e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.3798226467204059e-06, theta_kick=1.6544592711139263e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012029511363325432
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.3473985039532212e-07, theta_kick=2.8146191302883564e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01482482e-01 -6.31807223e+00  1.76843194e-02  3.15430008e-02]
 [ 1.79975908e-01  4.56370480e-01 -2.23813849e-03  2.35417359e-02]
 [ 1.77454898e-02  3.15448295e-02  3.83702658e-01 -5.11775077e+00]
 [ 3.29348018e-03  3.32934994e-02  2.12544655e-01 -2.29963197e-01]]
compute_tune_4x4()/ evals =  [0.10009729+0.99497765j 0.10009729-0.99497765j 0.05421644+0.99852921j
 0.05421644-0.99852921j]
compute_tune_4x4()/ angles =  [0.23404229756942618, 0.24136695270857775, 0.7586330472914222, 0.7659577024305738]
compute_tune_4x4()/  0.23404229756942618 0.24136695270857775
compute_tunes()/ 0.23404229756942618 0.24136695270857775

 Running simulation ..
Closed orbit computation: x_co=[ 8.81321855e-09 -1.43895551e-09], y_co=[ 6.40121535e-10 -5.18196507e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 32/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.49311159e-03 -6.04516342e-04  1.90229466e-03 -4.52111975e-04]
 [ 3.01818911e-03 -6.55023275e-04 -2.21748808e-03 -9.82239522e-05]
 [ 1.51262655e-04 -1.80983453e-04  9.50604115e-04  2.22759679e-05]
 [ 1.78420897e-03 -1.06797618e-05 -3.74137400e-04 -7.70742512e-04]
 [ 6.53489475e-04  1.66865224e-04 -2.71207472e-03  7.59535320e-04]
 [-2.54057501e-03  1.61220928e-04 -4.62941159e-03  4.31654396e-04]
 [-2.17175472e-03 -4.60410455e-05 -1.26311490e-03 -1.10907596e-04]
 [-3.34459815e-03  3.84500439e-04  2.14278693e-03 -2.78990134e-04]
 [-9.95088761e-04  4.79087848e-04 -5.90365084e-04  3.88384427e-04]
 [ 3.63577267e-03  1.03910513e-04 -5.30001805e-04  5.92505110e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001853200770211011
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00011169926080682709, theta_kick=1.3393161654337886e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2758341788956652e-05, theta_kick=-1.5297731854850998e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006926821332595316
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.97107637478766e-05, theta_kick=-1.0756658122271024e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.9715151180624757e-05, theta_kick=3.562958433838373e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.862240878119217e-05, theta_kick=-2.23289688220053e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011700772214040468
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.8808038925073665e-05, theta_kick=-5.852267513974215e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01556574e-01 -6.32025356e+00  4.49980308e-03  7.66294663e-02]
 [ 1.80012042e-01  4.56158813e-01  1.91631577e-03 -3.82556541e-03]
 [ 1.19591833e-02  7.66496803e-02  3.84070206e-01 -5.12017093e+00]
 [ 3.00596019e-03  5.54764817e-03  2.12589442e-01 -2.29984572e-01]]
compute_tune_4x4()/ evals =  [0.08169322+0.99665752j 0.08169322-0.99665752j 0.07265072+0.99735745j
 0.07265072-0.99735745j]
compute_tune_4x4()/ angles =  [0.2369836148778903, 0.2384270833380104, 0.7615729166619896, 0.7630163851221097]
compute_tune_4x4()/  0.2369836148778903 0.2384270833380104
compute_tunes()/ 0.2369836148778903 0.2384270833380104

 Running simulation ..
Closed orbit computation: x_co=[-1.70267259e-07  7.15808896e-08], y_co=[2.22414038e-05 1.33962932e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00011169926080682709, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2758341788956652e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.97107637478766e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.9715151180624757e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.862240878119217e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.8808038925073665e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.001853200770211011}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.006926821332595316}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011700772214040468}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.49311159e-03 -6.04516342e-04  1.90229466e-03 -4.52111975e-04]
 [ 3.01818911e-03 -6.55023275e-04 -2.21748808e-03 -9.82239522e-05]
 [ 1.51262655e-04 -1.80983453e-04  9.50604115e-04  2.22759679e-05]
 [ 1.78420897e-03 -1.06797618e-05 -3.74137400e-04 -7.70742512e-04]
 [ 6.53489475e-04  1.66865224e-04 -2.71207472e-03  7.59535320e-04]
 [-2.54057501e-03  1.61220928e-04 -4.62941159e-03  4.31654396e-04]
 [-2.17175472e-03 -4.60410455e-05 -1.26311490e-03 -1.10907596e-04]
 [-3.34459815e-03  3.84500439e-04  2.14278693e-03 -2.78990134e-04]
 [-9.95088761e-04  4.79087848e-04 -5.90365084e-04  3.88384427e-04]
 [ 3.63577267e-03  1.03910513e-04 -5.30001805e-04  5.92505110e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.001853200770211011
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.775690887363315e-07, theta_kick=-6.925270692141873e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.785045926554705e-07, theta_kick=9.334562988837526e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.006926821332595316
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.595329273696146e-07, theta_kick=7.908047957359486e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.639821379726937e-07, theta_kick=-5.5633204138570075e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.483417725338577e-07, theta_kick=-5.375786547346006e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011700772214040468
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.849710852637917e-07, theta_kick=8.213061041962158e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01556574e-01 -6.32025356e+00  4.49980308e-03  7.66294663e-02]
 [ 1.80012042e-01  4.56158813e-01  1.91631577e-03 -3.82556541e-03]
 [ 1.19591833e-02  7.66496803e-02  3.84070206e-01 -5.12017093e+00]
 [ 3.00596019e-03  5.54764817e-03  2.12589442e-01 -2.29984572e-01]]
compute_tune_4x4()/ evals =  [0.08169322+0.99665752j 0.08169322-0.99665752j 0.07265072+0.99735745j
 0.07265072-0.99735745j]
compute_tune_4x4()/ angles =  [0.2369836148778903, 0.2384270833380104, 0.7615729166619896, 0.7630163851221097]
compute_tune_4x4()/  0.2369836148778903 0.2384270833380104
compute_tunes()/ 0.2369836148778903 0.2384270833380104

 Running simulation ..
Closed orbit computation: x_co=[1.20498924e-09 5.45744988e-10], y_co=[-3.37602784e-09  1.17617223e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 33/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.57920130e-03  5.44006689e-04  1.63579335e-04 -5.33560357e-04]
 [-3.24431511e-03  4.50324782e-04  3.72910803e-03  3.15973619e-04]
 [ 2.64355408e-03  4.75235894e-04  2.53190378e-03  6.81349971e-04]
 [ 1.63220908e-03 -3.98715881e-04  1.99892212e-03 -2.82385969e-04]
 [ 5.01624282e-04  1.46536104e-04 -2.38837483e-06  2.78266241e-04]
 [ 1.27441200e-03 -4.69016162e-04 -7.37848385e-04  3.79984821e-04]
 [ 1.30979673e-03  3.85448407e-04  1.08448217e-03  4.50403029e-05]
 [-4.00353939e-04 -2.54201401e-04 -3.51212761e-03 -7.06523208e-04]
 [-1.42344323e-04  1.29149490e-04 -5.67676215e-04 -1.09870671e-04]
 [ 3.64229948e-04 -5.51148929e-04  1.66569189e-03 -1.57208469e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0014273121099612227
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.5045015582456596e-05, theta_kick=5.401066856309372e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.304851844731768e-05, theta_kick=8.758792216779036e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007483448544860791
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.533684916349901e-06, theta_kick=7.834134053448892e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.087899532868258e-05, theta_kick=-2.5034700999571874e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.517861563518487e-06, theta_kick=9.014198884383519e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0035352027545833297
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.243995242083426e-05, theta_kick=2.6906347286186766e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01688988e-01 -6.31988894e+00  6.53549697e-03 -1.22152258e-03]
 [ 1.79995541e-01  4.56153231e-01 -1.26184588e-03  1.01172369e-02]
 [ 5.16103163e-03 -1.22050084e-03  3.84031616e-01 -5.11888565e+00]
 [ 7.84974254e-04  1.23273292e-02  2.12579638e-01 -2.29760868e-01]]
compute_tune_4x4()/ evals =  [0.08567195+0.9963234j  0.08567195-0.9963234j  0.06869554+0.99763767j
 0.06869554-0.99763767j]
compute_tune_4x4()/ angles =  [0.23634815009528376, 0.23905814757110455, 0.7609418524288954, 0.7636518499047162]
compute_tune_4x4()/  0.23634815009528376 0.23905814757110455
compute_tunes()/ 0.23634815009528376 0.23905814757110455

 Running simulation ..
Closed orbit computation: x_co=[1.13405054e-07 2.61647555e-08], y_co=[-1.43952750e-05  7.45668759e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.5045015582456596e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.304851844731768e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.533684916349901e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.087899532868258e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.517861563518487e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.243995242083426e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0014273121099612227}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007483448544860791}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0035352027545833297}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.57920130e-03  5.44006689e-04  1.63579335e-04 -5.33560357e-04]
 [-3.24431511e-03  4.50324782e-04  3.72910803e-03  3.15973619e-04]
 [ 2.64355408e-03  4.75235894e-04  2.53190378e-03  6.81349971e-04]
 [ 1.63220908e-03 -3.98715881e-04  1.99892212e-03 -2.82385969e-04]
 [ 5.01624282e-04  1.46536104e-04 -2.38837483e-06  2.78266241e-04]
 [ 1.27441200e-03 -4.69016162e-04 -7.37848385e-04  3.79984821e-04]
 [ 1.30979673e-03  3.85448407e-04  1.08448217e-03  4.50403029e-05]
 [-4.00353939e-04 -2.54201401e-04 -3.51212761e-03 -7.06523208e-04]
 [-1.42344323e-04  1.29149490e-04 -5.67676215e-04 -1.09870671e-04]
 [ 3.64229948e-04 -5.51148929e-04  1.66569189e-03 -1.57208469e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0014273121099612227
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3562981564408465e-06, theta_kick=-1.626252522127922e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.62432198843037e-06, theta_kick=6.743773686861409e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007483448544860791
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.6214592718539475e-06, theta_kick=-7.939378808327266e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.848081050666874e-06, theta_kick=4.613993969011637e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.604976032587404e-07, theta_kick=-7.919614784242475e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0035352027545833297
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.492804920252354e-07, theta_kick=8.984155026317282e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01688988e-01 -6.31988894e+00  6.53549697e-03 -1.22152258e-03]
 [ 1.79995541e-01  4.56153231e-01 -1.26184588e-03  1.01172369e-02]
 [ 5.16103163e-03 -1.22050084e-03  3.84031616e-01 -5.11888565e+00]
 [ 7.84974254e-04  1.23273292e-02  2.12579638e-01 -2.29760868e-01]]
compute_tune_4x4()/ evals =  [0.08567195+0.9963234j  0.08567195-0.9963234j  0.06869554+0.99763767j
 0.06869554-0.99763767j]
compute_tune_4x4()/ angles =  [0.23634815009528376, 0.23905814757110455, 0.7609418524288954, 0.7636518499047162]
compute_tune_4x4()/  0.23634815009528376 0.23905814757110455
compute_tunes()/ 0.23634815009528376 0.23905814757110455

 Running simulation ..
Closed orbit computation: x_co=[ 1.11745247e-08 -1.09425905e-09], y_co=[ 1.63762735e-08 -1.59952313e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 34/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.52769856e-03  7.33801751e-04  4.01325847e-03 -4.76231879e-05]
 [ 4.60497535e-03 -2.48521816e-04 -7.60169228e-04  4.98558582e-04]
 [ 2.53554407e-03 -8.31282472e-04  6.34189590e-04  1.63917367e-04]
 [-3.96943739e-03 -4.51923631e-04  1.23443998e-03 -1.21486234e-04]
 [ 5.18033104e-03 -7.48214994e-04  2.08120789e-03  3.95605635e-04]
 [ 4.01816795e-04  9.67932947e-05 -3.91068036e-03 -8.54634602e-04]
 [-2.47921274e-03 -7.32317431e-04  2.22855495e-05 -6.33052473e-04]
 [ 1.25062021e-03 -2.27957397e-05 -7.16774556e-04 -5.18357986e-04]
 [ 6.13882298e-03 -9.66011467e-04  2.49541930e-04  9.42452813e-04]
 [-8.68163399e-04 -4.72726824e-04  8.75159743e-04  5.70435231e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0002961259708094837
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.703621161175926e-05, theta_kick=3.241743499658389e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.021080563210235e-05, theta_kick=9.617577399310438e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0011130147770698584
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.144207021600145e-05, theta_kick=-6.16809777665599e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.4868642420041045e-05, theta_kick=-4.180881424153255e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.606845002697931e-05, theta_kick=4.324742870663797e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005101293327420263
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2335947451789465e-05, theta_kick=1.479126515142844e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01683207e-01 -6.31997799e+00  2.48608709e-03  2.32469525e-02]
 [ 1.80001400e-01  4.56091878e-01  4.13548706e-04 -3.85805943e-06]
 [ 4.53628939e-03  2.32474700e-02  3.84083291e-01 -5.11933464e+00]
 [ 1.02074416e-03  3.10967391e-03  2.12576965e-01 -2.29749645e-01]]
compute_tune_4x4()/ evals =  [0.07970369+0.9968186j  0.07970369-0.9968186j  0.07466747+0.99720849j
 0.07466747-0.99720849j]
compute_tune_4x4()/ angles =  [0.23730129459508906, 0.2381052328641799, 0.76189476713582, 0.7626987054049109]
compute_tune_4x4()/  0.23730129459508906 0.2381052328641799
compute_tunes()/ 0.23730129459508906 0.2381052328641799

 Running simulation ..
Closed orbit computation: x_co=[-2.94210731e-08  1.89377560e-08], y_co=[7.14768684e-06 4.93196775e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.703621161175926e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.021080563210235e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 5.144207021600145e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.4868642420041045e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.606845002697931e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.2335947451789465e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0002961259708094837}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0011130147770698584}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005101293327420263}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.52769856e-03  7.33801751e-04  4.01325847e-03 -4.76231879e-05]
 [ 4.60497535e-03 -2.48521816e-04 -7.60169228e-04  4.98558582e-04]
 [ 2.53554407e-03 -8.31282472e-04  6.34189590e-04  1.63917367e-04]
 [-3.96943739e-03 -4.51923631e-04  1.23443998e-03 -1.21486234e-04]
 [ 5.18033104e-03 -7.48214994e-04  2.08120789e-03  3.95605635e-04]
 [ 4.01816795e-04  9.67932947e-05 -3.91068036e-03 -8.54634602e-04]
 [-2.47921274e-03 -7.32317431e-04  2.22855495e-05 -6.33052473e-04]
 [ 1.25062021e-03 -2.27957397e-05 -7.16774556e-04 -5.18357986e-04]
 [ 6.13882298e-03 -9.66011467e-04  2.49541930e-04  9.42452813e-04]
 [-8.68163399e-04 -4.72726824e-04  8.75159743e-04  5.70435231e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0002961259708094837
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.148731897528872e-06, theta_kick=-4.974485646794541e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.970106454494456e-06, theta_kick=7.158382272281176e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0011130147770698584
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.394881649236633e-06, theta_kick=-8.866741339873715e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.447265112773845e-06, theta_kick=1.0128588710008185e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.124733251685634e-06, theta_kick=-6.144747993801518e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005101293327420263
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.090930741247788e-06, theta_kick=2.5071046328575645e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01683207e-01 -6.31997799e+00  2.48608709e-03  2.32469525e-02]
 [ 1.80001400e-01  4.56091878e-01  4.13548706e-04 -3.85805943e-06]
 [ 4.53628939e-03  2.32474700e-02  3.84083291e-01 -5.11933464e+00]
 [ 1.02074416e-03  3.10967391e-03  2.12576965e-01 -2.29749645e-01]]
compute_tune_4x4()/ evals =  [0.07970369+0.9968186j  0.07970369-0.9968186j  0.07466747+0.99720849j
 0.07466747-0.99720849j]
compute_tune_4x4()/ angles =  [0.23730129459508906, 0.2381052328641799, 0.76189476713582, 0.7626987054049109]
compute_tune_4x4()/  0.23730129459508906 0.2381052328641799
compute_tunes()/ 0.23730129459508906 0.2381052328641799

 Running simulation ..
Closed orbit computation: x_co=[-5.26738094e-10  1.88484921e-10], y_co=[-8.96730406e-08 -1.95765234e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 35/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.48764771e-03  6.34331559e-05 -5.03412090e-03 -6.76800269e-04]
 [ 2.09278489e-03  5.92096853e-05 -2.49062190e-03  6.62539626e-04]
 [-1.16096191e-03 -1.96739294e-04  4.27257664e-03  3.41469629e-04]
 [-1.28884120e-03 -3.21228707e-05  2.01684155e-03  9.71229725e-06]
 [ 3.41630137e-03  8.86855477e-05  2.38959238e-03 -5.75824416e-05]
 [ 1.41248769e-03 -5.79697717e-04 -1.40014828e-03  8.95538888e-04]
 [ 1.19898688e-03 -1.42696711e-04  2.91879540e-03  4.59973140e-04]
 [-1.36233334e-03 -3.26060922e-04 -3.79732156e-03 -3.57274060e-04]
 [-1.59680610e-03  7.62719716e-04 -1.89995607e-03  1.60584660e-04]
 [ 1.57887696e-03 -6.40586968e-04  9.61592535e-04 -3.39722023e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.021079979883536132
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.664775727769082e-05, theta_kick=9.19035449516442e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.367624576359686e-05, theta_kick=-6.435983831200812e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004748044078087036
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.103825900073871e-05, theta_kick=-3.7216040398424344e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.750171040669202e-05, theta_kick=1.0491784314800564e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.784700976842987e-05, theta_kick=-4.537998875735666e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004087972271300304
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.4215662521985056e-05, theta_kick=-6.500661930160179e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01266540e-01 -6.31756758e+00 -1.32809855e-02 -9.08123187e-02]
 [ 1.80011429e-01  4.56189883e-01 -1.48904151e-04 -1.61059588e-02]
 [-2.06143692e-02 -9.08263961e-02  3.83910848e-01 -5.12054487e+00]
 [-5.06727692e-03 -3.20467325e-02  2.12520284e-01 -2.30313965e-01]]
compute_tune_4x4()/ evals =  [0.09753116+0.99523247j 0.09753116-0.99523247j 0.05672896+0.99838962j
 0.05672896-0.99838962j]
compute_tune_4x4()/ angles =  [0.2344527193252375, 0.24096645626206498, 0.759033543737935, 0.7655472806747625]
compute_tune_4x4()/  0.2344527193252375 0.24096645626206498
compute_tunes()/ 0.2344527193252375 0.24096645626206498

 Running simulation ..
Closed orbit computation: x_co=[ 9.32361821e-08 -9.83648678e-08], y_co=[-1.49785191e-05  6.55705192e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.664775727769082e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.367624576359686e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.103825900073871e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -8.750171040669202e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.784700976842987e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.4215662521985056e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.021079979883536132}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004748044078087036}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004087972271300304}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.48764771e-03  6.34331559e-05 -5.03412090e-03 -6.76800269e-04]
 [ 2.09278489e-03  5.92096853e-05 -2.49062190e-03  6.62539626e-04]
 [-1.16096191e-03 -1.96739294e-04  4.27257664e-03  3.41469629e-04]
 [-1.28884120e-03 -3.21228707e-05  2.01684155e-03  9.71229725e-06]
 [ 3.41630137e-03  8.86855477e-05  2.38959238e-03 -5.75824416e-05]
 [ 1.41248769e-03 -5.79697717e-04 -1.40014828e-03  8.95538888e-04]
 [ 1.19898688e-03 -1.42696711e-04  2.91879540e-03  4.59973140e-04]
 [-1.36233334e-03 -3.26060922e-04 -3.79732156e-03 -3.57274060e-04]
 [-1.59680610e-03  7.62719716e-04 -1.89995607e-03  1.60584660e-04]
 [ 1.57887696e-03 -6.40586968e-04  9.61592535e-04 -3.39722023e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.021079979883536132
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.6064408280486365e-06, theta_kick=1.926182997342519e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.515230423236976e-06, theta_kick=-5.413931169122037e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004748044078087036
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.933274749910829e-06, theta_kick=4.7161444199334745e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.070811603206433e-07, theta_kick=-8.478169161109047e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.443334806707765e-07, theta_kick=-8.924838498797287e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004087972271300304
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.470195209843347e-07, theta_kick=8.957045132815902e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01266540e-01 -6.31756758e+00 -1.32809855e-02 -9.08123187e-02]
 [ 1.80011429e-01  4.56189883e-01 -1.48904151e-04 -1.61059588e-02]
 [-2.06143692e-02 -9.08263961e-02  3.83910848e-01 -5.12054487e+00]
 [-5.06727692e-03 -3.20467325e-02  2.12520284e-01 -2.30313965e-01]]
compute_tune_4x4()/ evals =  [0.09753116+0.99523247j 0.09753116-0.99523247j 0.05672896+0.99838962j
 0.05672896-0.99838962j]
compute_tune_4x4()/ angles =  [0.2344527193252375, 0.24096645626206498, 0.759033543737935, 0.7655472806747625]
compute_tune_4x4()/  0.2344527193252375 0.24096645626206498
compute_tunes()/ 0.2344527193252375 0.24096645626206498

 Running simulation ..
Closed orbit computation: x_co=[1.53312329e-09 2.87672301e-10], y_co=[ 2.26615781e-07 -4.77389596e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 36/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 0.00197597 -0.0002698  -0.00078782  0.00011891]
 [ 0.00264104 -0.0003618   0.0038526   0.00071014]
 [-0.00591566  0.00015563 -0.00217456 -0.00084   ]
 [ 0.00156421 -0.00027574  0.00078284 -0.00099491]
 [ 0.00275015 -0.00021841 -0.00084477  0.00042875]
 [ 0.00225069 -0.00025533  0.00165472  0.00046702]
 [-0.00126632 -0.00011404  0.00260615  0.0009974 ]
 [-0.00394655  0.0003549  -0.00187276 -0.00013992]
 [-0.00041855 -0.00032353 -0.00142428  0.0009415 ]
 [-0.00196095 -0.00031603 -0.00186548 -0.00044208]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007501973496317794
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.368315748450209e-05, theta_kick=5.237774946189058e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.5306288948412604e-05, theta_kick=5.432394515963928e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01933224464805169
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00015693896222538443, theta_kick=-1.8817572074927566e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.287147821022153e-06, theta_kick=-2.7423762944404466e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00011446445046549148, theta_kick=-1.3724718298812402e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004156646320558695
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.2214087956973134e-05, theta_kick=2.6635527295560875e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01528226e-01 -6.31961979e+00 -1.53065648e-02  7.98446157e-03]
 [ 1.79952349e-01  4.56374517e-01  3.29667876e-03 -2.65044025e-02]
 [-1.15291531e-02  7.97858942e-03  3.83828716e-01 -5.11743169e+00]
 [-1.79955926e-03 -3.16598453e-02  2.12603050e-01 -2.30209342e-01]]
compute_tune_4x4()/ evals =  [0.09825078+0.99516169j 0.09825078-0.99516169j 0.05598205+0.99843178j
 0.05598205-0.99843178j]
compute_tune_4x4()/ angles =  [0.2343376340779483, 0.24108551973683465, 0.7589144802631653, 0.7656623659220517]
compute_tune_4x4()/  0.2343376340779483 0.24108551973683465
compute_tunes()/ 0.2343376340779483 0.24108551973683465

 Running simulation ..
Closed orbit computation: x_co=[-9.91432391e-07 -1.64985842e-08], y_co=[1.02283184e-04 1.63005432e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.368315748450209e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.5306288948412604e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00015693896222538443, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.287147821022153e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00011446445046549148, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.2214087956973134e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007501973496317794}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01933224464805169}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.004156646320558695}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 0.00197597 -0.0002698  -0.00078782  0.00011891]
 [ 0.00264104 -0.0003618   0.0038526   0.00071014]
 [-0.00591566  0.00015563 -0.00217456 -0.00084   ]
 [ 0.00156421 -0.00027574  0.00078284 -0.00099491]
 [ 0.00275015 -0.00021841 -0.00084477  0.00042875]
 [ 0.00225069 -0.00025533  0.00165472  0.00046702]
 [-0.00126632 -0.00011404  0.00260615  0.0009974 ]
 [-0.00394655  0.0003549  -0.00187276 -0.00013992]
 [-0.00041855 -0.00032353 -0.00142428  0.0009415 ]
 [-0.00196095 -0.00031603 -0.00186548 -0.00044208]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007501973496317794
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.21819633793577e-07, theta_kick=5.057776124536077e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.370686127241617e-07, theta_kick=8.837729998612401e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01933224464805169
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.8340780935728752e-06, theta_kick=-3.398166270221126e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.074318327496804e-06, theta_kick=4.88526097641472e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.4451745790191662e-06, theta_kick=-1.732818696895117e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.004156646320558695
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.7740315169397174e-07, theta_kick=-3.326168165504186e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01528226e-01 -6.31961979e+00 -1.53065648e-02  7.98446157e-03]
 [ 1.79952349e-01  4.56374517e-01  3.29667876e-03 -2.65044025e-02]
 [-1.15291531e-02  7.97858942e-03  3.83828716e-01 -5.11743169e+00]
 [-1.79955926e-03 -3.16598453e-02  2.12603050e-01 -2.30209342e-01]]
compute_tune_4x4()/ evals =  [0.09825078+0.99516169j 0.09825078-0.99516169j 0.05598205+0.99843178j
 0.05598205-0.99843178j]
compute_tune_4x4()/ angles =  [0.2343376340779483, 0.24108551973683465, 0.7589144802631653, 0.7656623659220517]
compute_tune_4x4()/  0.2343376340779483 0.24108551973683465
compute_tunes()/ 0.2343376340779483 0.24108551973683465

 Running simulation ..
Closed orbit computation: x_co=[-3.88984294e-09  3.92874568e-10], y_co=[-4.60275966e-07  4.79326455e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 37/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.43408527e-03  2.83972387e-04 -3.36885774e-03 -2.30673862e-05]
 [-6.87001662e-05 -3.38470947e-04 -1.96940401e-03 -4.67216915e-08]
 [-8.28874914e-04 -1.47812074e-05  2.04427861e-04 -9.40599088e-05]
 [ 5.76580210e-03  2.32667128e-04 -1.15735950e-03  1.00357898e-04]
 [ 2.24086644e-03 -1.95651153e-04 -9.82641705e-04  1.12412496e-03]
 [ 1.20209297e-03 -4.90577128e-04 -3.92051416e-03 -5.78470939e-04]
 [-3.98333411e-03  6.50463385e-06 -1.51926186e-03 -4.11990252e-04]
 [ 1.37896918e-03 -6.23422333e-04  4.89515367e-04  4.92896948e-04]
 [-4.09987609e-03  8.51044464e-04 -2.00056757e-03  1.07159913e-04]
 [ 2.34412226e-03  1.87926711e-04 -5.46373081e-04 -8.63925542e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0024880122108735005
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.594123396868041e-05, theta_kick=5.5085268129606846e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.945547965244324e-06, theta_kick=-5.929898093269265e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009520939331551989
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.56356612915173e-05, theta_kick=-7.869962751919393e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.977943755771299e-05, theta_kick=-3.570666612337454e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4464567765998185e-05, theta_kick=2.9333937263933173e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005766781982086017
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.1761288703892584e-06, theta_kick=-6.206373274456937e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01670389e-01 -6.31991317e+00 -4.08328992e-03 -3.71308593e-02]
 [ 1.80003313e-01  4.56101390e-01 -5.29785728e-04 -1.62819732e-03]
 [-7.33656114e-03 -3.71312357e-02  3.84076880e-01 -5.11938433e+00]
 [-1.73077057e-03 -6.98456014e-03  2.12575798e-01 -2.29756574e-01]]
compute_tune_4x4()/ evals =  [0.08216837+0.99661846j 0.08216837-0.99661846j 0.07220728+0.99738965j
 0.07220728-0.99738965j]
compute_tune_4x4()/ angles =  [0.23690773726124906, 0.2384978438581846, 0.7615021561418154, 0.763092262738751]
compute_tune_4x4()/  0.23690773726124906 0.2384978438581846
compute_tunes()/ 0.23690773726124906 0.2384978438581846

 Running simulation ..
Closed orbit computation: x_co=[5.39928985e-08 5.35970174e-10], y_co=[3.67662780e-05 3.84386784e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.594123396868041e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.945547965244324e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.56356612915173e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.977943755771299e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.4464567765998185e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.1761288703892584e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0024880122108735005}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0009520939331551989}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005766781982086017}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.43408527e-03  2.83972387e-04 -3.36885774e-03 -2.30673862e-05]
 [-6.87001662e-05 -3.38470947e-04 -1.96940401e-03 -4.67216915e-08]
 [-8.28874914e-04 -1.47812074e-05  2.04427861e-04 -9.40599088e-05]
 [ 5.76580210e-03  2.32667128e-04 -1.15735950e-03  1.00357898e-04]
 [ 2.24086644e-03 -1.95651153e-04 -9.82641705e-04  1.12412496e-03]
 [ 1.20209297e-03 -4.90577128e-04 -3.92051416e-03 -5.78470939e-04]
 [-3.98333411e-03  6.50463385e-06 -1.51926186e-03 -4.11990252e-04]
 [ 1.37896918e-03 -6.23422333e-04  4.89515367e-04  4.92896948e-04]
 [-4.09987609e-03  8.51044464e-04 -2.00056757e-03  1.07159913e-04]
 [ 2.34412226e-03  1.87926711e-04 -5.46373081e-04 -8.63925542e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0024880122108735005
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4913247859493452e-06, theta_kick=1.7881545314684513e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.6686443477356726e-06, theta_kick=-4.398842610648118e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0009520939331551989
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.018623452074839e-06, theta_kick=4.818480725188653e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6281518249659349e-06, theta_kick=-1.9522152995520282e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.937088503181034e-07, theta_kick=-1.0715905385374971e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005766781982086017
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2836677525592298e-06, theta_kick=1.539165935056534e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01670389e-01 -6.31991317e+00 -4.08328992e-03 -3.71308593e-02]
 [ 1.80003313e-01  4.56101390e-01 -5.29785728e-04 -1.62819732e-03]
 [-7.33656114e-03 -3.71312357e-02  3.84076880e-01 -5.11938433e+00]
 [-1.73077057e-03 -6.98456014e-03  2.12575798e-01 -2.29756574e-01]]
compute_tune_4x4()/ evals =  [0.08216837+0.99661846j 0.08216837-0.99661846j 0.07220728+0.99738965j
 0.07220728-0.99738965j]
compute_tune_4x4()/ angles =  [0.23690773726124906, 0.2384978438581846, 0.7615021561418154, 0.763092262738751]
compute_tune_4x4()/  0.23690773726124906 0.2384978438581846
compute_tunes()/ 0.23690773726124906 0.2384978438581846

 Running simulation ..
Closed orbit computation: x_co=[-1.23846633e-10 -2.16967710e-10], y_co=[5.49597083e-07 2.03149747e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 38/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.99510830e-04  4.56102680e-04  2.43487508e-03 -3.31676495e-04]
 [ 2.19702285e-05  7.08455101e-05 -2.49636488e-04  6.59977544e-05]
 [ 2.90781298e-04  1.13577977e-04 -9.07479968e-05 -2.38956084e-04]
 [ 2.05074321e-04 -3.42146217e-04 -2.20510297e-03  2.10877012e-04]
 [ 2.11391991e-03 -4.49400115e-05 -1.44157577e-03 -5.90811667e-04]
 [-6.81932820e-04  6.05692424e-05 -3.82264645e-04  8.75819996e-05]
 [-3.13945202e-04 -6.91305639e-04  2.48269786e-05 -7.41978555e-04]
 [-1.94639159e-03  5.18095317e-04 -3.93174454e-03 -6.49021531e-04]
 [-3.08495277e-03  4.88809490e-04  1.34638283e-03  4.88338148e-04]
 [-1.28204226e-04  2.61293549e-04 -3.38049345e-03 -1.84313577e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011247301972721939
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.751095395354865e-05, theta_kick=-2.0996292663667274e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.2566319340229505e-05, theta_kick=-3.904824224081396e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01395937717184903
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.784776213516718e-05, theta_kick=-4.538089087338352e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.0609685264238966e-05, theta_kick=-4.8692540626239555e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.178811018181572e-05, theta_kick=9.806702149643098e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010944468535306616
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.3956748486097871e-05, theta_kick=-1.6734666576398635e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01526551e-01 -6.32123285e+00  4.20940653e-03  1.33125472e-01]
 [ 1.80057495e-01  4.56556662e-01  3.67154869e-03 -7.74933411e-03]
 [ 1.78487318e-02  1.33152675e-01  3.84003232e-01 -5.12098588e+00]
 [ 5.02678455e-03  8.28815513e-03  2.12637299e-01 -2.30183506e-01]]
compute_tune_4x4()/ evals =  [0.08283712+0.9965631j 0.08283712-0.9965631j 0.0715878 +0.9974343j
 0.0715878 -0.9974343j]
compute_tune_4x4()/ angles =  [0.2368009380801861, 0.23859669383434076, 0.7614033061656592, 0.7631990619198139]
compute_tune_4x4()/  0.2368009380801861 0.23859669383434076
compute_tunes()/ 0.2368009380801861 0.23859669383434076

 Running simulation ..
Closed orbit computation: x_co=[-4.28867160e-07 -1.09042994e-07], y_co=[ 1.94297674e-05 -8.05426637e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.751095395354865e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.2566319340229505e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.784776213516718e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.0609685264238966e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.178811018181572e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.3956748486097871e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011247301972721939}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01395937717184903}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010944468535306616}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.99510830e-04  4.56102680e-04  2.43487508e-03 -3.31676495e-04]
 [ 2.19702285e-05  7.08455101e-05 -2.49636488e-04  6.59977544e-05]
 [ 2.90781298e-04  1.13577977e-04 -9.07479968e-05 -2.38956084e-04]
 [ 2.05074321e-04 -3.42146217e-04 -2.20510297e-03  2.10877012e-04]
 [ 2.11391991e-03 -4.49400115e-05 -1.44157577e-03 -5.90811667e-04]
 [-6.81932820e-04  6.05692424e-05 -3.82264645e-04  8.75819996e-05]
 [-3.13945202e-04 -6.91305639e-04  2.48269786e-05 -7.41978555e-04]
 [-1.94639159e-03  5.18095317e-04 -3.93174454e-03 -6.49021531e-04]
 [-3.08495277e-03  4.88809490e-04  1.34638283e-03  4.88338148e-04]
 [-1.28204226e-04  2.61293549e-04 -3.38049345e-03 -1.84313577e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011247301972721939
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.409594241587131e-06, theta_kick=4.0882317862648697e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.81927011869336e-06, theta_kick=-8.176561456588784e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01395937717184903
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.3795060440129175e-06, theta_kick=6.450230157973352e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.369038630220917e-06, theta_kick=-4.039604082276966e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6678042436351855e-06, theta_kick=1.9997600415124242e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010944468535306616
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.175240521328027e-06, theta_kick=-2.608195231443451e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01526551e-01 -6.32123285e+00  4.20940653e-03  1.33125472e-01]
 [ 1.80057495e-01  4.56556662e-01  3.67154869e-03 -7.74933411e-03]
 [ 1.78487318e-02  1.33152675e-01  3.84003232e-01 -5.12098588e+00]
 [ 5.02678455e-03  8.28815513e-03  2.12637299e-01 -2.30183506e-01]]
compute_tune_4x4()/ evals =  [0.08283712+0.9965631j 0.08283712-0.9965631j 0.0715878 +0.9974343j
 0.0715878 -0.9974343j]
compute_tune_4x4()/ angles =  [0.2368009380801861, 0.23859669383434076, 0.7614033061656592, 0.7631990619198139]
compute_tune_4x4()/  0.2368009380801861 0.23859669383434076
compute_tunes()/ 0.2368009380801861 0.23859669383434076

 Running simulation ..
Closed orbit computation: x_co=[ 1.42503607e-08 -1.31652345e-09], y_co=[-2.66203519e-08  1.18518374e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 39/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 9.33722299e-04 -1.13839848e-04  6.44641456e-04  6.32432320e-04]
 [-1.26678467e-03 -6.51147607e-06  3.87401423e-03  4.79741965e-04]
 [-2.55485364e-03  3.87461318e-04  1.01926802e-03  7.07941869e-04]
 [ 6.02925287e-03 -1.00408623e-04  2.07377365e-03  4.73514521e-06]
 [-2.11441529e-06 -8.26550364e-05  1.12428687e-03  3.84473902e-05]
 [ 5.37366351e-03  2.10649701e-04  8.20942422e-04  2.19914475e-04]
 [ 4.53460879e-05  1.23624811e-04 -8.92163094e-04  3.07688686e-04]
 [-1.07471343e-04  1.93627396e-04  5.95754903e-04  3.45239552e-05]
 [-1.33679104e-03 -3.60835185e-04 -1.08504849e-03 -1.36605337e-05]
 [ 9.38850568e-04 -2.12479687e-04  1.77897831e-03 -8.17170123e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002266581667932184
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.0492836948481646e-05, theta_kick=-7.253318762616192e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2045591338519033e-06, theta_kick=-1.444311724657512e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01083393125559205
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.724354367388189e-05, theta_kick=1.0460829152149326e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.793999312663143e-05, theta_kick=-6.947223182955668e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.7504376450258e-05, theta_kick=8.09402873074632e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011662065246001862
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.179040668151305e-05, theta_kick=-1.4137141241156559e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01573779e-01 -6.31868482e+00  1.36002166e-02  2.62910358e-02]
 [ 1.79996288e-01  4.56290882e-01 -1.55119727e-03  1.65270116e-02]
 [ 1.38686947e-02  2.62876486e-02  3.83819186e-01 -5.11853913e+00]
 [ 2.52095048e-03  2.39260716e-02  2.12549005e-01 -2.29811210e-01]]
compute_tune_4x4()/ evals =  [0.09406897+0.99556568j 0.09406897-0.99556568j 0.06029357+0.99818069j
 0.06029357-0.99818069j]
compute_tune_4x4()/ angles =  [0.23500628972759308, 0.24039815657263708, 0.7596018434273629, 0.7649937102724069]
compute_tune_4x4()/  0.23500628972759308 0.24039815657263708
compute_tunes()/ 0.23500628972759308 0.24039815657263708

 Running simulation ..
Closed orbit computation: x_co=[-3.47719734e-07  6.33784904e-09], y_co=[-3.5620386e-05 -8.1217770e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.0492836948481646e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2045591338519033e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.724354367388189e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.793999312663143e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.7504376450258e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.179040668151305e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.002266581667932184}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01083393125559205}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011662065246001862}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 9.33722299e-04 -1.13839848e-04  6.44641456e-04  6.32432320e-04]
 [-1.26678467e-03 -6.51147607e-06  3.87401423e-03  4.79741965e-04]
 [-2.55485364e-03  3.87461318e-04  1.01926802e-03  7.07941869e-04]
 [ 6.02925287e-03 -1.00408623e-04  2.07377365e-03  4.73514521e-06]
 [-2.11441529e-06 -8.26550364e-05  1.12428687e-03  3.84473902e-05]
 [ 5.37366351e-03  2.10649701e-04  8.20942422e-04  2.19914475e-04]
 [ 4.53460879e-05  1.23624811e-04 -8.92163094e-04  3.07688686e-04]
 [-1.07471343e-04  1.93627396e-04  5.95754903e-04  3.45239552e-05]
 [-1.33679104e-03 -3.60835185e-04 -1.08504849e-03 -1.36605337e-05]
 [ 9.38850568e-04 -2.12479687e-04  1.77897831e-03 -8.17170123e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002266581667932184
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.043702648461579e-07, theta_kick=-1.0843739757067977e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.2211405839825194e-06, theta_kick=-2.66323113361822e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01083393125559205
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.5399741298683033e-06, theta_kick=4.244562178033902e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.372823179575572e-07, theta_kick=-6.442217152061148e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3331311194387477e-06, theta_kick=-1.598474373071257e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011662065246001862
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.28079243973262e-07, theta_kick=9.928981711271932e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01573779e-01 -6.31868482e+00  1.36002166e-02  2.62910358e-02]
 [ 1.79996288e-01  4.56290882e-01 -1.55119727e-03  1.65270116e-02]
 [ 1.38686947e-02  2.62876486e-02  3.83819186e-01 -5.11853913e+00]
 [ 2.52095048e-03  2.39260716e-02  2.12549005e-01 -2.29811210e-01]]
compute_tune_4x4()/ evals =  [0.09406897+0.99556568j 0.09406897-0.99556568j 0.06029357+0.99818069j
 0.06029357-0.99818069j]
compute_tune_4x4()/ angles =  [0.23500628972759308, 0.24039815657263708, 0.7596018434273629, 0.7649937102724069]
compute_tune_4x4()/  0.23500628972759308 0.24039815657263708
compute_tunes()/ 0.23500628972759308 0.24039815657263708

 Running simulation ..
Closed orbit computation: x_co=[-1.14586339e-08  9.19068890e-10], y_co=[-8.68992725e-08 -1.14119774e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 40/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.07504525e-04 -3.90820606e-05 -1.86020623e-03 -1.07505846e-04]
 [-4.55126860e-03  2.21433013e-04 -4.39567125e-04  3.10802774e-04]
 [-1.86889437e-03 -2.49626810e-04 -7.98651921e-04  5.75409908e-04]
 [-7.41268888e-04 -2.54279302e-04 -2.49385914e-03 -6.19783822e-04]
 [-2.23993301e-03  3.31533855e-04 -1.53137566e-03 -7.83858450e-04]
 [ 6.19180901e-04 -8.84561898e-04  4.51272920e-04  7.19217275e-04]
 [-3.67097114e-04 -5.79018143e-04  1.32963961e-03 -1.70391963e-04]
 [ 1.73549910e-03 -1.96887126e-04 -4.46868858e-03 -2.68398471e-04]
 [-6.47968193e-04 -3.94325426e-04  1.35805261e-03  1.54000903e-03]
 [ 1.25901665e-03  5.00845208e-04 -2.68558507e-03 -1.10532658e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002853183678640702
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0176784953805946e-05, theta_kick=-1.220234807493246e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.4104374881925336e-05, theta_kick=-2.8902052443184656e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006761992398958028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.145094557738182e-05, theta_kick=-9.766274844943978e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8165687433248935e-05, theta_kick=2.178134274106198e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.3614178591509615e-05, theta_kick=6.4285417437314086e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00896911699569979
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.516447922048609e-05, theta_kick=1.0211541501425538e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01615721e-01 -6.32032262e+00 -3.28405868e-03 -6.89486567e-02]
 [ 1.80010442e-01  4.56163099e-01 -1.81588702e-03  3.93004561e-03]
 [-1.01411493e-02 -6.89606161e-02  3.84080644e-01 -5.11984903e+00]
 [-2.64804337e-03 -4.38818419e-03  2.12591993e-01 -2.29901715e-01]]
compute_tune_4x4()/ evals =  [0.08063401+0.99674378j 0.08063401-0.99674378j 0.07372915+0.9972783j
 0.07372915-0.9972783j ]
compute_tune_4x4()/ angles =  [0.23715275179326445, 0.23825498442152496, 0.7617450155784751, 0.7628472482067356]
compute_tune_4x4()/  0.23715275179326445 0.23825498442152496
compute_tunes()/ 0.23715275179326445 0.23825498442152496

 Running simulation ..
Closed orbit computation: x_co=[6.26627458e-07 5.33567774e-08], y_co=[ 4.30460971e-05 -1.44839269e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.0176784953805946e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.4104374881925336e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.145094557738182e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8165687433248935e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.3614178591509615e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.516447922048609e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002853183678640702}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006761992398958028}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00896911699569979}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.07504525e-04 -3.90820606e-05 -1.86020623e-03 -1.07505846e-04]
 [-4.55126860e-03  2.21433013e-04 -4.39567125e-04  3.10802774e-04]
 [-1.86889437e-03 -2.49626810e-04 -7.98651921e-04  5.75409908e-04]
 [-7.41268888e-04 -2.54279302e-04 -2.49385914e-03 -6.19783822e-04]
 [-2.23993301e-03  3.31533855e-04 -1.53137566e-03 -7.83858450e-04]
 [ 6.19180901e-04 -8.84561898e-04  4.51272920e-04  7.19217275e-04]
 [-3.67097114e-04 -5.79018143e-04  1.32963961e-03 -1.70391963e-04]
 [ 1.73549910e-03 -1.96887126e-04 -4.46868858e-03 -2.68398471e-04]
 [-6.47968193e-04 -3.94325426e-04  1.35805261e-03  1.54000903e-03]
 [ 1.25901665e-03  5.00845208e-04 -2.68558507e-03 -1.10532658e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002853183678640702
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.627437388823809e-07, theta_kick=9.145584421863457e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3434299354891244e-06, theta_kick=-2.8098606673771403e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006761992398958028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.54233872398484e-06, theta_kick=5.446435041705263e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.073510183682116e-06, theta_kick=-6.08332960792798e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4181361141235424e-06, theta_kick=2.899436186480974e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00896911699569979
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.456052670117184e-07, theta_kick=-1.0139125321906596e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01615721e-01 -6.32032262e+00 -3.28405868e-03 -6.89486567e-02]
 [ 1.80010442e-01  4.56163099e-01 -1.81588702e-03  3.93004561e-03]
 [-1.01411493e-02 -6.89606161e-02  3.84080644e-01 -5.11984903e+00]
 [-2.64804337e-03 -4.38818419e-03  2.12591993e-01 -2.29901715e-01]]
compute_tune_4x4()/ evals =  [0.08063401+0.99674378j 0.08063401-0.99674378j 0.07372915+0.9972783j
 0.07372915-0.9972783j ]
compute_tune_4x4()/ angles =  [0.23715275179326445, 0.23825498442152496, 0.7617450155784751, 0.7628472482067356]
compute_tune_4x4()/  0.23715275179326445 0.23825498442152496
compute_tunes()/ 0.23715275179326445 0.23825498442152496

 Running simulation ..
Closed orbit computation: x_co=[-4.84151397e-09  5.44844847e-10], y_co=[-9.56795099e-09  5.86667252e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 41/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.04607597e-03  8.10524615e-05  2.99468504e-03  6.98322168e-04]
 [ 1.90907526e-03  4.21688993e-04  3.63459310e-03  5.64777966e-05]
 [ 2.31959564e-04 -4.85442856e-04  4.02911995e-03 -3.03456285e-04]
 [ 2.23573664e-03 -4.80474579e-04 -3.51111004e-03  4.16533175e-04]
 [-2.54249094e-03  1.00582663e-03 -6.42081516e-03 -2.17023072e-04]
 [-8.98387572e-04 -1.15777870e-04  1.71237305e-03 -5.72576121e-05]
 [ 2.74540610e-03 -2.08975395e-04  4.28224647e-04 -6.09367439e-04]
 [ 3.40191295e-03 -8.04077948e-04  6.72905297e-04  3.70087733e-04]
 [ 2.24656548e-04 -2.01119788e-04  8.16815478e-04 -1.36417415e-04]
 [-1.93758113e-03  2.33940983e-04 -2.09935605e-03  1.97841081e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0026253889581132907
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.0001007134950427951, theta_kick=1.2075927003798654e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1645687110718876e-06, theta_kick=1.396361703050446e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012500544080821668
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.2422698239466195e-05, theta_kick=2.688565887351451e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.735116137436249e-06, theta_kick=6.876620040299392e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-0.00011705807356788307, theta_kick=1.4035703467647402e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0077600917028490795
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.259369730107686e-05, theta_kick=3.90810694460028e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01629428e-01 -6.31931175e+00 -1.21633002e-02 -6.67837760e-03]
 [ 1.79988465e-01  4.56287600e-01  2.02156319e-03 -1.75156338e-02]
 [-1.05762395e-02 -6.68249767e-03  3.83879892e-01 -5.11828377e+00]
 [-1.74199913e-03 -2.25211975e-02  2.12571700e-01 -2.29834463e-01]]
compute_tune_4x4()/ evals =  [0.09278384+0.99568628j 0.09278384-0.99568628j 0.06156796+0.99810289j
 0.06156796-0.99810289j]
compute_tune_4x4()/ angles =  [0.23521172322901399, 0.24019495319749082, 0.7598050468025092, 0.764788276770986]
compute_tune_4x4()/  0.23521172322901399 0.24019495319749082
compute_tunes()/ 0.23521172322901399 0.24019495319749082

 Running simulation ..
Closed orbit computation: x_co=[-6.63319232e-07  3.71248279e-08], y_co=[-4.61769414e-05 -4.09203407e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.0001007134950427951, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.1645687110718876e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.2422698239466195e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.735116137436249e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -0.00011705807356788307, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.259369730107686e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0026253889581132907}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.012500544080821668}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0077600917028490795}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.04607597e-03  8.10524615e-05  2.99468504e-03  6.98322168e-04]
 [ 1.90907526e-03  4.21688993e-04  3.63459310e-03  5.64777966e-05]
 [ 2.31959564e-04 -4.85442856e-04  4.02911995e-03 -3.03456285e-04]
 [ 2.23573664e-03 -4.80474579e-04 -3.51111004e-03  4.16533175e-04]
 [-2.54249094e-03  1.00582663e-03 -6.42081516e-03 -2.17023072e-04]
 [-8.98387572e-04 -1.15777870e-04  1.71237305e-03 -5.72576121e-05]
 [ 2.74540610e-03 -2.08975395e-04  4.28224647e-04 -6.09367439e-04]
 [ 3.40191295e-03 -8.04077948e-04  6.72905297e-04  3.70087733e-04]
 [ 2.24656548e-04 -2.01119788e-04  8.16815478e-04 -1.36417415e-04]
 [-1.93758113e-03  2.33940983e-04 -2.09935605e-03  1.97841081e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0026253889581132907
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.1258628053271816e-06, theta_kick=2.548989492054987e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.1963819863743544e-06, theta_kick=-3.8325822698648356e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.012500544080821668
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.146670740699415e-06, theta_kick=2.573938989493049e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.86942687038171e-08, theta_kick=1.0634776541787994e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.204322520597311e-07, theta_kick=-3.842103269171517e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0077600917028490795
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.575264814888572e-07, theta_kick=9.083027542651341e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01629428e-01 -6.31931175e+00 -1.21633002e-02 -6.67837760e-03]
 [ 1.79988465e-01  4.56287600e-01  2.02156319e-03 -1.75156338e-02]
 [-1.05762395e-02 -6.68249767e-03  3.83879892e-01 -5.11828377e+00]
 [-1.74199913e-03 -2.25211975e-02  2.12571700e-01 -2.29834463e-01]]
compute_tune_4x4()/ evals =  [0.09278384+0.99568628j 0.09278384-0.99568628j 0.06156796+0.99810289j
 0.06156796-0.99810289j]
compute_tune_4x4()/ angles =  [0.23521172322901399, 0.24019495319749082, 0.7598050468025092, 0.764788276770986]
compute_tune_4x4()/  0.23521172322901399 0.24019495319749082
compute_tunes()/ 0.23521172322901399 0.24019495319749082

 Running simulation ..
Closed orbit computation: x_co=[-3.68317067e-09  2.04120498e-10], y_co=[ 1.39807027e-07 -9.07852898e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 42/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.44845219e-04 -2.84772310e-04 -2.00579317e-03  2.79794570e-05]
 [ 9.84589230e-04 -2.13167977e-04  4.49411082e-04  4.23657071e-04]
 [-1.26272291e-03  3.25684660e-04 -8.25667676e-04 -1.09780901e-04]
 [-3.02865607e-03  3.14046418e-04  5.95680231e-04  7.88216250e-04]
 [-2.11727792e-04  1.33451615e-04 -9.52751198e-04  1.63478449e-04]
 [ 1.04935535e-03 -3.09030638e-04  2.04081784e-03 -1.22418317e-04]
 [ 8.85050479e-04 -3.61601178e-05  3.91089070e-05  6.30618561e-04]
 [-1.03591855e-03  1.42474116e-04 -2.27613434e-03 -4.30765440e-04]
 [-2.32713311e-03 -5.98577209e-04  3.97210290e-03  8.61329182e-04]
 [ 2.17388453e-03  2.63117600e-04 -2.70036301e-03 -7.52962568e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004625016785934308
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00011615770368860594, theta_kick=1.3927745731358444e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.8582505319540453e-05, theta_kick=5.825225186070042e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0145430892091395
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.051238897721423e-05, theta_kick=-7.255663124428385e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.016584846501024e-06, theta_kick=9.612186865818661e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.129719834487665e-05, theta_kick=3.752651841498931e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01285591541800523
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.4084133393995397e-06, theta_kick=1.688740587399748e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620338e-01 -6.31873117e+00  1.34826219e-02 -8.25686291e-03]
 [ 1.80018806e-01  4.56571729e-01 -2.52826449e-03  1.79309338e-02]
 [ 1.00267233e-02 -8.24165644e-03  3.83647163e-01 -5.11842154e+00]
 [ 1.21638355e-03  2.10293479e-02  2.12553147e-01 -2.29787934e-01]]
compute_tune_4x4()/ evals =  [0.09273581+0.99569075j 0.09273581-0.99569075j 0.0616695 +0.99809662j
 0.0616695 -0.99809662j]
compute_tune_4x4()/ angles =  [0.23521940091521693, 0.24017876158690096, 0.759821238413099, 0.7647805990847831]
compute_tune_4x4()/  0.23521940091521693 0.24017876158690096
compute_tunes()/ 0.23521940091521693 0.24017876158690096

 Running simulation ..
Closed orbit computation: x_co=[ 7.44374877e-07 -7.71957980e-09], y_co=[-3.78799138e-06  1.03549405e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00011615770368860594, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.8582505319540453e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.051238897721423e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -8.016584846501024e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.129719834487665e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.4084133393995397e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004625016785934308}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0145430892091395}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.01285591541800523}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.44845219e-04 -2.84772310e-04 -2.00579317e-03  2.79794570e-05]
 [ 9.84589230e-04 -2.13167977e-04  4.49411082e-04  4.23657071e-04]
 [-1.26272291e-03  3.25684660e-04 -8.25667676e-04 -1.09780901e-04]
 [-3.02865607e-03  3.14046418e-04  5.95680231e-04  7.88216250e-04]
 [-2.11727792e-04  1.33451615e-04 -9.52751198e-04  1.63478449e-04]
 [ 1.04935535e-03 -3.09030638e-04  2.04081784e-03 -1.22418317e-04]
 [ 8.85050479e-04 -3.61601178e-05  3.91089070e-05  6.30618561e-04]
 [-1.03591855e-03  1.42474116e-04 -2.27613434e-03 -4.30765440e-04]
 [-2.32713311e-03 -5.98577209e-04  3.97210290e-03  8.61329182e-04]
 [ 2.17388453e-03  2.63117600e-04 -2.70036301e-03 -7.52962568e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004625016785934308
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.03403168521381e-06, theta_kick=1.2398428974141903e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8426461491798337e-06, theta_kick=-3.408439691278568e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0145430892091395
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.710466505501886e-06, theta_kick=5.648026577779722e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.959263946143659e-06, theta_kick=-4.747306444095351e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.183166389983486e-07, theta_kick=8.612886777955778e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.01285591541800523
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.878788049061948e-07, theta_kick=3.4517751891251636e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620338e-01 -6.31873117e+00  1.34826219e-02 -8.25686291e-03]
 [ 1.80018806e-01  4.56571729e-01 -2.52826449e-03  1.79309338e-02]
 [ 1.00267233e-02 -8.24165644e-03  3.83647163e-01 -5.11842154e+00]
 [ 1.21638355e-03  2.10293479e-02  2.12553147e-01 -2.29787934e-01]]
compute_tune_4x4()/ evals =  [0.09273581+0.99569075j 0.09273581-0.99569075j 0.0616695 +0.99809662j
 0.0616695 -0.99809662j]
compute_tune_4x4()/ angles =  [0.23521940091521693, 0.24017876158690096, 0.759821238413099, 0.7647805990847831]
compute_tune_4x4()/  0.23521940091521693 0.24017876158690096
compute_tunes()/ 0.23521940091521693 0.24017876158690096

 Running simulation ..
Closed orbit computation: x_co=[-7.62041247e-09  7.58778680e-10], y_co=[3.39220123e-07 7.46432695e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 43/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.71317621e-03  2.53838475e-04 -1.31459037e-03 -3.73244115e-04]
 [ 2.22272072e-03  1.92508793e-04 -2.88730393e-05  6.69296887e-05]
 [-9.33871475e-04  6.73627034e-05 -1.90628563e-03  8.06131563e-05]
 [ 2.14242700e-03 -2.89330790e-04  1.37357647e-03 -3.18379961e-04]
 [ 2.78058677e-03 -6.72514504e-04  1.07694944e-03  3.67135632e-04]
 [ 4.80117273e-03  7.14343126e-04 -1.14065211e-03  5.13927155e-05]
 [-7.43257010e-05  4.91491888e-04  9.42111815e-04 -1.65917839e-04]
 [ 5.56412966e-04 -2.62092507e-04  2.48541187e-03 -9.00745371e-05]
 [ 4.19014906e-04 -8.19745599e-04 -1.36863458e-03 -1.28682638e-04]
 [ 1.00763972e-03 -3.24280497e-04 -7.74689155e-04  9.50636816e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00925497884994672
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.037919798787342e-05, theta_kick=-1.0836805902721016e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.153935364785236e-05, theta_kick=2.5826495471132702e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.001191497382055354
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.219369360811368e-05, theta_kick=3.860144996745916e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.383240265155645e-05, theta_kick=-4.056632376919456e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.600120875516729e-05, theta_kick=4.316680389169142e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0005486394498072123
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.5192316959143453e-05, theta_kick=-3.0206535929063536e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01634458e-01 -6.31963290e+00 -4.60834256e-03 -3.73089508e-02]
 [ 1.80004108e-01  4.56112172e-01 -1.89748798e-04 -5.71601098e-03]
 [-7.78134676e-03 -3.73096440e-02  3.84061953e-01 -5.11950487e+00]
 [-1.99789827e-03 -1.20548389e-02  2.12568869e-01 -2.29823921e-01]]
compute_tune_4x4()/ evals =  [0.08467764+0.9964084j  0.08467764-0.9964084j  0.06968024+0.99756938j
 0.06968024-0.99756938j]
compute_tune_4x4()/ angles =  [0.23650697778252763, 0.2389010520610423, 0.7610989479389577, 0.7634930222174724]
compute_tune_4x4()/  0.23650697778252763 0.2389010520610423
compute_tunes()/ 0.23650697778252763 0.2389010520610423

 Running simulation ..
Closed orbit computation: x_co=[1.54049157e-08 5.81908584e-08], y_co=[-2.02541216e-05 -7.11454299e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.037919798787342e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.153935364785236e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.219369360811368e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.383240265155645e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.600120875516729e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.5192316959143453e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.00925497884994672}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.001191497382055354}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0005486394498072123}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.71317621e-03  2.53838475e-04 -1.31459037e-03 -3.73244115e-04]
 [ 2.22272072e-03  1.92508793e-04 -2.88730393e-05  6.69296887e-05]
 [-9.33871475e-04  6.73627034e-05 -1.90628563e-03  8.06131563e-05]
 [ 2.14242700e-03 -2.89330790e-04  1.37357647e-03 -3.18379961e-04]
 [ 2.78058677e-03 -6.72514504e-04  1.07694944e-03  3.67135632e-04]
 [ 4.80117273e-03  7.14343126e-04 -1.14065211e-03  5.13927155e-05]
 [-7.43257010e-05  4.91491888e-04  9.42111815e-04 -1.65917839e-04]
 [ 5.56412966e-04 -2.62092507e-04  2.48541187e-03 -9.00745371e-05]
 [ 4.19014906e-04 -8.19745599e-04 -1.36863458e-03 -1.28682638e-04]
 [ 1.00763972e-03 -3.24280497e-04 -7.74689155e-04  9.50636816e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.00925497884994672
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.171124000626954e-07, theta_kick=-6.20037224729693e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0264173311889615e-06, theta_kick=1.2307130004380127e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.001191497382055354
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.5642649821721711e-06, theta_kick=-1.8756125712133056e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3200696130426058e-06, theta_kick=1.5828131354454119e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9196267833179324e-07, theta_kick=-3.500742368110784e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0005486394498072123
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.974676150566198e-07, theta_kick=-5.96482388345762e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01634458e-01 -6.31963290e+00 -4.60834256e-03 -3.73089508e-02]
 [ 1.80004108e-01  4.56112172e-01 -1.89748798e-04 -5.71601098e-03]
 [-7.78134676e-03 -3.73096440e-02  3.84061953e-01 -5.11950487e+00]
 [-1.99789827e-03 -1.20548389e-02  2.12568869e-01 -2.29823921e-01]]
compute_tune_4x4()/ evals =  [0.08467764+0.9964084j  0.08467764-0.9964084j  0.06968024+0.99756938j
 0.06968024-0.99756938j]
compute_tune_4x4()/ angles =  [0.23650697778252763, 0.2389010520610423, 0.7610989479389577, 0.7634930222174724]
compute_tune_4x4()/  0.23650697778252763 0.2389010520610423
compute_tunes()/ 0.23650697778252763 0.2389010520610423

 Running simulation ..
Closed orbit computation: x_co=[3.32785023e-11 1.55735408e-10], y_co=[-2.19172192e-07 -3.78488319e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 44/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.63268658e-03  1.67477005e-04  1.27773672e-03  6.58663811e-04]
 [-8.91308588e-04  9.95424936e-05 -2.00775931e-03  3.16146222e-04]
 [-3.33524998e-03 -4.82571602e-05  2.59584105e-03  5.03319471e-04]
 [ 2.20048018e-03  1.72444154e-04 -9.18704931e-04  7.04000376e-05]
 [ 6.93183771e-04  1.66524105e-05  2.21863911e-03 -6.86285762e-04]
 [ 6.81021848e-04  8.73318975e-05  9.71485004e-04  2.99656443e-04]
 [ 2.38967653e-03  3.12950708e-04 -1.18774295e-03  1.57528548e-04]
 [-9.37576110e-04 -1.95913846e-04 -3.26552026e-03 -2.59008765e-04]
 [ 4.06340622e-04 -3.59127882e-04 -3.55172284e-03 -1.12002579e-03]
 [-1.30161565e-03  5.90398608e-04 -3.39345515e-03  4.67664449e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004846630213594409
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5036761724410854e-05, theta_kick=1.8029643086096954e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.175662581752368e-05, theta_kick=-8.603889429545717e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007234838682017377
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.980392810422738e-05, theta_kick=5.971678373722683e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.387300583098635e-05, theta_kick=-2.862463224553486e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.678046194167913e-06, theta_kick=9.206266283695892e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012678203086306216
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.917347116902947e-06, theta_kick=-5.896084215012835e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01519222e-01 -6.31850977e+00 -1.34359403e-02 -5.17722572e-02]
 [ 1.79999887e-01  4.56201507e-01  6.92104920e-04 -1.38916845e-02]
 [-1.65009147e-02 -5.17636837e-02  3.83873221e-01 -5.11906577e+00]
 [-3.37955769e-03 -2.40846062e-02  2.12540126e-01 -2.29839848e-01]]
compute_tune_4x4()/ evals =  [0.09406446+0.99556611j 0.09406446-0.99556611j 0.06029336+0.9981807j
 0.06029336-0.9981807j ]
compute_tune_4x4()/ angles =  [0.23500701000595373, 0.24039818939494828, 0.7596018106050517, 0.7649929899940463]
compute_tune_4x4()/  0.23500701000595373 0.24039818939494828
compute_tunes()/ 0.23500701000595373 0.24039818939494828

 Running simulation ..
Closed orbit computation: x_co=[5.86756568e-08 2.91747917e-08], y_co=[ 5.83001977e-06 -1.72443769e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5036761724410854e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.175662581752368e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.980392810422738e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.387300583098635e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.678046194167913e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.917347116902947e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004846630213594409}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.007234838682017377}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012678203086306216}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.63268658e-03  1.67477005e-04  1.27773672e-03  6.58663811e-04]
 [-8.91308588e-04  9.95424936e-05 -2.00775931e-03  3.16146222e-04]
 [-3.33524998e-03 -4.82571602e-05  2.59584105e-03  5.03319471e-04]
 [ 2.20048018e-03  1.72444154e-04 -9.18704931e-04  7.04000376e-05]
 [ 6.93183771e-04  1.66524105e-05  2.21863911e-03 -6.86285762e-04]
 [ 6.81021848e-04  8.73318975e-05  9.71485004e-04  2.99656443e-04]
 [ 2.38967653e-03  3.12950708e-04 -1.18774295e-03  1.57528548e-04]
 [-9.37576110e-04 -1.95913846e-04 -3.26552026e-03 -2.59008765e-04]
 [ 4.06340622e-04 -3.59127882e-04 -3.55172284e-03 -1.12002579e-03]
 [-1.30161565e-03  5.90398608e-04 -3.39345515e-03  4.67664449e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004846630213594409
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.9060129279057e-07, theta_kick=-1.1877682227713808e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.404300437873819e-06, theta_kick=5.280921942780651e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007234838682017377
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.512568528533011e-06, theta_kick=-4.211701830860012e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.0657597431836574e-08, theta_kick=-4.874998911794929e-09
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.3813374326572409e-06, theta_kick=1.6562755564480643e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012678203086306216
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0011115890352629e-06, theta_kick=-1.2003704634329008e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01519222e-01 -6.31850977e+00 -1.34359403e-02 -5.17722572e-02]
 [ 1.79999887e-01  4.56201507e-01  6.92104920e-04 -1.38916845e-02]
 [-1.65009147e-02 -5.17636837e-02  3.83873221e-01 -5.11906577e+00]
 [-3.37955769e-03 -2.40846062e-02  2.12540126e-01 -2.29839848e-01]]
compute_tune_4x4()/ evals =  [0.09406446+0.99556611j 0.09406446-0.99556611j 0.06029336+0.9981807j
 0.06029336-0.9981807j ]
compute_tune_4x4()/ angles =  [0.23500701000595373, 0.24039818939494828, 0.7596018106050517, 0.7649929899940463]
compute_tune_4x4()/  0.23500701000595373 0.24039818939494828
compute_tunes()/ 0.23500701000595373 0.24039818939494828

 Running simulation ..
Closed orbit computation: x_co=[-3.09567390e-09 -5.68953815e-10], y_co=[-3.21384479e-07  1.00274396e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 45/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.55592018e-03  2.17661257e-04 -1.61298640e-03 -3.46723792e-04]
 [ 2.90748056e-03  2.14848640e-05  6.91642454e-04 -1.22037047e-04]
 [-1.62595911e-03  2.54445151e-04 -2.01016606e-03  4.74134513e-04]
 [-6.84137258e-04 -5.84160776e-05  1.97814420e-03  1.27417904e-04]
 [ 3.77521874e-04 -5.34837433e-04  1.21314251e-03  5.52266658e-04]
 [-1.93571618e-03 -4.50706967e-04  2.07622430e-03  6.95275612e-04]
 [-1.65796411e-04  1.62313406e-04 -6.18955901e-04 -8.20188963e-04]
 [ 5.47560197e-05 -3.04433294e-04  9.12978789e-04 -3.04031117e-04]
 [-2.03148213e-03  7.69708458e-06 -3.10993720e-03  1.89005618e-04]
 [ 2.22738427e-03  7.17241004e-04  8.59437753e-04 -9.02060302e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004608176619769629
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.354692541101724e-05, theta_kick=-6.420477834341173e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.9550795092818693e-06, theta_kick=-3.543251520498382e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005292388786824841
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.91118630529053e-05, theta_kick=-1.0684847675498975e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.9782441266608796e-05, theta_kick=-5.969102021045078e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.371806993183474e-05, theta_kick=-4.042923453632478e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00424828089332989
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.999056798679452e-05, theta_kick=4.7950195715457465e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01654799e-01 -6.32006238e+00 -1.86054463e-03  1.39668778e-02]
 [ 1.79995279e-01  4.56084857e-01  1.01169001e-03 -6.94758880e-03]
 [ 8.53946293e-06  1.39703661e-02  3.84090195e-01 -5.11936059e+00]
 [ 8.20730048e-05 -6.70554409e-03  2.12581687e-01 -2.29844732e-01]]
compute_tune_4x4()/ evals =  [0.08102415+0.99671214j 0.08102415-0.99671214j 0.07331362+0.99730894j
 0.07331362-0.99730894j]
compute_tune_4x4()/ angles =  [0.2370904553880482, 0.23832129780175615, 0.7616787021982439, 0.7629095446119518]
compute_tune_4x4()/  0.2370904553880482 0.23832129780175615
compute_tunes()/ 0.2370904553880482 0.23832129780175615

 Running simulation ..
Closed orbit computation: x_co=[-2.57844932e-07 -4.71249589e-08], y_co=[ 9.04123719e-05 -1.98796845e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.354692541101724e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.9550795092818693e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.91118630529053e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.9782441266608796e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.371806993183474e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.999056798679452e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004608176619769629}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.005292388786824841}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.00424828089332989}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.55592018e-03  2.17661257e-04 -1.61298640e-03 -3.46723792e-04]
 [ 2.90748056e-03  2.14848640e-05  6.91642454e-04 -1.22037047e-04]
 [-1.62595911e-03  2.54445151e-04 -2.01016606e-03  4.74134513e-04]
 [-6.84137258e-04 -5.84160776e-05  1.97814420e-03  1.27417904e-04]
 [ 3.77521874e-04 -5.34837433e-04  1.21314251e-03  5.52266658e-04]
 [-1.93571618e-03 -4.50706967e-04  2.07622430e-03  6.95275612e-04]
 [-1.65796411e-04  1.62313406e-04 -6.18955901e-04 -8.20188963e-04]
 [ 5.47560197e-05 -3.04433294e-04  9.12978789e-04 -3.04031117e-04]
 [-2.03148213e-03  7.69708458e-06 -3.10993720e-03  1.89005618e-04]
 [ 2.22738427e-03  7.17241004e-04  8.59437753e-04 -9.02060302e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004608176619769629
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.614927435449882e-06, theta_kick=-3.1353963852912893e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.925429353823337e-06, theta_kick=4.7067374948309165e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005292388786824841
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.287243740600297e-06, theta_kick=-7.538641811042055e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.822645988053271e-06, theta_kick=6.981571624618398e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.870592612650051e-06, theta_kick=-3.441948552502903e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.00424828089332989
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.472415990835761e-06, theta_kick=1.765482174658234e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01654799e-01 -6.32006238e+00 -1.86054463e-03  1.39668778e-02]
 [ 1.79995279e-01  4.56084857e-01  1.01169001e-03 -6.94758880e-03]
 [ 8.53946293e-06  1.39703661e-02  3.84090195e-01 -5.11936059e+00]
 [ 8.20730048e-05 -6.70554409e-03  2.12581687e-01 -2.29844732e-01]]
compute_tune_4x4()/ evals =  [0.08102415+0.99671214j 0.08102415-0.99671214j 0.07331362+0.99730894j
 0.07331362-0.99730894j]
compute_tune_4x4()/ angles =  [0.2370904553880482, 0.23832129780175615, 0.7616787021982439, 0.7629095446119518]
compute_tune_4x4()/  0.2370904553880482 0.23832129780175615
compute_tunes()/ 0.2370904553880482 0.23832129780175615

 Running simulation ..
Closed orbit computation: x_co=[-5.84591480e-09  7.41935766e-10], y_co=[ 3.61317662e-07 -1.87997853e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 46/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.58587426e-05  3.91171558e-04  2.22847817e-03 -1.16748596e-04]
 [-5.88980418e-04  4.95319971e-04  2.45052492e-03  2.65006606e-04]
 [-1.05243782e-03 -7.10584045e-04  3.52226315e-03  9.15481850e-04]
 [-9.72621633e-04  2.17453608e-04  2.79334026e-03  9.10757044e-04]
 [ 4.45546226e-03 -5.89940438e-04 -3.48550667e-03  1.95019933e-05]
 [-1.72788096e-03 -7.18299695e-04 -1.42020420e-03  2.76649976e-04]
 [-4.92211404e-04  5.74572179e-05  2.26662803e-03 -5.09485123e-04]
 [ 1.05828058e-03 -1.56300694e-04 -1.12471190e-04 -3.83829411e-04]
 [ 3.26474195e-03 -2.52557660e-04  1.16732130e-03 -3.02726067e-04]
 [ 3.02534800e-03  5.24085949e-05 -3.13378043e-04 -6.22940000e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015351397042349113
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9244705392574776e-06, theta_kick=2.3075125873805994e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.807585565451147e-05, theta_kick=-5.764475984895072e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005379348799964725
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.025184156576117e-07, theta_kick=4.826347256741079e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.684266355312132e-05, theta_kick=-2.019498732822334e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.887398078001694e-05, theta_kick=3.4620989377879203e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005198311502261118
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.370876627615041e-05, theta_kick=-4.041807910309662e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01450771e-01 -6.31902541e+00  5.57059588e-03  2.65211345e-02]
 [ 1.79997534e-01  4.56094363e-01 -6.01844577e-04  1.16770018e-02]
 [ 7.39060114e-03  2.65193371e-02  3.84017008e-01 -5.12019821e+00]
 [ 1.95205324e-03  1.79656045e-02  2.12552216e-01 -2.30173365e-01]]
compute_tune_4x4()/ evals =  [0.08771595+0.99614553j 0.08771595-0.99614553j 0.06652767+0.99778458j
 0.06652767-0.99778458j]
compute_tune_4x4()/ angles =  [0.23602160823444907, 0.23940396714636442, 0.7605960328536356, 0.7639783917655509]
compute_tune_4x4()/  0.23602160823444907 0.23940396714636442
compute_tunes()/ 0.23602160823444907 0.23940396714636442

 Running simulation ..
Closed orbit computation: x_co=[-5.08720548e-09  8.55567209e-09], y_co=[ 5.35970086e-06 -2.03216099e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.9244705392574776e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.807585565451147e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.025184156576117e-07, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.684266355312132e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.887398078001694e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.370876627615041e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.015351397042349113}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005379348799964725}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005198311502261118}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.58587426e-05  3.91171558e-04  2.22847817e-03 -1.16748596e-04]
 [-5.88980418e-04  4.95319971e-04  2.45052492e-03  2.65006606e-04]
 [-1.05243782e-03 -7.10584045e-04  3.52226315e-03  9.15481850e-04]
 [-9.72621633e-04  2.17453608e-04  2.79334026e-03  9.10757044e-04]
 [ 4.45546226e-03 -5.89940438e-04 -3.48550667e-03  1.95019933e-05]
 [-1.72788096e-03 -7.18299695e-04 -1.42020420e-03  2.76649976e-04]
 [-4.92211404e-04  5.74572179e-05  2.26662803e-03 -5.09485123e-04]
 [ 1.05828058e-03 -1.56300694e-04 -1.12471190e-04 -3.83829411e-04]
 [ 3.26474195e-03 -2.52557660e-04  1.16732130e-03 -3.02726067e-04]
 [ 3.02534800e-03  5.24085949e-05 -3.13378043e-04 -6.22940000e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.015351397042349113
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.1764557666082926e-06, theta_kick=2.6096523562597393e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.5353571615050146e-06, theta_kick=-4.239026259246629e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005379348799964725
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.072530651852064e-06, theta_kick=3.6840798596983816e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.971027285777318e-06, theta_kick=-2.363335878218541e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6500449490280196e-06, theta_kick=1.9784659790609164e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005198311502261118
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0318185364766334e-06, theta_kick=-1.2371892488055966e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01450771e-01 -6.31902541e+00  5.57059588e-03  2.65211345e-02]
 [ 1.79997534e-01  4.56094363e-01 -6.01844577e-04  1.16770018e-02]
 [ 7.39060114e-03  2.65193371e-02  3.84017008e-01 -5.12019821e+00]
 [ 1.95205324e-03  1.79656045e-02  2.12552216e-01 -2.30173365e-01]]
compute_tune_4x4()/ evals =  [0.08771595+0.99614553j 0.08771595-0.99614553j 0.06652767+0.99778458j
 0.06652767-0.99778458j]
compute_tune_4x4()/ angles =  [0.23602160823444907, 0.23940396714636442, 0.7605960328536356, 0.7639783917655509]
compute_tune_4x4()/  0.23602160823444907 0.23940396714636442
compute_tunes()/ 0.23602160823444907 0.23940396714636442

 Running simulation ..
Closed orbit computation: x_co=[-1.92739585e-09  2.90699802e-10], y_co=[-2.79740239e-07  3.17946480e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 47/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.11053784e-03 -1.61914339e-04  3.86984424e-04 -1.20272549e-04]
 [ 2.23767678e-03  4.40124303e-04  6.21291997e-04 -6.24425272e-05]
 [ 3.90246631e-03 -8.43495029e-04  3.31179071e-03 -2.67928396e-04]
 [-7.68683094e-04 -8.80285015e-04  2.82977212e-03 -5.31737306e-04]
 [ 3.53429418e-04  3.69988390e-04  2.45059284e-04 -1.93246199e-04]
 [ 2.45608450e-03 -3.07961141e-04  9.57225954e-04 -3.32988199e-04]
 [-7.87343395e-05  1.40803863e-04  1.98299716e-04  1.63657560e-04]
 [-5.86652875e-04  6.00358164e-04  1.19793216e-04 -4.07689849e-04]
 [-7.98589320e-04  4.65318098e-05  2.55940612e-04  3.92350495e-04]
 [-1.88380149e-04  4.70070088e-04  4.69178773e-04  1.05619256e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005368053641637705
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.473009141725775e-05, theta_kick=-5.363306263957199e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.987803327778686e-05, theta_kick=5.980563862863218e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00794552813076219
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.3374471334758467e-06, theta_kick=1.603649436297613e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.1733715998383095e-05, theta_kick=-6.203067203320309e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=7.75007819053114e-06, theta_kick=-9.292635357636835e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.001980149909528949
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9772597309139987e-05, theta_kick=3.5698464407961894e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01713324e-01 -6.32013411e+00 -3.11136084e-03  3.73191336e-02]
 [ 1.80011364e-01  4.56242037e-01  1.71032064e-03 -7.12466354e-03]
 [ 1.52871093e-03  3.73138106e-02  3.84017802e-01 -5.11918360e+00]
 [ 9.60990485e-04 -3.79539939e-03  2.12586738e-01 -2.29752069e-01]]
compute_tune_4x4()/ evals =  [0.0803076 +0.99677013j 0.0803076 -0.99677013j 0.07408962+0.99725159j
 0.07408962-0.99725159j]
compute_tune_4x4()/ angles =  [0.237204870188024, 0.2381974552949403, 0.7618025447050597, 0.762795129811976]
compute_tune_4x4()/  0.237204870188024 0.2381974552949403
compute_tunes()/ 0.237204870188024 0.2381974552949403

 Running simulation ..
Closed orbit computation: x_co=[-4.61411247e-08  1.48794242e-08], y_co=[2.02043492e-05 2.64667301e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.473009141725775e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.987803327778686e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.3374471334758467e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.1733715998383095e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 7.75007819053114e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9772597309139987e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005368053641637705}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00794552813076219}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.001980149909528949}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.11053784e-03 -1.61914339e-04  3.86984424e-04 -1.20272549e-04]
 [ 2.23767678e-03  4.40124303e-04  6.21291997e-04 -6.24425272e-05]
 [ 3.90246631e-03 -8.43495029e-04  3.31179071e-03 -2.67928396e-04]
 [-7.68683094e-04 -8.80285015e-04  2.82977212e-03 -5.31737306e-04]
 [ 3.53429418e-04  3.69988390e-04  2.45059284e-04 -1.93246199e-04]
 [ 2.45608450e-03 -3.07961141e-04  9.57225954e-04 -3.32988199e-04]
 [-7.87343395e-05  1.40803863e-04  1.98299716e-04  1.63657560e-04]
 [-5.86652875e-04  6.00358164e-04  1.19793216e-04 -4.07689849e-04]
 [-7.98589320e-04  4.65318098e-05  2.55940612e-04  3.92350495e-04]
 [-1.88380149e-04  4.70070088e-04  4.69178773e-04  1.05619256e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005368053641637705
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.9980549221214034e-07, theta_kick=-3.594780657501105e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.1715968910273335e-07, theta_kick=-1.4047887552618166e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00794552813076219
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.987708372447134e-08, theta_kick=7.179487634202442e-09
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.6079370556227364e-07, theta_kick=3.127014656856031e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.143025070193922e-07, theta_kick=-6.166680572447404e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.001980149909528949
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.091247703027554e-07, theta_kick=8.502672813730509e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01713324e-01 -6.32013411e+00 -3.11136084e-03  3.73191336e-02]
 [ 1.80011364e-01  4.56242037e-01  1.71032064e-03 -7.12466354e-03]
 [ 1.52871093e-03  3.73138106e-02  3.84017802e-01 -5.11918360e+00]
 [ 9.60990485e-04 -3.79539939e-03  2.12586738e-01 -2.29752069e-01]]
compute_tune_4x4()/ evals =  [0.0803076 +0.99677013j 0.0803076 -0.99677013j 0.07408962+0.99725159j
 0.07408962-0.99725159j]
compute_tune_4x4()/ angles =  [0.237204870188024, 0.2381974552949403, 0.7618025447050597, 0.762795129811976]
compute_tune_4x4()/  0.237204870188024 0.2381974552949403
compute_tunes()/ 0.237204870188024 0.2381974552949403

 Running simulation ..
Closed orbit computation: x_co=[-1.36511277e-09  8.97297827e-11], y_co=[ 2.33871520e-07 -5.08363263e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 48/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.96390423e-03  7.73466877e-05  3.68970345e-03  4.47030453e-04]
 [-2.61240731e-03 -3.23101888e-04  1.16982134e-03  2.13205932e-04]
 [ 2.97021689e-03 -6.19903785e-05  6.56101816e-04 -5.64009072e-04]
 [-1.38438304e-03  5.09747835e-04  1.32938296e-05  4.88577538e-04]
 [-1.30543485e-03 -7.85612698e-04  1.61591513e-04 -8.45923871e-04]
 [ 1.22189154e-03 -1.23299157e-03 -5.55758122e-04  3.41751031e-05]
 [-4.52905193e-05  2.71708527e-04 -4.02609822e-03 -1.04103263e-03]
 [ 4.02267098e-03 -2.76864999e-04 -1.52104184e-03  5.69226538e-05]
 [ 6.87710918e-04 -8.91507440e-05  1.54171977e-03 -4.87795133e-04]
 [ 9.77386015e-04 -3.93602757e-04 -3.04380701e-03 -2.44679431e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009328874194951622
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4185104992305249e-05, theta_kick=-1.7008474619564154e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.587094326901461e-05, theta_kick=-3.102023440883321e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006659452680646805
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.6384756927794276e-05, theta_kick=-5.561706884573649e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.7294238686964403e-05, theta_kick=2.0736442904827303e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.701620455616151e-05, theta_kick=-1.0433570336540428e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010873680936448969
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.771371699921069e-05, theta_kick=-4.5220165711741865e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01530590e-01 -6.32000392e+00 -7.08377542e-03 -1.03520891e-01]
 [ 1.80032260e-01  4.56269295e-01 -2.15401123e-03  3.46441718e-04]
 [-1.69692637e-02 -1.03531856e-01  3.84033419e-01 -5.12047711e+00]
 [-4.38147067e-03 -1.34468128e-02  2.12586686e-01 -2.29979517e-01]]
compute_tune_4x4()/ evals =  [0.08643624+0.99625738j 0.08643624-0.99625738j 0.06796006+0.99768804j
 0.06796006-0.99768804j]
compute_tune_4x4()/ angles =  [0.23622605725675438, 0.23917547679143183, 0.7608245232085682, 0.7637739427432456]
compute_tune_4x4()/  0.23622605725675438 0.23917547679143183
compute_tunes()/ 0.23622605725675438 0.23917547679143183

 Running simulation ..
Closed orbit computation: x_co=[-8.58862828e-08 -2.00026305e-08], y_co=[4.04300219e-05 7.08601314e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.4185104992305249e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.587094326901461e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.6384756927794276e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.7294238686964403e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.701620455616151e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.771371699921069e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009328874194951622}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.006659452680646805}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010873680936448969}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.96390423e-03  7.73466877e-05  3.68970345e-03  4.47030453e-04]
 [-2.61240731e-03 -3.23101888e-04  1.16982134e-03  2.13205932e-04]
 [ 2.97021689e-03 -6.19903785e-05  6.56101816e-04 -5.64009072e-04]
 [-1.38438304e-03  5.09747835e-04  1.32938296e-05  4.88577538e-04]
 [-1.30543485e-03 -7.85612698e-04  1.61591513e-04 -8.45923871e-04]
 [ 1.22189154e-03 -1.23299157e-03 -5.55758122e-04  3.41751031e-05]
 [-4.52905193e-05  2.71708527e-04 -4.02609822e-03 -1.04103263e-03]
 [ 4.02267098e-03 -2.76864999e-04 -1.52104184e-03  5.69226538e-05]
 [ 6.87710918e-04 -8.91507440e-05  1.54171977e-03 -4.87795133e-04]
 [ 9.77386015e-04 -3.93602757e-04 -3.04380701e-03 -2.44679431e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009328874194951622
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.949193789559096e-06, theta_kick=5.934269573801755e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.6086876775578305e-06, theta_kick=-7.924065186217687e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.006659452680646805
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.581689407633187e-06, theta_kick=6.692655618376984e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5750063924980132e-06, theta_kick=-3.0875295527086815e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.625560879800702e-07, theta_kick=9.143334416938559e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010873680936448969
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.434143234065683e-07, theta_kick=-6.515742204644905e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01530590e-01 -6.32000392e+00 -7.08377542e-03 -1.03520891e-01]
 [ 1.80032260e-01  4.56269295e-01 -2.15401123e-03  3.46441718e-04]
 [-1.69692637e-02 -1.03531856e-01  3.84033419e-01 -5.12047711e+00]
 [-4.38147067e-03 -1.34468128e-02  2.12586686e-01 -2.29979517e-01]]
compute_tune_4x4()/ evals =  [0.08643624+0.99625738j 0.08643624-0.99625738j 0.06796006+0.99768804j
 0.06796006-0.99768804j]
compute_tune_4x4()/ angles =  [0.23622605725675438, 0.23917547679143183, 0.7608245232085682, 0.7637739427432456]
compute_tune_4x4()/  0.23622605725675438 0.23917547679143183
compute_tunes()/ 0.23622605725675438 0.23917547679143183

 Running simulation ..
Closed orbit computation: x_co=[-1.65393529e-09 -2.26666451e-09], y_co=[6.63102449e-08 2.04648133e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 49/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 9.05015970e-04  2.75515075e-04  8.76935041e-04  6.04664027e-05]
 [-6.67022126e-05  3.32720439e-04  2.64342291e-03  3.27029841e-04]
 [ 3.32550017e-03  2.35877957e-04  3.12962684e-04  4.53592274e-06]
 [-3.45220724e-03 -8.87331215e-05  3.88815269e-03  1.41673453e-04]
 [-2.81067171e-03  1.27174188e-06  4.94518622e-04  9.14032889e-06]
 [ 1.61716927e-04  9.09084081e-04  1.89906882e-03  5.00010349e-04]
 [ 3.66314514e-04 -2.92857426e-04 -3.21923727e-04  6.00920205e-04]
 [-2.10123406e-03 -3.58233686e-04 -7.79989981e-05 -5.15571338e-05]
 [ 3.30407016e-03  9.42221613e-05  1.20531462e-03  7.74884225e-04]
 [ 3.65667469e-04 -1.66193730e-05 -1.81054945e-03  8.25486109e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007668273839142878
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.571989162356075e-05, theta_kick=-4.282949406595704e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.076699447950976e-05, theta_kick=6.087153655786733e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017611204219303594
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.265714428172848e-05, theta_kick=-8.711864981726578e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.671746809689408e-05, theta_kick=-4.402562579264981e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6879669009570794e-05, theta_kick=2.0239358262886688e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02351992711570513
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.712259445012222e-05, theta_kick=1.0446326885132704e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01080158e-01 -6.31445899e+00  2.65087774e-02  7.82654559e-02]
 [ 1.79987681e-01  4.56646741e-01 -2.16296830e-03  2.99205193e-02]
 [ 2.99631078e-02  7.82161550e-02  3.83171296e-01 -5.11764104e+00]
 [ 5.86028118e-03  4.74186708e-02  2.12445188e-01 -2.30133767e-01]]
compute_tune_4x4()/ evals =  [0.11042654+0.99388429j 0.11042654-0.99388429j 0.04387552+0.99903701j
 0.04387552-0.99903701j]
compute_tune_4x4()/ angles =  [0.23238915500500876, 0.24301475208560558, 0.7569852479143944, 0.7676108449949912]
compute_tune_4x4()/  0.23238915500500876 0.24301475208560558
compute_tunes()/ 0.23238915500500876 0.24301475208560558

 Running simulation ..
Closed orbit computation: x_co=[ 1.16536149e-06 -2.92000635e-07], y_co=[ 5.47081890e-05 -6.05200772e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.571989162356075e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.076699447950976e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.265714428172848e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.671746809689408e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.6879669009570794e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.712259445012222e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007668273839142878}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.017611204219303594}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.02351992711570513}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 9.05015970e-04  2.75515075e-04  8.76935041e-04  6.04664027e-05]
 [-6.67022126e-05  3.32720439e-04  2.64342291e-03  3.27029841e-04]
 [ 3.32550017e-03  2.35877957e-04  3.12962684e-04  4.53592274e-06]
 [-3.45220724e-03 -8.87331215e-05  3.88815269e-03  1.41673453e-04]
 [-2.81067171e-03  1.27174188e-06  4.94518622e-04  9.14032889e-06]
 [ 1.61716927e-04  9.09084081e-04  1.89906882e-03  5.00010349e-04]
 [ 3.66314514e-04 -2.92857426e-04 -3.21923727e-04  6.00920205e-04]
 [-2.10123406e-03 -3.58233686e-04 -7.79989981e-05 -5.15571338e-05]
 [ 3.30407016e-03  9.42221613e-05  1.20531462e-03  7.74884225e-04]
 [ 3.65667469e-04 -1.66193730e-05 -1.81054945e-03  8.25486109e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007668273839142878
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0547408392052698e-06, theta_kick=1.2646739522599217e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.741281844045274e-06, theta_kick=-3.2869000754529444e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017611204219303594
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.9675948292069953e-06, theta_kick=3.5582578599944735e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.128356765218608e-07, theta_kick=-8.547167975576315e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3375735315700832e-06, theta_kick=-1.603800992368502e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02351992711570513
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.5571146285967068e-06, theta_kick=1.8670390282345848e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01080158e-01 -6.31445899e+00  2.65087774e-02  7.82654559e-02]
 [ 1.79987681e-01  4.56646741e-01 -2.16296830e-03  2.99205193e-02]
 [ 2.99631078e-02  7.82161550e-02  3.83171296e-01 -5.11764104e+00]
 [ 5.86028118e-03  4.74186708e-02  2.12445188e-01 -2.30133767e-01]]
compute_tune_4x4()/ evals =  [0.11042654+0.99388429j 0.11042654-0.99388429j 0.04387552+0.99903701j
 0.04387552-0.99903701j]
compute_tune_4x4()/ angles =  [0.23238915500500876, 0.24301475208560558, 0.7569852479143944, 0.7676108449949912]
compute_tune_4x4()/  0.23238915500500876 0.24301475208560558
compute_tunes()/ 0.23238915500500876 0.24301475208560558

 Running simulation ..
Closed orbit computation: x_co=[5.79313582e-10 8.08765618e-10], y_co=[5.48381934e-07 2.64674819e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 50/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.37435247e-04 -8.89037057e-05 -1.15915402e-03 -7.56366424e-04]
 [-2.07573939e-03  2.33741523e-04  3.03247056e-03 -2.67316590e-04]
 [-2.81050225e-04  5.46298492e-04  1.52526487e-03  5.50227613e-04]
 [ 3.41179732e-03 -2.90084328e-04  4.60118431e-03  7.23143586e-04]
 [-1.91840546e-03 -2.21246431e-04 -2.31580449e-03 -6.40589293e-04]
 [ 1.65750234e-03  1.02044273e-04  1.18974587e-03  1.18623896e-03]
 [-7.53567517e-04 -2.37619059e-04 -2.31333454e-03 -1.35212250e-04]
 [-8.03103341e-05 -2.75153072e-04  1.35952104e-03 -2.22923775e-04]
 [-2.39166002e-03  4.47388274e-05 -7.02035904e-04  1.36647308e-05]
 [-3.59497411e-03  5.92337852e-04 -4.87384260e-04  4.17955315e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035169965097665017
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.586110746818459e-05, theta_kick=1.0295069849482734e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3533886001854002e-05, theta_kick=-1.6227638547016464e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0032650113819997773
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.6109095196916737e-05, theta_kick=-1.931541126763097e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.114098126312513e-06, theta_kick=9.72910895738188e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.097284427022419e-05, theta_kick=9.708948699294845e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0007777599510257849
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.48098118094412e-05, theta_kick=8.969977918002502e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690541e-01 -6.31994962e+00  3.52370367e-03  8.32855609e-03]
 [ 1.79997422e-01  4.56089540e-01 -4.56310069e-04  5.52251950e-03]
 [ 3.75793536e-03  8.32867968e-03  3.84084010e-01 -5.11916289e+00]
 [ 7.86963743e-04  7.93374347e-03  2.12577721e-01 -2.29749845e-01]]
compute_tune_4x4()/ evals =  [0.08233914+0.99660437j 0.08233914-0.99660437j 0.07202744+0.99740265j
 0.07202744-0.99740265j]
compute_tune_4x4()/ angles =  [0.23688046542969693, 0.23852654175262278, 0.7614734582473772, 0.763119534570303]
compute_tune_4x4()/  0.23688046542969693 0.23852654175262278
compute_tunes()/ 0.23688046542969693 0.23852654175262278

 Running simulation ..
Closed orbit computation: x_co=[ 2.68966509e-07 -4.33127064e-08], y_co=[-1.64160432e-06 -5.99997940e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.586110746818459e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.3533886001854002e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.6109095196916737e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -8.114098126312513e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.097284427022419e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.48098118094412e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0035169965097665017}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0032650113819997773}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0007777599510257849}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.37435247e-04 -8.89037057e-05 -1.15915402e-03 -7.56366424e-04]
 [-2.07573939e-03  2.33741523e-04  3.03247056e-03 -2.67316590e-04]
 [-2.81050225e-04  5.46298492e-04  1.52526487e-03  5.50227613e-04]
 [ 3.41179732e-03 -2.90084328e-04  4.60118431e-03  7.23143586e-04]
 [-1.91840546e-03 -2.21246431e-04 -2.31580449e-03 -6.40589293e-04]
 [ 1.65750234e-03  1.02044273e-04  1.18974587e-03  1.18623896e-03]
 [-7.53567517e-04 -2.37619059e-04 -2.31333454e-03 -1.35212250e-04]
 [-8.03103341e-05 -2.75153072e-04  1.35952104e-03 -2.22923775e-04]
 [-2.39166002e-03  4.47388274e-05 -7.02035904e-04  1.36647308e-05]
 [-3.59497411e-03  5.92337852e-04 -4.87384260e-04  4.17955315e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0035169965097665017
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.5367523650503075e-07, theta_kick=4.2406991607938586e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6298008886527116e-06, theta_kick=-1.9541925889607281e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0032650113819997773
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.0674365423833803e-06, theta_kick=2.4789342044180836e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6290730502113886e-06, theta_kick=-1.9533198832836746e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.402920869810945e-06, theta_kick=1.6821549097014146e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0007777599510257849
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.04566088939209e-07, theta_kick=3.651862003497663e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01690541e-01 -6.31994962e+00  3.52370367e-03  8.32855609e-03]
 [ 1.79997422e-01  4.56089540e-01 -4.56310069e-04  5.52251950e-03]
 [ 3.75793536e-03  8.32867968e-03  3.84084010e-01 -5.11916289e+00]
 [ 7.86963743e-04  7.93374347e-03  2.12577721e-01 -2.29749845e-01]]
compute_tune_4x4()/ evals =  [0.08233914+0.99660437j 0.08233914-0.99660437j 0.07202744+0.99740265j
 0.07202744-0.99740265j]
compute_tune_4x4()/ angles =  [0.23688046542969693, 0.23852654175262278, 0.7614734582473772, 0.763119534570303]
compute_tune_4x4()/  0.23688046542969693 0.23852654175262278
compute_tunes()/ 0.23688046542969693 0.23852654175262278

 Running simulation ..
Closed orbit computation: x_co=[ 4.05356825e-10 -3.99567500e-10], y_co=[-7.60762947e-08 -1.21527712e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
Completed benchmarking for noise_level=3.0000000000000004e-05 meters.
Running evaluation for noise_level= 4e-05
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.73451225e-04 -4.10328941e-05  1.71417969e-03  3.74238558e-04]
 [ 1.21851142e-04  6.75265298e-04  3.87569737e-03 -4.15461354e-05]
 [-1.46576509e-03  3.14735369e-04  2.13690721e-04 -1.74378381e-04]
 [ 1.42701113e-03 -3.04872047e-04  2.43747308e-03  8.45929030e-05]
 [ 1.70813528e-03  1.35738805e-04 -1.71942722e-03  1.78277594e-05]
 [ 3.17017085e-04 -2.57090606e-04  5.53424268e-04  3.21901551e-04]
 [ 6.21710652e-04  4.27949368e-04 -2.47732703e-04  7.97685619e-04]
 [ 2.20320446e-03 -3.36201050e-04 -4.12170795e-04 -7.09898680e-04]
 [ 7.60764483e-04 -3.89240019e-04 -3.66900450e-03 -1.50212817e-04]
 [-2.60972498e-03  1.12985708e-04 -3.16958058e-03 -6.94650886e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015378198431526697
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.026926520810574e-06, theta_kick=-7.226511669726162e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2638932482055896e-05, theta_kick=-1.515455560294007e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00943521622366883
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.538620986148862e-06, theta_kick=-1.0238127839573314e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.59154978229074e-05, theta_kick=-4.306403325892188e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.6601903705929694e-05, theta_kick=-4.388705973961675e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.009409090908376095
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.9145870077789916e-05, theta_kick=3.4946994876112123e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01326638e-01 -6.31755396e+00 -1.66894598e-02 -7.55390216e-02]
 [ 1.79983507e-01  4.56164846e-01  8.00492493e-04 -2.02903526e-02]
 [-2.17166875e-02 -7.55465623e-02  3.83856957e-01 -5.11915758e+00]
 [-4.82657401e-03 -3.51680945e-02  2.12524668e-01 -2.30154401e-01]]
compute_tune_4x4()/ evals =  [0.10047326+0.99493976j 0.10047326-0.99493976j 0.05379712+0.99855189j
 0.05379712-0.99855189j]
compute_tune_4x4()/ angles =  [0.23398215641648643, 0.24143378718036398, 0.758566212819636, 0.7660178435835135]
compute_tune_4x4()/  0.23398215641648643 0.24143378718036398
compute_tunes()/ 0.23398215641648643 0.24143378718036398

 Running simulation ..
Closed orbit computation: x_co=[-1.08839289e-07 -2.59707777e-08], y_co=[4.44165759e-05 2.22903436e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.026926520810574e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2638932482055896e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.538620986148862e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.59154978229074e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.6601903705929694e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.9145870077789916e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.015378198431526697}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00943521622366883}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.009409090908376095}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.73451225e-04 -4.10328941e-05  1.71417969e-03  3.74238558e-04]
 [ 1.21851142e-04  6.75265298e-04  3.87569737e-03 -4.15461354e-05]
 [-1.46576509e-03  3.14735369e-04  2.13690721e-04 -1.74378381e-04]
 [ 1.42701113e-03 -3.04872047e-04  2.43747308e-03  8.45929030e-05]
 [ 1.70813528e-03  1.35738805e-04 -1.71942722e-03  1.78277594e-05]
 [ 3.17017085e-04 -2.57090606e-04  5.53424268e-04  3.21901551e-04]
 [ 6.21710652e-04  4.27949368e-04 -2.47732703e-04  7.97685619e-04]
 [ 2.20320446e-03 -3.36201050e-04 -4.12170795e-04 -7.09898680e-04]
 [ 7.60764483e-04 -3.89240019e-04 -3.66900450e-03 -1.50212817e-04]
 [-2.60972498e-03  1.12985708e-04 -3.16958058e-03 -6.94650886e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.015378198431526697
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.703827324550022e-06, theta_kick=4.441028323655684e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.2452801194233306e-06, theta_kick=-3.89121297124905e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00943521622366883
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1896417532235775e-06, theta_kick=1.4264252239974966e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.1209120619917476e-06, theta_kick=-2.543053364517378e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.4477278899147093e-06, theta_kick=2.9349178390852317e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.009409090908376095
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.0384695270162386e-06, theta_kick=-2.444201663069689e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01326638e-01 -6.31755396e+00 -1.66894598e-02 -7.55390216e-02]
 [ 1.79983507e-01  4.56164846e-01  8.00492493e-04 -2.02903526e-02]
 [-2.17166875e-02 -7.55465623e-02  3.83856957e-01 -5.11915758e+00]
 [-4.82657401e-03 -3.51680945e-02  2.12524668e-01 -2.30154401e-01]]
compute_tune_4x4()/ evals =  [0.10047326+0.99493976j 0.10047326-0.99493976j 0.05379712+0.99855189j
 0.05379712-0.99855189j]
compute_tune_4x4()/ angles =  [0.23398215641648643, 0.24143378718036398, 0.758566212819636, 0.7660178435835135]
compute_tune_4x4()/  0.23398215641648643 0.24143378718036398
compute_tunes()/ 0.23398215641648643 0.24143378718036398

 Running simulation ..
Closed orbit computation: x_co=[-1.64190721e-09 -1.90418417e-09], y_co=[4.62449586e-08 1.97104796e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.91738578e-03 -2.37429862e-05  1.00403214e-03 -5.50032986e-06]
 [-1.73007191e-03  6.97105019e-04  1.29625417e-03 -2.94848014e-04]
 [ 3.93352041e-03 -5.02640839e-04 -1.41271651e-03 -5.03002218e-05]
 [ 1.30146008e-03 -7.59408941e-04 -1.15455491e-03 -2.85397066e-04]
 [ 1.43465522e-03 -3.28638269e-04 -5.86040110e-03 -4.03479396e-04]
 [-1.79044440e-03 -5.95901345e-04  1.30977592e-04  4.32841617e-04]
 [ 8.48641345e-05 -3.78037837e-04  3.99592158e-04  7.87063952e-05]
 [-8.60437209e-04 -4.47746513e-04 -6.84451199e-04 -4.52154927e-04]
 [-5.87185392e-04 -2.84098170e-04 -2.38587337e-04 -7.83836149e-04]
 [-2.95405991e-04 -2.89890997e-04  1.06241509e-03  2.59754257e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0008223861903858458
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.908902190930354e-05, theta_kick=-8.284033683729072e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.262480316759726e-05, theta_kick=7.5089495340998446e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011407445958417582
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.00011101280660903892, theta_kick=1.3310853213146178e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.332485165570256e-05, theta_kick=-5.194812729141779e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.7670176429206995e-05, theta_kick=4.516795893003451e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0053910172002929755
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.4635321457599095e-05, theta_kick=4.152905362854739e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01648644e-01 -6.32074577e+00 -2.73610344e-03  5.23375016e-02]
 [ 1.79995470e-01  4.56197312e-01  2.42179711e-03 -1.18577449e-02]
 [ 3.46272387e-03  5.23528637e-02  3.84079605e-01 -5.11930207e+00]
 [ 1.29704425e-03 -7.62486803e-03  2.12611187e-01 -2.29969471e-01]]
compute_tune_4x4()/ evals =  [0.08182962+0.99664633j 0.08182962-0.99664633j 0.07249978+0.99736843j
 0.07249978-0.99736843j]
compute_tune_4x4()/ angles =  [0.23696183284501965, 0.23845116931185298, 0.761548830688147, 0.7630381671549804]
compute_tune_4x4()/  0.23696183284501965 0.23845116931185298
compute_tunes()/ 0.23696183284501965 0.23845116931185298

 Running simulation ..
Closed orbit computation: x_co=[ 3.95958958e-07 -4.57193676e-09], y_co=[-5.27233209e-05 -6.48040433e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.908902190930354e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.262480316759726e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.00011101280660903892, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.332485165570256e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.7670176429206995e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.4635321457599095e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0008223861903858458}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.011407445958417582}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0053910172002929755}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.91738578e-03 -2.37429862e-05  1.00403214e-03 -5.50032986e-06]
 [-1.73007191e-03  6.97105019e-04  1.29625417e-03 -2.94848014e-04]
 [ 3.93352041e-03 -5.02640839e-04 -1.41271651e-03 -5.03002218e-05]
 [ 1.30146008e-03 -7.59408941e-04 -1.15455491e-03 -2.85397066e-04]
 [ 1.43465522e-03 -3.28638269e-04 -5.86040110e-03 -4.03479396e-04]
 [-1.79044440e-03 -5.95901345e-04  1.30977592e-04  4.32841617e-04]
 [ 8.48641345e-05 -3.78037837e-04  3.99592158e-04  7.87063952e-05]
 [-8.60437209e-04 -4.47746513e-04 -6.84451199e-04 -4.52154927e-04]
 [-5.87185392e-04 -2.84098170e-04 -2.38587337e-04 -7.83836149e-04]
 [-2.95405991e-04 -2.89890997e-04  1.06241509e-03  2.59754257e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0008223861903858458
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0220256254341931e-06, theta_kick=1.2254471799941674e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.642061675741665e-07, theta_kick=-1.0362157118491148e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.011407445958417582
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.31326317369281e-07, theta_kick=-5.171764837627239e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8128756281701055e-06, theta_kick=2.173706090077147e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.1750225855516961e-06, theta_kick=-1.4088962918929243e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0053910172002929755
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.553974703803743e-07, theta_kick=-1.8632741402638977e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01648644e-01 -6.32074577e+00 -2.73610344e-03  5.23375016e-02]
 [ 1.79995470e-01  4.56197312e-01  2.42179711e-03 -1.18577449e-02]
 [ 3.46272387e-03  5.23528637e-02  3.84079605e-01 -5.11930207e+00]
 [ 1.29704425e-03 -7.62486803e-03  2.12611187e-01 -2.29969471e-01]]
compute_tune_4x4()/ evals =  [0.08182962+0.99664633j 0.08182962-0.99664633j 0.07249978+0.99736843j
 0.07249978-0.99736843j]
compute_tune_4x4()/ angles =  [0.23696183284501965, 0.23845116931185298, 0.761548830688147, 0.7630381671549804]
compute_tune_4x4()/  0.23696183284501965 0.23845116931185298
compute_tunes()/ 0.23696183284501965 0.23845116931185298

 Running simulation ..
Closed orbit computation: x_co=[8.00509057e-10 1.65674590e-10], y_co=[-1.02118249e-07  6.59535900e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.25009372e-04 -5.04989869e-04  1.07978227e-03 -4.96623015e-04]
 [ 2.88745704e-03  3.47891242e-04 -9.72105067e-05  5.77683959e-04]
 [ 9.73160034e-04 -3.46216072e-05  1.99053135e-03  2.86221476e-04]
 [-8.48386152e-04  5.76748907e-05  2.43338328e-04 -2.29697502e-04]
 [ 4.15188557e-03  1.44048136e-04 -1.47283471e-03 -5.55255406e-04]
 [-3.75695979e-03  4.67514877e-04  2.29229560e-03 -2.99017527e-04]
 [-7.66838347e-04  8.33872254e-04 -1.15984726e-03 -4.97874745e-04]
 [-2.14826344e-03 -2.31841095e-04  2.70712075e-03  8.73406038e-04]
 [ 1.24673707e-03  9.75549993e-04 -7.09805646e-04  8.18005085e-06]
 [ 3.26562446e-04 -1.82366697e-04 -2.19839829e-03 -1.75008479e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002088953867164206
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.0001665149897155957, theta_kick=1.9965773802104477e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.6348553285053724e-05, theta_kick=-3.1592906788787923e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009765672706802576
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.848081111027021e-05, theta_kick=-4.6139940413857245e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.168270929040477e-06, theta_kick=7.395988933468638e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.2870532436878333e-05, theta_kick=5.140338145367152e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011590037862182958
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.102684094367748e-05, theta_kick=-1.0914460729966271e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01532160e-01 -6.32057535e+00  1.43748274e-03  6.80496792e-02]
 [ 1.80001224e-01  4.56144305e-01  2.29781903e-03 -8.87496568e-03]
 [ 8.54783865e-03  6.80856260e-02  3.84088492e-01 -5.12016836e+00]
 [ 2.25382292e-03 -1.83327207e-03  2.12601397e-01 -2.30118380e-01]]
compute_tune_4x4()/ evals =  [0.07738749+0.99700109j 0.07738749-0.99700109j 0.07690364+0.99703853j
 0.07690364-0.99703853j]
compute_tune_4x4()/ angles =  [0.23767107204958068, 0.23774830861332547, 0.7622516913866746, 0.7623289279504193]
compute_tune_4x4()/  0.23767107204958068 0.23774830861332547
compute_tunes()/ 0.23767107204958068 0.23774830861332547

 Running simulation ..
Closed orbit computation: x_co=[-4.05623294e-08  8.06035972e-08], y_co=[-1.87943213e-05  1.62826642e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.0001665149897155957, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.6348553285053724e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.848081111027021e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.168270929040477e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.2870532436878333e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.102684094367748e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002088953867164206}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009765672706802576}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011590037862182958}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.25009372e-04 -5.04989869e-04  1.07978227e-03 -4.96623015e-04]
 [ 2.88745704e-03  3.47891242e-04 -9.72105067e-05  5.77683959e-04]
 [ 9.73160034e-04 -3.46216072e-05  1.99053135e-03  2.86221476e-04]
 [-8.48386152e-04  5.76748907e-05  2.43338328e-04 -2.29697502e-04]
 [ 4.15188557e-03  1.44048136e-04 -1.47283471e-03 -5.55255406e-04]
 [-3.75695979e-03  4.67514877e-04  2.29229560e-03 -2.99017527e-04]
 [-7.66838347e-04  8.33872254e-04 -1.15984726e-03 -4.97874745e-04]
 [-2.14826344e-03 -2.31841095e-04  2.70712075e-03  8.73406038e-04]
 [ 1.24673707e-03  9.75549993e-04 -7.09805646e-04  8.18005085e-06]
 [ 3.26562446e-04 -1.82366697e-04 -2.19839829e-03 -1.75008479e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002088953867164206
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.544299960662586e-06, theta_kick=3.050711385566912e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.670770250311846e-06, theta_kick=-1.0396579779599802e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009765672706802576
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.0378473905808294e-05, theta_kick=1.2444180717203299e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.332131090376902e-06, theta_kick=-8.791501058726121e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.310725245042617e-06, theta_kick=3.969684139328077e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011590037862182958
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.792510092464623e-07, theta_kick=-5.746399925549138e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01532160e-01 -6.32057535e+00  1.43748274e-03  6.80496792e-02]
 [ 1.80001224e-01  4.56144305e-01  2.29781903e-03 -8.87496568e-03]
 [ 8.54783865e-03  6.80856260e-02  3.84088492e-01 -5.12016836e+00]
 [ 2.25382292e-03 -1.83327207e-03  2.12601397e-01 -2.30118380e-01]]
compute_tune_4x4()/ evals =  [0.07738749+0.99700109j 0.07738749-0.99700109j 0.07690364+0.99703853j
 0.07690364-0.99703853j]
compute_tune_4x4()/ angles =  [0.23767107204958068, 0.23774830861332547, 0.7622516913866746, 0.7623289279504193]
compute_tune_4x4()/  0.23767107204958068 0.23774830861332547
compute_tunes()/ 0.23767107204958068 0.23774830861332547

 Running simulation ..
Closed orbit computation: x_co=[ 1.18272393e-08 -2.48508670e-09], y_co=[ 4.14534113e-10 -1.17268924e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.17643941e-03  3.67492915e-04  2.49459106e-03 -2.76585749e-04]
 [-2.56444926e-03  7.54452922e-05  2.60970217e-03 -1.35688309e-04]
 [ 2.83168178e-03  6.93841043e-04 -1.58658755e-03  7.08880581e-04]
 [ 1.79600230e-03 -2.27311585e-04  3.23929612e-03  5.33253182e-04]
 [-2.74628947e-03 -3.13458190e-04 -3.02466947e-03  3.46081911e-04]
 [-4.48125417e-03 -6.37659685e-04 -1.55481059e-04 -2.08051614e-04]
 [ 5.26696554e-03 -9.47603496e-04 -1.89164584e-03 -9.44977290e-04]
 [-1.57825355e-03 -6.40798463e-05 -1.40998311e-05 -5.54409629e-04]
 [-3.41881934e-03  1.27452448e-05 -1.02537384e-04 -5.03239872e-04]
 [-3.72337464e-04  3.17904595e-04 -2.02699429e-04  8.82764224e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016393630056111934
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.437142273291003e-06, theta_kick=5.320300539164398e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.462799601700572e-05, theta_kick=-4.15202701496463e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01132592461135769
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.5498686125501517e-05, theta_kick=-1.858350782353596e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.159337074474337e-05, theta_kick=7.385276905695457e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.6184433978211426e-05, theta_kick=1.9405745301127e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0012316576398993316
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.00012141868963945006, theta_kick=-1.4558557742036934e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01359340e-01 -6.31846376e+00  1.29730079e-02  4.02223669e-02]
 [ 1.79968017e-01  4.56094112e-01 -1.46070763e-03  2.06640604e-02]
 [ 1.48739200e-02  4.02313212e-02  3.83961688e-01 -5.11927480e+00]
 [ 3.29964909e-03  3.08982016e-02  2.12551059e-01 -2.30320132e-01]]
compute_tune_4x4()/ evals =  [0.09683839+0.99530012j 0.09683839-0.99530012j 0.05734978+0.99835415j
 0.05734978-0.99835415j]
compute_tune_4x4()/ angles =  [0.23456350122320663, 0.24086748875242708, 0.7591325112475729, 0.7654364987767934]
compute_tune_4x4()/  0.23456350122320663 0.24086748875242708
compute_tunes()/ 0.23456350122320663 0.24086748875242708

 Running simulation ..
Closed orbit computation: x_co=[-6.46986393e-07  3.98516557e-08], y_co=[-4.71796089e-05  1.78352448e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.437142273291003e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.462799601700572e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.5498686125501517e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.159337074474337e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.6184433978211426e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.00012141868963945006, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.016393630056111934}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01132592461135769}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0012316576398993316}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.17643941e-03  3.67492915e-04  2.49459106e-03 -2.76585749e-04]
 [-2.56444926e-03  7.54452922e-05  2.60970217e-03 -1.35688309e-04]
 [ 2.83168178e-03  6.93841043e-04 -1.58658755e-03  7.08880581e-04]
 [ 1.79600230e-03 -2.27311585e-04  3.23929612e-03  5.33253182e-04]
 [-2.74628947e-03 -3.13458190e-04 -3.02466947e-03  3.46081911e-04]
 [-4.48125417e-03 -6.37659685e-04 -1.55481059e-04 -2.08051614e-04]
 [ 5.26696554e-03 -9.47603496e-04 -1.89164584e-03 -9.44977290e-04]
 [-1.57825355e-03 -6.40798463e-05 -1.40998311e-05 -5.54409629e-04]
 [-3.41881934e-03  1.27452448e-05 -1.02537384e-04 -5.03239872e-04]
 [-3.72337464e-04  3.17904595e-04 -2.02699429e-04  8.82764224e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016393630056111934
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.304587925089534e-06, theta_kick=-5.161362888133931e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.864509582506066e-06, theta_kick=9.429842902250902e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01132592461135769
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.700279961397864e-06, theta_kick=-1.1631000659889369e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.87654796314331e-06, theta_kick=1.1842352626304492e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.873712008891336e-06, theta_kick=-7.042801705031444e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0012316576398993316
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.1501936426823856e-06, theta_kick=2.57816308152459e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01359340e-01 -6.31846376e+00  1.29730079e-02  4.02223669e-02]
 [ 1.79968017e-01  4.56094112e-01 -1.46070763e-03  2.06640604e-02]
 [ 1.48739200e-02  4.02313212e-02  3.83961688e-01 -5.11927480e+00]
 [ 3.29964909e-03  3.08982016e-02  2.12551059e-01 -2.30320132e-01]]
compute_tune_4x4()/ evals =  [0.09683839+0.99530012j 0.09683839-0.99530012j 0.05734978+0.99835415j
 0.05734978-0.99835415j]
compute_tune_4x4()/ angles =  [0.23456350122320663, 0.24086748875242708, 0.7591325112475729, 0.7654364987767934]
compute_tune_4x4()/  0.23456350122320663 0.24086748875242708
compute_tunes()/ 0.23456350122320663 0.24086748875242708

 Running simulation ..
Closed orbit computation: x_co=[ 1.03854465e-08 -2.37104467e-09], y_co=[-6.86435223e-09 -1.16311970e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.53739470e-04  4.50067392e-04 -2.39521021e-03 -2.29095717e-04]
 [-1.94884262e-03  2.16096706e-05 -5.27586494e-03 -4.54262910e-04]
 [-2.11599769e-03 -5.79130653e-04  1.14074528e-03 -6.14010392e-04]
 [-5.82348252e-03  9.05690329e-05  2.69946783e-04 -5.27056652e-05]
 [ 2.45726803e-03  2.08825920e-04  1.54826541e-03  1.09140550e-04]
 [-3.09900522e-03  1.72570837e-04 -2.20754587e-03 -2.45366822e-04]
 [-8.37984682e-04 -4.67984599e-04 -4.36620635e-04 -4.23201875e-04]
 [ 2.82770472e-03 -6.54986665e-04 -4.00019939e-03 -4.56204288e-04]
 [-1.24109472e-03 -4.74035855e-04  2.51898212e-03 -2.93765369e-05]
 [ 1.54269038e-03 -5.73570487e-04  2.25488059e-03  1.09863016e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0064207881779627385
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.532683680046069e-06, theta_kick=7.832933533447725e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.523895049147015e-05, theta_kick=6.623358007961039e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007439838663583807
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.8367806417633446e-05, theta_kick=3.401406727188536e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.85068978757929e-06, theta_kick=1.181134770085435e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.732048809312939e-05, theta_kick=-8.071979824821745e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002747107888126032
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.358374153360671e-05, theta_kick=7.6239298523198755e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01707091e-01 -6.32003445e+00 -2.91498186e-03  3.70303866e-02]
 [ 1.80014130e-01  4.56249202e-01  1.62546364e-03 -6.28107080e-03]
 [ 1.65629651e-03  3.70242346e-02  3.84007357e-01 -5.11926480e+00]
 [ 1.00629387e-03 -2.79242234e-03  2.12582851e-01 -2.29750871e-01]]
compute_tune_4x4()/ evals =  [0.07976928+0.99681335j 0.07976928-0.99681335j 0.07463002+0.99721129j
 0.07463002-0.99721129j]
compute_tune_4x4()/ angles =  [0.2372908217836838, 0.238111210423138, 0.761888789576862, 0.7627091782163162]
compute_tune_4x4()/  0.2372908217836838 0.238111210423138
compute_tunes()/ 0.2372908217836838 0.238111210423138

 Running simulation ..
Closed orbit computation: x_co=[-4.57883859e-08  6.71897511e-09], y_co=[1.19607115e-06 5.24947032e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.532683680046069e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.523895049147015e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.8367806417633446e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.85068978757929e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.732048809312939e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.358374153360671e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0064207881779627385}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.007439838663583807}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.002747107888126032}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.53739470e-04  4.50067392e-04 -2.39521021e-03 -2.29095717e-04]
 [-1.94884262e-03  2.16096706e-05 -5.27586494e-03 -4.54262910e-04]
 [-2.11599769e-03 -5.79130653e-04  1.14074528e-03 -6.14010392e-04]
 [-5.82348252e-03  9.05690329e-05  2.69946783e-04 -5.27056652e-05]
 [ 2.45726803e-03  2.08825920e-04  1.54826541e-03  1.09140550e-04]
 [-3.09900522e-03  1.72570837e-04 -2.20754587e-03 -2.45366822e-04]
 [-8.37984682e-04 -4.67984599e-04 -4.36620635e-04 -4.23201875e-04]
 [ 2.82770472e-03 -6.54986665e-04 -4.00019939e-03 -4.56204288e-04]
 [-1.24109472e-03 -4.74035855e-04  2.51898212e-03 -2.93765369e-05]
 [ 1.54269038e-03 -5.73570487e-04  2.25488059e-03  1.09863016e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0064207881779627385
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.94832720011724e-06, theta_kick=4.7341928740997906e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.438004443369006e-06, theta_kick=-1.1316522445301127e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007439838663583807
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1955254204337152e-05, theta_kick=1.4334799623634003e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=9.516126771761515e-06, theta_kick=-1.1410194056502176e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.809717715078003e-06, theta_kick=5.767032512522691e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.002747107888126032
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.127229508576647e-07, theta_kick=-6.14774109973889e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01707091e-01 -6.32003445e+00 -2.91498186e-03  3.70303866e-02]
 [ 1.80014130e-01  4.56249202e-01  1.62546364e-03 -6.28107080e-03]
 [ 1.65629651e-03  3.70242346e-02  3.84007357e-01 -5.11926480e+00]
 [ 1.00629387e-03 -2.79242234e-03  2.12582851e-01 -2.29750871e-01]]
compute_tune_4x4()/ evals =  [0.07976928+0.99681335j 0.07976928-0.99681335j 0.07463002+0.99721129j
 0.07463002-0.99721129j]
compute_tune_4x4()/ angles =  [0.2372908217836838, 0.238111210423138, 0.761888789576862, 0.7627091782163162]
compute_tune_4x4()/  0.2372908217836838 0.238111210423138
compute_tunes()/ 0.2372908217836838 0.238111210423138

 Running simulation ..
Closed orbit computation: x_co=[ 7.61123602e-09 -8.30093941e-10], y_co=[ 2.29188090e-09 -4.20432425e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-6.41929020e-03  5.72547662e-05  2.91659131e-03 -4.06842394e-05]
 [ 9.67438167e-04  6.21805882e-04  2.94553423e-03 -2.85131367e-05]
 [-1.60062262e-03  2.59348737e-04  1.06200245e-03  1.39359216e-04]
 [-9.56149122e-04  5.05782603e-05 -5.61351282e-04 -3.39986007e-04]
 [ 2.08284797e-03  1.50221020e-04  2.56443117e-03  3.12559067e-04]
 [ 1.10353418e-03  1.73869376e-05  2.86868939e-03  6.54199690e-04]
 [-2.60485149e-03  7.81839999e-04  3.96206541e-03  2.41441133e-04]
 [ 3.28626000e-04 -6.08695189e-04 -1.62531199e-03  1.38398944e-04]
 [-2.12842701e-03 -3.56182496e-04 -1.12372199e-03  1.09624317e-03]
 [-2.35057901e-04 -5.98035110e-04  8.06466437e-04 -1.18872803e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0026080619251620664
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.0479139911912372e-05, theta_kick=1.2564883046216928e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.642637070499627e-05, theta_kick=3.168621280328487e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010086004609486086
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.542824746979301e-05, theta_kick=-7.84509305427205e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.9559559866043024e-05, theta_kick=4.743340076141203e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.423158328518907e-05, theta_kick=-6.502570889572368e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.026855526442397318
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-8.82775535535184e-06, theta_kick=1.058481082731998e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01105634e-01 -6.31536029e+00 -2.07068915e-02 -7.13952024e-02]
 [ 1.80043806e-01  4.56575332e-01  9.96795821e-04 -1.76141279e-02]
 [-2.45229136e-02 -7.13371110e-02  3.83282614e-01 -5.12034791e+00]
 [-4.64820389e-03 -3.12968404e-02  2.12437337e-01 -2.30088646e-01]]
compute_tune_4x4()/ evals =  [0.10058015+0.99492896j 0.10058015-0.99492896j 0.05375168+0.99855433j
 0.05375168-0.99855433j]
compute_tune_4x4()/ angles =  [0.2339650575143807, 0.2414410297134057, 0.7585589702865942, 0.7660349424856193]
compute_tune_4x4()/  0.2339650575143807 0.2414410297134057
compute_tunes()/ 0.2339650575143807 0.2414410297134057

 Running simulation ..
Closed orbit computation: x_co=[-1.54302032e-07  1.57410044e-08], y_co=[2.30050237e-05 4.80392665e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.0479139911912372e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.642637070499627e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.542824746979301e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.9559559866043024e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.423158328518907e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -8.82775535535184e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0026080619251620664}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.010086004609486086}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.026855526442397318}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-6.41929020e-03  5.72547662e-05  2.91659131e-03 -4.06842394e-05]
 [ 9.67438167e-04  6.21805882e-04  2.94553423e-03 -2.85131367e-05]
 [-1.60062262e-03  2.59348737e-04  1.06200245e-03  1.39359216e-04]
 [-9.56149122e-04  5.05782603e-05 -5.61351282e-04 -3.39986007e-04]
 [ 2.08284797e-03  1.50221020e-04  2.56443117e-03  3.12559067e-04]
 [ 1.10353418e-03  1.73869376e-05  2.86868939e-03  6.54199690e-04]
 [-2.60485149e-03  7.81839999e-04  3.96206541e-03  2.41441133e-04]
 [ 3.28626000e-04 -6.08695189e-04 -1.62531199e-03  1.38398944e-04]
 [-2.12842701e-03 -3.56182496e-04 -1.12372199e-03  1.09624317e-03]
 [-2.35057901e-04 -5.98035110e-04  8.06466437e-04 -1.18872803e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0026080619251620664
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.1610329147377148e-06, theta_kick=-2.5911597765612233e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.374444133209618e-07, theta_kick=1.0041273615522678e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010086004609486086
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.4091430075104013e-06, theta_kick=1.6896154869194222e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.117295994467817e-06, theta_kick=-1.3396799371421686e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.141312246240425e-07, theta_kick=8.562702084788994e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.026855526442397318
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.543500066385875e-08, theta_kick=9.044940414004917e-09
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01105634e-01 -6.31536029e+00 -2.07068915e-02 -7.13952024e-02]
 [ 1.80043806e-01  4.56575332e-01  9.96795821e-04 -1.76141279e-02]
 [-2.45229136e-02 -7.13371110e-02  3.83282614e-01 -5.12034791e+00]
 [-4.64820389e-03 -3.12968404e-02  2.12437337e-01 -2.30088646e-01]]
compute_tune_4x4()/ evals =  [0.10058015+0.99492896j 0.10058015-0.99492896j 0.05375168+0.99855433j
 0.05375168-0.99855433j]
compute_tune_4x4()/ angles =  [0.2339650575143807, 0.2414410297134057, 0.7585589702865942, 0.7660349424856193]
compute_tune_4x4()/  0.2339650575143807 0.2414410297134057
compute_tunes()/ 0.2339650575143807 0.2414410297134057

 Running simulation ..
Closed orbit computation: x_co=[ 8.33199154e-09 -4.02683980e-10], y_co=[-5.27638845e-07 -1.66806407e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.00596886e-03  4.37189859e-05  6.47494462e-04  5.32348134e-04]
 [-4.68508009e-04 -6.36252936e-04  3.03760492e-03 -4.81616612e-04]
 [-3.47167983e-03 -2.41135820e-04  2.50879389e-03 -1.05617573e-04]
 [-3.27799539e-03  8.83269928e-04 -1.41253243e-03  4.85016207e-04]
 [-3.71467554e-03  1.14328346e-03  4.55368269e-04 -6.58923217e-04]
 [-1.45068305e-03  1.27084444e-04 -4.90518130e-04 -1.19740137e-04]
 [-1.19847922e-03  8.86375849e-05 -1.05132666e-04  3.96775498e-05]
 [-1.55788752e-03  7.99581696e-04 -3.68971950e-04  1.30050309e-04]
 [-7.09272144e-04  5.53417630e-04  3.36870802e-03  1.57734053e-04]
 [-6.59606605e-03  7.51388935e-04 -3.00249330e-03  5.19115336e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002278180338118786
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.230548097349086e-05, theta_kick=-3.873548722469746e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.582564055046408e-05, theta_kick=-5.494666727180652e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012802265138165592
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.753524094993452e-05, theta_kick=-4.500616621325662e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.132413158711119e-05, theta_kick=2.556843612228247e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.05774463491667e-05, theta_kick=-2.4673132426943506e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0027607402178245
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2538900715018737e-05, theta_kick=-1.503461375043178e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01670425e-01 -6.32007143e+00  9.07608031e-03 -1.64463255e-02]
 [ 1.79986546e-01  4.56253698e-01 -2.29967425e-03  1.63330893e-02]
 [ 5.56639406e-03 -1.64433795e-02  3.83974648e-01 -5.11844979e+00]
 [ 6.34308006e-04  1.79629884e-02  2.12594872e-01 -2.29876107e-01]]
compute_tune_4x4()/ evals =  [0.08933795+0.99600137j 0.08933795-0.99600137j 0.06500296+0.99788507j
 0.06500296-0.99788507j]
compute_tune_4x4()/ angles =  [0.23576244196751311, 0.23964715833175734, 0.7603528416682427, 0.7642375580324869]
compute_tune_4x4()/  0.23576244196751311 0.23964715833175734
compute_tunes()/ 0.23576244196751311 0.23964715833175734

 Running simulation ..
Closed orbit computation: x_co=[-7.14424198e-10 -2.45451028e-08], y_co=[ 2.66758358e-05 -4.13474021e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.230548097349086e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.582564055046408e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.753524094993452e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.132413158711119e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.05774463491667e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.2538900715018737e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.002278180338118786}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.012802265138165592}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0027607402178245}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.00596886e-03  4.37189859e-05  6.47494462e-04  5.32348134e-04]
 [-4.68508009e-04 -6.36252936e-04  3.03760492e-03 -4.81616612e-04]
 [-3.47167983e-03 -2.41135820e-04  2.50879389e-03 -1.05617573e-04]
 [-3.27799539e-03  8.83269928e-04 -1.41253243e-03  4.85016207e-04]
 [-3.71467554e-03  1.14328346e-03  4.55368269e-04 -6.58923217e-04]
 [-1.45068305e-03  1.27084444e-04 -4.90518130e-04 -1.19740137e-04]
 [-1.19847922e-03  8.86375849e-05 -1.05132666e-04  3.96775498e-05]
 [-1.55788752e-03  7.99581696e-04 -3.68971950e-04  1.30050309e-04]
 [-7.09272144e-04  5.53417630e-04  3.36870802e-03  1.57734053e-04]
 [-6.59606605e-03  7.51388935e-04 -3.00249330e-03  5.19115336e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002278180338118786
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.434993776887073e-06, theta_kick=-2.9196491584268435e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.7979183293658636e-06, theta_kick=4.553846978731387e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.012802265138165592
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.9813190781159145e-06, theta_kick=-7.171826629893456e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-7.046812818093024e-06, theta_kick=8.44939371477127e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.8902336733568393e-06, theta_kick=-3.4654989233118556e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0027607402178245
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.032167805716184e-07, theta_kick=7.232796167538434e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01670425e-01 -6.32007143e+00  9.07608031e-03 -1.64463255e-02]
 [ 1.79986546e-01  4.56253698e-01 -2.29967425e-03  1.63330893e-02]
 [ 5.56639406e-03 -1.64433795e-02  3.83974648e-01 -5.11844979e+00]
 [ 6.34308006e-04  1.79629884e-02  2.12594872e-01 -2.29876107e-01]]
compute_tune_4x4()/ evals =  [0.08933795+0.99600137j 0.08933795-0.99600137j 0.06500296+0.99788507j
 0.06500296-0.99788507j]
compute_tune_4x4()/ angles =  [0.23576244196751311, 0.23964715833175734, 0.7603528416682427, 0.7642375580324869]
compute_tune_4x4()/  0.23576244196751311 0.23964715833175734
compute_tunes()/ 0.23576244196751311 0.23964715833175734

 Running simulation ..
Closed orbit computation: x_co=[ 4.49681101e-09 -8.83223078e-10], y_co=[-5.54631799e-07 -1.86381393e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.42775416e-03  3.19219121e-05  3.47961017e-03  3.80304252e-04]
 [-9.76462136e-04 -2.66090292e-04 -2.21378894e-03 -2.86358454e-04]
 [ 4.65777923e-04 -2.45314859e-04  1.06644711e-03  1.96437974e-04]
 [-5.51468726e-03 -2.36055604e-04  4.25700793e-03  4.18539718e-04]
 [-1.37621531e-03 -1.32278223e-04 -2.78297767e-03  2.41030570e-04]
 [ 1.68101230e-03  1.99778054e-04 -1.94962014e-04 -4.75390427e-04]
 [ 3.00553814e-03 -9.44277854e-05  3.19934816e-03  3.42503387e-04]
 [ 2.54289678e-03  1.45748112e-04 -5.99167269e-03 -8.82052708e-04]
 [-1.65167223e-03  2.10497548e-04 -1.46052521e-03 -3.88433825e-04]
 [ 1.37065650e-03  2.62505317e-04  4.67132318e-03 -9.16487500e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.012453244878357037
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.260634377566627e-06, theta_kick=1.110384906261509e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.139855976258489e-05, theta_kick=9.7599935886411e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004852289227451497
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.1946487223646742e-05, theta_kick=2.6314663947462453e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.5858997506035787e-06, theta_kick=4.299628725309186e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.94355739019514e-05, theta_kick=4.728473692532633e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007426422999344865
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.303999614129297e-05, theta_kick=3.961619854802032e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01483518e-01 -6.31862531e+00 -1.19891925e-02 -6.85280505e-02]
 [ 1.79999873e-01  4.56136491e-01  1.09226508e-04 -1.32114618e-02]
 [-1.71481132e-02 -6.85307446e-02  3.83971974e-01 -5.11950755e+00]
 [-3.95769762e-03 -2.54899065e-02  2.12546305e-01 -2.29960253e-01]]
compute_tune_4x4()/ evals =  [0.09403287+0.99556909j 0.09403287-0.99556909j 0.06029948+0.99818033j
 0.06029948-0.99818033j]
compute_tune_4x4()/ angles =  [0.2350120611997205, 0.24039721433336086, 0.7596027856666392, 0.7649879388002795]
compute_tune_4x4()/  0.2350120611997205 0.24039721433336086
compute_tunes()/ 0.2350120611997205 0.24039721433336086

 Running simulation ..
Closed orbit computation: x_co=[-8.9046020e-08 -1.2064841e-08], y_co=[-4.22107856e-05 -6.79142908e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.260634377566627e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -8.139855976258489e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.1946487223646742e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.5858997506035787e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.94355739019514e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.303999614129297e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.012453244878357037}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004852289227451497}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007426422999344865}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.42775416e-03  3.19219121e-05  3.47961017e-03  3.80304252e-04]
 [-9.76462136e-04 -2.66090292e-04 -2.21378894e-03 -2.86358454e-04]
 [ 4.65777923e-04 -2.45314859e-04  1.06644711e-03  1.96437974e-04]
 [-5.51468726e-03 -2.36055604e-04  4.25700793e-03  4.18539718e-04]
 [-1.37621531e-03 -1.32278223e-04 -2.78297767e-03  2.41030570e-04]
 [ 1.68101230e-03  1.99778054e-04 -1.94962014e-04 -4.75390427e-04]
 [ 3.00553814e-03 -9.44277854e-05  3.19934816e-03  3.42503387e-04]
 [ 2.54289678e-03  1.45748112e-04 -5.99167269e-03 -8.82052708e-04]
 [-1.65167223e-03  2.10497548e-04 -1.46052521e-03 -3.88433825e-04]
 [ 1.37065650e-03  2.62505317e-04  4.67132318e-03 -9.16487500e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.012453244878357037
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.1937610713327258e-06, theta_kick=1.4313644414052892e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.507795735216608e-06, theta_kick=1.8079038193816768e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004852289227451497
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.983794934548299e-06, theta_kick=-7.174795274913336e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.139448068897485e-06, theta_kick=4.96335398694888e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3022867895840602e-07, theta_kick=-1.5614908610157945e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007426422999344865
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.149517254392872e-07, theta_kick=-1.0970615450997481e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01483518e-01 -6.31862531e+00 -1.19891925e-02 -6.85280505e-02]
 [ 1.79999873e-01  4.56136491e-01  1.09226508e-04 -1.32114618e-02]
 [-1.71481132e-02 -6.85307446e-02  3.83971974e-01 -5.11950755e+00]
 [-3.95769762e-03 -2.54899065e-02  2.12546305e-01 -2.29960253e-01]]
compute_tune_4x4()/ evals =  [0.09403287+0.99556909j 0.09403287-0.99556909j 0.06029948+0.99818033j
 0.06029948-0.99818033j]
compute_tune_4x4()/ angles =  [0.2350120611997205, 0.24039721433336086, 0.7596027856666392, 0.7649879388002795]
compute_tune_4x4()/  0.2350120611997205 0.24039721433336086
compute_tunes()/ 0.2350120611997205 0.24039721433336086

 Running simulation ..
Closed orbit computation: x_co=[-6.35232609e-09  6.90575361e-10], y_co=[1.79912519e-07 3.80561007e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.75680034e-03  3.20802309e-04 -1.41925442e-03  2.10939933e-04]
 [-1.25923059e-03  4.04649693e-04  3.11411045e-03  9.88886509e-05]
 [-4.99240006e-03  4.82254292e-04  1.22717856e-03  2.74097914e-05]
 [-2.34165425e-03 -4.82464517e-05  1.30695864e-04  1.75857507e-04]
 [ 2.33978515e-04  1.00217561e-04  7.59788419e-04  3.50955533e-04]
 [ 1.48547999e-04 -1.60281210e-04  5.22219251e-03  1.33712843e-04]
 [-1.67367492e-03 -2.70544400e-04 -5.62970315e-03 -3.50068290e-04]
 [ 1.73669378e-03  1.13231486e-04  1.89191458e-03  8.01289262e-04]
 [ 3.66207681e-03 -3.18089994e-04 -5.94547762e-04  3.08353671e-05]
 [-1.49451291e-03 -6.04630805e-05  4.57355033e-03 -8.08399514e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011178049277989386
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.71096899961818e-06, theta_kick=-1.164381721890507e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.3279141580250746e-05, theta_kick=-1.5922190400410227e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007490333867278266
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.086992139313234e-05, theta_kick=3.7014197272973796e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.691136786198452e-06, theta_kick=8.022924769737187e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.935971429914511e-05, theta_kick=-5.918415467078705e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005003683272730794
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.3201390573933765e-05, theta_kick=6.3790469072532335e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01681822e-01 -6.31976209e+00  7.32743781e-03  3.58062818e-03]
 [ 1.79996709e-01  4.56165485e-01 -1.21671883e-03  1.03858409e-02]
 [ 6.32360785e-03  3.58154559e-03  3.84011406e-01 -5.11887086e+00]
 [ 1.02182561e-03  1.33022062e-02  2.12575710e-01 -2.29753758e-01]]
compute_tune_4x4()/ evals =  [0.08646866+0.99625457j 0.08646866-0.99625457j 0.067902  +0.997692j
 0.067902  -0.997692j  ]
compute_tune_4x4()/ angles =  [0.23622087887903814, 0.23918473924111597, 0.7608152607588841, 0.7637791211209619]
compute_tune_4x4()/  0.23622087887903814 0.23918473924111597
compute_tunes()/ 0.23622087887903814 0.23918473924111597

 Running simulation ..
Closed orbit computation: x_co=[ 4.32866471e-08 -1.78224167e-09], y_co=[ 1.53623152e-05 -1.07758391e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.71096899961818e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.3279141580250746e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.086992139313234e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.691136786198452e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.935971429914511e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.3201390573933765e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0011178049277989386}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007490333867278266}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005003683272730794}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.75680034e-03  3.20802309e-04 -1.41925442e-03  2.10939933e-04]
 [-1.25923059e-03  4.04649693e-04  3.11411045e-03  9.88886509e-05]
 [-4.99240006e-03  4.82254292e-04  1.22717856e-03  2.74097914e-05]
 [-2.34165425e-03 -4.82464517e-05  1.30695864e-04  1.75857507e-04]
 [ 2.33978515e-04  1.00217561e-04  7.59788419e-04  3.50955533e-04]
 [ 1.48547999e-04 -1.60281210e-04  5.22219251e-03  1.33712843e-04]
 [-1.67367492e-03 -2.70544400e-04 -5.62970315e-03 -3.50068290e-04]
 [ 1.73669378e-03  1.13231486e-04  1.89191458e-03  8.01289262e-04]
 [ 3.66207681e-03 -3.18089994e-04 -5.94547762e-04  3.08353671e-05]
 [-1.49451291e-03 -6.04630805e-05  4.57355033e-03 -8.08399514e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011178049277989386
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.716033730346262e-06, theta_kick=3.2566266371333503e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.924150018401144e-06, theta_kick=-4.705203523522979e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007490333867278266
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.362189331463112e-06, theta_kick=6.42946676806137e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.7905556791730005e-06, theta_kick=-6.943094136829613e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.0016164458981256e-06, theta_kick=3.5990510585165513e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005003683272730794
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.901759207788414e-07, theta_kick=-8.27546897817747e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01681822e-01 -6.31976209e+00  7.32743781e-03  3.58062818e-03]
 [ 1.79996709e-01  4.56165485e-01 -1.21671883e-03  1.03858409e-02]
 [ 6.32360785e-03  3.58154559e-03  3.84011406e-01 -5.11887086e+00]
 [ 1.02182561e-03  1.33022062e-02  2.12575710e-01 -2.29753758e-01]]
compute_tune_4x4()/ evals =  [0.08646866+0.99625457j 0.08646866-0.99625457j 0.067902  +0.997692j
 0.067902  -0.997692j  ]
compute_tune_4x4()/ angles =  [0.23622087887903814, 0.23918473924111597, 0.7608152607588841, 0.7637791211209619]
compute_tune_4x4()/  0.23622087887903814 0.23918473924111597
compute_tunes()/ 0.23622087887903814 0.23918473924111597

 Running simulation ..
Closed orbit computation: x_co=[-1.51991058e-09  3.35336847e-10], y_co=[2.20324767e-07 1.28744710e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.85113044e-04  1.85717005e-04  2.49747383e-03  3.97032706e-04]
 [ 3.06571466e-03 -6.97462720e-04 -2.49473782e-03 -7.55482910e-05]
 [ 1.18512125e-03 -5.67635937e-05 -1.89686940e-03 -7.23418700e-04]
 [-7.50468755e-04 -3.83990542e-05  3.12713148e-03  1.35445638e-04]
 [-4.22768834e-03  1.34579110e-04 -2.50601950e-03 -4.23617230e-04]
 [-2.26321752e-03 -4.56637004e-05 -1.13013928e-03  6.49771612e-04]
 [-2.96554127e-03 -7.04689795e-05  6.34919338e-04  5.04230505e-04]
 [-4.27479089e-04  2.07969243e-04  5.40358278e-04 -9.54530966e-04]
 [-7.66721058e-04  6.63224501e-04 -1.64902793e-03  7.72838159e-04]
 [ 3.03336649e-03 -5.82908497e-04 -5.24012940e-03 -4.39180666e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006222098796762855
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.386460802481663e-05, theta_kick=-5.259531548705009e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.55724087409861e-06, theta_kick=5.464303280405256e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.031174497288552462
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.411995907853457e-05, theta_kick=1.1285337232611605e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.2133501110309788e-05, theta_kick=-1.4548524370676478e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.598464846533757e-06, theta_kick=4.3146947481082254e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005013700379053183
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.3805403408082387e-05, theta_kick=2.8543574396840274e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01464195e-01 -6.32063060e+00  2.13043540e-02 -4.43246279e-02]
 [ 1.79915661e-01  4.57015871e-01 -5.63723666e-03  3.95861200e-02]
 [ 1.24387416e-02 -4.42993719e-02  3.83460090e-01 -5.11501503e+00]
 [ 1.33515300e-03  4.29578710e-02  2.12685488e-01 -2.30748796e-01]]
compute_tune_4x4()/ evals =  [0.10598405+0.99436783j 0.10598405-0.99436783j 0.04814743+0.99884024j
 0.04814743-0.99884024j]
compute_tune_4x4()/ angles =  [0.23310037530885194, 0.24233413407750257, 0.7576658659224974, 0.766899624691148]
compute_tune_4x4()/  0.23310037530885194 0.24233413407750257
compute_tunes()/ 0.23310037530885194 0.24233413407750257

 Running simulation ..
Closed orbit computation: x_co=[-9.52933933e-07  8.31578005e-08], y_co=[-3.43611166e-05 -5.22399260e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.386460802481663e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.55724087409861e-06, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.411995907853457e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.2133501110309788e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.598464846533757e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -2.3805403408082387e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.006222098796762855}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.031174497288552462}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005013700379053183}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.85113044e-04  1.85717005e-04  2.49747383e-03  3.97032706e-04]
 [ 3.06571466e-03 -6.97462720e-04 -2.49473782e-03 -7.55482910e-05]
 [ 1.18512125e-03 -5.67635937e-05 -1.89686940e-03 -7.23418700e-04]
 [-7.50468755e-04 -3.83990542e-05  3.12713148e-03  1.35445638e-04]
 [-4.22768834e-03  1.34579110e-04 -2.50601950e-03 -4.23617230e-04]
 [-2.26321752e-03 -4.56637004e-05 -1.13013928e-03  6.49771612e-04]
 [-2.96554127e-03 -7.04689795e-05  6.34919338e-04  5.04230505e-04]
 [-4.27479089e-04  2.07969243e-04  5.40358278e-04 -9.54530966e-04]
 [-7.66721058e-04  6.63224501e-04 -1.64902793e-03  7.72838159e-04]
 [ 3.03336649e-03 -5.82908497e-04 -5.24012940e-03 -4.39180666e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.006222098796762855
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.558064964728759e-06, theta_kick=5.465291396078333e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.448613058252264e-06, theta_kick=-8.931167321000505e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.031174497288552462
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1156660014103226e-05, theta_kick=1.337725514135536e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.3096107346808474e-05, theta_kick=-1.5702725467601978e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.979774466667592e-06, theta_kick=1.076708746171255e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005013700379053183
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.836470704222844e-06, theta_kick=-4.6000727267702333e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01464195e-01 -6.32063060e+00  2.13043540e-02 -4.43246279e-02]
 [ 1.79915661e-01  4.57015871e-01 -5.63723666e-03  3.95861200e-02]
 [ 1.24387416e-02 -4.42993719e-02  3.83460090e-01 -5.11501503e+00]
 [ 1.33515300e-03  4.29578710e-02  2.12685488e-01 -2.30748796e-01]]
compute_tune_4x4()/ evals =  [0.10598405+0.99436783j 0.10598405-0.99436783j 0.04814743+0.99884024j
 0.04814743-0.99884024j]
compute_tune_4x4()/ angles =  [0.23310037530885194, 0.24233413407750257, 0.7576658659224974, 0.766899624691148]
compute_tune_4x4()/  0.23310037530885194 0.24233413407750257
compute_tunes()/ 0.23310037530885194 0.24233413407750257

 Running simulation ..
Closed orbit computation: x_co=[-4.2183549e-08  4.8616016e-09], y_co=[-6.84206879e-07  1.71694023e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.28604475e-04  3.09971371e-05 -1.04963929e-04 -8.44518000e-05]
 [ 2.91520749e-03 -9.22319741e-05  3.05925845e-03  1.52201273e-04]
 [ 9.80252901e-04 -5.82058609e-04 -1.84154396e-03  7.84010788e-04]
 [ 1.49247638e-07 -4.10140917e-04  8.89491993e-04  1.36775109e-04]
 [-1.87332493e-03 -6.95589145e-06  9.40319017e-04  5.36254741e-04]
 [-2.34828911e-03  1.35324670e-04 -1.48853987e-03  5.12135684e-04]
 [ 9.62895936e-04  2.07488287e-04  1.84526511e-03  1.90578962e-05]
 [ 4.17816600e-04 -7.94451282e-05 -1.02252998e-03 -5.23847154e-04]
 [ 2.86120326e-03 -5.41352992e-04  1.58610653e-03  2.28044071e-05]
 [ 1.30300328e-03 -2.44835894e-04  1.21722966e-03 -4.71961996e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.022575615171649167
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.497826523218464e-05, theta_kick=8.990176117218262e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.353606105922504e-05, theta_kick=-5.220137531328115e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.001708158116447299
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.720526838227036e-05, theta_kick=-1.0456239800669133e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.378496179691318e-05, theta_kick=4.050944039945086e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.317276811654725e-05, theta_kick=-6.3756149669167165e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007224585459793271
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.993384838508032e-05, theta_kick=-1.1982444436012494e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01268465e-01 -6.31783615e+00 -5.32152234e-03 -5.88589726e-02]
 [ 1.80033719e-01  4.56262515e-01 -3.48518387e-04 -1.02382297e-02]
 [-1.06966500e-02 -5.88534377e-02  3.83869320e-01 -5.12162525e+00]
 [-3.15248054e-03 -2.05208034e-02  2.12514350e-01 -2.30424333e-01]]
compute_tune_4x4()/ evals =  [0.08874614+0.99605428j 0.08874614-0.99605428j 0.06547338+0.99785432j
 0.06547338-0.99785432j]
compute_tune_4x4()/ angles =  [0.23585700687491587, 0.23957212877480122, 0.7604278712251988, 0.7641429931250842]
compute_tune_4x4()/  0.23585700687491587 0.23957212877480122
compute_tunes()/ 0.23585700687491587 0.23957212877480122

 Running simulation ..
Closed orbit computation: x_co=[ 1.52132071e-07 -2.92590076e-07], y_co=[2.80478362e-05 1.47317634e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.497826523218464e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.353606105922504e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.720526838227036e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.378496179691318e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.317276811654725e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 9.993384838508032e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.022575615171649167}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.001708158116447299}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.007224585459793271}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.28604475e-04  3.09971371e-05 -1.04963929e-04 -8.44518000e-05]
 [ 2.91520749e-03 -9.22319741e-05  3.05925845e-03  1.52201273e-04]
 [ 9.80252901e-04 -5.82058609e-04 -1.84154396e-03  7.84010788e-04]
 [ 1.49247638e-07 -4.10140917e-04  8.89491993e-04  1.36775109e-04]
 [-1.87332493e-03 -6.95589145e-06  9.40319017e-04  5.36254741e-04]
 [-2.34828911e-03  1.35324670e-04 -1.48853987e-03  5.12135684e-04]
 [ 9.62895936e-04  2.07488287e-04  1.84526511e-03  1.90578962e-05]
 [ 4.17816600e-04 -7.94451282e-05 -1.02252998e-03 -5.23847154e-04]
 [ 2.86120326e-03 -5.41352992e-04  1.58610653e-03  2.28044071e-05]
 [ 1.30300328e-03 -2.44835894e-04  1.21722966e-03 -4.71961996e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.022575615171649167
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.5132157306543336e-06, theta_kick=-4.212477850555335e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.22069082361863e-06, theta_kick=5.060767106728229e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.001708158116447299
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.0605084847765896e-06, theta_kick=1.2715895763154116e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.308646363822862e-06, theta_kick=-8.763341987943179e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.45926632421046e-06, theta_kick=5.346828108664212e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007224585459793271
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.773308496322463e-07, theta_kick=-9.320489368352356e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01268465e-01 -6.31783615e+00 -5.32152234e-03 -5.88589726e-02]
 [ 1.80033719e-01  4.56262515e-01 -3.48518387e-04 -1.02382297e-02]
 [-1.06966500e-02 -5.88534377e-02  3.83869320e-01 -5.12162525e+00]
 [-3.15248054e-03 -2.05208034e-02  2.12514350e-01 -2.30424333e-01]]
compute_tune_4x4()/ evals =  [0.08874614+0.99605428j 0.08874614-0.99605428j 0.06547338+0.99785432j
 0.06547338-0.99785432j]
compute_tune_4x4()/ angles =  [0.23585700687491587, 0.23957212877480122, 0.7604278712251988, 0.7641429931250842]
compute_tune_4x4()/  0.23585700687491587 0.23957212877480122
compute_tunes()/ 0.23585700687491587 0.23957212877480122

 Running simulation ..
Closed orbit computation: x_co=[-6.13888223e-11 -5.27685351e-10], y_co=[ 2.17504905e-07 -4.08074432e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.32664317e-03 -4.99506695e-04 -2.94820199e-03 -2.75055756e-04]
 [-2.08894291e-03  5.86843813e-04  4.36498423e-03 -1.86332578e-04]
 [-3.09416020e-04  1.64947449e-04  9.48837931e-05  1.08316782e-04]
 [-2.59124568e-03  6.37739047e-04  1.72002682e-03  1.96394999e-04]
 [-1.30303584e-03 -3.18797650e-04 -6.36922974e-04  6.51397792e-04]
 [ 1.17383318e-03  8.16305276e-04 -2.06836113e-03 -4.20286294e-04]
 [-4.04783456e-03  2.48542989e-04  2.12565997e-04  1.84385300e-04]
 [ 7.42001684e-04 -1.33440428e-05 -9.64648791e-04 -1.50564339e-04]
 [ 2.03289435e-03 -2.91399203e-04  2.32155406e-03  8.13970932e-04]
 [-5.82473582e-04 -1.39207055e-04  1.93293543e-03  5.39116504e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0014695255462239352
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.989630144759835e-05, theta_kick=-4.783716658805502e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.3268728395256024e-05, theta_kick=5.188083339042869e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.023228219639974682
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.124112897909573e-05, theta_kick=9.741117045346102e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.8954452531427117e-05, theta_kick=-3.4717478035678657e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.5066602519614773e-05, theta_kick=1.8065423322346796e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0030366059703474885
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.008505025855897e-05, theta_kick=-8.403461230496381e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642378e-01 -6.32088304e+00 -1.41864302e-02  4.91205768e-02]
 [ 1.79971084e-01  4.56690156e-01  4.36720071e-03 -2.78752140e-02]
 [-6.15915717e-03  4.91054377e-02  3.83748091e-01 -5.11710977e+00]
 [-1.92681111e-04 -2.78396320e-02  2.12651730e-01 -2.30211375e-01]]
compute_tune_4x4()/ evals =  [0.0960593 +0.99537561j 0.0960593 -0.99537561j 0.05823295+0.99830302j
 0.05823295-0.99830302j]
compute_tune_4x4()/ angles =  [0.23468807817527348, 0.24072669190286153, 0.7592733080971384, 0.7653119218247265]
compute_tune_4x4()/  0.23468807817527348 0.24072669190286153
compute_tunes()/ 0.23468807817527348 0.24072669190286153

 Running simulation ..
Closed orbit computation: x_co=[ 1.76425510e-06 -2.11572098e-07], y_co=[-5.96400457e-05  3.82107740e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.989630144759835e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.3268728395256024e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.124112897909573e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.8954452531427117e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.5066602519614773e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.008505025855897e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0014695255462239352}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.023228219639974682}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0030366059703474885}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.32664317e-03 -4.99506695e-04 -2.94820199e-03 -2.75055756e-04]
 [-2.08894291e-03  5.86843813e-04  4.36498423e-03 -1.86332578e-04]
 [-3.09416020e-04  1.64947449e-04  9.48837931e-05  1.08316782e-04]
 [-2.59124568e-03  6.37739047e-04  1.72002682e-03  1.96394999e-04]
 [-1.30303584e-03 -3.18797650e-04 -6.36922974e-04  6.51397792e-04]
 [ 1.17383318e-03  8.16305276e-04 -2.06836113e-03 -4.20286294e-04]
 [-4.04783456e-03  2.48542989e-04  2.12565997e-04  1.84385300e-04]
 [ 7.42001684e-04 -1.33440428e-05 -9.64648791e-04 -1.50564339e-04]
 [ 2.03289435e-03 -2.91399203e-04  2.32155406e-03  8.13970932e-04]
 [-5.82473582e-04 -1.39207055e-04  1.93293543e-03  5.39116504e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0014695255462239352
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.9599110831524336e-06, theta_kick=3.5490447593637006e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.67011194137596e-06, theta_kick=-6.798677563352176e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.023228219639974682
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.976383777180229e-06, theta_kick=1.1962059523792498e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0277420400773147e-05, theta_kick=-1.2323013762391144e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.387438280758599e-06, theta_kick=7.658778834647154e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0030366059703474885
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.116844853915084e-07, theta_kick=-1.0931440013481287e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01642378e-01 -6.32088304e+00 -1.41864302e-02  4.91205768e-02]
 [ 1.79971084e-01  4.56690156e-01  4.36720071e-03 -2.78752140e-02]
 [-6.15915717e-03  4.91054377e-02  3.83748091e-01 -5.11710977e+00]
 [-1.92681111e-04 -2.78396320e-02  2.12651730e-01 -2.30211375e-01]]
compute_tune_4x4()/ evals =  [0.0960593 +0.99537561j 0.0960593 -0.99537561j 0.05823295+0.99830302j
 0.05823295-0.99830302j]
compute_tune_4x4()/ angles =  [0.23468807817527348, 0.24072669190286153, 0.7592733080971384, 0.7653119218247265]
compute_tune_4x4()/  0.23468807817527348 0.24072669190286153
compute_tunes()/ 0.23468807817527348 0.24072669190286153

 Running simulation ..
Closed orbit computation: x_co=[ 1.57388627e-08 -1.68390211e-09], y_co=[-4.20294629e-07  2.58352044e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.05525494e-05  2.40349961e-04 -1.80931041e-03 -5.05150132e-04]
 [ 7.86269647e-04  2.05080636e-04 -1.50831581e-03 -2.75589235e-04]
 [ 2.77144235e-03 -3.21717861e-04  5.64499957e-04 -2.64690171e-04]
 [ 1.65682414e-03 -1.20202450e-03  1.88608494e-03 -4.88076720e-04]
 [ 4.60078533e-03 -6.71700521e-04 -1.21861373e-05 -8.02022245e-05]
 [-3.40284221e-03  8.86357793e-04  1.45200841e-03  3.46872987e-04]
 [-1.27533087e-03 -1.16492471e-04  6.47490276e-04 -1.79041016e-04]
 [-2.83568943e-03  6.69311443e-04  8.68664310e-04  1.36552844e-05]
 [-1.22433340e-03  2.15497421e-04  3.40862561e-03 -5.01614456e-04]
 [-1.96340958e-03  6.14149701e-04 -1.26339649e-03  5.65323378e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017340891529732361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.310955381564058e-05, theta_kick=3.9699600816764825e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.5548083963704085e-05, theta_kick=-4.262349021729297e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009838718230106073
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.9855526336558307e-05, theta_kick=-2.3807523168607676e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.1362171168887246e-05, theta_kick=4.9594799539214305e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.060153034269835e-05, theta_kick=-2.4702010041380836e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0077342051337943975
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.6276204300482183e-05, theta_kick=1.9515781370512322e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01645447e-01 -6.31938585e+00  1.04507339e-02  1.06423013e-02]
 [ 1.79994725e-01  4.56229822e-01 -1.53924137e-03  1.40802711e-02]
 [ 9.61958169e-03  1.06434788e-02  3.83929464e-01 -5.11862603e+00]
 [ 1.63583425e-03  1.88096749e-02  2.12568161e-01 -2.29782963e-01]]
compute_tune_4x4()/ evals =  [0.09035002+0.99591007j 0.09035002-0.99591007j 0.06401541+0.99794891j
 0.06401541-0.99794891j]
compute_tune_4x4()/ angles =  [0.2356007112462618, 0.2398046588357077, 0.7601953411642923, 0.7643992887537382]
compute_tune_4x4()/  0.2356007112462618 0.2398046588357077
compute_tunes()/ 0.2356007112462618 0.2398046588357077

 Running simulation ..
Closed orbit computation: x_co=[ 1.77638181e-07 -2.46778739e-08], y_co=[ 1.01419171e-05 -4.52347007e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.310955381564058e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.5548083963704085e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.9855526336558307e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.1362171168887246e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.060153034269835e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.6276204300482183e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0017340891529732361}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.009838718230106073}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0077342051337943975}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.05525494e-05  2.40349961e-04 -1.80931041e-03 -5.05150132e-04]
 [ 7.86269647e-04  2.05080636e-04 -1.50831581e-03 -2.75589235e-04]
 [ 2.77144235e-03 -3.21717861e-04  5.64499957e-04 -2.64690171e-04]
 [ 1.65682414e-03 -1.20202450e-03  1.88608494e-03 -4.88076720e-04]
 [ 4.60078533e-03 -6.71700521e-04 -1.21861373e-05 -8.02022245e-05]
 [-3.40284221e-03  8.86357793e-04  1.45200841e-03  3.46872987e-04]
 [-1.27533087e-03 -1.16492471e-04  6.47490276e-04 -1.79041016e-04]
 [-2.83568943e-03  6.69311443e-04  8.68664310e-04  1.36552844e-05]
 [-1.22433340e-03  2.15497421e-04  3.40862561e-03 -5.01614456e-04]
 [-1.96340958e-03  6.14149701e-04 -1.26339649e-03  5.65323378e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0017340891529732361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.261007776782644e-07, theta_kick=9.905259155970166e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.5657891412938584e-07, theta_kick=1.87744009534876e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009838718230106073
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2760476227491583e-07, theta_kick=-2.7290667390511298e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.791700007218897e-07, theta_kick=6.944466229213535e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.161737126393918e-07, theta_kick=-7.388154658252238e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0077342051337943975
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.3276356953046127e-06, theta_kick=1.591885152761652e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01645447e-01 -6.31938585e+00  1.04507339e-02  1.06423013e-02]
 [ 1.79994725e-01  4.56229822e-01 -1.53924137e-03  1.40802711e-02]
 [ 9.61958169e-03  1.06434788e-02  3.83929464e-01 -5.11862603e+00]
 [ 1.63583425e-03  1.88096749e-02  2.12568161e-01 -2.29782963e-01]]
compute_tune_4x4()/ evals =  [0.09035002+0.99591007j 0.09035002-0.99591007j 0.06401541+0.99794891j
 0.06401541-0.99794891j]
compute_tune_4x4()/ angles =  [0.2356007112462618, 0.2398046588357077, 0.7601953411642923, 0.7643992887537382]
compute_tune_4x4()/  0.2356007112462618 0.2398046588357077
compute_tunes()/ 0.2356007112462618 0.2398046588357077

 Running simulation ..
Closed orbit computation: x_co=[ 7.65108013e-09 -2.81367000e-10], y_co=[2.79111164e-07 2.07732621e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 0.00218237  0.00012059 -0.00273596  0.00038725]
 [ 0.00173977 -0.00024857  0.00241757  0.00013896]
 [ 0.00159451 -0.00070208 -0.0005966   0.00018677]
 [-0.00448258  0.0008072   0.00071245 -0.00014659]
 [-0.00232169  0.00046317  0.00021218  0.00039826]
 [-0.0028595   0.00034834  0.0054602   0.00045574]
 [ 0.00212723 -0.0002628  -0.00297057 -0.00067366]
 [-0.0040853   0.00068095 -0.00121778 -0.00033906]
 [ 0.00043588 -0.00028568 -0.00032534  0.00052824]
 [ 0.00061556  0.00051269  0.00158891  0.00063597]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016380829158129488
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.667638419207184e-06, theta_kick=-6.795711717202191e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.2083795169202028e-05, theta_kick=-1.4488925077034912e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01665782425136025
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.177793346296855e-05, theta_kick=-1.412218538279996e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.887664466848283e-05, theta_kick=-9.457606479811109e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.992022957887829e-05, theta_kick=2.388510479069647e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016274354749969057
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.4483353657075857e-05, theta_kick=-1.7366085990634125e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01048494e-01 -6.31520387e+00  2.49871332e-02  8.71358646e-02]
 [ 1.79954732e-01  4.56358366e-01 -1.89356979e-03  3.08230807e-02]
 [ 2.96946330e-02  8.71368812e-02  3.83487188e-01 -5.11782385e+00]
 [ 6.21385507e-03  4.97273099e-02  2.12477128e-01 -2.30400640e-01]]
compute_tune_4x4()/ evals =  [0.11072489+0.99385109j 0.11072489-0.99385109j 0.04347332+0.99905459j
 0.04347332-0.99905459j]
compute_tune_4x4()/ angles =  [0.23234137715319667, 0.24307882566435454, 0.7569211743356454, 0.7676586228468033]
compute_tune_4x4()/  0.23234137715319667 0.24307882566435454
compute_tunes()/ 0.23234137715319667 0.24307882566435454

 Running simulation ..
Closed orbit computation: x_co=[ 1.05566403e-07 -2.67956861e-08], y_co=[3.77243521e-05 2.42163237e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.667638419207184e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.2083795169202028e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.177793346296855e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.887664466848283e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.992022957887829e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.4483353657075857e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.016380829158129488}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01665782425136025}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.016274354749969057}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 0.00218237  0.00012059 -0.00273596  0.00038725]
 [ 0.00173977 -0.00024857  0.00241757  0.00013896]
 [ 0.00159451 -0.00070208 -0.0005966   0.00018677]
 [-0.00448258  0.0008072   0.00071245 -0.00014659]
 [-0.00232169  0.00046317  0.00021218  0.00039826]
 [-0.0028595   0.00034834  0.0054602   0.00045574]
 [ 0.00212723 -0.0002628  -0.00297057 -0.00067366]
 [-0.0040853   0.00068095 -0.00121778 -0.00033906]
 [ 0.00043588 -0.00028568 -0.00032534  0.00052824]
 [ 0.00061556  0.00051269  0.00158891  0.00063597]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016380829158129488
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.971551279125252e-07, theta_kick=-5.961077045022405e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.095550512113845e-07, theta_kick=6.109756791014838e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01665782425136025
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0009878621585557e-06, theta_kick=-1.2002221102523376e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.505420412527123e-07, theta_kick=1.1397356728938869e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.2332620372543792e-06, theta_kick=-1.4787275858227013e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.016274354749969057
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.16149083794373e-07, theta_kick=8.586896975488104e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01048494e-01 -6.31520387e+00  2.49871332e-02  8.71358646e-02]
 [ 1.79954732e-01  4.56358366e-01 -1.89356979e-03  3.08230807e-02]
 [ 2.96946330e-02  8.71368812e-02  3.83487188e-01 -5.11782385e+00]
 [ 6.21385507e-03  4.97273099e-02  2.12477128e-01 -2.30400640e-01]]
compute_tune_4x4()/ evals =  [0.11072489+0.99385109j 0.11072489-0.99385109j 0.04347332+0.99905459j
 0.04347332-0.99905459j]
compute_tune_4x4()/ angles =  [0.23234137715319667, 0.24307882566435454, 0.7569211743356454, 0.7676586228468033]
compute_tune_4x4()/  0.23234137715319667 0.24307882566435454
compute_tunes()/ 0.23234137715319667 0.24307882566435454

 Running simulation ..
Closed orbit computation: x_co=[ 4.03956104e-09 -4.04254673e-10], y_co=[ 4.50511274e-07 -5.16653771e-09]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 15/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.79848348e-03  3.30938841e-04  5.65106369e-03  4.69651061e-04]
 [ 3.47170274e-03 -2.52830970e-04 -1.34953022e-03  5.57191660e-04]
 [ 2.24383355e-05 -1.94796652e-04  1.26270319e-03 -4.66860549e-05]
 [ 9.58147080e-05 -3.77689486e-04 -4.38250951e-03  1.78963037e-04]
 [ 3.89235051e-03 -8.37299928e-04 -2.07325254e-03  2.63636830e-04]
 [ 1.43917265e-03  4.44276333e-04 -3.49873553e-04 -1.30989304e-05]
 [ 4.26437093e-04  4.14886194e-05 -1.74039840e-03 -3.07345209e-04]
 [ 1.17482193e-03  7.40715228e-05  8.87535162e-04 -6.69165913e-04]
 [-2.70729752e-03  4.11769261e-04  5.99645149e-04  7.64093861e-04]
 [-6.51675693e-04 -1.85613990e-05  1.96955756e-03 -2.08106528e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0050648446564994475
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.85136756236486e-05, theta_kick=-8.21504749926071e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.342267124093886e-05, theta_kick=-1.609428786407318e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011098443199345203
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.0001282089266434415, theta_kick=-1.5372732708002023e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.2738833091992667e-05, theta_kick=2.726471645669581e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.369168281448509e-06, theta_kick=-7.636872418040886e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012580997844577738
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.7559427002001856e-05, theta_kick=4.503516619971833e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01526410e-01 -6.31933853e+00 -9.25203062e-03 -7.66634995e-02]
 [ 1.80014445e-01  4.56148655e-01 -9.50286531e-04 -4.48532772e-03]
 [-1.58127406e-02 -7.66650451e-02  3.84003850e-01 -5.12000533e+00]
 [-3.66955980e-03 -1.58083328e-02  2.12560291e-01 -2.29889537e-01]]
compute_tune_4x4()/ evals =  [0.08846174+0.99607958j 0.08846174-0.99607958j 0.06590654+0.9978258j
 0.06590654-0.9978258j ]
compute_tune_4x4()/ angles =  [0.23590244891793183, 0.23950304027520827, 0.7604969597247917, 0.7640975510820682]
compute_tune_4x4()/  0.23590244891793183 0.23950304027520827
compute_tunes()/ 0.23590244891793183 0.23950304027520827

 Running simulation ..
Closed orbit computation: x_co=[1.45736795e-07 1.97648446e-07], y_co=[ 6.89797135e-05 -1.06591859e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.85136756236486e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.342267124093886e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.0001282089266434415, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.2738833091992667e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.369168281448509e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.7559427002001856e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0050648446564994475}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0011098443199345203}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012580997844577738}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.79848348e-03  3.30938841e-04  5.65106369e-03  4.69651061e-04]
 [ 3.47170274e-03 -2.52830970e-04 -1.34953022e-03  5.57191660e-04]
 [ 2.24383355e-05 -1.94796652e-04  1.26270319e-03 -4.66860549e-05]
 [ 9.58147080e-05 -3.77689486e-04 -4.38250951e-03  1.78963037e-04]
 [ 3.89235051e-03 -8.37299928e-04 -2.07325254e-03  2.63636830e-04]
 [ 1.43917265e-03  4.44276333e-04 -3.49873553e-04 -1.30989304e-05]
 [ 4.26437093e-04  4.14886194e-05 -1.74039840e-03 -3.07345209e-04]
 [ 1.17482193e-03  7.40715228e-05  8.87535162e-04 -6.69165913e-04]
 [-2.70729752e-03  4.11769261e-04  5.99645149e-04  7.64093861e-04]
 [-6.51675693e-04 -1.85613990e-05  1.96955756e-03 -2.08106528e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0050648446564994475
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.167261859942965e-06, theta_kick=-1.0991891900716863e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.5699540103717674e-05, theta_kick=1.8824339300820136e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011098443199345203
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4400027456889922e-05, theta_kick=-1.7266174741350037e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.027450129636811e-06, theta_kick=1.0824252375474045e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.6476421491340435e-06, theta_kick=-5.57269781064317e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012580997844577738
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.5912183639819963e-06, theta_kick=3.1069683165153646e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01526410e-01 -6.31933853e+00 -9.25203062e-03 -7.66634995e-02]
 [ 1.80014445e-01  4.56148655e-01 -9.50286531e-04 -4.48532772e-03]
 [-1.58127406e-02 -7.66650451e-02  3.84003850e-01 -5.12000533e+00]
 [-3.66955980e-03 -1.58083328e-02  2.12560291e-01 -2.29889537e-01]]
compute_tune_4x4()/ evals =  [0.08846174+0.99607958j 0.08846174-0.99607958j 0.06590654+0.9978258j
 0.06590654-0.9978258j ]
compute_tune_4x4()/ angles =  [0.23590244891793183, 0.23950304027520827, 0.7604969597247917, 0.7640975510820682]
compute_tune_4x4()/  0.23590244891793183 0.23950304027520827
compute_tunes()/ 0.23590244891793183 0.23950304027520827

 Running simulation ..
Closed orbit computation: x_co=[1.19584526e-09 6.44199481e-10], y_co=[ 1.12258922e-07 -2.26644018e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 16/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.95720920e-03  1.11344911e-04 -2.17131285e-03 -9.17684300e-04]
 [ 1.44275649e-03  3.66998121e-04  3.33670816e-04 -4.01141129e-04]
 [ 2.09750878e-03  4.14199387e-04 -2.34457700e-03 -4.19208739e-04]
 [-2.00342718e-03  1.57517432e-04  1.24929477e-03  3.86316748e-04]
 [-1.92131780e-04  6.38308862e-04 -3.78428002e-03 -2.94101591e-05]
 [-1.75495596e-03 -4.89105407e-04 -4.29225354e-03  6.68436222e-04]
 [-1.34550948e-03  5.59411004e-05  7.72482839e-04  3.25469248e-04]
 [ 3.61843711e-03 -1.92257807e-04 -3.25143922e-03 -1.53599195e-04]
 [ 3.80059894e-03  4.17811328e-05  1.22434730e-03  8.38003949e-05]
 [-1.01975296e-03  7.21049392e-04  1.84979351e-03 -3.21312941e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009177114088298997
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.9329239627569405e-05, theta_kick=2.317648560227966e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.1312338494893914e-05, theta_kick=-2.5554295760982887e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00016412274045099286
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.4961639351909065e-06, theta_kick=-2.9929944798432057e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.66989717791152e-05, theta_kick=1.1594570559295857e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.974016600856988e-05, theta_kick=-8.362108311248981e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02243628793037164
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.038942824632648e-05, theta_kick=-7.240919670138538e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01203236e-01 -6.31783705e+00  1.01968513e-02  5.56163649e-02]
 [ 1.80035466e-01  4.56244283e-01  5.49207251e-04  1.77107603e-03]
 [ 1.42967493e-02  5.56300629e-02  3.83735726e-01 -5.12183517e+00]
 [ 2.70196228e-03  9.64029069e-03  2.12499867e-01 -2.30306438e-01]]
compute_tune_4x4()/ evals =  [0.0860529 +0.99629057j 0.0860529 -0.99629057j 0.06818227+0.99767288j
 0.06818227-0.99767288j]
compute_tune_4x4()/ angles =  [0.23628729554960912, 0.2391400300363014, 0.7608599699636986, 0.7637127044503909]
compute_tune_4x4()/  0.23628729554960912 0.2391400300363014
compute_tunes()/ 0.23628729554960912 0.2391400300363014

 Running simulation ..
Closed orbit computation: x_co=[6.99868235e-08 9.05359501e-08], y_co=[-3.27072873e-05  5.89823377e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.9329239627569405e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.1312338494893914e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.4961639351909065e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -9.66989717791152e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.974016600856988e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.038942824632648e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009177114088298997}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.00016412274045099286}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.02243628793037164}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.95720920e-03  1.11344911e-04 -2.17131285e-03 -9.17684300e-04]
 [ 1.44275649e-03  3.66998121e-04  3.33670816e-04 -4.01141129e-04]
 [ 2.09750878e-03  4.14199387e-04 -2.34457700e-03 -4.19208739e-04]
 [-2.00342718e-03  1.57517432e-04  1.24929477e-03  3.86316748e-04]
 [-1.92131780e-04  6.38308862e-04 -3.78428002e-03 -2.94101591e-05]
 [-1.75495596e-03 -4.89105407e-04 -4.29225354e-03  6.68436222e-04]
 [-1.34550948e-03  5.59411004e-05  7.72482839e-04  3.25469248e-04]
 [ 3.61843711e-03 -1.92257807e-04 -3.25143922e-03 -1.53599195e-04]
 [ 3.80059894e-03  4.17811328e-05  1.22434730e-03  8.38003949e-05]
 [-1.01975296e-03  7.21049392e-04  1.84979351e-03 -3.21312941e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009177114088298997
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3075480396026242e-06, theta_kick=-1.5677992977497115e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.5818757258003524e-06, theta_kick=4.294803768160734e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.00016412274045099286
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.5173162833684722e-06, theta_kick=-1.8193193148392825e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.770004141580611e-06, theta_kick=-2.1223015645585876e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.7546449731061024e-06, theta_kick=2.1038853436481325e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.02243628793037164
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.475945286710925e-07, theta_kick=-6.565864438625402e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01203236e-01 -6.31783705e+00  1.01968513e-02  5.56163649e-02]
 [ 1.80035466e-01  4.56244283e-01  5.49207251e-04  1.77107603e-03]
 [ 1.42967493e-02  5.56300629e-02  3.83735726e-01 -5.12183517e+00]
 [ 2.70196228e-03  9.64029069e-03  2.12499867e-01 -2.30306438e-01]]
compute_tune_4x4()/ evals =  [0.0860529 +0.99629057j 0.0860529 -0.99629057j 0.06818227+0.99767288j
 0.06818227-0.99767288j]
compute_tune_4x4()/ angles =  [0.23628729554960912, 0.2391400300363014, 0.7608599699636986, 0.7637127044503909]
compute_tune_4x4()/  0.23628729554960912 0.2391400300363014
compute_tunes()/ 0.23628729554960912 0.2391400300363014

 Running simulation ..
Closed orbit computation: x_co=[3.97720134e-10 3.94489282e-10], y_co=[-1.82182236e-07  5.51176752e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 17/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.05009638e-04  1.88330867e-04  1.95931052e-03 -4.43927565e-05]
 [ 1.33169963e-03 -2.79629603e-05 -4.75451629e-04  8.20530289e-04]
 [-2.05998777e-03  8.13626682e-04  7.05622085e-03  1.43308160e-03]
 [ 3.21048487e-04  6.74148120e-04 -3.81979486e-03  1.38403988e-04]
 [ 1.75060389e-03 -1.23819915e-05  3.35471520e-04 -1.89445455e-04]
 [-2.27190075e-03  2.31868050e-04 -3.54832246e-03 -1.12880691e-04]
 [-1.44777009e-03  3.35638946e-04 -2.59923510e-03  1.49003700e-04]
 [ 3.95030898e-03 -2.61776515e-04 -9.05089874e-04  3.16982329e-04]
 [ 1.66847724e-03 -3.19923203e-04  1.75768136e-03 -4.30489227e-04]
 [ 1.76764410e-03  1.53618143e-04 -1.03549131e-03 -7.14111125e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012307523092240945
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.910061249438466e-05, theta_kick=5.887348185782289e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.8323711803744025e-05, theta_kick=4.595157243425814e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.013454611517137378
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.840837260284105e-05, theta_kick=9.401458897203583e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.817355643225183e-05, theta_kick=5.776190675758553e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.812721423919414e-05, theta_kick=-1.1765822204215044e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01210181295420891
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.439760502551915e-05, theta_kick=6.522477520917231e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620702e-01 -6.31883148e+00 -9.42181055e-03  4.01788278e-02]
 [ 1.80055431e-01  4.56715254e-01  2.67808007e-03 -1.29969638e-02]
 [-3.27827099e-03  4.01398016e-02  3.83613405e-01 -5.11950159e+00]
 [ 5.00206791e-04 -1.06553162e-02  2.12550377e-01 -2.29832539e-01]]
compute_tune_4x4()/ evals =  [0.0862619 +0.9962725j  0.0862619 -0.9962725j  0.06817581+0.99767332j
 0.06817581-0.99767332j]
compute_tune_4x4()/ angles =  [0.23625390905088942, 0.2391410592944086, 0.7608589407055915, 0.7637460909491106]
compute_tune_4x4()/  0.23625390905088942 0.2391410592944086
compute_tunes()/ 0.23625390905088942 0.2391410592944086

 Running simulation ..
Closed orbit computation: x_co=[ 1.78448007e-07 -1.48976221e-07], y_co=[-3.02573351e-05  9.70858655e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.910061249438466e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.8323711803744025e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -7.840837260284105e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.817355643225183e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 9.812721423919414e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.439760502551915e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.012307523092240945}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.013454611517137378}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01210181295420891}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.05009638e-04  1.88330867e-04  1.95931052e-03 -4.43927565e-05]
 [ 1.33169963e-03 -2.79629603e-05 -4.75451629e-04  8.20530289e-04]
 [-2.05998777e-03  8.13626682e-04  7.05622085e-03  1.43308160e-03]
 [ 3.21048487e-04  6.74148120e-04 -3.81979486e-03  1.38403988e-04]
 [ 1.75060389e-03 -1.23819915e-05  3.35471520e-04 -1.89445455e-04]
 [-2.27190075e-03  2.31868050e-04 -3.54832246e-03 -1.12880691e-04]
 [-1.44777009e-03  3.35638946e-04 -2.59923510e-03  1.49003700e-04]
 [ 3.95030898e-03 -2.61776515e-04 -9.05089874e-04  3.16982329e-04]
 [ 1.66847724e-03 -3.19923203e-04  1.75768136e-03 -4.30489227e-04]
 [ 1.76764410e-03  1.53618143e-04 -1.03549131e-03 -7.14111125e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012307523092240945
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.570404834591063e-06, theta_kick=-4.281049737992977e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.866949431926421e-06, theta_kick=8.233730747153969e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.013454611517137378
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.039223080459407e-05, theta_kick=-1.2460675756469394e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.1678597228259793e-05, theta_kick=1.4003077499723769e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.849882135848595e-06, theta_kick=-8.213266416976523e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01210181295420891
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.533767882345706e-06, theta_kick=3.0380830273812595e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01620702e-01 -6.31883148e+00 -9.42181055e-03  4.01788278e-02]
 [ 1.80055431e-01  4.56715254e-01  2.67808007e-03 -1.29969638e-02]
 [-3.27827099e-03  4.01398016e-02  3.83613405e-01 -5.11950159e+00]
 [ 5.00206791e-04 -1.06553162e-02  2.12550377e-01 -2.29832539e-01]]
compute_tune_4x4()/ evals =  [0.0862619 +0.9962725j  0.0862619 -0.9962725j  0.06817581+0.99767332j
 0.06817581-0.99767332j]
compute_tune_4x4()/ angles =  [0.23625390905088942, 0.2391410592944086, 0.7608589407055915, 0.7637460909491106]
compute_tune_4x4()/  0.23625390905088942 0.2391410592944086
compute_tunes()/ 0.23625390905088942 0.2391410592944086

 Running simulation ..
Closed orbit computation: x_co=[-1.58106611e-08  2.20573914e-11], y_co=[ 1.47718179e-07 -1.41617824e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 18/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.96394936e-04 -6.92435242e-04  5.33330139e-03  4.05451660e-04]
 [-4.34529129e-03  8.14322467e-04  8.85025927e-04 -1.60867680e-04]
 [-6.06639768e-04  1.00712598e-04 -8.11018867e-04 -1.00333305e-03]
 [ 4.66993842e-03 -9.37473439e-04  1.87930762e-03  3.21168461e-04]
 [-1.69802222e-03  8.22894142e-05 -2.38977905e-03  3.02647788e-04]
 [-3.12158931e-03  5.02772549e-04 -2.82835815e-03  6.85324745e-04]
 [ 2.84471427e-03  3.90035909e-04  4.06305211e-03  9.07230684e-04]
 [-1.49336335e-03  2.72582730e-04  1.35441058e-03  3.77418005e-04]
 [ 5.41475395e-03 -6.16445213e-04 -1.47946108e-03 -5.06914629e-04]
 [-3.49717256e-03  1.65346106e-04 -1.38363243e-03  4.53899878e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004977614749018626
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4960366834388809e-05, theta_kick=1.79380427384993e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.931219934312022e-05, theta_kick=-7.1117558714244405e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0021138122898108837
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.3653964312216083e-05, theta_kick=-1.6371616959249683e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.631080133465902e-05, theta_kick=5.552839330688795e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.0521159466474275e-05, theta_kick=-2.4605642336725085e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007447971070669173
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.80985956000365e-07, theta_kick=-3.369127337216494e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01633132e-01 -6.31984019e+00 -5.52661091e-03 -5.78801527e-02]
 [ 1.80008811e-01  4.56128142e-01 -9.34125328e-04 -1.90135673e-03]
 [-1.07570513e-02 -5.78816033e-02  3.84064685e-01 -5.11961370e+00]
 [-2.62997233e-03 -1.01020024e-02  2.12575105e-01 -2.29802075e-01]]
compute_tune_4x4()/ evals =  [0.08422226+0.99644699j 0.08422226-0.99644699j 0.07015655+0.99753599j
 0.07015655-0.99753599j]
compute_tune_4x4()/ angles =  [0.2365797125185189, 0.23882505897552153, 0.7611749410244785, 0.763420287481481]
compute_tune_4x4()/  0.2365797125185189 0.23882505897552153
compute_tunes()/ 0.2365797125185189 0.23882505897552153

 Running simulation ..
Closed orbit computation: x_co=[2.03715316e-08 2.89996776e-08], y_co=[ 8.70811323e-06 -2.70048187e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.4960366834388809e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.931219934312022e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.3653964312216083e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.631080133465902e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.0521159466474275e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.80985956000365e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004977614749018626}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0021138122898108837}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.007447971070669173}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.96394936e-04 -6.92435242e-04  5.33330139e-03  4.05451660e-04]
 [-4.34529129e-03  8.14322467e-04  8.85025927e-04 -1.60867680e-04]
 [-6.06639768e-04  1.00712598e-04 -8.11018867e-04 -1.00333305e-03]
 [ 4.66993842e-03 -9.37473439e-04  1.87930762e-03  3.21168461e-04]
 [-1.69802222e-03  8.22894142e-05 -2.38977905e-03  3.02647788e-04]
 [-3.12158931e-03  5.02772549e-04 -2.82835815e-03  6.85324745e-04]
 [ 2.84471427e-03  3.90035909e-04  4.06305211e-03  9.07230684e-04]
 [-1.49336335e-03  2.72582730e-04  1.35441058e-03  3.77418005e-04]
 [ 5.41475395e-03 -6.16445213e-04 -1.47946108e-03 -5.06914629e-04]
 [-3.49717256e-03  1.65346106e-04 -1.38363243e-03  4.53899878e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004977614749018626
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.4884036154572426e-06, theta_kick=-2.983689564490001e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.045857306911137e-06, theta_kick=4.851135141848052e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0021138122898108837
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.971862637896373e-06, theta_kick=-3.5633751231951205e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.7296457288638493e-07, theta_kick=2.073910309171243e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.606688319454388e-07, theta_kick=1.1518780759686833e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.007447971070669173
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.396551333060023e-07, theta_kick=-8.868743353602075e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01633132e-01 -6.31984019e+00 -5.52661091e-03 -5.78801527e-02]
 [ 1.80008811e-01  4.56128142e-01 -9.34125328e-04 -1.90135673e-03]
 [-1.07570513e-02 -5.78816033e-02  3.84064685e-01 -5.11961370e+00]
 [-2.62997233e-03 -1.01020024e-02  2.12575105e-01 -2.29802075e-01]]
compute_tune_4x4()/ evals =  [0.08422226+0.99644699j 0.08422226-0.99644699j 0.07015655+0.99753599j
 0.07015655-0.99753599j]
compute_tune_4x4()/ angles =  [0.2365797125185189, 0.23882505897552153, 0.7611749410244785, 0.763420287481481]
compute_tune_4x4()/  0.2365797125185189 0.23882505897552153
compute_tunes()/ 0.2365797125185189 0.23882505897552153

 Running simulation ..
Closed orbit computation: x_co=[-6.59668088e-11  6.01429474e-10], y_co=[-3.18105682e-07 -5.39706001e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 19/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 4.69284511e-03 -5.92341113e-04  9.23378216e-04 -1.54181644e-04]
 [ 7.45503796e-03 -2.38370212e-04 -1.87064628e-03 -1.44996369e-04]
 [ 1.41366759e-03 -2.40308070e-04  5.20582311e-04 -1.48190460e-04]
 [-4.15853300e-03  6.42750497e-04 -1.66795460e-03  4.59357526e-04]
 [-4.15722294e-03  3.50506465e-04  1.77306021e-03  1.33032268e-04]
 [-2.00860598e-03  2.75560437e-04 -2.39276462e-03 -7.61735441e-04]
 [-4.38508564e-04  8.68818090e-04 -1.44192876e-04 -1.01398119e-03]
 [ 9.55926570e-04  6.34850995e-05 -1.85887618e-03 -4.91535575e-04]
 [-5.25852940e-05  7.02011839e-04 -2.30192118e-03 -1.15424027e-04]
 [ 6.20281427e-03 -7.01077113e-04  1.02810415e-04 -5.55864388e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007945363946654798
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.593276200885664e-05, theta_kick=-4.308473366746341e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.048263349513282e-05, theta_kick=4.854020077458637e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0008961967708256834
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.2474174757738996e-05, theta_kick=-2.6947381155797327e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.500658956790931e-05, theta_kick=-7.794534685291223e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.767425076265547e-06, theta_kick=1.0512472552687043e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010551010070431003
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.736292854981421e-05, theta_kick=-6.878030968911647e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01535213e-01 -6.31912426e+00  1.01459152e-02  7.43411629e-02]
 [ 1.80011130e-01  4.56147333e-01  5.98824904e-04  7.52019529e-03]
 [ 1.62851049e-02  7.43397857e-02  3.83998047e-01 -5.11976262e+00]
 [ 3.78791845e-03  1.92430427e-02  2.12556060e-01 -2.29866669e-01]]
compute_tune_4x4()/ evals =  [0.09041156+0.99590449j 0.09041156-0.99590449j 0.06396019+0.99795245j
 0.06396019-0.99795245j]
compute_tune_4x4()/ angles =  [0.235590876852272, 0.23981346648142748, 0.7601865335185725, 0.764409123147728]
compute_tune_4x4()/  0.235590876852272 0.23981346648142748
compute_tunes()/ 0.235590876852272 0.23981346648142748

 Running simulation ..
Closed orbit computation: x_co=[-4.97045723e-08  2.47164295e-08], y_co=[1.35068547e-05 5.82709874e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.593276200885664e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.048263349513282e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.2474174757738996e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.500658956790931e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.767425076265547e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.736292854981421e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.007945363946654798}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0008961967708256834}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010551010070431003}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 4.69284511e-03 -5.92341113e-04  9.23378216e-04 -1.54181644e-04]
 [ 7.45503796e-03 -2.38370212e-04 -1.87064628e-03 -1.44996369e-04]
 [ 1.41366759e-03 -2.40308070e-04  5.20582311e-04 -1.48190460e-04]
 [-4.15853300e-03  6.42750497e-04 -1.66795460e-03  4.59357526e-04]
 [-4.15722294e-03  3.50506465e-04  1.77306021e-03  1.33032268e-04]
 [-2.00860598e-03  2.75560437e-04 -2.39276462e-03 -7.61735441e-04]
 [-4.38508564e-04  8.68818090e-04 -1.44192876e-04 -1.01398119e-03]
 [ 9.55926570e-04  6.34850995e-05 -1.85887618e-03 -4.91535575e-04]
 [-5.25852940e-05  7.02011839e-04 -2.30192118e-03 -1.15424027e-04]
 [ 6.20281427e-03 -7.01077113e-04  1.02810415e-04 -5.55864388e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.007945363946654798
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.145201862088997e-06, theta_kick=-4.970253001479765e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.095581734680951e-06, theta_kick=9.70690710711132e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0008961967708256834
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.76066266828629e-06, theta_kick=-1.0504364171075152e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.556906453644563e-06, theta_kick=7.861977550406988e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.724701112324644e-06, theta_kick=-4.466056780601996e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010551010070431003
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2579048927322157e-06, theta_kick=1.5082752967614454e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01535213e-01 -6.31912426e+00  1.01459152e-02  7.43411629e-02]
 [ 1.80011130e-01  4.56147333e-01  5.98824904e-04  7.52019529e-03]
 [ 1.62851049e-02  7.43397857e-02  3.83998047e-01 -5.11976262e+00]
 [ 3.78791845e-03  1.92430427e-02  2.12556060e-01 -2.29866669e-01]]
compute_tune_4x4()/ evals =  [0.09041156+0.99590449j 0.09041156-0.99590449j 0.06396019+0.99795245j
 0.06396019-0.99795245j]
compute_tune_4x4()/ angles =  [0.235590876852272, 0.23981346648142748, 0.7601865335185725, 0.764409123147728]
compute_tune_4x4()/  0.235590876852272 0.23981346648142748
compute_tunes()/ 0.235590876852272 0.23981346648142748

 Running simulation ..
Closed orbit computation: x_co=[9.72698741e-10 1.25711448e-10], y_co=[ 1.60540388e-07 -3.89049404e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 20/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-9.79266610e-04  8.06417876e-04 -1.72190599e-03  4.35931714e-04]
 [ 1.74643366e-03 -7.23720480e-04  4.77948874e-03  2.65549190e-04]
 [-1.89947148e-03 -8.50871587e-04 -2.70451300e-03 -4.85463773e-05]
 [ 1.85979155e-03 -3.15923618e-04  3.87253560e-04  4.24698187e-04]
 [-1.62481181e-03  3.98494023e-04  1.49291507e-03 -7.58584102e-04]
 [-3.20889334e-03 -6.20603671e-05  2.88492007e-03  6.38796062e-04]
 [-3.39865227e-04  7.60198960e-04 -2.61058477e-03 -9.28232455e-04]
 [-3.05773407e-03  1.28833939e-04 -6.09900094e-04  9.41505602e-05]
 [-2.95989492e-04  1.57401498e-04 -1.48369599e-03  1.94504634e-04]
 [-1.85188397e-03  4.19575436e-04  1.60278502e-03  6.06854444e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005059017074900042
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.6432341385356735e-05, theta_kick=-6.766450066432933e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.884392852469012e-05, theta_kick=-2.259457932943976e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010889075420817287
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.186711460075758e-06, theta_kick=6.219062197675323e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.0666205936846466e-05, theta_kick=-6.07506873029086e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.219442076158397e-05, theta_kick=-6.258307437892172e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0024077150810868386
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-0.00010520353977940058, theta_kick=1.2614300262119184e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01720454e-01 -6.32026780e+00 -4.98441393e-03  4.28568803e-02]
 [ 1.80012399e-01  4.56327408e-01  2.25673862e-03 -1.07258305e-02]
 [ 6.12126353e-04  4.28476096e-02  3.83974748e-01 -5.11898848e+00]
 [ 9.02369925e-04 -7.49911134e-03  2.12595252e-01 -2.29779152e-01]]
compute_tune_4x4()/ evals =  [0.08281945+0.99656457j 0.08281945-0.99656457j 0.07158182+0.99743473j
 0.07158182-0.99743473j]
compute_tune_4x4()/ angles =  [0.2368037593037959, 0.2385976477428164, 0.7614023522571836, 0.7631962406962041]
compute_tune_4x4()/  0.2368037593037959 0.2385976477428164
compute_tunes()/ 0.2368037593037959 0.2385976477428164

 Running simulation ..
Closed orbit computation: x_co=[-4.45718607e-07  7.19700001e-08], y_co=[ 7.28070474e-05 -5.91014047e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.6432341385356735e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.884392852469012e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.186711460075758e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.0666205936846466e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.219442076158397e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -0.00010520353977940058, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005059017074900042}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.010889075420817287}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0024077150810868386}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-9.79266610e-04  8.06417876e-04 -1.72190599e-03  4.35931714e-04]
 [ 1.74643366e-03 -7.23720480e-04  4.77948874e-03  2.65549190e-04]
 [-1.89947148e-03 -8.50871587e-04 -2.70451300e-03 -4.85463773e-05]
 [ 1.85979155e-03 -3.15923618e-04  3.87253560e-04  4.24698187e-04]
 [-1.62481181e-03  3.98494023e-04  1.49291507e-03 -7.58584102e-04]
 [-3.20889334e-03 -6.20603671e-05  2.88492007e-03  6.38796062e-04]
 [-3.39865227e-04  7.60198960e-04 -2.61058477e-03 -9.28232455e-04]
 [-3.05773407e-03  1.28833939e-04 -6.09900094e-04  9.41505602e-05]
 [-2.95989492e-04  1.57401498e-04 -1.48369599e-03  1.94504634e-04]
 [-1.85188397e-03  4.19575436e-04  1.60278502e-03  6.06854444e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005059017074900042
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.356279277751569e-06, theta_kick=2.825267512223719e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.154125249235798e-06, theta_kick=-9.77710298384162e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.010889075420817287
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.894900418498155e-06, theta_kick=9.466282658101789e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.9065873267028046e-06, theta_kick=-3.4851075690020277e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.179862285187848e-07, theta_kick=-1.1007000284693543e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0024077150810868386
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.317096521054751e-07, theta_kick=8.773474044412825e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01720454e-01 -6.32026780e+00 -4.98441393e-03  4.28568803e-02]
 [ 1.80012399e-01  4.56327408e-01  2.25673862e-03 -1.07258305e-02]
 [ 6.12126353e-04  4.28476096e-02  3.83974748e-01 -5.11898848e+00]
 [ 9.02369925e-04 -7.49911134e-03  2.12595252e-01 -2.29779152e-01]]
compute_tune_4x4()/ evals =  [0.08281945+0.99656457j 0.08281945-0.99656457j 0.07158182+0.99743473j
 0.07158182-0.99743473j]
compute_tune_4x4()/ angles =  [0.2368037593037959, 0.2385976477428164, 0.7614023522571836, 0.7631962406962041]
compute_tune_4x4()/  0.2368037593037959 0.2385976477428164
compute_tunes()/ 0.2368037593037959 0.2385976477428164

 Running simulation ..
Closed orbit computation: x_co=[ 1.21672887e-08 -1.13302954e-09], y_co=[ 5.43293682e-07 -4.17174630e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 21/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.97434612e-03 -7.98599642e-05 -3.45251344e-03 -3.63957775e-04]
 [-3.05253904e-03  3.44665281e-04  2.01494808e-03 -5.44828876e-04]
 [ 8.36956061e-04 -3.41267403e-05  1.83396567e-03  2.51269242e-04]
 [-9.65039197e-04 -3.42173767e-04 -8.62254884e-04  1.55110113e-05]
 [ 2.42955552e-04  2.43230916e-04 -1.50348920e-03 -2.07249242e-04]
 [ 1.85359638e-03 -4.31365125e-04 -9.36619122e-04 -9.42871044e-04]
 [ 2.36630969e-03  3.64600491e-04  7.83369845e-04  2.43640286e-04]
 [-8.68094471e-04 -2.99533510e-04  2.00453089e-03  6.99486420e-04]
 [-8.22061331e-04 -4.09847063e-05  3.22563300e-03  3.79522418e-05]
 [-5.32285020e-04 -2.75747407e-04 -8.45125635e-04  4.21401182e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01553732721810683
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.2841808357172615e-05, theta_kick=-2.7388187674230404e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.241914674147983e-05, theta_kick=2.688140049379894e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010158009248995313
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.938718926677038e-05, theta_kick=-5.921709819075262e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.6226616286246206e-05, theta_kick=-4.343707600271873e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.808546356981731e-05, theta_kick=-8.16370326280048e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006622669399427151
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5970910857839894e-06, theta_kick=-1.9149723045704897e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01358342e-01 -6.31792618e+00  1.53890079e-02  6.24971105e-02]
 [ 1.79976984e-01  4.56138454e-01 -1.04894826e-03  2.04217509e-02]
 [ 1.92480162e-02  6.25080022e-02  3.83899335e-01 -5.11908491e+00]
 [ 4.26500166e-03  3.35839001e-02  2.12535629e-01 -2.30184718e-01]]
compute_tune_4x4()/ evals =  [0.09916325+0.99507118j 0.09916325-0.99507118j 0.05508412+0.99848172j
 0.05508412-0.99848172j]
compute_tune_4x4()/ angles =  [0.23419169831068049, 0.2412286509771467, 0.7587713490228533, 0.7658083016893196]
compute_tune_4x4()/  0.23419169831068049 0.2412286509771467
compute_tunes()/ 0.23419169831068049 0.2412286509771467

 Running simulation ..
Closed orbit computation: x_co=[-5.25473405e-08  1.25854342e-07], y_co=[5.59720819e-05 7.81786717e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.2841808357172615e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.241914674147983e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.938718926677038e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.6226616286246206e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.808546356981731e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.5970910857839894e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.01553732721810683}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.010158009248995313}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006622669399427151}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.97434612e-03 -7.98599642e-05 -3.45251344e-03 -3.63957775e-04]
 [-3.05253904e-03  3.44665281e-04  2.01494808e-03 -5.44828876e-04]
 [ 8.36956061e-04 -3.41267403e-05  1.83396567e-03  2.51269242e-04]
 [-9.65039197e-04 -3.42173767e-04 -8.62254884e-04  1.55110113e-05]
 [ 2.42955552e-04  2.43230916e-04 -1.50348920e-03 -2.07249242e-04]
 [ 1.85359638e-03 -4.31365125e-04 -9.36619122e-04 -9.42871044e-04]
 [ 2.36630969e-03  3.64600491e-04  7.83369845e-04  2.43640286e-04]
 [-8.68094471e-04 -2.99533510e-04  2.00453089e-03  6.99486420e-04]
 [-8.22061331e-04 -4.09847063e-05  3.22563300e-03  3.79522418e-05]
 [-5.32285020e-04 -2.75747407e-04 -8.45125635e-04  4.21401182e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.01553732721810683
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.7164208043962414e-06, theta_kick=-4.456128379838039e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.961345686316686e-06, theta_kick=8.346915407954836e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.010158009248995313
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.813615286057118e-06, theta_kick=-9.368818725841769e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.860167026247729e-06, theta_kick=5.827523134838863e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.7228802585426604e-06, theta_kick=-2.0657982556961522e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006622669399427151
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.7028699226676568e-06, theta_kick=2.0418051100660304e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01358342e-01 -6.31792618e+00  1.53890079e-02  6.24971105e-02]
 [ 1.79976984e-01  4.56138454e-01 -1.04894826e-03  2.04217509e-02]
 [ 1.92480162e-02  6.25080022e-02  3.83899335e-01 -5.11908491e+00]
 [ 4.26500166e-03  3.35839001e-02  2.12535629e-01 -2.30184718e-01]]
compute_tune_4x4()/ evals =  [0.09916325+0.99507118j 0.09916325-0.99507118j 0.05508412+0.99848172j
 0.05508412-0.99848172j]
compute_tune_4x4()/ angles =  [0.23419169831068049, 0.2412286509771467, 0.7587713490228533, 0.7658083016893196]
compute_tune_4x4()/  0.23419169831068049 0.2412286509771467
compute_tunes()/ 0.23419169831068049 0.2412286509771467

 Running simulation ..
Closed orbit computation: x_co=[ 1.59610849e-08 -3.86800470e-09], y_co=[ 3.45214752e-07 -1.87742003e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 22/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.67733162e-03 -1.21148516e-04 -2.16516199e-03 -5.65345312e-04]
 [-4.74857696e-03  7.67246736e-05 -9.69704274e-04 -5.42877370e-04]
 [-2.79208835e-03 -7.15201592e-05 -1.65865962e-03 -2.31077499e-04]
 [-3.23180845e-03  3.23766623e-04  1.23701037e-03 -3.00507112e-04]
 [-2.07315778e-04  2.98847973e-04 -1.12985411e-03 -5.48284571e-04]
 [ 1.53039331e-03 -6.40201373e-04 -1.79404774e-04 -6.28139772e-04]
 [ 1.98985945e-03  2.67358121e-05 -3.98990317e-03 -5.06670180e-04]
 [-3.16539267e-03 -3.52129344e-04 -2.73334135e-03  4.00313894e-04]
 [ 9.69665131e-04  3.69664879e-04 -2.46553288e-03 -2.52265022e-04]
 [-1.50365672e-03  2.50163004e-04  1.57570026e-03  6.17630845e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002165882731226098
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.199779552849999e-06, theta_kick=2.6376184535525964e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.3115970555492904e-05, theta_kick=-5.1697670992832065e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.019264552284009744
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.529145533608696e-05, theta_kick=-1.0226766415450918e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.814661961584501e-05, theta_kick=-4.573923223763376e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.898118432566676e-05, theta_kick=-4.6739906726337734e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007800471818649749
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.018127310507868e-07, theta_kick=8.414998711845589e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01683050e-01 -6.31984782e+00  1.37036513e-02 -3.28581204e-02]
 [ 1.79999422e-01  4.56663868e-01 -3.55342271e-03  2.30267862e-02]
 [ 7.53477582e-03 -3.28273370e-02  3.83689092e-01 -5.11756967e+00]
 [ 5.40224872e-04  2.40296616e-02  2.12603578e-01 -2.29905978e-01]]
compute_tune_4x4()/ evals =  [0.09417201+0.99555594j 0.09417201-0.99555594j 0.06020995+0.99818574j
 0.06020995-0.99818574j]
compute_tune_4x4()/ angles =  [0.23498981652729498, 0.24041148899636175, 0.7595885110036382, 0.765010183472705]
compute_tune_4x4()/  0.23498981652729498 0.24041148899636175
compute_tunes()/ 0.23498981652729498 0.24041148899636175

 Running simulation ..
Closed orbit computation: x_co=[ 6.76176546e-07 -1.73808473e-07], y_co=[8.52452373e-05 3.58483890e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.199779552849999e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.3115970555492904e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 8.529145533608696e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.814661961584501e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.898118432566676e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.018127310507868e-07, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.002165882731226098}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.019264552284009744}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.007800471818649749}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.67733162e-03 -1.21148516e-04 -2.16516199e-03 -5.65345312e-04]
 [-4.74857696e-03  7.67246736e-05 -9.69704274e-04 -5.42877370e-04]
 [-2.79208835e-03 -7.15201592e-05 -1.65865962e-03 -2.31077499e-04]
 [-3.23180845e-03  3.23766623e-04  1.23701037e-03 -3.00507112e-04]
 [-2.07315778e-04  2.98847973e-04 -1.12985411e-03 -5.48284571e-04]
 [ 1.53039331e-03 -6.40201373e-04 -1.79404774e-04 -6.28139772e-04]
 [ 1.98985945e-03  2.67358121e-05 -3.98990317e-03 -5.06670180e-04]
 [-3.16539267e-03 -3.52129344e-04 -2.73334135e-03  4.00313894e-04]
 [ 9.69665131e-04  3.69664879e-04 -2.46553288e-03 -2.52265022e-04]
 [-1.50365672e-03  2.50163004e-04  1.57570026e-03  6.17630845e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.002165882731226098
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.950785233516887e-06, theta_kick=-4.7371401486328034e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.647286710529361e-06, theta_kick=7.970346879091452e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.019264552284009744
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.692427766681223e-06, theta_kick=-5.626397451201765e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.3121030353926103e-06, theta_kick=2.7722985354443694e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.991000130508455e-07, theta_kick=-7.183434575974823e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.007800471818649749
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.672435775694528e-07, theta_kick=9.199539180846709e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01683050e-01 -6.31984782e+00  1.37036513e-02 -3.28581204e-02]
 [ 1.79999422e-01  4.56663868e-01 -3.55342271e-03  2.30267862e-02]
 [ 7.53477582e-03 -3.28273370e-02  3.83689092e-01 -5.11756967e+00]
 [ 5.40224872e-04  2.40296616e-02  2.12603578e-01 -2.29905978e-01]]
compute_tune_4x4()/ evals =  [0.09417201+0.99555594j 0.09417201-0.99555594j 0.06020995+0.99818574j
 0.06020995-0.99818574j]
compute_tune_4x4()/ angles =  [0.23498981652729498, 0.24041148899636175, 0.7595885110036382, 0.765010183472705]
compute_tune_4x4()/  0.23498981652729498 0.24041148899636175
compute_tunes()/ 0.23498981652729498 0.24041148899636175

 Running simulation ..
Closed orbit computation: x_co=[ 5.68457117e-09 -1.53408241e-10], y_co=[-4.11822061e-07 -1.22967236e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 23/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.93764871e-03  1.72476680e-04  3.58263295e-03 -2.59857622e-04]
 [-9.94668732e-04  8.28914566e-04 -3.27663564e-03 -7.48516390e-04]
 [-1.39620863e-03 -3.76726243e-04 -2.64739799e-04  2.13195533e-04]
 [ 4.41162246e-04  1.23638837e-03 -1.43306009e-04  8.53850997e-05]
 [ 4.98540076e-04  5.06735367e-04  1.29327576e-03  1.41517234e-03]
 [-6.65278773e-04 -6.53333635e-04  2.38783764e-03  2.77205884e-04]
 [-2.35865787e-03  2.01605073e-04  2.19021683e-04  1.21207469e-04]
 [ 1.96056452e-04  2.66080053e-04 -1.34225187e-03 -7.46504236e-05]
 [-4.82631095e-03 -3.88178321e-04 -2.59576982e-03  8.76253243e-04]
 [ 8.99391160e-04  3.58459707e-04 -7.16051826e-04  3.62224589e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-1.4574226389327621e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.365046666468957e-05, theta_kick=5.233855193889899e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.613601471406969e-05, theta_kick=7.929957009930954e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01416057685935862
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.537034045329043e-06, theta_kick=1.1435262664174129e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.502766830285113e-05, theta_kick=4.199949225858609e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00012129395546698055, theta_kick=-1.454360164542862e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.019468140093939816
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.5045388400607685e-05, theta_kick=-1.8039986795447332e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01261886e-01 -6.32120364e+00 -4.93616029e-03 -1.22242268e-01]
 [ 1.80020833e-01  4.56276153e-01 -3.57125867e-03  1.07712376e-02]
 [-1.72589684e-02 -1.22373622e-01  3.84059264e-01 -5.12193063e+00]
 [-4.44006535e-03 -3.10676524e-03  2.12628237e-01 -2.30634596e-01]]
compute_tune_4x4()/ evals =  [0.0807394 +0.99673525j 0.0807394 -0.99673525j 0.07348007+0.99729669j
 0.07348007-0.99729669j]
compute_tune_4x4()/ angles =  [0.2371359229149647, 0.23829473453323247, 0.7617052654667675, 0.7628640770850353]
compute_tune_4x4()/  0.2371359229149647 0.23829473453323247
compute_tunes()/ 0.2371359229149647 0.23829473453323247

 Running simulation ..
Closed orbit computation: x_co=[-6.79957443e-07 -1.96425864e-07], y_co=[-9.53739796e-06  1.86077827e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.365046666468957e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.613601471406969e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.537034045329043e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.502766830285113e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00012129395546698055, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.5045388400607685e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -1.4574226389327621e-05}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.01416057685935862}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.019468140093939816}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.93764871e-03  1.72476680e-04  3.58263295e-03 -2.59857622e-04]
 [-9.94668732e-04  8.28914566e-04 -3.27663564e-03 -7.48516390e-04]
 [-1.39620863e-03 -3.76726243e-04 -2.64739799e-04  2.13195533e-04]
 [ 4.41162246e-04  1.23638837e-03 -1.43306009e-04  8.53850997e-05]
 [ 4.98540076e-04  5.06735367e-04  1.29327576e-03  1.41517234e-03]
 [-6.65278773e-04 -6.53333635e-04  2.38783764e-03  2.77205884e-04]
 [-2.35865787e-03  2.01605073e-04  2.19021683e-04  1.21207469e-04]
 [ 1.96056452e-04  2.66080053e-04 -1.34225187e-03 -7.46504236e-05]
 [-4.82631095e-03 -3.88178321e-04 -2.59576982e-03  8.76253243e-04]
 [ 8.99391160e-04  3.58459707e-04 -7.16051826e-04  3.62224589e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-1.4574226389327621e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.770162119301992e-06, theta_kick=-6.918641491208959e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.186806728994499e-06, theta_kick=9.816289307757246e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.01416057685935862
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.052531979855425e-06, theta_kick=-1.0854326457624753e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.071666311561463e-06, theta_kick=1.0877269241295442e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.00014974669597e-06, theta_kick=-7.194405310050355e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.019468140093939816
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.839117661414725e-06, theta_kick=4.6032465280386484e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01261886e-01 -6.32120364e+00 -4.93616029e-03 -1.22242268e-01]
 [ 1.80020833e-01  4.56276153e-01 -3.57125867e-03  1.07712376e-02]
 [-1.72589684e-02 -1.22373622e-01  3.84059264e-01 -5.12193063e+00]
 [-4.44006535e-03 -3.10676524e-03  2.12628237e-01 -2.30634596e-01]]
compute_tune_4x4()/ evals =  [0.0807394 +0.99673525j 0.0807394 -0.99673525j 0.07348007+0.99729669j
 0.07348007-0.99729669j]
compute_tune_4x4()/ angles =  [0.2371359229149647, 0.23829473453323247, 0.7617052654667675, 0.7628640770850353]
compute_tune_4x4()/  0.2371359229149647 0.23829473453323247
compute_tunes()/ 0.2371359229149647 0.23829473453323247

 Running simulation ..
Closed orbit computation: x_co=[ 1.79986496e-08 -1.49059768e-09], y_co=[ 4.87854050e-07 -2.96861052e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 24/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.95524860e-03 -5.09505227e-04 -3.47819307e-04 -2.29425281e-04]
 [ 3.11933964e-03 -1.78934353e-04 -2.50941606e-03  1.41351558e-04]
 [-3.82552075e-03  5.77741133e-04  5.70942984e-04 -1.66376048e-04]
 [ 9.93682625e-04 -2.62194497e-04  2.15001384e-03  3.62286521e-04]
 [ 2.38968976e-03 -6.55825492e-04 -2.50610539e-03 -9.54376428e-04]
 [-1.73257115e-03  5.39870513e-05  4.52614203e-03  2.49052456e-04]
 [ 4.71672599e-03  5.94932938e-04  7.47179852e-04 -1.33402923e-04]
 [-1.29670665e-03 -5.11549204e-05  1.32876674e-03 -3.07106872e-04]
 [-6.90800677e-04  7.57614999e-07 -1.45917844e-03 -3.06299616e-04]
 [-2.93044968e-03  6.57922186e-04  2.47041817e-03  4.34345710e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009691027478054504
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.124354655966914e-05, theta_kick=1.0940444548707906e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.1628015307061843e-05, theta_kick=1.3942427872994126e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007761484175392028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.400584785889345e-06, theta_kick=-8.873579615308559e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3981316418041768e-05, theta_kick=1.6764124451201085e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.2772052668523193e-06, theta_kick=-3.9294924242433247e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011561973996346338
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.468159915545142e-06, theta_kick=8.954604738371649e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01451517e-01 -6.31816373e+00  1.49282079e-02  6.57397221e-02]
 [ 1.79993722e-01  4.56179331e-01 -6.30952680e-04  1.63895079e-02]
 [ 1.92256026e-02  6.57354655e-02  3.83876054e-01 -5.11907023e+00]
 [ 4.14021888e-03  2.90396021e-02  2.12534973e-01 -2.29937753e-01]]
compute_tune_4x4()/ evals =  [0.09695348+0.99528891j 0.09695348-0.99528891j 0.05737957+0.99835244j
 0.05737957-0.99835244j]
compute_tune_4x4()/ angles =  [0.23454509619778702, 0.24086273879773606, 0.759137261202264, 0.7654549038022129]
compute_tune_4x4()/  0.23454509619778702 0.24086273879773606
compute_tunes()/ 0.23454509619778702 0.24086273879773606

 Running simulation ..
Closed orbit computation: x_co=[1.80286710e-07 1.21013248e-07], y_co=[-7.30366501e-06  8.37724932e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.124354655966914e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -1.1628015307061843e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.400584785889345e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.3981316418041768e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.2772052668523193e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -7.468159915545142e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009691027478054504}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007761484175392028}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.011561973996346338}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.95524860e-03 -5.09505227e-04 -3.47819307e-04 -2.29425281e-04]
 [ 3.11933964e-03 -1.78934353e-04 -2.50941606e-03  1.41351558e-04]
 [-3.82552075e-03  5.77741133e-04  5.70942984e-04 -1.66376048e-04]
 [ 9.93682625e-04 -2.62194497e-04  2.15001384e-03  3.62286521e-04]
 [ 2.38968976e-03 -6.55825492e-04 -2.50610539e-03 -9.54376428e-04]
 [-1.73257115e-03  5.39870513e-05  4.52614203e-03  2.49052456e-04]
 [ 4.71672599e-03  5.94932938e-04  7.47179852e-04 -1.33402923e-04]
 [-1.29670665e-03 -5.11549204e-05  1.32876674e-03 -3.07106872e-04]
 [-6.90800677e-04  7.57614999e-07 -1.45917844e-03 -3.06299616e-04]
 [-2.93044968e-03  6.57922186e-04  2.47041817e-03  4.34345710e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009691027478054504
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.4992514496744302e-06, theta_kick=1.7976588995262883e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.438611300387391e-07, theta_kick=-8.919174836990835e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007761484175392028
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.186711531726414e-07, theta_kick=2.621949404523422e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7404472844169345e-06, theta_kick=-2.0868617807025514e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.490997149164401e-06, theta_kick=1.7877616826355254e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.011561973996346338
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1136138116557831e-06, theta_kick=-1.3352648614034236e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01451517e-01 -6.31816373e+00  1.49282079e-02  6.57397221e-02]
 [ 1.79993722e-01  4.56179331e-01 -6.30952680e-04  1.63895079e-02]
 [ 1.92256026e-02  6.57354655e-02  3.83876054e-01 -5.11907023e+00]
 [ 4.14021888e-03  2.90396021e-02  2.12534973e-01 -2.29937753e-01]]
compute_tune_4x4()/ evals =  [0.09695348+0.99528891j 0.09695348-0.99528891j 0.05737957+0.99835244j
 0.05737957-0.99835244j]
compute_tune_4x4()/ angles =  [0.23454509619778702, 0.24086273879773606, 0.759137261202264, 0.7654549038022129]
compute_tune_4x4()/  0.23454509619778702 0.24086273879773606
compute_tunes()/ 0.23454509619778702 0.24086273879773606

 Running simulation ..
Closed orbit computation: x_co=[1.04432193e-09 8.53941057e-10], y_co=[1.61046623e-07 1.36045708e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 25/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.20431705e-03 -7.31160182e-04  1.04978729e-03 -2.10587216e-04]
 [ 7.22351751e-03 -5.61414351e-04 -1.39430918e-03  6.31582239e-04]
 [ 1.49488582e-03  3.86792879e-05 -1.41713973e-03  4.46085491e-04]
 [-2.12071373e-03  2.96186183e-04  2.27092160e-03  1.76536548e-04]
 [ 4.45330975e-03 -2.41988925e-04 -5.22191015e-03  5.33663985e-04]
 [ 3.63017292e-03 -3.98009563e-04 -1.76749554e-03 -3.47483131e-04]
 [-1.70795772e-03  8.12511886e-04  1.75826037e-03  6.84090402e-04]
 [-2.15977983e-03  2.31907892e-04  5.57656333e-04 -8.66558191e-04]
 [-3.72061668e-04 -3.03173036e-04 -2.97604120e-03 -6.10766350e-04]
 [ 1.39887659e-03 -1.30832401e-04 -4.14993005e-03 -1.00209613e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004078087908277962
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.762273955086351e-05, theta_kick=-3.312070406447809e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6477566074968846e-05, theta_kick=-1.9757221714631356e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005893137423639637
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.884379486850786e-05, theta_kick=2.259441907064823e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.8862563626042617e-05, theta_kick=-2.2616923517132333e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.197269481300436e-05, theta_kick=-3.833646409674405e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01727068653591654
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.413126134274486e-05, theta_kick=-7.689579537552988e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01386640e-01 -6.31964030e+00 -9.35856191e-03 -1.06031350e-01]
 [ 1.80027740e-01  4.56202940e-01 -2.03712499e-03  1.16221684e-04]
 [-1.90844289e-02 -1.06061328e-01  3.83995027e-01 -5.12105897e+00]
 [-4.57827289e-03 -1.40685858e-02  2.12571047e-01 -2.30137822e-01]]
compute_tune_4x4()/ evals =  [0.08771025+0.99614603j 0.08771025-0.99614603j 0.0666265 +0.99777799j
 0.0666265 -0.99777799j]
compute_tune_4x4()/ angles =  [0.2360225185950683, 0.23938820248590015, 0.7606117975140998, 0.7639774814049317]
compute_tune_4x4()/  0.2360225185950683 0.23938820248590015
compute_tunes()/ 0.2360225185950683 0.23938820248590015

 Running simulation ..
Closed orbit computation: x_co=[-2.77848139e-07  3.03381180e-08], y_co=[6.33875864e-08 5.02400985e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.762273955086351e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.6477566074968846e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.884379486850786e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.8862563626042617e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.197269481300436e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.413126134274486e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004078087908277962}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005893137423639637}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01727068653591654}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.20431705e-03 -7.31160182e-04  1.04978729e-03 -2.10587216e-04]
 [ 7.22351751e-03 -5.61414351e-04 -1.39430918e-03  6.31582239e-04]
 [ 1.49488582e-03  3.86792879e-05 -1.41713973e-03  4.46085491e-04]
 [-2.12071373e-03  2.96186183e-04  2.27092160e-03  1.76536548e-04]
 [ 4.45330975e-03 -2.41988925e-04 -5.22191015e-03  5.33663985e-04]
 [ 3.63017292e-03 -3.98009563e-04 -1.76749554e-03 -3.47483131e-04]
 [-1.70795772e-03  8.12511886e-04  1.75826037e-03  6.84090402e-04]
 [-2.15977983e-03  2.31907892e-04  5.57656333e-04 -8.66558191e-04]
 [-3.72061668e-04 -3.03173036e-04 -2.97604120e-03 -6.10766350e-04]
 [ 1.39887659e-03 -1.30832401e-04 -4.14993005e-03 -1.00209613e-03]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004078087908277962
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.5141134346799225e-06, theta_kick=-1.815478978750191e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.3891578851802555e-06, theta_kick=4.0637278259874333e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005893137423639637
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.844486908224906e-06, theta_kick=-3.4106468306346617e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.147013186460311e-06, theta_kick=2.574349594845349e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.5362727192329593e-06, theta_kick=-1.8420487947023798e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01727068653591654
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.3866425558965877e-07, theta_kick=5.259749477888222e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01386640e-01 -6.31964030e+00 -9.35856191e-03 -1.06031350e-01]
 [ 1.80027740e-01  4.56202940e-01 -2.03712499e-03  1.16221684e-04]
 [-1.90844289e-02 -1.06061328e-01  3.83995027e-01 -5.12105897e+00]
 [-4.57827289e-03 -1.40685858e-02  2.12571047e-01 -2.30137822e-01]]
compute_tune_4x4()/ evals =  [0.08771025+0.99614603j 0.08771025-0.99614603j 0.0666265 +0.99777799j
 0.0666265 -0.99777799j]
compute_tune_4x4()/ angles =  [0.2360225185950683, 0.23938820248590015, 0.7606117975140998, 0.7639774814049317]
compute_tune_4x4()/  0.2360225185950683 0.23938820248590015
compute_tunes()/ 0.2360225185950683 0.23938820248590015

 Running simulation ..
Closed orbit computation: x_co=[ 2.15488629e-11 -1.38284181e-09], y_co=[-7.87246067e-08  4.33929850e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 26/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.19880340e-03 -5.80721434e-04 -4.60911323e-04  2.97881894e-04]
 [ 6.17137239e-03  4.33090806e-04  2.28941257e-03 -3.17997276e-04]
 [-1.65078090e-03  7.08355819e-05 -2.94112134e-03 -3.22373039e-05]
 [ 8.07018083e-04  6.20683075e-04  1.54804368e-03  1.55545979e-05]
 [ 4.57163347e-03  1.65873642e-04  1.38462930e-03 -5.42056982e-04]
 [ 3.48779676e-03 -1.63104945e-04  4.52416516e-04  1.20775834e-05]
 [-1.15421530e-03  2.92219608e-04  1.57444313e-05  5.45636056e-04]
 [ 7.77769134e-05  3.59048307e-04  1.95929751e-03  3.22844804e-04]
 [ 1.48109337e-04  4.90836558e-04  2.08488031e-03 -4.53687776e-04]
 [ 8.33518707e-04  3.20808454e-04 -2.00570371e-03 -2.26341614e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005007045787013631
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.4923628334762824e-05, theta_kick=-5.386512068574926e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.5425597041702777e-05, theta_kick=3.0486247525531264e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014940466742781922
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.683153069606264e-06, theta_kick=1.0411427245854159e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.265791055073387e-05, theta_kick=3.915806354845205e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.237896560886847e-06, theta_kick=7.479472685811147e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004409284643695837
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.109914874418112e-05, theta_kick=-8.525055454605398e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01682501e-01 -6.32127674e+00 -2.81678251e-03  8.28370523e-02]
 [ 1.80016734e-01  4.56433438e-01  3.32704415e-03 -1.34869082e-02]
 [ 6.70484701e-03  8.28450426e-02  3.84011644e-01 -5.11935118e+00]
 [ 2.41932487e-03 -5.54580463e-03  2.12636013e-01 -2.29995139e-01]]
compute_tune_4x4()/ evals =  [0.08096206+0.99671718j 0.08096206-0.99671718j 0.07342166+0.99730099j
 0.07342166-0.99730099j]
compute_tune_4x4()/ angles =  [0.23710036886923003, 0.23830405569076343, 0.7616959443092366, 0.76289963113077]
compute_tune_4x4()/  0.23710036886923003 0.23830405569076343
compute_tunes()/ 0.23710036886923003 0.23830405569076343

 Running simulation ..
Closed orbit computation: x_co=[ 8.52766702e-07 -1.00261482e-07], y_co=[-4.60807132e-05 -3.43781988e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.4923628334762824e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.5425597041702777e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.683153069606264e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.265791055073387e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.237896560886847e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.109914874418112e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005007045787013631}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.014940466742781922}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004409284643695837}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.19880340e-03 -5.80721434e-04 -4.60911323e-04  2.97881894e-04]
 [ 6.17137239e-03  4.33090806e-04  2.28941257e-03 -3.17997276e-04]
 [-1.65078090e-03  7.08355819e-05 -2.94112134e-03 -3.22373039e-05]
 [ 8.07018083e-04  6.20683075e-04  1.54804368e-03  1.55545979e-05]
 [ 4.57163347e-03  1.65873642e-04  1.38462930e-03 -5.42056982e-04]
 [ 3.48779676e-03 -1.63104945e-04  4.52416516e-04  1.20775834e-05]
 [-1.15421530e-03  2.92219608e-04  1.57444313e-05  5.45636056e-04]
 [ 7.77769134e-05  3.59048307e-04  1.95929751e-03  3.22844804e-04]
 [ 1.48109337e-04  4.90836558e-04  2.08488031e-03 -4.53687776e-04]
 [ 8.33518707e-04  3.20808454e-04 -2.00570371e-03 -2.26341614e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005007045787013631
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.73175956018612e-06, theta_kick=6.872595377880722e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.3686973423725515e-06, theta_kick=-8.835345370723668e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014940466742781922
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.800849002605859e-06, theta_kick=1.055254909798958e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.230387598952438e-06, theta_kick=-7.470469157916927e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6492330576356922e-06, theta_kick=3.17653011708758e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004409284643695837
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.549113921284998e-06, theta_kick=-1.8574458791303956e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01682501e-01 -6.32127674e+00 -2.81678251e-03  8.28370523e-02]
 [ 1.80016734e-01  4.56433438e-01  3.32704415e-03 -1.34869082e-02]
 [ 6.70484701e-03  8.28450426e-02  3.84011644e-01 -5.11935118e+00]
 [ 2.41932487e-03 -5.54580463e-03  2.12636013e-01 -2.29995139e-01]]
compute_tune_4x4()/ evals =  [0.08096206+0.99671718j 0.08096206-0.99671718j 0.07342166+0.99730099j
 0.07342166-0.99730099j]
compute_tune_4x4()/ angles =  [0.23710036886923003, 0.23830405569076343, 0.7616959443092366, 0.76289963113077]
compute_tune_4x4()/  0.23710036886923003 0.23830405569076343
compute_tunes()/ 0.23710036886923003 0.23830405569076343

 Running simulation ..
Closed orbit computation: x_co=[1.52663823e-08 2.34231103e-10], y_co=[-3.60048920e-07  3.36774247e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 27/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.67929675e-03  5.76402971e-04  1.98284040e-03  3.57168999e-04]
 [-2.49637546e-04  3.21471799e-04  1.29737636e-03 -1.32933527e-04]
 [ 5.07829908e-04 -5.62195324e-04 -5.00662043e-03 -4.24324174e-04]
 [ 5.79181266e-04 -1.47823954e-04  1.93257790e-03  2.18701506e-04]
 [ 4.51031106e-03 -6.83804804e-04 -2.03611981e-03 -7.33920923e-04]
 [-6.78958037e-04  2.37075351e-04 -1.29778753e-03 -5.26412191e-04]
 [-3.65333406e-03  4.20048609e-05  1.66573766e-03  4.62046893e-04]
 [ 4.30863634e-03 -4.91639488e-04  6.17707464e-04  2.18635570e-04]
 [-6.76434455e-03 -2.96981879e-06 -1.05168212e-03  1.91898707e-04]
 [ 9.21907720e-04  1.13421611e-03  4.45865568e-04 -2.98893368e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0004803642890296731
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.956662520172718e-06, theta_kick=-7.142262489183171e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.439869497598941e-05, theta_kick=-7.72164583643428e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009892255369386135
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.851169857741083e-05, theta_kick=4.617697564914164e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.3858619103188204e-06, theta_kick=4.059775828113054e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.059931471892811e-05, theta_kick=-7.2660858479297565e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012412211394009965
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.2513381364846024e-05, theta_kick=1.500401508937458e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588029e-01 -6.31874517e+00 -1.25019419e-02 -2.07360891e-02]
 [ 1.80005240e-01  4.56309887e-01  1.45495778e-03 -1.44128860e-02]
 [-1.23768514e-02 -2.07321876e-02  3.83812550e-01 -5.11879032e+00]
 [-2.13396917e-03 -2.05707444e-02  2.12546896e-01 -2.29782363e-01]]
compute_tune_4x4()/ evals =  [0.09207208+0.99575234j 0.09207208-0.99575234j 0.06230394+0.99805722j
 0.06230394-0.99805722j]
compute_tune_4x4()/ angles =  [0.23532548978232087, 0.2400775932826981, 0.7599224067173019, 0.7646745102176791]
compute_tune_4x4()/  0.23532548978232087 0.2400775932826981
compute_tunes()/ 0.23532548978232087 0.2400775932826981

 Running simulation ..
Closed orbit computation: x_co=[1.53357415e-07 1.29148121e-08], y_co=[2.24411094e-05 4.25506226e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.956662520172718e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.439869497598941e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.851169857741083e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.3858619103188204e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.059931471892811e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.2513381364846024e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0004803642890296731}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.009892255369386135}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012412211394009965}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.67929675e-03  5.76402971e-04  1.98284040e-03  3.57168999e-04]
 [-2.49637546e-04  3.21471799e-04  1.29737636e-03 -1.32933527e-04]
 [ 5.07829908e-04 -5.62195324e-04 -5.00662043e-03 -4.24324174e-04]
 [ 5.79181266e-04 -1.47823954e-04  1.93257790e-03  2.18701506e-04]
 [ 4.51031106e-03 -6.83804804e-04 -2.03611981e-03 -7.33920923e-04]
 [-6.78958037e-04  2.37075351e-04 -1.29778753e-03 -5.26412191e-04]
 [-3.65333406e-03  4.20048609e-05  1.66573766e-03  4.62046893e-04]
 [ 4.30863634e-03 -4.91639488e-04  6.17707464e-04  2.18635570e-04]
 [-6.76434455e-03 -2.96981879e-06 -1.05168212e-03  1.91898707e-04]
 [ 9.21907720e-04  1.13421611e-03  4.45865568e-04 -2.98893368e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0004803642890296731
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=8.202034256713848e-07, theta_kick=-9.834547686449104e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.0750871340385575e-06, theta_kick=3.6871451780310926e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.009892255369386135
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.620191695776482e-06, theta_kick=-1.9426708051432307e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.179369490118887e-07, theta_kick=-2.6131460203817358e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=9.970169114127447e-08, theta_kick=-1.1954607908957096e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012412211394009965
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.147615533530521e-07, theta_kick=6.172184710710389e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588029e-01 -6.31874517e+00 -1.25019419e-02 -2.07360891e-02]
 [ 1.80005240e-01  4.56309887e-01  1.45495778e-03 -1.44128860e-02]
 [-1.23768514e-02 -2.07321876e-02  3.83812550e-01 -5.11879032e+00]
 [-2.13396917e-03 -2.05707444e-02  2.12546896e-01 -2.29782363e-01]]
compute_tune_4x4()/ evals =  [0.09207208+0.99575234j 0.09207208-0.99575234j 0.06230394+0.99805722j
 0.06230394-0.99805722j]
compute_tune_4x4()/ angles =  [0.23532548978232087, 0.2400775932826981, 0.7599224067173019, 0.7646745102176791]
compute_tune_4x4()/  0.23532548978232087 0.2400775932826981
compute_tunes()/ 0.23532548978232087 0.2400775932826981

 Running simulation ..
Closed orbit computation: x_co=[-4.36088407e-09 -4.92338891e-10], y_co=[1.11146407e-07 8.57011106e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 28/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.17088251e-03  4.20767695e-04  1.51211765e-03  8.15005930e-04]
 [-2.43064270e-03  4.03771223e-04 -4.32404612e-03 -1.27501323e-04]
 [ 2.52706750e-03  5.04707620e-04  1.52460861e-03  1.28087658e-04]
 [-1.26809122e-03  9.01116615e-05  5.63528767e-04  4.87235396e-04]
 [-1.12307464e-03 -4.63799827e-04  2.32493681e-05  3.32617614e-04]
 [ 2.59522542e-03 -1.02947315e-04 -6.80858130e-04  1.51836429e-04]
 [-1.26293965e-03 -3.41923317e-04  9.63061097e-04 -3.97499888e-04]
 [-2.21529884e-03  4.80044310e-04 -2.63153051e-03  7.00971036e-04]
 [ 6.31438479e-04 -3.31410262e-05 -5.38740393e-04  3.07080696e-04]
 [ 2.38573261e-03 -1.38590071e-04 -1.76697270e-04 -2.96336767e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007499515199542256
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.218967444706696e-06, theta_kick=-7.456775963277509e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.43047369942889e-05, theta_kick=1.1307492799962489e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005621783067337552
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.415447348777348e-05, theta_kick=-4.095249882017027e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.6275579051484815e-05, theta_kick=-4.349578420053019e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.7868892356954215e-06, theta_kick=5.739660306790516e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.024190644428619065
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.9101391067075185e-05, theta_kick=-3.4893662868682133e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01073088e-01 -6.31604610e+00 -2.08084113e-02 -1.15404295e-01]
 [ 1.80028943e-01  4.56329808e-01 -2.08316361e-04 -1.64144668e-02]
 [-2.93776354e-02 -1.15363187e-01  3.83570950e-01 -5.12062220e+00]
 [-6.34290613e-03 -3.57161572e-02  2.12467383e-01 -2.30160065e-01]]
compute_tune_4x4()/ evals =  [0.10261038+0.99472162j 0.10261038-0.99472162j 0.05172342+0.99866145j
 0.05172342-0.99866145j]
compute_tune_4x4()/ angles =  [0.23364025612904277, 0.2417642869311306, 0.7582357130688694, 0.7663597438709573]
compute_tune_4x4()/  0.23364025612904277 0.2417642869311306
compute_tunes()/ 0.23364025612904277 0.2417642869311306

 Running simulation ..
Closed orbit computation: x_co=[ 1.96911763e-08 -1.60833886e-07], y_co=[-4.31617631e-06  8.53114055e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.218967444706696e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -9.43047369942889e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.415447348777348e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.6275579051484815e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.7868892356954215e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.9101391067075185e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.007499515199542256}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.005621783067337552}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.024190644428619065}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.17088251e-03  4.20767695e-04  1.51211765e-03  8.15005930e-04]
 [-2.43064270e-03  4.03771223e-04 -4.32404612e-03 -1.27501323e-04]
 [ 2.52706750e-03  5.04707620e-04  1.52460861e-03  1.28087658e-04]
 [-1.26809122e-03  9.01116615e-05  5.63528767e-04  4.87235396e-04]
 [-1.12307464e-03 -4.63799827e-04  2.32493681e-05  3.32617614e-04]
 [ 2.59522542e-03 -1.02947315e-04 -6.80858130e-04  1.51836429e-04]
 [-1.26293965e-03 -3.41923317e-04  9.63061097e-04 -3.97499888e-04]
 [-2.21529884e-03  4.80044310e-04 -2.63153051e-03  7.00971036e-04]
 [ 6.31438479e-04 -3.31410262e-05 -5.38740393e-04  3.07080696e-04]
 [ 2.38573261e-03 -1.38590071e-04 -1.76697270e-04 -2.96336767e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.007499515199542256
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.015819451664451e-07, theta_kick=-4.815118623192284e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.24278085081656e-06, theta_kick=5.087253880505743e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005621783067337552
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.958448907264081e-06, theta_kick=-1.0741517313584683e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.532114432987296e-06, theta_kick=1.0230326237514718e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.898977408153873e-06, theta_kick=-5.87405824303752e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.024190644428619065
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.9994500935880029e-07, theta_kick=-2.397415894230197e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01073088e-01 -6.31604610e+00 -2.08084113e-02 -1.15404295e-01]
 [ 1.80028943e-01  4.56329808e-01 -2.08316361e-04 -1.64144668e-02]
 [-2.93776354e-02 -1.15363187e-01  3.83570950e-01 -5.12062220e+00]
 [-6.34290613e-03 -3.57161572e-02  2.12467383e-01 -2.30160065e-01]]
compute_tune_4x4()/ evals =  [0.10261038+0.99472162j 0.10261038-0.99472162j 0.05172342+0.99866145j
 0.05172342-0.99866145j]
compute_tune_4x4()/ angles =  [0.23364025612904277, 0.2417642869311306, 0.7582357130688694, 0.7663597438709573]
compute_tune_4x4()/  0.23364025612904277 0.2417642869311306
compute_tunes()/ 0.23364025612904277 0.2417642869311306

 Running simulation ..
Closed orbit computation: x_co=[-4.99477103e-09 -2.32789503e-09], y_co=[3.75490130e-07 1.95555795e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 29/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.52517664e-03  5.32269479e-04  3.56564222e-03  3.74400573e-04]
 [ 8.05199603e-04 -1.17136644e-03 -1.11814571e-03 -6.41065645e-04]
 [ 9.97952065e-05  2.07659834e-04  2.05863439e-03  1.82596537e-04]
 [ 1.80598386e-03 -2.37256201e-04 -5.90498170e-03 -1.02453403e-03]
 [ 3.27483927e-03 -7.79312952e-05 -1.68959531e-03  4.96713678e-04]
 [ 9.81864324e-04  2.36959311e-05  3.47994472e-04  3.03332022e-05]
 [-7.58873144e-04  1.62148417e-04  9.53923606e-05 -2.77433828e-04]
 [ 1.03252911e-03  4.54101122e-07  5.39477143e-04 -8.23953544e-04]
 [ 6.30949193e-04 -4.95936495e-04  1.47638528e-03  1.21734881e-03]
 [-1.10215834e-03  1.55715433e-04  2.57463494e-03  3.56849556e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0025656009664200225
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2045217922453462e-05, theta_kick=1.4442669506662215e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.236548871212362e-05, theta_kick=3.8807438761190576e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017975961192170504
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.257931013274763e-05, theta_kick=-8.702532374402245e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-5.1939797461010996e-05, theta_kick=6.227777146098814e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.4304683225594214e-05, theta_kick=1.7151853420570628e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009113626345856099
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.220974917753475e-05, theta_kick=-8.658220625349067e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01599159e-01 -6.31912971e+00  1.57427140e-02 -3.94262176e-03]
 [ 1.79979304e-01  4.56498513e-01 -3.04245502e-03  2.40745534e-02]
 [ 1.23220880e-02 -3.92715620e-03  3.83712572e-01 -5.11742339e+00]
 [ 1.83386876e-03  2.91997323e-02  2.12580800e-01 -2.29945458e-01]]
compute_tune_4x4()/ evals =  [0.09739036+0.99524626j 0.09739036-0.99524626j 0.05694287+0.99837744j
 0.05694287-0.99837744j]
compute_tune_4x4()/ angles =  [0.23447523471124057, 0.2409323553902628, 0.7590676446097372, 0.7655247652887595]
compute_tune_4x4()/  0.23447523471124057 0.2409323553902628
compute_tunes()/ 0.23447523471124057 0.2409323553902628

 Running simulation ..
Closed orbit computation: x_co=[-2.68472839e-07  4.35351865e-08], y_co=[-2.33741652e-05  3.68992852e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.2045217922453462e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.236548871212362e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.257931013274763e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -5.1939797461010996e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.4304683225594214e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.220974917753475e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0025656009664200225}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.017975961192170504}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.009113626345856099}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.52517664e-03  5.32269479e-04  3.56564222e-03  3.74400573e-04]
 [ 8.05199603e-04 -1.17136644e-03 -1.11814571e-03 -6.41065645e-04]
 [ 9.97952065e-05  2.07659834e-04  2.05863439e-03  1.82596537e-04]
 [ 1.80598386e-03 -2.37256201e-04 -5.90498170e-03 -1.02453403e-03]
 [ 3.27483927e-03 -7.79312952e-05 -1.68959531e-03  4.96713678e-04]
 [ 9.81864324e-04  2.36959311e-05  3.47994472e-04  3.03332022e-05]
 [-7.58873144e-04  1.62148417e-04  9.53923606e-05 -2.77433828e-04]
 [ 1.03252911e-03  4.54101122e-07  5.39477143e-04 -8.23953544e-04]
 [ 6.30949193e-04 -4.95936495e-04  1.47638528e-03  1.21734881e-03]
 [-1.10215834e-03  1.55715433e-04  2.57463494e-03  3.56849556e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0025656009664200225
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.3101558006905674e-06, theta_kick=2.769963727769276e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3026085021840174e-06, theta_kick=-2.7609142328825935e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017975961192170504
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.37431553768692e-08, theta_kick=1.0041119424652381e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6975470746620415e-06, theta_kick=-2.035422815027931e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.3112769762675602e-06, theta_kick=3.9703456858264183e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.009113626345856099
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.5881629259964994e-06, theta_kick=-4.302342357760338e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01599159e-01 -6.31912971e+00  1.57427140e-02 -3.94262176e-03]
 [ 1.79979304e-01  4.56498513e-01 -3.04245502e-03  2.40745534e-02]
 [ 1.23220880e-02 -3.92715620e-03  3.83712572e-01 -5.11742339e+00]
 [ 1.83386876e-03  2.91997323e-02  2.12580800e-01 -2.29945458e-01]]
compute_tune_4x4()/ evals =  [0.09739036+0.99524626j 0.09739036-0.99524626j 0.05694287+0.99837744j
 0.05694287-0.99837744j]
compute_tune_4x4()/ angles =  [0.23447523471124057, 0.2409323553902628, 0.7590676446097372, 0.7655247652887595]
compute_tune_4x4()/  0.23447523471124057 0.2409323553902628
compute_tunes()/ 0.23447523471124057 0.2409323553902628

 Running simulation ..
Closed orbit computation: x_co=[-7.21884970e-09  1.77381726e-10], y_co=[-5.31002153e-07  1.19574981e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 30/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.61992346e-03 -1.24037290e-05  2.30858337e-03  1.45531156e-04]
 [ 1.17766876e-03  4.60723140e-04 -2.06506728e-04  2.50907917e-04]
 [-9.28422178e-04 -1.03823478e-04 -2.59126878e-03 -5.16338407e-04]
 [ 2.24569631e-03 -4.98274155e-04  3.88654450e-04  9.16322860e-04]
 [ 4.60253701e-04 -3.19710722e-05  6.70510836e-03  1.60034423e-03]
 [ 2.69038618e-04 -8.08205042e-04  1.80208075e-03 -3.04817263e-04]
 [ 4.57961068e-03 -5.15776936e-05 -1.10187570e-03 -8.58855862e-04]
 [ 2.70264786e-03 -4.76609414e-04 -7.47110038e-04 -2.35048826e-04]
 [ 4.58812633e-03 -2.95993078e-04 -4.90939158e-03 -5.89984021e-04]
 [-1.19676629e-03 -5.77497371e-05  1.47638760e-05 -6.72970586e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02394629932185951
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.382323832939258e-06, theta_kick=8.851684045628315e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.138612663611175e-05, theta_kick=-7.360427557286494e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014269518795455767
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.384721365783178e-05, theta_kick=5.257445898654863e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.742900251979003e-05, theta_kick=5.686915860169431e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.3722585841202326e-05, theta_kick=-2.8444273018027946e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006423016517405745
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.84523071276538e-05, theta_kick=8.207689185683653e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01392376e-01 -6.31990408e+00  6.27707999e-03  1.68074313e-01]
 [ 1.80139191e-01  4.57050169e-01  4.09666196e-03 -3.57318725e-03]
 [ 2.33063013e-02  1.68018087e-01  3.83752944e-01 -5.12263758e+00]
 [ 6.74812802e-03  1.81425071e-02  2.12606227e-01 -2.30340062e-01]]
compute_tune_4x4()/ evals =  [0.08825952+0.99609751j 0.08825952-0.99609751j 0.06627581+0.99780134j
 0.06627581-0.99780134j]
compute_tune_4x4()/ angles =  [0.23593475931438906, 0.23944413920347507, 0.7605558607965249, 0.764065240685611]
compute_tune_4x4()/  0.23593475931438906 0.23944413920347507
compute_tunes()/ 0.23593475931438906 0.23944413920347507

 Running simulation ..
Closed orbit computation: x_co=[-1.95525431e-07 -1.19836207e-07], y_co=[-2.19387768e-07 -8.09332558e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -7.382323832939258e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.138612663611175e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.384721365783178e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.742900251979003e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.3722585841202326e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.84523071276538e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.02394629932185951}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.014269518795455767}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006423016517405745}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.61992346e-03 -1.24037290e-05  2.30858337e-03  1.45531156e-04]
 [ 1.17766876e-03  4.60723140e-04 -2.06506728e-04  2.50907917e-04]
 [-9.28422178e-04 -1.03823478e-04 -2.59126878e-03 -5.16338407e-04]
 [ 2.24569631e-03 -4.98274155e-04  3.88654450e-04  9.16322860e-04]
 [ 4.60253701e-04 -3.19710722e-05  6.70510836e-03  1.60034423e-03]
 [ 2.69038618e-04 -8.08205042e-04  1.80208075e-03 -3.04817263e-04]
 [ 4.57961068e-03 -5.15776936e-05 -1.10187570e-03 -8.58855862e-04]
 [ 2.70264786e-03 -4.76609414e-04 -7.47110038e-04 -2.35048826e-04]
 [ 4.58812633e-03 -2.95993078e-04 -4.90939158e-03 -5.89984021e-04]
 [-1.19676629e-03 -5.77497371e-05  1.47638760e-05 -6.72970586e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.02394629932185951
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.311159025655249e-06, theta_kick=-6.36827951131336e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.0180789085520789e-05, theta_kick=1.2207149179519437e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014269518795455767
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0828311803957442e-05, theta_kick=-1.2983553282844384e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.7724793228320245e-06, theta_kick=8.120457531783966e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.102689309631623e-06, theta_kick=-3.720241225136424e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006423016517405745
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.3270506633028268e-06, theta_kick=1.591183677378889e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01392376e-01 -6.31990408e+00  6.27707999e-03  1.68074313e-01]
 [ 1.80139191e-01  4.57050169e-01  4.09666196e-03 -3.57318725e-03]
 [ 2.33063013e-02  1.68018087e-01  3.83752944e-01 -5.12263758e+00]
 [ 6.74812802e-03  1.81425071e-02  2.12606227e-01 -2.30340062e-01]]
compute_tune_4x4()/ evals =  [0.08825952+0.99609751j 0.08825952-0.99609751j 0.06627581+0.99780134j
 0.06627581-0.99780134j]
compute_tune_4x4()/ angles =  [0.23593475931438906, 0.23944413920347507, 0.7605558607965249, 0.764065240685611]
compute_tune_4x4()/  0.23593475931438906 0.23944413920347507
compute_tunes()/ 0.23593475931438906 0.23944413920347507

 Running simulation ..
Closed orbit computation: x_co=[-1.79939746e-08  4.41909639e-10], y_co=[ 2.63033602e-07 -1.06466684e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 31/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-5.09596268e-03  4.84312853e-04  3.15088466e-03  5.35655280e-04]
 [ 3.31925874e-03 -1.10766217e-03 -1.06028076e-03 -7.86433317e-05]
 [-4.04998174e-03 -3.31788716e-04  1.19623458e-03  4.02927644e-04]
 [ 3.56851794e-03 -2.21439955e-04 -3.62020509e-03 -3.44924211e-04]
 [-3.78777884e-03  4.63722646e-04 -8.73598188e-04 -3.18287274e-05]
 [-3.51443004e-03  5.55600459e-04  2.73803269e-03  1.40481675e-04]
 [-1.66385468e-03 -4.47363050e-05 -1.91681591e-03  3.02714197e-04]
 [-2.21916660e-03 -8.66482426e-04  4.41118971e-03  5.23067920e-04]
 [-3.25876133e-04  1.22783281e-04 -2.56440852e-03  4.54014410e-04]
 [ 7.74925090e-05  7.15852548e-04  6.21354318e-04  6.44910048e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005545013121743429
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.2744276259347967e-05, theta_kick=-1.5280866755615582e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.767031726138839e-05, theta_kick=5.715850405666478e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004200002693868581
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.3406015875623526e-05, theta_kick=-5.204544624501674e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00011544497984465595, theta_kick=1.3842287460748829e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.967444381174758e-05, theta_kick=9.553265598915897e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012871257042406449
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.517513104966692e-05, theta_kick=-4.217630564050383e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01569726e-01 -6.31901275e+00 -7.90732597e-03 -1.82083114e-02]
 [ 1.80016658e-01  4.56222797e-01  5.39267510e-04 -5.76803294e-03]
 [-8.38168334e-03 -1.82057521e-02  3.83898246e-01 -5.11974865e+00]
 [-1.35624734e-03 -9.55898319e-03  2.12544967e-01 -2.29832355e-01]]
compute_tune_4x4()/ evals =  [0.08504158+0.9963774j  0.08504158-0.9963774j  0.0693179 +0.99759462j
 0.0693179 -0.99759462j]
compute_tune_4x4()/ angles =  [0.2364488440315341, 0.23895885999364197, 0.761041140006358, 0.7635511559684659]
compute_tune_4x4()/  0.2364488440315341 0.23895885999364197
compute_tunes()/ 0.2364488440315341 0.23895885999364197

 Running simulation ..
Closed orbit computation: x_co=[ 5.02921360e-08 -1.14192955e-07], y_co=[-8.30132538e-05 -1.02856553e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.2744276259347967e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.767031726138839e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.3406015875623526e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00011544497984465595, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -7.967444381174758e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.517513104966692e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005545013121743429}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.004200002693868581}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.012871257042406449}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-5.09596268e-03  4.84312853e-04  3.15088466e-03  5.35655280e-04]
 [ 3.31925874e-03 -1.10766217e-03 -1.06028076e-03 -7.86433317e-05]
 [-4.04998174e-03 -3.31788716e-04  1.19623458e-03  4.02927644e-04]
 [ 3.56851794e-03 -2.21439955e-04 -3.62020509e-03 -3.44924211e-04]
 [-3.78777884e-03  4.63722646e-04 -8.73598188e-04 -3.18287274e-05]
 [-3.51443004e-03  5.55600459e-04  2.73803269e-03  1.40481675e-04]
 [-1.66385468e-03 -4.47363050e-05 -1.91681591e-03  3.02714197e-04]
 [-2.21916660e-03 -8.66482426e-04  4.41118971e-03  5.23067920e-04]
 [-3.25876133e-04  1.22783281e-04 -2.56440852e-03  4.54014410e-04]
 [ 7.74925090e-05  7.15852548e-04  6.21354318e-04  6.44910048e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005545013121743429
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.408935810983817e-06, theta_kick=-2.888404676842575e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.4477963060157855e-06, theta_kick=4.1340374989192477e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.004200002693868581
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.513635575179907e-06, theta_kick=-4.212981259938716e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.2690085964688237e-06, theta_kick=1.5215890553335325e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.630559757246128e-07, theta_kick=-6.751253006376004e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.012871257042406449
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.4729397683791863e-06, theta_kick=1.7661102036406406e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01569726e-01 -6.31901275e+00 -7.90732597e-03 -1.82083114e-02]
 [ 1.80016658e-01  4.56222797e-01  5.39267510e-04 -5.76803294e-03]
 [-8.38168334e-03 -1.82057521e-02  3.83898246e-01 -5.11974865e+00]
 [-1.35624734e-03 -9.55898319e-03  2.12544967e-01 -2.29832355e-01]]
compute_tune_4x4()/ evals =  [0.08504158+0.9963774j  0.08504158-0.9963774j  0.0693179 +0.99759462j
 0.0693179 -0.99759462j]
compute_tune_4x4()/ angles =  [0.2364488440315341, 0.23895885999364197, 0.761041140006358, 0.7635511559684659]
compute_tune_4x4()/  0.2364488440315341 0.23895885999364197
compute_tunes()/ 0.2364488440315341 0.23895885999364197

 Running simulation ..
Closed orbit computation: x_co=[-3.52093321e-09  1.41087604e-09], y_co=[ 6.36099350e-07 -1.53144557e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 32/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.03304536e-03  1.04426715e-03 -3.80074607e-03  8.97685453e-05]
 [-3.05382792e-03  8.96851640e-05  1.97563732e-03  3.81881486e-04]
 [ 1.49955210e-03  2.74732244e-05  7.90941933e-04 -4.65513081e-04]
 [ 1.05504804e-03 -3.19082525e-05 -1.99785345e-03  7.55421744e-05]
 [ 4.46404148e-04  4.28248937e-04  5.82882106e-04  8.46582725e-04]
 [ 2.89250750e-03 -3.02658037e-04 -3.81936443e-03  8.96459071e-05]
 [ 1.95589992e-03  2.45939826e-04  4.28830587e-03 -3.77808267e-04]
 [-1.22141852e-03  1.56237631e-04  1.97849820e-03  8.14679533e-04]
 [-2.26444674e-03 -2.19202860e-04  5.38351889e-04 -6.69958110e-05]
 [-5.37999285e-03  8.70303489e-04 -1.46424150e-03  1.21246842e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012754503187941522
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.4821515004243568e-05, theta_kick=2.976193043321274e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.5088452358517255e-05, theta_kick=-5.406275089195798e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011887861161325633
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.011980192288124e-05, theta_kick=4.810515206742734e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.5236080369739217e-05, theta_kick=5.423976243211701e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.0723644806392691e-05, theta_kick=1.2858053614526687e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004998780165666405
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.9853789275707397e-06, theta_kick=-2.3805440367288165e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01538183e-01 -6.31909002e+00  8.75407030e-03  7.03909768e-02]
 [ 1.80011731e-01  4.56154816e-01  5.23410310e-04  8.52266939e-03]
 [ 1.47294573e-02  7.03928006e-02  3.84016372e-01 -5.11983114e+00]
 [ 3.63833970e-03  1.99516927e-02  2.12556749e-01 -2.29918390e-01]]
compute_tune_4x4()/ evals =  [0.09009697+0.995933j   0.09009697-0.995933j   0.06426034+0.99793317j
 0.06426034-0.99793317j]
compute_tune_4x4()/ angles =  [0.23564115070777783, 0.2397655977734231, 0.7602344022265769, 0.7643588492922222]
compute_tune_4x4()/  0.23564115070777783 0.2397655977734231
compute_tunes()/ 0.23564115070777783 0.2397655977734231

 Running simulation ..
Closed orbit computation: x_co=[ 2.16026749e-08 -5.13693984e-08], y_co=[-3.17106524e-05 -3.73369706e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.4821515004243568e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.5088452358517255e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.011980192288124e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.5236080369739217e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.0723644806392691e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.9853789275707397e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.012754503187941522}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0011887861161325633}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.004998780165666405}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.03304536e-03  1.04426715e-03 -3.80074607e-03  8.97685453e-05]
 [-3.05382792e-03  8.96851640e-05  1.97563732e-03  3.81881486e-04]
 [ 1.49955210e-03  2.74732244e-05  7.90941933e-04 -4.65513081e-04]
 [ 1.05504804e-03 -3.19082525e-05 -1.99785345e-03  7.55421744e-05]
 [ 4.46404148e-04  4.28248937e-04  5.82882106e-04  8.46582725e-04]
 [ 2.89250750e-03 -3.02658037e-04 -3.81936443e-03  8.96459071e-05]
 [ 1.95589992e-03  2.45939826e-04  4.28830587e-03 -3.77808267e-04]
 [-1.22141852e-03  1.56237631e-04  1.97849820e-03  8.14679533e-04]
 [-2.26444674e-03 -2.19202860e-04  5.38351889e-04 -6.69958110e-05]
 [-5.37999285e-03  8.70303489e-04 -1.46424150e-03  1.21246842e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012754503187941522
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.905032599950343e-06, theta_kick=-8.279393898545436e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.3068298679523711e-05, theta_kick=1.566938182918877e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0011887861161325633
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.3833879421983648e-05, theta_kick=-1.6587341945410707e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.064121203083953e-05, theta_kick=1.2759213614993605e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.892832828481481e-06, theta_kick=-8.264765913521344e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.004998780165666405
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.873925182774225e-06, theta_kick=4.64498205582883e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01538183e-01 -6.31909002e+00  8.75407030e-03  7.03909768e-02]
 [ 1.80011731e-01  4.56154816e-01  5.23410310e-04  8.52266939e-03]
 [ 1.47294573e-02  7.03928006e-02  3.84016372e-01 -5.11983114e+00]
 [ 3.63833970e-03  1.99516927e-02  2.12556749e-01 -2.29918390e-01]]
compute_tune_4x4()/ evals =  [0.09009697+0.995933j   0.09009697-0.995933j   0.06426034+0.99793317j
 0.06426034-0.99793317j]
compute_tune_4x4()/ angles =  [0.23564115070777783, 0.2397655977734231, 0.7602344022265769, 0.7643588492922222]
compute_tune_4x4()/  0.23564115070777783 0.2397655977734231
compute_tunes()/ 0.23564115070777783 0.2397655977734231

 Running simulation ..
Closed orbit computation: x_co=[ 2.68728154e-09 -5.23961759e-10], y_co=[ 8.32750603e-07 -1.30977053e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 33/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.12088761e-05  1.49848419e-04 -1.40745496e-04  3.80480020e-04]
 [ 1.49292651e-03  1.93979963e-04 -1.49202348e-03  2.42144272e-04]
 [-7.82803772e-04 -5.66517464e-04  7.09788747e-04  6.52270144e-04]
 [ 1.21744346e-03 -7.66275151e-06  3.63107295e-05  8.09044845e-05]
 [-1.55853982e-03  1.04511426e-04 -2.47613825e-03  4.77550887e-04]
 [-4.12329233e-03  4.42575987e-04  2.85776878e-03 -1.99068656e-04]
 [ 1.28151993e-03 -5.23466668e-04  9.94618580e-04 -3.44040941e-04]
 [-9.95140331e-04  8.50767881e-05 -8.78038413e-05  4.74326381e-05]
 [ 2.42227191e-03 -5.48218160e-04 -2.31874529e-03 -5.07789229e-04]
 [ 1.78577657e-03  9.00364479e-05 -3.80075960e-04  5.27308340e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011751211647721789
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.763211730555087e-05, theta_kick=-3.313194834519896e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.83653943411102e-05, theta_kick=-8.197268015555944e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004180724080902899
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-3.912630107856826e-05, theta_kick=4.691390717328103e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.9381048210995847e-05, theta_kick=-2.323860604317609e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.160544522225057e-06, theta_kick=2.590574175562117e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0021654547278391867
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.925881397852249e-05, theta_kick=-8.304392391694084e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01697271e-01 -6.32011924e+00  1.23176876e-03 -1.63384571e-02]
 [ 1.79998397e-01  4.56096610e-01 -8.57470426e-04  4.69176998e-03]
 [-7.75198329e-04 -1.63393875e-02  3.84092751e-01 -5.11921221e+00]
 [-3.32767981e-04  3.60339148e-03  2.12582829e-01 -2.29758010e-01]]
compute_tune_4x4()/ evals =  [0.07935946+0.99684606j 0.07935946-0.99684606j 0.07500758+0.99718296j
 0.07500758-0.99718296j]
compute_tune_4x4()/ angles =  [0.23735625503628874, 0.2380509497511714, 0.7619490502488286, 0.7626437449637112]
compute_tune_4x4()/  0.23735625503628874 0.2380509497511714
compute_tunes()/ 0.23735625503628874 0.2380509497511714

 Running simulation ..
Closed orbit computation: x_co=[-1.92175924e-07  2.97908100e-08], y_co=[-5.16779230e-06 -8.51179202e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.763211730555087e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.83653943411102e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -3.912630107856826e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.9381048210995847e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.160544522225057e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.925881397852249e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0011751211647721789}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004180724080902899}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0021654547278391867}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.12088761e-05  1.49848419e-04 -1.40745496e-04  3.80480020e-04]
 [ 1.49292651e-03  1.93979963e-04 -1.49202348e-03  2.42144272e-04]
 [-7.82803772e-04 -5.66517464e-04  7.09788747e-04  6.52270144e-04]
 [ 1.21744346e-03 -7.66275151e-06  3.63107295e-05  8.09044845e-05]
 [-1.55853982e-03  1.04511426e-04 -2.47613825e-03  4.77550887e-04]
 [-4.12329233e-03  4.42575987e-04  2.85776878e-03 -1.99068656e-04]
 [ 1.28151993e-03 -5.23466668e-04  9.94618580e-04 -3.44040941e-04]
 [-9.95140331e-04  8.50767881e-05 -8.78038413e-05  4.74326381e-05]
 [ 2.42227191e-03 -5.48218160e-04 -2.31874529e-03 -5.07789229e-04]
 [ 1.78577657e-03  9.00364479e-05 -3.80075960e-04  5.27308340e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0011751211647721789
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2089524032161129e-07, theta_kick=1.44957941992791e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.1128379798437116e-08, theta_kick=-3.732409862578183e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004180724080902899
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.050460702297227e-06, theta_kick=-3.6576171597703846e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.725339871149866e-06, theta_kick=5.665860302822181e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.399995242272605e-06, theta_kick=-2.877684598556824e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0021654547278391867
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.1759194211331797e-06, theta_kick=2.6090092578543537e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01697271e-01 -6.32011924e+00  1.23176876e-03 -1.63384571e-02]
 [ 1.79998397e-01  4.56096610e-01 -8.57470426e-04  4.69176998e-03]
 [-7.75198329e-04 -1.63393875e-02  3.84092751e-01 -5.11921221e+00]
 [-3.32767981e-04  3.60339148e-03  2.12582829e-01 -2.29758010e-01]]
compute_tune_4x4()/ evals =  [0.07935946+0.99684606j 0.07935946-0.99684606j 0.07500758+0.99718296j
 0.07500758-0.99718296j]
compute_tune_4x4()/ angles =  [0.23735625503628874, 0.2380509497511714, 0.7619490502488286, 0.7626437449637112]
compute_tune_4x4()/  0.23735625503628874 0.2380509497511714
compute_tunes()/ 0.23735625503628874 0.2380509497511714

 Running simulation ..
Closed orbit computation: x_co=[ 5.81947340e-09 -6.11456971e-10], y_co=[ 5.01276495e-07 -1.85987079e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 34/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.30187464e-03 -1.19867356e-03 -3.02543660e-04  1.60821061e-04]
 [ 2.55547868e-04 -2.24911049e-04 -3.58371368e-03  7.94351342e-05]
 [-2.88225092e-03  1.55423337e-04  8.28093133e-04  5.81343568e-04]
 [ 3.56956062e-03 -1.65722552e-04  1.53112758e-03  1.88175174e-04]
 [-3.87659538e-04 -3.84471895e-04  1.03441803e-03  5.53428006e-04]
 [ 3.72325477e-03 -4.71307120e-04 -1.17367697e-03  2.48661520e-04]
 [ 1.53824019e-03 -2.54715998e-04  1.18444586e-03 -6.51867590e-04]
 [ 2.30538744e-03 -1.13730429e-03  2.59058735e-03 -2.58517307e-04]
 [ 2.51774162e-04 -7.90713249e-05 -1.16475750e-04 -4.80296460e-04]
 [ 2.07920434e-04 -3.85125758e-04  3.90033670e-03  6.69870771e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01332448746625081
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-9.348326142830862e-06, theta_kick=1.120899478868836e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.7562146760192626e-05, theta_kick=-3.3048051028577875e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015528377355324852
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-9.861625752971066e-05, theta_kick=1.1824460334839599e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.4741005610685275e-05, theta_kick=-4.165577290460713e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=5.5664700047651616e-05, theta_kick=-6.674406981687574e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008222755399624204
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.5582925613281084e-05, theta_kick=1.86845141390085e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01351807e-01 -6.31783268e+00 -1.82155517e-02 -4.42530746e-02]
 [ 1.79954042e-01  4.56232825e-01  2.13274868e-03 -2.59490028e-02]
 [-1.95557163e-02 -4.42642899e-02  3.83788850e-01 -5.11797749e+00]
 [-3.96364381e-03 -3.79686407e-02  2.12544338e-01 -2.30241696e-01]]
compute_tune_4x4()/ evals =  [0.10239055+0.99474428j 0.10239055-0.99474428j 0.05182354+0.99865626j
 0.05182354-0.99865626j]
compute_tune_4x4()/ angles =  [0.2336754291170164, 0.24174833123901138, 0.7582516687609886, 0.7663245708829836]
compute_tune_4x4()/  0.2336754291170164 0.24174833123901138
compute_tunes()/ 0.2336754291170164 0.24174833123901138

 Running simulation ..
Closed orbit computation: x_co=[ 5.03963174e-07 -1.48034306e-07], y_co=[-1.03510187e-06  5.54232982e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -9.348326142830862e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.7562146760192626e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -9.861625752971066e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 3.4741005610685275e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 5.5664700047651616e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.5582925613281084e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.01332448746625081}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.015528377355324852}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.008222755399624204}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.30187464e-03 -1.19867356e-03 -3.02543660e-04  1.60821061e-04]
 [ 2.55547868e-04 -2.24911049e-04 -3.58371368e-03  7.94351342e-05]
 [-2.88225092e-03  1.55423337e-04  8.28093133e-04  5.81343568e-04]
 [ 3.56956062e-03 -1.65722552e-04  1.53112758e-03  1.88175174e-04]
 [-3.87659538e-04 -3.84471895e-04  1.03441803e-03  5.53428006e-04]
 [ 3.72325477e-03 -4.71307120e-04 -1.17367697e-03  2.48661520e-04]
 [ 1.53824019e-03 -2.54715998e-04  1.18444586e-03 -6.51867590e-04]
 [ 2.30538744e-03 -1.13730429e-03  2.59058735e-03 -2.58517307e-04]
 [ 2.51774162e-04 -7.90713249e-05 -1.16475750e-04 -4.80296460e-04]
 [ 2.07920434e-04 -3.85125758e-04  3.90033670e-03  6.69870771e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.01332448746625081
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.292185692919796e-06, theta_kick=-6.345529771466207e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.418688963730893e-06, theta_kick=7.696249579380212e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.015528377355324852
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.828534800554389e-06, theta_kick=-5.789594906027208e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.41963823138602e-06, theta_kick=2.9012372815978814e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.613979594622118e-06, theta_kick=-3.1342598884750054e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.008222755399624204
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.730545506298775e-06, theta_kick=2.0749891761710637e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01351807e-01 -6.31783268e+00 -1.82155517e-02 -4.42530746e-02]
 [ 1.79954042e-01  4.56232825e-01  2.13274868e-03 -2.59490028e-02]
 [-1.95557163e-02 -4.42642899e-02  3.83788850e-01 -5.11797749e+00]
 [-3.96364381e-03 -3.79686407e-02  2.12544338e-01 -2.30241696e-01]]
compute_tune_4x4()/ evals =  [0.10239055+0.99474428j 0.10239055-0.99474428j 0.05182354+0.99865626j
 0.05182354-0.99865626j]
compute_tune_4x4()/ angles =  [0.2336754291170164, 0.24174833123901138, 0.7582516687609886, 0.7663245708829836]
compute_tune_4x4()/  0.2336754291170164 0.24174833123901138
compute_tunes()/ 0.2336754291170164 0.24174833123901138

 Running simulation ..
Closed orbit computation: x_co=[-3.57092994e-09  1.84369741e-09], y_co=[ 5.98813553e-07 -1.45367678e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 35/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.65995482e-03  4.55182799e-04  1.59341415e-03  3.53235914e-04]
 [ 6.34396006e-04  4.78584087e-04  2.09561950e-04  2.35475414e-04]
 [-4.62775437e-03  3.53769814e-04  1.88338479e-03 -1.19249828e-04]
 [-1.22559956e-03 -6.46046390e-05 -3.78341778e-03 -1.51901388e-04]
 [-2.53889493e-03 -2.16191242e-04  2.01634272e-03  3.71454703e-04]
 [-1.71899492e-03  2.72481000e-04  6.01210211e-03  3.20648064e-05]
 [ 2.51125019e-03 -6.89534965e-04  2.86482226e-03  1.48126055e-04]
 [ 2.41602934e-03 -9.65664640e-04 -6.37783296e-04 -4.35262747e-05]
 [ 4.02584180e-03 -1.27890731e-03  9.28014860e-04 -3.77446905e-04]
 [-8.67956780e-04 -6.78069315e-05  3.11960569e-03 -4.83241636e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.02016953172962762
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.774975318444274e-05, theta_kick=-6.924412698083691e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.8033703151708794e-05, theta_kick=-4.560384114849953e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.014620134484909798
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.33619863003754e-05, theta_kick=7.597340565471338e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.133916921906601e-05, theta_kick=-4.956721933589913e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.254648903418985e-05, theta_kick=-2.703408869418451e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006793819689413813
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-0.00011523786723277956, theta_kick=1.3817453879295595e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01484469e-01 -6.32050975e+00 -4.83460886e-03 -1.54928878e-01]
 [ 1.80112360e-01  4.56914152e-01 -4.01739551e-03  5.58351398e-03]
 [-2.07145652e-02 -1.54893176e-01  3.83831281e-01 -5.12185686e+00]
 [-6.05061674e-03 -1.38933430e-02  2.12621945e-01 -2.30230747e-01]]
compute_tune_4x4()/ evals =  [0.0856879 +0.99632203j 0.0856879 -0.99632203j 0.06882721+0.9976286j
 0.06882721-0.9976286j ]
compute_tune_4x4()/ angles =  [0.2363456035701038, 0.23903714174026014, 0.7609628582597399, 0.7636543964298962]
compute_tune_4x4()/  0.2363456035701038 0.23903714174026014
compute_tunes()/ 0.2363456035701038 0.23903714174026014

 Running simulation ..
Closed orbit computation: x_co=[4.19745784e-07 1.00694683e-07], y_co=[ 3.96274279e-05 -1.12132653e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.774975318444274e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.8033703151708794e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.33619863003754e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 4.133916921906601e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.254648903418985e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -0.00011523786723277956, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.02016953172962762}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.014620134484909798}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006793819689413813}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.65995482e-03  4.55182799e-04  1.59341415e-03  3.53235914e-04]
 [ 6.34396006e-04  4.78584087e-04  2.09561950e-04  2.35475414e-04]
 [-4.62775437e-03  3.53769814e-04  1.88338479e-03 -1.19249828e-04]
 [-1.22559956e-03 -6.46046390e-05 -3.78341778e-03 -1.51901388e-04]
 [-2.53889493e-03 -2.16191242e-04  2.01634272e-03  3.71454703e-04]
 [-1.71899492e-03  2.72481000e-04  6.01210211e-03  3.20648064e-05]
 [ 2.51125019e-03 -6.89534965e-04  2.86482226e-03  1.48126055e-04]
 [ 2.41602934e-03 -9.65664640e-04 -6.37783296e-04 -4.35262747e-05]
 [ 4.02584180e-03 -1.27890731e-03  9.28014860e-04 -3.77446905e-04]
 [-8.67956780e-04 -6.78069315e-05  3.11960569e-03 -4.83241636e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.02016953172962762
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.4234333318316875e-06, theta_kick=-2.9057877498280317e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.996171258305805e-06, theta_kick=3.5925220737108005e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.014620134484909798
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.979301637105554e-06, theta_kick=-8.36844526856766e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.458186822315125e-06, theta_kick=1.0141684250692294e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.947931744383655e-06, theta_kick=-4.733718707795664e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006793819689413813
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.466592023050933e-06, theta_kick=1.7584990181495484e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01484469e-01 -6.32050975e+00 -4.83460886e-03 -1.54928878e-01]
 [ 1.80112360e-01  4.56914152e-01 -4.01739551e-03  5.58351398e-03]
 [-2.07145652e-02 -1.54893176e-01  3.83831281e-01 -5.12185686e+00]
 [-6.05061674e-03 -1.38933430e-02  2.12621945e-01 -2.30230747e-01]]
compute_tune_4x4()/ evals =  [0.0856879 +0.99632203j 0.0856879 -0.99632203j 0.06882721+0.9976286j
 0.06882721-0.9976286j ]
compute_tune_4x4()/ angles =  [0.2363456035701038, 0.23903714174026014, 0.7609628582597399, 0.7636543964298962]
compute_tune_4x4()/  0.2363456035701038 0.23903714174026014
compute_tunes()/ 0.2363456035701038 0.23903714174026014

 Running simulation ..
Closed orbit computation: x_co=[1.19482622e-08 3.13323565e-09], y_co=[ 4.72586567e-08 -2.72499865e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 36/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.23978076e-03 -2.67443300e-04  8.50785285e-04 -9.05191303e-05]
 [ 3.94807479e-03 -5.87126937e-04 -2.32871502e-03 -6.94437121e-04]
 [-7.02434062e-03  7.95609713e-05  1.90231331e-03  3.03255207e-04]
 [-1.36575976e-03  5.04557564e-04  2.74324361e-03  5.89259518e-04]
 [-2.97705240e-03  7.59878180e-04  2.76435472e-03  2.91089098e-05]
 [-2.14190255e-03 -9.79084635e-05 -2.51559550e-05  1.08639217e-04]
 [-2.98538250e-04  7.67771489e-06  2.12148367e-03 -1.88525414e-04]
 [ 2.75678145e-03 -5.71729427e-04  7.10996306e-04  4.94359222e-04]
 [-3.75369066e-03 -9.33170694e-05  4.34918502e-04 -9.05616659e-04]
 [-2.89417124e-03  6.48902520e-05 -1.62097441e-03 -1.38980244e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004493916054850788
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.7500201290830056e-05, theta_kick=5.695452860712151e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.7929175822154295e-05, theta_kick=-5.746888521092709e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01826240550864902
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.938665369438489e-05, theta_kick=1.0717796107349388e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.4085951367453048e-05, theta_kick=-1.6889585692576918e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.733010248750582e-05, theta_kick=6.874095000528364e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006569330315105612
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.964575632694559e-05, theta_kick=-8.350788235193013e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588831e-01 -6.31947174e+00 -1.50725007e-02  7.33979614e-03]
 [ 1.79968674e-01  4.56431224e-01  3.11885624e-03 -2.45811699e-02]
 [-1.14101114e-02  7.32768393e-03  3.83785586e-01 -5.11744760e+00]
 [-1.70341976e-03 -2.93709498e-02  2.12593340e-01 -2.30031798e-01]]
compute_tune_4x4()/ evals =  [0.09714789+0.99526996j 0.09714789-0.99526996j 0.0571502 +0.99836559j
 0.0571502 -0.99836559j]
compute_tune_4x4()/ angles =  [0.23451400948887613, 0.24089930388091105, 0.7591006961190889, 0.7654859905111239]
compute_tune_4x4()/  0.23451400948887613 0.24089930388091105
compute_tunes()/ 0.23451400948887613 0.24089930388091105

 Running simulation ..
Closed orbit computation: x_co=[ 7.95053084e-07 -1.12575964e-07], y_co=[-5.85131234e-05  1.96819427e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.7500201290830056e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.7929175822154295e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.938665369438489e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.4085951367453048e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.733010248750582e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 6.964575632694559e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004493916054850788}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.01826240550864902}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006569330315105612}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.23978076e-03 -2.67443300e-04  8.50785285e-04 -9.05191303e-05]
 [ 3.94807479e-03 -5.87126937e-04 -2.32871502e-03 -6.94437121e-04]
 [-7.02434062e-03  7.95609713e-05  1.90231331e-03  3.03255207e-04]
 [-1.36575976e-03  5.04557564e-04  2.74324361e-03  5.89259518e-04]
 [-2.97705240e-03  7.59878180e-04  2.76435472e-03  2.91089098e-05]
 [-2.14190255e-03 -9.79084635e-05 -2.51559550e-05  1.08639217e-04]
 [-2.98538250e-04  7.67771489e-06  2.12148367e-03 -1.88525414e-04]
 [ 2.75678145e-03 -5.71729427e-04  7.10996306e-04  4.94359222e-04]
 [-3.75369066e-03 -9.33170694e-05  4.34918502e-04 -9.05616659e-04]
 [-2.89417124e-03  6.48902520e-05 -1.62097441e-03 -1.38980244e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004493916054850788
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.151376648697088e-06, theta_kick=2.579581550248422e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.2256814356924475e-06, theta_kick=5.066751038383276e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.01826240550864902
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=8.920272098327826e-06, theta_kick=-1.0695741883215962e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-9.743635640186882e-06, theta_kick=1.1682985750073543e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.586979860866965e-06, theta_kick=-5.499961444510176e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006569330315105612
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.66093086028384e-07, theta_kick=7.98670672802669e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01588831e-01 -6.31947174e+00 -1.50725007e-02  7.33979614e-03]
 [ 1.79968674e-01  4.56431224e-01  3.11885624e-03 -2.45811699e-02]
 [-1.14101114e-02  7.32768393e-03  3.83785586e-01 -5.11744760e+00]
 [-1.70341976e-03 -2.93709498e-02  2.12593340e-01 -2.30031798e-01]]
compute_tune_4x4()/ evals =  [0.09714789+0.99526996j 0.09714789-0.99526996j 0.0571502 +0.99836559j
 0.0571502 -0.99836559j]
compute_tune_4x4()/ angles =  [0.23451400948887613, 0.24089930388091105, 0.7591006961190889, 0.7654859905111239]
compute_tune_4x4()/  0.23451400948887613 0.24089930388091105
compute_tunes()/ 0.23451400948887613 0.24089930388091105

 Running simulation ..
Closed orbit computation: x_co=[-3.19393159e-08  8.38256684e-10], y_co=[-1.95223055e-07  2.78331642e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 37/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.41507746e-04 -1.88373939e-04  2.66586707e-03  2.77280813e-04]
 [ 1.99047036e-03 -2.77871317e-04  3.66750316e-03  1.12956444e-05]
 [ 7.84310127e-04  9.65942478e-05 -1.88340084e-04  1.19978683e-04]
 [ 1.67975601e-03 -2.31167902e-04  1.35198851e-04 -1.55726223e-04]
 [-3.31052933e-03  2.31322749e-04 -1.31592851e-04  3.82370536e-04]
 [-5.83048842e-04 -1.13627013e-04 -2.53786344e-04  4.73813533e-04]
 [-1.77564307e-04 -9.93386259e-04  3.15704821e-03  1.67980339e-04]
 [ 4.21050056e-03 -2.34809398e-04  7.51651873e-04  3.60247398e-04]
 [-1.85063706e-03 -3.81669543e-04 -1.64775576e-03 -4.89746481e-04]
 [ 1.01512278e-03 -7.10674526e-04  6.29101221e-05 -2.47356611e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0040806811917188015
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.7562635765947805e-05, theta_kick=5.7029389891969385e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.641043786880867e-05, theta_kick=5.564786126029294e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003901999811155227
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-4.21232619723847e-05, theta_kick=5.050737604968019e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7075181624166297e-05, theta_kick=-2.0473785244213655e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.5325148426041544e-05, theta_kick=-3.0365805855838217e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.022603977172536847
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.133400743122243e-06, theta_kick=1.3589901367418085e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01178942e-01 -6.31853856e+00 -1.36706926e-02 -1.22398189e-01]
 [ 1.80039648e-01  4.56235689e-01 -1.86403079e-03 -3.60456665e-03]
 [-2.43531063e-02 -1.22427137e-01  3.83862214e-01 -5.12187114e+00]
 [-5.60938144e-03 -2.08541545e-02  2.12535642e-01 -2.30294340e-01]]
compute_tune_4x4()/ evals =  [0.09269385+0.99569466j 0.09269385-0.99569466j 0.06161846+0.99809978j
 0.06161846-0.99809978j]
compute_tune_4x4()/ angles =  [0.2352261068372624, 0.24018690132874554, 0.7598130986712545, 0.7647738931627376]
compute_tune_4x4()/  0.2352261068372624 0.24018690132874554
compute_tunes()/ 0.2352261068372624 0.24018690132874554

 Running simulation ..
Closed orbit computation: x_co=[-1.60209963e-07 -2.52194975e-07], y_co=[-2.01494566e-05  1.05601530e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -4.7562635765947805e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.641043786880867e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -4.21232619723847e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.7075181624166297e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.5325148426041544e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.133400743122243e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0040806811917188015}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003901999811155227}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.022603977172536847}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.41507746e-04 -1.88373939e-04  2.66586707e-03  2.77280813e-04]
 [ 1.99047036e-03 -2.77871317e-04  3.66750316e-03  1.12956444e-05]
 [ 7.84310127e-04  9.65942478e-05 -1.88340084e-04  1.19978683e-04]
 [ 1.67975601e-03 -2.31167902e-04  1.35198851e-04 -1.55726223e-04]
 [-3.31052933e-03  2.31322749e-04 -1.31592851e-04  3.82370536e-04]
 [-5.83048842e-04 -1.13627013e-04 -2.53786344e-04  4.73813533e-04]
 [-1.77564307e-04 -9.93386259e-04  3.15704821e-03  1.67980339e-04]
 [ 4.21050056e-03 -2.34809398e-04  7.51651873e-04  3.60247398e-04]
 [-1.85063706e-03 -3.81669543e-04 -1.64775576e-03 -4.89746481e-04]
 [ 1.01512278e-03 -7.10674526e-04  6.29101221e-05 -2.47356611e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0040806811917188015
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.373655363147675e-06, theta_kick=-5.244177345121556e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.854784571699137e-06, theta_kick=5.821069369312959e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003901999811155227
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.3328584459779324e-07, theta_kick=-3.996222680041186e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.1393463894618696e-06, theta_kick=-7.361307322188906e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.383077639808342e-06, theta_kick=5.255475009363618e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.022603977172536847
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.2983629894798783e-06, theta_kick=-1.5567860770525864e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01178942e-01 -6.31853856e+00 -1.36706926e-02 -1.22398189e-01]
 [ 1.80039648e-01  4.56235689e-01 -1.86403079e-03 -3.60456665e-03]
 [-2.43531063e-02 -1.22427137e-01  3.83862214e-01 -5.12187114e+00]
 [-5.60938144e-03 -2.08541545e-02  2.12535642e-01 -2.30294340e-01]]
compute_tune_4x4()/ evals =  [0.09269385+0.99569466j 0.09269385-0.99569466j 0.06161846+0.99809978j
 0.06161846-0.99809978j]
compute_tune_4x4()/ angles =  [0.2352261068372624, 0.24018690132874554, 0.7598130986712545, 0.7647738931627376]
compute_tune_4x4()/  0.2352261068372624 0.24018690132874554
compute_tunes()/ 0.2352261068372624 0.24018690132874554

 Running simulation ..
Closed orbit computation: x_co=[1.00436999e-10 4.30752666e-09], y_co=[ 5.10535643e-08 -1.10368510e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 38/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 7.64934498e-04  6.35413151e-04  4.87290753e-04  4.70357184e-04]
 [-5.59558438e-03 -3.56419555e-04  3.62741854e-04  8.19473457e-04]
 [-1.89463052e-03 -3.75744987e-06 -3.19445665e-03  4.39339751e-04]
 [-2.25196039e-03  2.44081158e-04 -1.47818463e-03  1.64800868e-04]
 [ 1.42804375e-03 -6.79561083e-04  9.79013440e-04 -9.29228880e-04]
 [ 1.75102706e-04 -8.46423755e-05  1.97948917e-03 -1.13464315e-04]
 [-3.20858794e-03 -5.95143235e-05 -3.23939363e-03 -2.23723417e-04]
 [-9.30269823e-04  6.75512070e-04  4.74132698e-03  2.95029049e-04]
 [ 4.12488917e-03 -2.23940538e-05 -1.68722827e-03 -1.76114534e-04]
 [-7.74865506e-04  1.60540383e-04 -2.86790435e-03  1.23187853e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006796583064101528
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2870464853007973e-05, theta_kick=1.5432171627430697e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0033234791046179e-05, theta_kick=-1.2030226028514176e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0017708576253942865
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.382616309713811e-05, theta_kick=-2.856846604512951e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.297431387095085e-05, theta_kick=-1.5556690507404177e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.535096935880589e-05, theta_kick=-1.0233902370704489e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006817824423464769
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.213750839828983e-05, theta_kick=5.052445805038151e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01649745e-01 -6.31966180e+00  2.43082085e-03 -5.08696259e-03]
 [ 1.80008974e-01  4.56144560e-01 -3.63853129e-04  7.83161430e-04]
 [ 1.41733467e-03 -5.08590583e-03  3.84024670e-01 -5.11956983e+00]
 [-6.91005975e-05  2.85223399e-04  2.12565908e-01 -2.29792684e-01]]
compute_tune_4x4()/ evals =  [0.07840579+0.99692153j 0.07840579-0.99692153j 0.07595761+0.99711105j
 0.07595761-0.99711105j]
compute_tune_4x4()/ angles =  [0.23750850973694915, 0.23789931611901008, 0.76210068388099, 0.7624914902630509]
compute_tune_4x4()/  0.23750850973694915 0.23789931611901008
compute_tunes()/ 0.23750850973694915 0.23789931611901008

 Running simulation ..
Closed orbit computation: x_co=[ 5.98704219e-08 -7.21193298e-08], y_co=[5.77823935e-05 6.60895622e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.2870464853007973e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.0033234791046179e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.382616309713811e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.297431387095085e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.535096935880589e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -4.213750839828983e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.006796583064101528}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0017708576253942865}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006817824423464769}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 7.64934498e-04  6.35413151e-04  4.87290753e-04  4.70357184e-04]
 [-5.59558438e-03 -3.56419555e-04  3.62741854e-04  8.19473457e-04]
 [-1.89463052e-03 -3.75744987e-06 -3.19445665e-03  4.39339751e-04]
 [-2.25196039e-03  2.44081158e-04 -1.47818463e-03  1.64800868e-04]
 [ 1.42804375e-03 -6.79561083e-04  9.79013440e-04 -9.29228880e-04]
 [ 1.75102706e-04 -8.46423755e-05  1.97948917e-03 -1.13464315e-04]
 [-3.20858794e-03 -5.95143235e-05 -3.23939363e-03 -2.23723417e-04]
 [-9.30269823e-04  6.75512070e-04  4.74132698e-03  2.95029049e-04]
 [ 4.12488917e-03 -2.23940538e-05 -1.68722827e-03 -1.76114534e-04]
 [-7.74865506e-04  1.60540383e-04 -2.86790435e-03  1.23187853e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.006796583064101528
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.238188026935489e-06, theta_kick=2.683671659151964e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.574839583221528e-06, theta_kick=-5.485404794818905e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0017708576253942865
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.431213712117111e-06, theta_kick=6.512229597601335e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.2960047895375322e-06, theta_kick=-2.752996132945824e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-7.018456748468602e-08, theta_kick=8.415393720356059e-09
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006817824423464769
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.1412808367563038e-06, theta_kick=-1.3684386655082444e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01649745e-01 -6.31966180e+00  2.43082085e-03 -5.08696259e-03]
 [ 1.80008974e-01  4.56144560e-01 -3.63853129e-04  7.83161430e-04]
 [ 1.41733467e-03 -5.08590583e-03  3.84024670e-01 -5.11956983e+00]
 [-6.91005975e-05  2.85223399e-04  2.12565908e-01 -2.29792684e-01]]
compute_tune_4x4()/ evals =  [0.07840579+0.99692153j 0.07840579-0.99692153j 0.07595761+0.99711105j
 0.07595761-0.99711105j]
compute_tune_4x4()/ angles =  [0.23750850973694915, 0.23789931611901008, 0.76210068388099, 0.7624914902630509]
compute_tune_4x4()/  0.23750850973694915 0.23789931611901008
compute_tunes()/ 0.23750850973694915 0.23789931611901008

 Running simulation ..
Closed orbit computation: x_co=[-2.04178915e-09  4.21122755e-10], y_co=[-4.66291212e-07  1.54993783e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 39/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.26364637e-03 -2.20745485e-04  3.29977387e-03  3.46629256e-04]
 [-1.97345475e-03 -2.42712449e-04 -6.97744404e-04  4.69782972e-04]
 [-7.66519141e-04  4.23312827e-04 -7.41637518e-04  2.40419702e-05]
 [ 4.46075933e-03 -2.21127416e-04  1.97400969e-03 -1.80947356e-04]
 [-1.23185687e-03 -1.40791935e-04 -1.40850773e-03 -3.08990736e-04]
 [-5.52685680e-04  2.25131705e-04  7.49400386e-04  4.88806872e-04]
 [-1.56147733e-03  3.88221853e-05  1.68963941e-03 -4.43574415e-04]
 [-1.11506866e-03  3.36879113e-04 -3.76330514e-04 -4.59046160e-04]
 [-3.02288225e-03 -1.42397593e-04  4.28363068e-03 -1.93711459e-04]
 [-5.26278325e-03  2.73774931e-04  2.50391058e-03  5.73230122e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0073878116334881476
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.2192999003990635e-05, theta_kick=-3.860061711098021e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-6.263377571867908e-05, theta_kick=7.510025376734993e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005868783155489986
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.18536808326928e-05, theta_kick=-3.8193761856288285e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.9234202282060373e-05, theta_kick=3.5052908512651244e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.831666469707249e-05, theta_kick=-2.1962370161110484e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006276526006317679
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.3560926909667473e-05, theta_kick=-1.6260061612935604e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01596727e-01 -6.31992374e+00 -1.99413115e-03  1.25220336e-02]
 [ 1.79993971e-01  4.56076349e-01  1.08699838e-03 -8.31305561e-03]
 [-2.56490110e-04  1.25291548e-02  3.84079463e-01 -5.11962615e+00]
 [-6.09966902e-05 -8.58378470e-03  2.12577420e-01 -2.29952106e-01]]
compute_tune_4x4()/ evals =  [0.08191323+0.99663946j 0.08191323-0.99663946j 0.07239026+0.99737638j
 0.07239026-0.99737638j]
compute_tune_4x4()/ angles =  [0.23694848056466328, 0.23846864669280046, 0.7615313533071996, 0.7630515194353367]
compute_tune_4x4()/  0.23694848056466328 0.23846864669280046
compute_tunes()/ 0.23694848056466328 0.23846864669280046

 Running simulation ..
Closed orbit computation: x_co=[9.95731351e-08 4.13463529e-09], y_co=[-1.48655895e-05  1.55324902e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.2192999003990635e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -6.263377571867908e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.18536808326928e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.9234202282060373e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 1.831666469707249e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.3560926909667473e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0073878116334881476}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.005868783155489986}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.006276526006317679}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.26364637e-03 -2.20745485e-04  3.29977387e-03  3.46629256e-04]
 [-1.97345475e-03 -2.42712449e-04 -6.97744404e-04  4.69782972e-04]
 [-7.66519141e-04  4.23312827e-04 -7.41637518e-04  2.40419702e-05]
 [ 4.46075933e-03 -2.21127416e-04  1.97400969e-03 -1.80947356e-04]
 [-1.23185687e-03 -1.40791935e-04 -1.40850773e-03 -3.08990736e-04]
 [-5.52685680e-04  2.25131705e-04  7.49400386e-04  4.88806872e-04]
 [-1.56147733e-03  3.88221853e-05  1.68963941e-03 -4.43574415e-04]
 [-1.11506866e-03  3.36879113e-04 -3.76330514e-04 -4.59046160e-04]
 [-3.02288225e-03 -1.42397593e-04  4.28363068e-03 -1.93711459e-04]
 [-5.26278325e-03  2.73774931e-04  2.50391058e-03  5.73230122e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0073878116334881476
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.7344530189176201e-06, theta_kick=2.0796744308265145e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.8232488453561585e-06, theta_kick=-2.1861439677895726e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.005868783155489986
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.790437825056174e-06, theta_kick=-4.544877572599962e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.874211374343808e-06, theta_kick=8.242438089352838e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.368272533867065e-06, theta_kick=-4.038685503923284e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.006276526006317679
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-9.912220588377343e-07, theta_kick=1.1885125446190944e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01596727e-01 -6.31992374e+00 -1.99413115e-03  1.25220336e-02]
 [ 1.79993971e-01  4.56076349e-01  1.08699838e-03 -8.31305561e-03]
 [-2.56490110e-04  1.25291548e-02  3.84079463e-01 -5.11962615e+00]
 [-6.09966902e-05 -8.58378470e-03  2.12577420e-01 -2.29952106e-01]]
compute_tune_4x4()/ evals =  [0.08191323+0.99663946j 0.08191323-0.99663946j 0.07239026+0.99737638j
 0.07239026-0.99737638j]
compute_tune_4x4()/ angles =  [0.23694848056466328, 0.23846864669280046, 0.7615313533071996, 0.7630515194353367]
compute_tune_4x4()/  0.23694848056466328 0.23846864669280046
compute_tunes()/ 0.23694848056466328 0.23846864669280046

 Running simulation ..
Closed orbit computation: x_co=[-6.72866992e-09  7.27226563e-10], y_co=[ 3.30595002e-07 -8.45878821e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 40/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.87776718e-04  5.12191459e-04 -1.79289301e-03 -3.80297763e-04]
 [ 2.01853033e-05  3.23229695e-04 -9.78433160e-04 -4.54591998e-04]
 [ 8.09419445e-04  3.35128275e-04 -3.40852486e-05  1.50504078e-04]
 [-2.49031977e-03 -7.06884693e-05  7.48610542e-04 -2.10116955e-04]
 [-3.85122870e-03 -8.05348722e-05 -4.98737345e-04  8.31025236e-04]
 [ 4.92192286e-04  1.13379171e-04  6.71837800e-04 -2.40895593e-04]
 [ 2.44271176e-03 -5.04701072e-04  1.03497342e-03 -7.27957529e-05]
 [-8.34117358e-05 -6.93706994e-04 -1.95587026e-03  9.60706920e-04]
 [ 3.82230612e-03 -4.63022401e-04  1.82724746e-03  4.78419997e-04]
 [-2.04660002e-03  7.49630388e-04  1.56204648e-03 -3.33820776e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012230933960416133
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.749432464263562e-06, theta_kick=2.0976353494182208e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.10881852785738e-05, theta_kick=-4.926628014763823e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0015134915509617513
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.0468394050089034e-05, theta_kick=-3.653275088065469e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.161125145552842e-06, theta_kick=3.790307991133448e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.482809619181809e-05, theta_kick=-2.9769821524740688e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0022072170800845267
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.0001224082300267482, theta_kick=-1.4677207357753728e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01571741e-01 -6.31927791e+00  6.97863428e-03  5.56487927e-02]
 [ 1.80007991e-01  4.56135566e-01  3.23190259e-04  7.88981480e-03]
 [ 1.16915921e-02  5.56506265e-02  3.84034371e-01 -5.11972869e+00]
 [ 2.94634284e-03  1.71953322e-02  2.12560607e-01 -2.29900545e-01]]
compute_tune_4x4()/ evals =  [0.08805331+0.99611576j 0.08805331-0.99611576j 0.06629551+0.99780003j
 0.06629551-0.99780003j]
compute_tune_4x4()/ angles =  [0.2359677073797554, 0.23944099682900558, 0.7605590031709945, 0.7640322926202446]
compute_tune_4x4()/  0.2359677073797554 0.23944099682900558
compute_tunes()/ 0.2359677073797554 0.23944099682900558

 Running simulation ..
Closed orbit computation: x_co=[-1.20024623e-07  8.11210021e-08], y_co=[2.88039254e-06 8.51312440e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.749432464263562e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.10881852785738e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.0468394050089034e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.161125145552842e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.482809619181809e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.0001224082300267482, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.012230933960416133}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0015134915509617513}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0022072170800845267}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.87776718e-04  5.12191459e-04 -1.79289301e-03 -3.80297763e-04]
 [ 2.01853033e-05  3.23229695e-04 -9.78433160e-04 -4.54591998e-04]
 [ 8.09419445e-04  3.35128275e-04 -3.40852486e-05  1.50504078e-04]
 [-2.49031977e-03 -7.06884693e-05  7.48610542e-04 -2.10116955e-04]
 [-3.85122870e-03 -8.05348722e-05 -4.98737345e-04  8.31025236e-04]
 [ 4.92192286e-04  1.13379171e-04  6.71837800e-04 -2.40895593e-04]
 [ 2.44271176e-03 -5.04701072e-04  1.03497342e-03 -7.27957529e-05]
 [-8.34117358e-05 -6.93706994e-04 -1.95587026e-03  9.60706920e-04]
 [ 3.82230612e-03 -4.63022401e-04  1.82724746e-03  4.78419997e-04]
 [-2.04660002e-03  7.49630388e-04  1.56204648e-03 -3.33820776e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012230933960416133
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.023539827687826e-06, theta_kick=9.620526149952228e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5245488137231002e-05, theta_kick=-1.827991390868233e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0015134915509617513
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.4253603205603225e-05, theta_kick=1.7090606554646488e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.116260481424934e-06, theta_kick=-8.532664076168636e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.483780500874658e-06, theta_kick=2.9781462761545334e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0022072170800845267
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.856275037230776e-07, theta_kick=-7.021894119920755e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01571741e-01 -6.31927791e+00  6.97863428e-03  5.56487927e-02]
 [ 1.80007991e-01  4.56135566e-01  3.23190259e-04  7.88981480e-03]
 [ 1.16915921e-02  5.56506265e-02  3.84034371e-01 -5.11972869e+00]
 [ 2.94634284e-03  1.71953322e-02  2.12560607e-01 -2.29900545e-01]]
compute_tune_4x4()/ evals =  [0.08805331+0.99611576j 0.08805331-0.99611576j 0.06629551+0.99780003j
 0.06629551-0.99780003j]
compute_tune_4x4()/ angles =  [0.2359677073797554, 0.23944099682900558, 0.7605590031709945, 0.7640322926202446]
compute_tune_4x4()/  0.2359677073797554 0.23944099682900558
compute_tunes()/ 0.2359677073797554 0.23944099682900558

 Running simulation ..
Closed orbit computation: x_co=[-2.24839405e-09  1.21580820e-09], y_co=[1.23601437e-07 9.99842210e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 41/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.56640904e-03 -3.10258364e-04  3.98454341e-03  4.03982455e-04]
 [ 2.38900620e-03  4.00279420e-04 -6.11971608e-04  2.28790774e-04]
 [-6.16779912e-04 -2.27954402e-04 -2.49245646e-03  2.93698023e-05]
 [ 2.48541183e-04 -3.47871805e-06 -3.73270544e-03 -2.86176775e-04]
 [ 1.12272999e-03  3.85356679e-04  1.45132300e-03  6.94755488e-04]
 [-2.41473699e-03 -4.89172143e-04 -1.26602659e-03  1.23036001e-04]
 [ 1.02972019e-03 -2.83585793e-04 -3.81818293e-04 -1.29082769e-04]
 [-3.82158493e-04  2.45605928e-04  4.16492893e-04  3.54352412e-04]
 [-2.82265122e-03  4.76981506e-04  1.93345548e-04  5.33138782e-04]
 [-9.41355792e-04 -2.70613432e-04  1.26350831e-03  2.61873364e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009122002088257603
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5470119267098983e-05, theta_kick=1.854925508544458e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.080849221229155e-05, theta_kick=6.09212939008811e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00018757869370257982
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.4869876651929705e-05, theta_kick=6.579104665909824e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.7159213551566777e-05, theta_kick=-2.0574542686981926e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.9376881169184024e-05, theta_kick=3.5223985866798897e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.014362559012162705
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.471164690250162e-05, theta_kick=-5.361094697237954e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01472644e-01 -6.31898867e+00 -5.20116892e-03 -2.23452417e-02]
 [ 1.80017658e-01  4.56168063e-01 -2.27152383e-04  4.37117927e-04]
 [-6.63872509e-03 -2.23516554e-02  3.83925572e-01 -5.12052322e+00]
 [-1.05806129e-03 -2.45530911e-03  2.12540698e-01 -2.30024346e-01]]
compute_tune_4x4()/ evals =  [0.08060006+0.99674652j 0.08060006-0.99674652j 0.07369826+0.99728059j
 0.07369826-0.99728059j]
compute_tune_4x4()/ angles =  [0.23715817204257358, 0.23825991332684696, 0.7617400866731531, 0.7628418279574264]
compute_tune_4x4()/  0.23715817204257358 0.23825991332684696
compute_tunes()/ 0.23715817204257358 0.23825991332684696

 Running simulation ..
Closed orbit computation: x_co=[-7.26017877e-08 -1.27250484e-07], y_co=[-5.51562832e-05  5.72598737e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5470119267098983e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -5.080849221229155e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -5.4869876651929705e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.7159213551566777e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.9376881169184024e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.471164690250162e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.009122002088257603}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00018757869370257982}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.014362559012162705}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.56640904e-03 -3.10258364e-04  3.98454341e-03  4.03982455e-04]
 [ 2.38900620e-03  4.00279420e-04 -6.11971608e-04  2.28790774e-04]
 [-6.16779912e-04 -2.27954402e-04 -2.49245646e-03  2.93698023e-05]
 [ 2.48541183e-04 -3.47871805e-06 -3.73270544e-03 -2.86176775e-04]
 [ 1.12272999e-03  3.85356679e-04  1.45132300e-03  6.94755488e-04]
 [-2.41473699e-03 -4.89172143e-04 -1.26602659e-03  1.23036001e-04]
 [ 1.02972019e-03 -2.83585793e-04 -3.81818293e-04 -1.29082769e-04]
 [-3.82158493e-04  2.45605928e-04  4.16492893e-04  3.54352412e-04]
 [-2.82265122e-03  4.76981506e-04  1.93345548e-04  5.33138782e-04]
 [-9.41355792e-04 -2.70613432e-04  1.26350831e-03  2.61873364e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.009122002088257603
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2027640125387401e-06, theta_kick=1.4421593066591582e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.280715434145442e-06, theta_kick=-6.331776499611733e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00018757869370257982
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.090125128531842e-06, theta_kick=7.302289178317186e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=3.10847848085527e-07, theta_kick=-3.7271826592589863e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.986770773044874e-06, theta_kick=-2.382212911822375e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.014362559012162705
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-7.256497462410132e-07, theta_kick=8.700813492976259e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01472644e-01 -6.31898867e+00 -5.20116892e-03 -2.23452417e-02]
 [ 1.80017658e-01  4.56168063e-01 -2.27152383e-04  4.37117927e-04]
 [-6.63872509e-03 -2.23516554e-02  3.83925572e-01 -5.12052322e+00]
 [-1.05806129e-03 -2.45530911e-03  2.12540698e-01 -2.30024346e-01]]
compute_tune_4x4()/ evals =  [0.08060006+0.99674652j 0.08060006-0.99674652j 0.07369826+0.99728059j
 0.07369826-0.99728059j]
compute_tune_4x4()/ angles =  [0.23715817204257358, 0.23825991332684696, 0.7617400866731531, 0.7628418279574264]
compute_tune_4x4()/  0.23715817204257358 0.23825991332684696
compute_tunes()/ 0.23715817204257358 0.23825991332684696

 Running simulation ..
Closed orbit computation: x_co=[-6.21405497e-10 -1.54669832e-09], y_co=[-3.62099076e-07 -3.32086500e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 42/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.09347214e-03 -4.36138294e-04 -1.91198255e-03  4.18887088e-04]
 [-1.95849270e-03  3.79511531e-04  4.69352480e-05 -3.79946297e-05]
 [-9.00904036e-05  3.13565856e-04  3.00045644e-03  2.90604089e-04]
 [ 8.27529752e-03 -5.63426925e-04 -5.62342671e-04  1.48921139e-04]
 [ 2.81653339e-04 -8.34055072e-04  6.28749125e-04  1.49722493e-04]
 [-2.63375345e-04 -2.16612039e-04  1.02260080e-03 -1.70365990e-04]
 [-8.57198642e-04  3.34916837e-05 -4.58427660e-03  1.23915184e-04]
 [ 1.81138983e-03  1.93306414e-04 -6.20025130e-04  1.09048793e-04]
 [ 1.81020523e-03 -1.63407687e-04  8.46644690e-04  2.31557936e-04]
 [ 1.60646745e-03 -6.30380124e-04  1.61642059e-03  3.01328380e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005626419666066567
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.444538227781209e-05, theta_kick=7.727243819590115e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0960171841007647e-05, theta_kick=-1.314165842868009e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007243170488778918
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.65125390849815e-05, theta_kick=1.0373178951436383e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.558288898545824e-05, theta_kick=-1.8684470220870738e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=6.0478381482043525e-05, theta_kick=-7.25158549779961e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005797047885103733
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.079938255829979e-05, theta_kick=-8.489112361007345e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01659697e-01 -6.32036599e+00  2.17175542e-03  6.87004715e-02]
 [ 1.80014831e-01  4.56209918e-01  1.90102118e-03 -4.08216266e-03]
 [ 9.21306821e-03  6.87046703e-02  3.84070954e-01 -5.11967288e+00]
 [ 2.58868989e-03  4.16675249e-03  2.12594785e-01 -2.29843695e-01]]
compute_tune_4x4()/ evals =  [0.0800468 +0.99679111j 0.0800468 -0.99679111j 0.07434194+0.99723281j
 0.07434194-0.99723281j]
compute_tune_4x4()/ angles =  [0.23724651133236319, 0.2381571873126843, 0.7618428126873157, 0.7627534886676368]
compute_tune_4x4()/  0.23724651133236319 0.2381571873126843
compute_tunes()/ 0.23724651133236319 0.2381571873126843

 Running simulation ..
Closed orbit computation: x_co=[5.01659695e-07 7.25167357e-08], y_co=[-3.19673437e-05  1.71458118e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.444538227781209e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.0960171841007647e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.65125390849815e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.558288898545824e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 6.0478381482043525e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.079938255829979e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005626419666066567}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.007243170488778918}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005797047885103733}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.09347214e-03 -4.36138294e-04 -1.91198255e-03  4.18887088e-04]
 [-1.95849270e-03  3.79511531e-04  4.69352480e-05 -3.79946297e-05]
 [-9.00904036e-05  3.13565856e-04  3.00045644e-03  2.90604089e-04]
 [ 8.27529752e-03 -5.63426925e-04 -5.62342671e-04  1.48921139e-04]
 [ 2.81653339e-04 -8.34055072e-04  6.28749125e-04  1.49722493e-04]
 [-2.63375345e-04 -2.16612039e-04  1.02260080e-03 -1.70365990e-04]
 [-8.57198642e-04  3.34916837e-05 -4.58427660e-03  1.23915184e-04]
 [ 1.81138983e-03  1.93306414e-04 -6.20025130e-04  1.09048793e-04]
 [ 1.81020523e-03 -1.63407687e-04  8.46644690e-04  2.31557936e-04]
 [ 1.60646745e-03 -6.30380124e-04  1.61642059e-03  3.01328380e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005626419666066567
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.146277131929723e-07, theta_kick=-3.772504664122703e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.619385476880807e-07, theta_kick=1.1534005129188857e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.007243170488778918
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.7344297701685407e-06, theta_kick=-3.27868418105618e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.322218147166595e-06, theta_kick=7.58057744047447e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.8834292978022595e-06, theta_kick=-4.656377847352645e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005797047885103733
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.0225118219641966e-06, theta_kick=1.2260301479274446e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01659697e-01 -6.32036599e+00  2.17175542e-03  6.87004715e-02]
 [ 1.80014831e-01  4.56209918e-01  1.90102118e-03 -4.08216266e-03]
 [ 9.21306821e-03  6.87046703e-02  3.84070954e-01 -5.11967288e+00]
 [ 2.58868989e-03  4.16675249e-03  2.12594785e-01 -2.29843695e-01]]
compute_tune_4x4()/ evals =  [0.0800468 +0.99679111j 0.0800468 -0.99679111j 0.07434194+0.99723281j
 0.07434194-0.99723281j]
compute_tune_4x4()/ angles =  [0.23724651133236319, 0.2381571873126843, 0.7618428126873157, 0.7627534886676368]
compute_tune_4x4()/  0.23724651133236319 0.2381571873126843
compute_tunes()/ 0.23724651133236319 0.2381571873126843

 Running simulation ..
Closed orbit computation: x_co=[1.01099569e-09 2.63929109e-10], y_co=[-5.39893998e-07 -4.02048475e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 43/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.14311313e-03  2.93196665e-04  4.30897014e-03  6.01028439e-04]
 [-1.88536841e-03 -1.08315696e-04  2.02124298e-03  3.27717865e-04]
 [-1.54704674e-03 -2.49350362e-04  4.40768631e-04 -2.53401522e-05]
 [-4.11219754e-04 -2.94539752e-04  1.92228175e-03  4.38449523e-04]
 [-1.22341140e-03  3.18871906e-04 -1.27009628e-03 -6.74552067e-05]
 [ 6.25266673e-03 -5.35726025e-04 -2.82714643e-03 -2.62903388e-04]
 [ 4.26433766e-03 -1.27674869e-04  6.02670665e-04 -3.37881075e-04]
 [ 2.21303378e-04  1.41515331e-04 -7.02563019e-04 -4.76409325e-04]
 [-1.69821965e-03 -2.23102832e-04  4.07569673e-03 -1.40824576e-04]
 [ 1.25044774e-03 -8.14561070e-06  1.14779816e-03 -3.51847280e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0018183936562183685
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.36507392174958e-05, theta_kick=7.631963126706039e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.638237135394569e-05, theta_kick=-4.362383218938583e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0035856868968123226
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=9.862831564642459e-06, theta_kick=-1.1825906148403898e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.835795007376442e-05, theta_kick=-2.201187288118233e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=0.00012197779838359102, theta_kick=-1.4625596984181818e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0072676851177821125
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.748194417410346e-05, theta_kick=-5.693263763721757e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647119e-01 -6.32003599e+00  1.97941261e-03  3.31507167e-02]
 [ 1.80001444e-01  4.56093564e-01  9.20971778e-04 -2.91323752e-03]
 [ 5.20051319e-03  3.31550348e-02  3.84082660e-01 -5.11954621e+00]
 [ 1.22737782e-03  8.45374388e-04  2.12579049e-01 -2.29825445e-01]]
compute_tune_4x4()/ evals =  [0.0784476 +0.99691824j 0.0784476 -0.99691824j 0.07590423+0.99711511j
 0.07590423-0.99711511j]
compute_tune_4x4()/ angles =  [0.23750183581464762, 0.2379078356230651, 0.7620921643769349, 0.7624981641853523]
compute_tune_4x4()/  0.23750183581464762 0.2379078356230651
compute_tunes()/ 0.23750183581464762 0.2379078356230651

 Running simulation ..
Closed orbit computation: x_co=[ 1.21911129e-07 -1.83782608e-08], y_co=[4.89186306e-05 1.99980085e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.36507392174958e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.638237135394569e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 9.862831564642459e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.835795007376442e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 0.00012197779838359102, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.748194417410346e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0018183936562183685}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0035856868968123226}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0072676851177821125}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.14311313e-03  2.93196665e-04  4.30897014e-03  6.01028439e-04]
 [-1.88536841e-03 -1.08315696e-04  2.02124298e-03  3.27717865e-04]
 [-1.54704674e-03 -2.49350362e-04  4.40768631e-04 -2.53401522e-05]
 [-4.11219754e-04 -2.94539752e-04  1.92228175e-03  4.38449523e-04]
 [-1.22341140e-03  3.18871906e-04 -1.27009628e-03 -6.74552067e-05]
 [ 6.25266673e-03 -5.35726025e-04 -2.82714643e-03 -2.62903388e-04]
 [ 4.26433766e-03 -1.27674869e-04  6.02670665e-04 -3.37881075e-04]
 [ 2.21303378e-04  1.41515331e-04 -7.02563019e-04 -4.76409325e-04]
 [-1.69821965e-03 -2.23102832e-04  4.07569673e-03 -1.40824576e-04]
 [ 1.25044774e-03 -8.14561070e-06  1.14779816e-03 -3.51847280e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0018183936562183685
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.2519811991064535e-06, theta_kick=1.5011725652171596e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.327070518891326e-06, theta_kick=-5.188320364040325e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0035856868968123226
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.932886789996207e-06, theta_kick=7.113754494107482e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.127822256337145e-06, theta_kick=-4.949414200252087e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.0160735827858765e-06, theta_kick=2.4173480832597465e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0072676851177821125
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.532308564353534e-07, theta_kick=3.03633325019983e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01647119e-01 -6.32003599e+00  1.97941261e-03  3.31507167e-02]
 [ 1.80001444e-01  4.56093564e-01  9.20971778e-04 -2.91323752e-03]
 [ 5.20051319e-03  3.31550348e-02  3.84082660e-01 -5.11954621e+00]
 [ 1.22737782e-03  8.45374388e-04  2.12579049e-01 -2.29825445e-01]]
compute_tune_4x4()/ evals =  [0.0784476 +0.99691824j 0.0784476 -0.99691824j 0.07590423+0.99711511j
 0.07590423-0.99711511j]
compute_tune_4x4()/ angles =  [0.23750183581464762, 0.2379078356230651, 0.7620921643769349, 0.7624981641853523]
compute_tune_4x4()/  0.23750183581464762 0.2379078356230651
compute_tunes()/ 0.23750183581464762 0.2379078356230651

 Running simulation ..
Closed orbit computation: x_co=[ 1.77701158e-09 -3.16249617e-10], y_co=[-1.26129648e-07 -1.02174728e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 44/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.53839790e-03 -2.28040624e-04 -2.40648821e-04 -3.49930396e-06]
 [-1.93679749e-03  7.82939203e-05 -2.41394186e-03 -6.29967117e-04]
 [ 1.21049390e-03  1.47932328e-04  1.11000152e-03 -4.78152821e-04]
 [-1.02554897e-03 -2.14582972e-04  5.42198853e-04 -7.37672721e-05]
 [ 2.74788277e-03 -7.45033213e-04  3.03802044e-03 -5.06211929e-04]
 [ 2.22105985e-03  1.53431517e-04  2.32105448e-03  6.76342579e-04]
 [ 1.78639437e-03  3.23122269e-04 -1.62184310e-03 -3.05352531e-04]
 [-6.10282335e-04 -3.35348583e-04 -3.61539006e-03  4.35785564e-04]
 [-3.03285105e-03  3.02114942e-04 -2.31780406e-03  6.19398599e-06]
 [-3.49032992e-03  8.35947995e-04  3.50972311e-03  6.88851604e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004981077421848375
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.168157721021184e-05, theta_kick=-3.798740313730168e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.4338246080470246e-05, theta_kick=-4.117284907350642e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=3.0861336479924396e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=3.480374954307235e-05, theta_kick=-4.173100524036468e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.8104130698578026e-06, theta_kick=3.369791016358181e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.196347208785132e-05, theta_kick=3.832540570226804e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0014215437845483845
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-6.161140261036024e-05, theta_kick=7.387438994230256e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686942e-01 -6.31991804e+00 -2.87108085e-03 -2.65513336e-02]
 [ 1.80002095e-01  4.56098964e-01 -2.67797409e-04 -2.69105685e-03]
 [-5.20672132e-03 -2.65513868e-02  3.84083406e-01 -5.11929806e+00]
 [-1.32584008e-03 -6.87933037e-03  2.12576140e-01 -2.29744992e-01]]
compute_tune_4x4()/ evals =  [0.08157532+0.99666718j 0.08157532-0.99666718j 0.0727999 +0.99734657j
 0.0727999 -0.99734657j]
compute_tune_4x4()/ angles =  [0.23700244250527047, 0.23840327680912612, 0.7615967231908739, 0.7629975574947295]
compute_tune_4x4()/  0.23700244250527047 0.23840327680912612
compute_tunes()/ 0.23700244250527047 0.23840327680912612

 Running simulation ..
Closed orbit computation: x_co=[-1.06663621e-08  4.75756751e-08], y_co=[ 3.28582877e-05 -1.25309020e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.168157721021184e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 3.4338246080470246e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 3.480374954307235e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.8104130698578026e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.196347208785132e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -6.161140261036024e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004981077421848375}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 3.0861336479924396e-05}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0014215437845483845}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.53839790e-03 -2.28040624e-04 -2.40648821e-04 -3.49930396e-06]
 [-1.93679749e-03  7.82939203e-05 -2.41394186e-03 -6.29967117e-04]
 [ 1.21049390e-03  1.47932328e-04  1.11000152e-03 -4.78152821e-04]
 [-1.02554897e-03 -2.14582972e-04  5.42198853e-04 -7.37672721e-05]
 [ 2.74788277e-03 -7.45033213e-04  3.03802044e-03 -5.06211929e-04]
 [ 2.22105985e-03  1.53431517e-04  2.32105448e-03  6.76342579e-04]
 [ 1.78639437e-03  3.23122269e-04 -1.62184310e-03 -3.05352531e-04]
 [-6.10282335e-04 -3.35348583e-04 -3.61539006e-03  4.35785564e-04]
 [-3.03285105e-03  3.02114942e-04 -2.31780406e-03  6.19398599e-06]
 [-3.49032992e-03  8.35947995e-04  3.50972311e-03  6.88851604e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004981077421848375
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.926831347272085e-06, theta_kick=2.3103432850187136e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.9270410859051394e-08, theta_kick=3.509632395886023e-09
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=3.0861336479924396e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.350966781533948e-06, theta_kick=-2.818897629368926e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.4785211753062847e-06, theta_kick=1.7728025205542277e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.5223309847765066e-07, theta_kick=3.024369756867026e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0014215437845483845
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.7257489231734726e-07, theta_kick=-4.467313145235044e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01686942e-01 -6.31991804e+00 -2.87108085e-03 -2.65513336e-02]
 [ 1.80002095e-01  4.56098964e-01 -2.67797409e-04 -2.69105685e-03]
 [-5.20672132e-03 -2.65513868e-02  3.84083406e-01 -5.11929806e+00]
 [-1.32584008e-03 -6.87933037e-03  2.12576140e-01 -2.29744992e-01]]
compute_tune_4x4()/ evals =  [0.08157532+0.99666718j 0.08157532-0.99666718j 0.0727999 +0.99734657j
 0.0727999 -0.99734657j]
compute_tune_4x4()/ angles =  [0.23700244250527047, 0.23840327680912612, 0.7615967231908739, 0.7629975574947295]
compute_tune_4x4()/  0.23700244250527047 0.23840327680912612
compute_tunes()/ 0.23700244250527047 0.23840327680912612

 Running simulation ..
Closed orbit computation: x_co=[ 1.50610977e-10 -4.53688998e-10], y_co=[1.65702835e-07 1.02146216e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 45/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.08470620e-03 -5.93566560e-04 -1.41218639e-04 -1.07783064e-04]
 [-8.16561169e-05  6.21836035e-04  3.76021793e-03 -4.99551497e-04]
 [-4.31559262e-04 -1.87463027e-04 -3.07882055e-03 -1.82616443e-04]
 [-3.71754330e-03  2.48386195e-04 -1.41150864e-04  1.26945424e-04]
 [ 2.17252983e-03  2.50958037e-04  3.77318923e-03 -2.99774649e-04]
 [-2.60144629e-03  1.42202046e-04  3.57354827e-03  1.07928468e-03]
 [ 9.39652544e-04  3.35336710e-05  1.99395762e-03  3.20958475e-04]
 [-8.01751992e-04 -1.96108740e-04 -1.47871640e-03  4.79464277e-04]
 [-1.31494935e-03 -8.77014108e-04 -1.87871242e-03  1.50437671e-04]
 [ 1.46627124e-03 -1.63475901e-04 -1.11072274e-03  4.76453980e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.016766886304164463
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.391820198480454e-05, theta_kick=2.8678824134529383e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.368490129033085e-05, theta_kick=5.2379840350692325e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003153735273535156
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.1843226869950955e-06, theta_kick=-2.619085089807052e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-4.114967123501698e-06, theta_kick=4.9340004122906e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.939269652633226e-05, theta_kick=-3.5242949075093867e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.018646084643865548
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-0.00011132106546679172, theta_kick=1.3347814610056449e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01273026e-01 -6.31752289e+00  6.51440802e-03 -1.40320935e-03]
 [ 1.80054250e-01  4.56406232e-01 -5.84793384e-04  1.05298974e-03]
 [ 5.13007519e-03 -1.38754175e-03  3.83656411e-01 -5.12183862e+00]
 [ 2.43255003e-04  1.11138542e-03  2.12490203e-01 -2.30275236e-01]]
compute_tune_4x4()/ evals =  [0.08058927+0.99674739j 0.08058927-0.99674739j 0.07366792+0.99728283j
 0.07366792-0.99728283j]
compute_tune_4x4()/ angles =  [0.23715989427962453, 0.23826475619050136, 0.7617352438094986, 0.7628401057203755]
compute_tune_4x4()/  0.23715989427962453 0.23826475619050136
compute_tunes()/ 0.23715989427962453 0.23826475619050136

 Running simulation ..
Closed orbit computation: x_co=[2.14428087e-07 3.29059669e-08], y_co=[ 2.17734313e-05 -3.83819664e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -2.391820198480454e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.368490129033085e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.1843226869950955e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -4.114967123501698e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.939269652633226e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -0.00011132106546679172, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.016766886304164463}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.003153735273535156}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.018646084643865548}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.08470620e-03 -5.93566560e-04 -1.41218639e-04 -1.07783064e-04]
 [-8.16561169e-05  6.21836035e-04  3.76021793e-03 -4.99551497e-04]
 [-4.31559262e-04 -1.87463027e-04 -3.07882055e-03 -1.82616443e-04]
 [-3.71754330e-03  2.48386195e-04 -1.41150864e-04  1.26945424e-04]
 [ 2.17252983e-03  2.50958037e-04  3.77318923e-03 -2.99774649e-04]
 [-2.60144629e-03  1.42202046e-04  3.57354827e-03  1.07928468e-03]
 [ 9.39652544e-04  3.35336710e-05  1.99395762e-03  3.20958475e-04]
 [-8.01751992e-04 -1.96108740e-04 -1.47871640e-03  4.79464277e-04]
 [-1.31494935e-03 -8.77014108e-04 -1.87871242e-03  1.50437671e-04]
 [ 1.46627124e-03 -1.63475901e-04 -1.11072274e-03  4.76453980e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.016766886304164463
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.227304839845232e-06, theta_kick=3.869659934690667e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.684478947669452e-06, theta_kick=-5.616866518121569e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.003153735273535156
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.019968669790593e-06, theta_kick=9.616244197263792e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.540413364056734e-06, theta_kick=-1.0240276968125498e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.511738343199282e-06, theta_kick=6.60878166011718e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.018646084643865548
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.5901849540543213e-06, theta_kick=-4.3047668454832113e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01273026e-01 -6.31752289e+00  6.51440802e-03 -1.40320935e-03]
 [ 1.80054250e-01  4.56406232e-01 -5.84793384e-04  1.05298974e-03]
 [ 5.13007519e-03 -1.38754175e-03  3.83656411e-01 -5.12183862e+00]
 [ 2.43255003e-04  1.11138542e-03  2.12490203e-01 -2.30275236e-01]]
compute_tune_4x4()/ evals =  [0.08058927+0.99674739j 0.08058927-0.99674739j 0.07366792+0.99728283j
 0.07366792-0.99728283j]
compute_tune_4x4()/ angles =  [0.23715989427962453, 0.23826475619050136, 0.7617352438094986, 0.7628401057203755]
compute_tune_4x4()/  0.23715989427962453 0.23826475619050136
compute_tunes()/ 0.23715989427962453 0.23826475619050136

 Running simulation ..
Closed orbit computation: x_co=[-3.96276653e-09  4.11718086e-10], y_co=[-1.03493695e-06  2.55113122e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 46/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.68279361e-04  6.27093168e-05  1.83061725e-03 -2.57750748e-04]
 [ 2.73189117e-04 -1.79970137e-04  9.32951491e-04  8.04377070e-04]
 [-2.67098513e-03 -2.31694320e-04  2.51360361e-03 -1.90079902e-04]
 [-1.68318273e-03  9.45413078e-05 -2.07737992e-03  7.28643004e-04]
 [ 1.72534332e-03  5.81449742e-04  2.42921983e-05  3.63498119e-04]
 [ 1.34693684e-03  1.98393992e-04 -2.35973631e-03 -2.61110330e-04]
 [-3.20340468e-03  2.55341382e-04  1.47261833e-03  5.04476666e-04]
 [ 3.34574155e-04  3.55036787e-04 -2.73424798e-03 -3.52249108e-04]
 [ 3.55841508e-03 -6.29970328e-05  8.55618482e-04 -1.12671766e-04]
 [ 3.66338516e-03 -3.89577553e-04 -3.42214845e-03 -2.58062741e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012640380123777788
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=5.177356940541115e-05, theta_kick=-6.207845776776817e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.0865660503983055e-05, theta_kick=2.50187120430163e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-2.2241679691527795e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=6.74678638875985e-05, theta_kick=-8.089650737099983e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.335053292165948e-06, theta_kick=-6.396929635913832e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.8685087356063956e-05, theta_kick=2.2404122791642854e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0016297355893365511
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.6139694475569976e-05, theta_kick=-1.935210095407551e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01579308e-01 -6.31933892e+00  6.03005477e-03  5.93084152e-02]
 [ 1.80013681e-01  4.56161329e-01  6.09873520e-04  6.22386604e-03]
 [ 1.13201018e-02  5.93088779e-02  3.84030701e-01 -5.11985023e+00]
 [ 2.96019239e-03  1.56293038e-02  2.12561900e-01 -2.29894254e-01]]
compute_tune_4x4()/ evals =  [0.08692692+0.99621469j 0.08692692-0.99621469j 0.06743231+0.99772385j
 0.06743231-0.99772385j]
compute_tune_4x4()/ angles =  [0.23614766816959132, 0.23925966373039415, 0.7607403362696059, 0.7638523318304087]
compute_tune_4x4()/  0.23614766816959132 0.23925966373039415
compute_tunes()/ 0.23614766816959132 0.23925966373039415

 Running simulation ..
Closed orbit computation: x_co=[ 3.78625021e-09 -3.09934723e-08], y_co=[ 2.04754459e-05 -4.09563392e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 5.177356940541115e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.0865660503983055e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 6.74678638875985e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.335053292165948e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.8685087356063956e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.6139694475569976e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.012640380123777788}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -2.2241679691527795e-05}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0016297355893365511}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.68279361e-04  6.27093168e-05  1.83061725e-03 -2.57750748e-04]
 [ 2.73189117e-04 -1.79970137e-04  9.32951491e-04  8.04377070e-04]
 [-2.67098513e-03 -2.31694320e-04  2.51360361e-03 -1.90079902e-04]
 [-1.68318273e-03  9.45413078e-05 -2.07737992e-03  7.28643004e-04]
 [ 1.72534332e-03  5.81449742e-04  2.42921983e-05  3.63498119e-04]
 [ 1.34693684e-03  1.98393992e-04 -2.35973631e-03 -2.61110330e-04]
 [-3.20340468e-03  2.55341382e-04  1.47261833e-03  5.04476666e-04]
 [ 3.34574155e-04  3.55036787e-04 -2.73424798e-03 -3.52249108e-04]
 [ 3.55841508e-03 -6.29970328e-05  8.55618482e-04 -1.12671766e-04]
 [ 3.66338516e-03 -3.89577553e-04 -3.42214845e-03 -2.58062741e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.012640380123777788
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.118096330336517e-06, theta_kick=6.136790075380772e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.503840969631891e-06, theta_kick=-1.139546291747881e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-2.2241679691527795e-05
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.1655264783600586e-05, theta_kick=1.3975101020662545e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0587303340381448e-05, theta_kick=-1.2694575066746862e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.4831008912757505e-06, theta_kick=7.773481904092522e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0016297355893365511
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.57049406797274e-06, theta_kick=-4.281156732175134e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01579308e-01 -6.31933892e+00  6.03005477e-03  5.93084152e-02]
 [ 1.80013681e-01  4.56161329e-01  6.09873520e-04  6.22386604e-03]
 [ 1.13201018e-02  5.93088779e-02  3.84030701e-01 -5.11985023e+00]
 [ 2.96019239e-03  1.56293038e-02  2.12561900e-01 -2.29894254e-01]]
compute_tune_4x4()/ evals =  [0.08692692+0.99621469j 0.08692692-0.99621469j 0.06743231+0.99772385j
 0.06743231-0.99772385j]
compute_tune_4x4()/ angles =  [0.23614766816959132, 0.23925966373039415, 0.7607403362696059, 0.7638523318304087]
compute_tune_4x4()/  0.23614766816959132 0.23925966373039415
compute_tunes()/ 0.23614766816959132 0.23925966373039415

 Running simulation ..
Closed orbit computation: x_co=[-5.50147095e-10  1.07208108e-09], y_co=[-6.57237330e-07  1.81240239e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 47/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.17372966e-03  9.38082735e-05 -2.77286228e-03 -2.98478106e-04]
 [ 4.23597158e-03 -1.84800838e-04  1.69722891e-03  1.88472179e-05]
 [-4.76470618e-04  3.59237845e-06 -1.49322197e-03 -6.46117358e-04]
 [-3.26098103e-03 -3.53860031e-04 -4.09866007e-03  9.69869958e-05]
 [-1.06120519e-03 -4.07588307e-04 -1.04793621e-03  4.91979203e-04]
 [-1.34801901e-03  1.95841162e-05  5.93214500e-04  4.54143700e-04]
 [-1.82309030e-03  3.26484263e-04 -2.71774899e-03 -8.77993990e-06]
 [-1.30154315e-03 -5.64210276e-05  1.84578351e-03 -4.99650846e-05]
 [ 1.40554782e-03 -2.24725022e-05 -2.60266156e-03 -8.18550803e-04]
 [ 1.51640278e-03  1.42302736e-04 -6.57505550e-04 -8.22112078e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=8.292043824895342e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-6.539591214061928e-05, theta_kick=7.841215926638064e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=5.729681069013984e-05, theta_kick=-6.870103188759285e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0005094264222539833
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.946214607734947e-05, theta_kick=8.328772675408003e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5327803576011373e-05, theta_kick=-3.036898948055566e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.4879020836428706e-05, theta_kick=-2.9830882089737553e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0016846794989478961
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.015891610585884e-05, theta_kick=-8.412318023517892e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01706589e-01 -6.32003381e+00  7.55328440e-04  8.15385954e-03]
 [ 1.79999991e-01  4.56087381e-01  1.65044385e-04 -1.55641473e-04]
 [ 1.49660689e-03  8.15388683e-03  3.84092955e-01 -5.11920982e+00]
 [ 3.44689553e-04  9.00203287e-04  2.12578815e-01 -2.29720680e-01]]
compute_tune_4x4()/ evals =  [0.07793325+0.99695858j 0.07793325-0.99695858j 0.07644328+0.99707393j
 0.07644328-0.99707393j]
compute_tune_4x4()/ angles =  [0.23758394735461627, 0.2378217937910801, 0.76217820620892, 0.7624160526453837]
compute_tune_4x4()/  0.23758394735461627 0.2378217937910801
compute_tunes()/ 0.23758394735461627 0.2378217937910801

 Running simulation ..
Closed orbit computation: x_co=[2.90271447e-08 6.35933101e-09], y_co=[-1.55826460e-05  1.16709923e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -6.539591214061928e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 5.729681069013984e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -6.946214607734947e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.5327803576011373e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 2.4879020836428706e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.015891610585884e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 8.292043824895342e-05}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0005094264222539833}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0016846794989478961}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.17372966e-03  9.38082735e-05 -2.77286228e-03 -2.98478106e-04]
 [ 4.23597158e-03 -1.84800838e-04  1.69722891e-03  1.88472179e-05]
 [-4.76470618e-04  3.59237845e-06 -1.49322197e-03 -6.46117358e-04]
 [-3.26098103e-03 -3.53860031e-04 -4.09866007e-03  9.69869958e-05]
 [-1.06120519e-03 -4.07588307e-04 -1.04793621e-03  4.91979203e-04]
 [-1.34801901e-03  1.95841162e-05  5.93214500e-04  4.54143700e-04]
 [-1.82309030e-03  3.26484263e-04 -2.71774899e-03 -8.77993990e-06]
 [-1.30154315e-03 -5.64210276e-05  1.84578351e-03 -4.99650846e-05]
 [ 1.40554782e-03 -2.24725022e-05 -2.60266156e-03 -8.18550803e-04]
 [ 1.51640278e-03  1.42302736e-04 -6.57505550e-04 -8.22112078e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=8.292043824895342e-05
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.4919880344417953e-06, theta_kick=-1.788949791366522e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.402454614580192e-06, theta_kick=4.0796711048454125e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0005094264222539833
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.4259155229221431e-06, theta_kick=-1.7097263639867128e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.1763376370027417e-06, theta_kick=-2.6095107144178976e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.661375833567265e-06, theta_kick=4.3901273886725056e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0016846794989478961
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=8.454881486183523e-07, theta_kick=-1.0137721028302753e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01706589e-01 -6.32003381e+00  7.55328440e-04  8.15385954e-03]
 [ 1.79999991e-01  4.56087381e-01  1.65044385e-04 -1.55641473e-04]
 [ 1.49660689e-03  8.15388683e-03  3.84092955e-01 -5.11920982e+00]
 [ 3.44689553e-04  9.00203287e-04  2.12578815e-01 -2.29720680e-01]]
compute_tune_4x4()/ evals =  [0.07793325+0.99695858j 0.07793325-0.99695858j 0.07644328+0.99707393j
 0.07644328-0.99707393j]
compute_tune_4x4()/ angles =  [0.23758394735461627, 0.2378217937910801, 0.76217820620892, 0.7624160526453837]
compute_tune_4x4()/  0.23758394735461627 0.2378217937910801
compute_tunes()/ 0.23758394735461627 0.2378217937910801

 Running simulation ..
Closed orbit computation: x_co=[-2.31995887e-10 -3.07777694e-11], y_co=[-6.40887073e-07 -1.10731541e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 48/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.54841748e-03  3.02523852e-04 -2.93529535e-03 -4.68171827e-04]
 [ 1.71203004e-03 -2.14483532e-04 -2.74205693e-04  1.06768164e-03]
 [-3.36291072e-03  6.73450408e-04  3.52128418e-03  3.28814212e-04]
 [-1.63819642e-03  1.53622795e-05 -1.24601412e-03  7.29700114e-04]
 [-9.85681464e-05 -5.34763426e-05  2.36307666e-03  5.15007462e-05]
 [-2.98893580e-03  5.38684519e-04 -2.07307142e-03 -5.10861105e-04]
 [ 2.18342470e-03  9.41508330e-05 -2.49533523e-03 -5.02583581e-05]
 [ 1.99151532e-03  3.19088266e-04  6.27820535e-04 -1.40987803e-04]
 [ 5.73675861e-03 -8.28751445e-04 -3.12585768e-04 -4.38439838e-04]
 [-2.45504765e-04 -3.05859996e-04 -2.72544157e-04  2.27724915e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002691582589310089
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-5.760742528128641e-06, theta_kick=6.907347046967234e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.3673613036487506e-05, theta_kick=-5.236630530959831e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008548095184595667
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.779761197069291e-05, theta_kick=2.134000641211944e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-3.1480438874725526e-05, theta_kick=3.7746230704951258e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.806075904517931e-05, theta_kick=8.160741097342265e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00278425265129786
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.266815531689418e-05, theta_kick=-5.116072367209725e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01669534e-01 -6.32029765e+00  3.65229642e-03 -2.53635467e-02]
 [ 1.79992397e-01  4.56129039e-01 -1.67363868e-03  1.01736092e-02]
 [ 2.06011088e-04 -2.53683594e-02  3.84081427e-01 -5.11912989e+00]
 [-2.83021379e-04  9.16169921e-03  2.12593081e-01 -2.29863501e-01]]
compute_tune_4x4()/ evals =  [0.0829362 +0.99655486j 0.0829362 -0.99655486j 0.07140252+0.99744758j
 0.07140252-0.99744758j]
compute_tune_4x4()/ angles =  [0.23678511525896204, 0.23862625758045294, 0.761373742419547, 0.7632148847410379]
compute_tune_4x4()/  0.23678511525896204 0.23862625758045294
compute_tunes()/ 0.23678511525896204 0.23862625758045294

 Running simulation ..
Closed orbit computation: x_co=[-1.07726110e-07 -4.75364776e-09], y_co=[-4.23378821e-05 -7.31904803e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -5.760742528128641e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.3673613036487506e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.779761197069291e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -3.1480438874725526e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.806075904517931e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.266815531689418e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.002691582589310089}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.008548095184595667}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00278425265129786}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.54841748e-03  3.02523852e-04 -2.93529535e-03 -4.68171827e-04]
 [ 1.71203004e-03 -2.14483532e-04 -2.74205693e-04  1.06768164e-03]
 [-3.36291072e-03  6.73450408e-04  3.52128418e-03  3.28814212e-04]
 [-1.63819642e-03  1.53622795e-05 -1.24601412e-03  7.29700114e-04]
 [-9.85681464e-05 -5.34763426e-05  2.36307666e-03  5.15007462e-05]
 [-2.98893580e-03  5.38684519e-04 -2.07307142e-03 -5.10861105e-04]
 [ 2.18342470e-03  9.41508330e-05 -2.49533523e-03 -5.02583581e-05]
 [ 1.99151532e-03  3.19088266e-04  6.27820535e-04 -1.40987803e-04]
 [ 5.73675861e-03 -8.28751445e-04 -3.12585768e-04 -4.38439838e-04]
 [-2.45504765e-04 -3.05859996e-04 -2.72544157e-04  2.27724915e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.002691582589310089
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.499012700424966e-06, theta_kick=1.7973726301929167e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.5710811369891625e-07, theta_kick=-3.082823023660514e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.008548095184595667
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.4105132146561896e-06, theta_kick=2.8902960431976995e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=4.4107904702720294e-06, theta_kick=-5.288703735822365e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.333956524725383e-06, theta_kick=3.9975393177760794e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00278425265129786
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=9.60943822681208e-07, theta_kick=-1.1522078002077697e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01669534e-01 -6.32029765e+00  3.65229642e-03 -2.53635467e-02]
 [ 1.79992397e-01  4.56129039e-01 -1.67363868e-03  1.01736092e-02]
 [ 2.06011088e-04 -2.53683594e-02  3.84081427e-01 -5.11912989e+00]
 [-2.83021379e-04  9.16169921e-03  2.12593081e-01 -2.29863501e-01]]
compute_tune_4x4()/ evals =  [0.0829362 +0.99655486j 0.0829362 -0.99655486j 0.07140252+0.99744758j
 0.07140252-0.99744758j]
compute_tune_4x4()/ angles =  [0.23678511525896204, 0.23862625758045294, 0.761373742419547, 0.7632148847410379]
compute_tune_4x4()/  0.23678511525896204 0.23862625758045294
compute_tunes()/ 0.23678511525896204 0.23862625758045294

 Running simulation ..
Closed orbit computation: x_co=[ 1.60077038e-10 -3.57634706e-11], y_co=[-3.01192484e-07  1.31940241e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 49/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-1.34576774e-03  8.01080998e-04 -2.35850953e-03  5.76846376e-05]
 [ 3.51161419e-03 -2.26213416e-04 -2.61448226e-03 -6.65266499e-04]
 [ 2.02955638e-03 -8.93245012e-04 -1.24056204e-03 -1.26044478e-04]
 [ 3.57985107e-03 -1.45480428e-04 -8.00716991e-04  8.98638775e-04]
 [-4.46349754e-03  6.60637824e-04  5.58376383e-04 -1.19857847e-04]
 [ 5.30566205e-04  2.99158200e-06 -2.10755788e-03 -2.04717897e-04]
 [ 8.06144972e-04 -4.66645398e-04  3.80551450e-03 -2.48711144e-04]
 [ 9.46725433e-04 -1.58185783e-04 -1.96994702e-03 -1.04786576e-05]
 [ 1.84216614e-03  2.76820357e-04 -1.27604178e-03  3.20403493e-04]
 [-2.20213346e-04 -4.48452806e-04 -3.58084718e-03  3.35475936e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.010570855983639682
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.203736718965103e-05, theta_kick=3.84140087097292e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.0853983586403524e-05, theta_kick=-4.898546350657015e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015993795574253712
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-0.0001214453106255166, theta_kick=1.4561749698431378e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.0354208392662662e-05, theta_kick=2.440546171746466e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.8311486276097025e-05, theta_kick=-5.792728983015312e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008769207750194406
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.501428954457487e-06, theta_kick=-6.59642031511105e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01721620e-01 -6.32084948e+00  4.42509677e-03 -8.70839940e-02]
 [ 1.80045438e-01  4.56680573e-01 -3.55854743e-03  1.36000983e-02]
 [-5.85982004e-03 -8.70504025e-02  3.83855243e-01 -5.11934470e+00]
 [-2.52431591e-03  5.11415969e-03  2.12624978e-01 -2.29906573e-01]]
compute_tune_4x4()/ evals =  [0.08152972+0.99667091j 0.08152972-0.99667091j 0.07292409+0.99733749j
 0.07292409-0.99733749j]
compute_tune_4x4()/ angles =  [0.2370097232245367, 0.23838345924820137, 0.7616165407517986, 0.7629902767754633]
compute_tune_4x4()/  0.2370097232245367 0.23838345924820137
compute_tunes()/ 0.2370097232245367 0.23838345924820137

 Running simulation ..
Closed orbit computation: x_co=[-8.20985834e-07  9.42728135e-08], y_co=[-4.28247048e-05  4.52861762e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -3.203736718965103e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 4.0853983586403524e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -0.0001214453106255166, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.0354208392662662e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.8311486276097025e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.501428954457487e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.010570855983639682}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.015993795574253712}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0008769207750194406}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-1.34576774e-03  8.01080998e-04 -2.35850953e-03  5.76846376e-05]
 [ 3.51161419e-03 -2.26213416e-04 -2.61448226e-03 -6.65266499e-04]
 [ 2.02955638e-03 -8.93245012e-04 -1.24056204e-03 -1.26044478e-04]
 [ 3.57985107e-03 -1.45480428e-04 -8.00716991e-04  8.98638775e-04]
 [-4.46349754e-03  6.60637824e-04  5.58376383e-04 -1.19857847e-04]
 [ 5.30566205e-04  2.99158200e-06 -2.10755788e-03 -2.04717897e-04]
 [ 8.06144972e-04 -4.66645398e-04  3.80551450e-03 -2.48711144e-04]
 [ 9.46725433e-04 -1.58185783e-04 -1.96994702e-03 -1.04786576e-05]
 [ 1.84216614e-03  2.76820357e-04 -1.27604178e-03  3.20403493e-04]
 [-2.20213346e-04 -4.48452806e-04 -3.58084718e-03  3.35475936e-06]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.010570855983639682
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.764719394746678e-07, theta_kick=-1.1708265965095564e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-5.165102271148021e-06, theta_kick=6.193151967075961e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.015993795574253712
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.083001264157819e-05, theta_kick=-1.298559265114798e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0054166343169022e-05, theta_kick=1.2055323747087468e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.7334110999921215e-06, theta_kick=-4.476500383540386e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0008769207750194406
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.280640878568822e-07, theta_kick=-6.33168710467011e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01721620e-01 -6.32084948e+00  4.42509677e-03 -8.70839940e-02]
 [ 1.80045438e-01  4.56680573e-01 -3.55854743e-03  1.36000983e-02]
 [-5.85982004e-03 -8.70504025e-02  3.83855243e-01 -5.11934470e+00]
 [-2.52431591e-03  5.11415969e-03  2.12624978e-01 -2.29906573e-01]]
compute_tune_4x4()/ evals =  [0.08152972+0.99667091j 0.08152972-0.99667091j 0.07292409+0.99733749j
 0.07292409-0.99733749j]
compute_tune_4x4()/ angles =  [0.2370097232245367, 0.23838345924820137, 0.7616165407517986, 0.7629902767754633]
compute_tune_4x4()/  0.2370097232245367 0.23838345924820137
compute_tunes()/ 0.2370097232245367 0.23838345924820137

 Running simulation ..
Closed orbit computation: x_co=[ 1.98210634e-08 -2.15824731e-09], y_co=[-1.72855293e-07  1.74913549e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 50/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.99731788e-04  2.15908987e-04  1.15977222e-03  6.32317310e-04]
 [ 4.71303526e-03 -8.16085357e-04  2.02805854e-03 -5.12678546e-04]
 [-2.83933015e-03 -3.49647002e-04 -4.32966901e-04  1.93531500e-04]
 [ 7.81257789e-04  3.69340341e-05 -3.89589119e-03  1.95041532e-04]
 [-3.74502396e-03 -7.58787107e-05  3.87550871e-03  8.46642625e-04]
 [-4.88261192e-03  7.21745586e-04  2.04708234e-03 -2.58326292e-04]
 [ 2.42893024e-03 -6.55428874e-04  3.21892540e-03 -3.17505776e-04]
 [-2.63647354e-04  2.26963974e-04  2.56108938e-03  1.56358034e-05]
 [ 9.67026280e-04  4.14129571e-04  1.73758718e-03 -5.04004580e-05]
 [ 6.70028581e-04  1.49236526e-04 -1.13456641e-03 -8.85283930e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009224189440809305
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=3.2371691350890536e-05, theta_kick=-3.8814875958454795e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.58673934713854e-05, theta_kick=5.499673059500139e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0012096766667050202
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.11890580234483e-06, theta_kick=9.734873541839952e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.5721208621432795e-05, theta_kick=3.0840696932413674e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.757639320838583e-05, theta_kick=6.903626184664076e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005944241679226173
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=0.00014515673023652442, theta_kick=-1.7404838127219396e-05
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01593096e-01 -6.31938470e+00 -7.95285482e-03 -5.95782583e-02]
 [ 1.80006765e-01  4.56128220e-01 -4.04895977e-04 -7.19841750e-03]
 [-1.29069458e-02 -5.95787295e-02  3.84037410e-01 -5.11956315e+00]
 [-3.09830565e-03 -1.68682885e-02  2.12563593e-01 -2.29836624e-01]]
compute_tune_4x4()/ evals =  [0.08835386+0.99608915j 0.08835386-0.99608915j 0.0660141 +0.99781869j
 0.0660141 -0.99781869j]
compute_tune_4x4()/ angles =  [0.23591968691164886, 0.23948588396147488, 0.7605141160385251, 0.7640803130883511]
compute_tune_4x4()/  0.23591968691164886 0.23948588396147488
compute_tunes()/ 0.23591968691164886 0.23948588396147488

 Running simulation ..
Closed orbit computation: x_co=[ 7.29934885e-08 -3.62681959e-09], y_co=[-8.41459690e-05  2.70262208e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 3.2371691350890536e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.58673934713854e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -8.11890580234483e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.5721208621432795e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -5.757639320838583e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 0.00014515673023652442, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009224189440809305}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.0012096766667050202}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.005944241679226173}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.99731788e-04  2.15908987e-04  1.15977222e-03  6.32317310e-04]
 [ 4.71303526e-03 -8.16085357e-04  2.02805854e-03 -5.12678546e-04]
 [-2.83933015e-03 -3.49647002e-04 -4.32966901e-04  1.93531500e-04]
 [ 7.81257789e-04  3.69340341e-05 -3.89589119e-03  1.95041532e-04]
 [-3.74502396e-03 -7.58787107e-05  3.87550871e-03  8.46642625e-04]
 [-4.88261192e-03  7.21745586e-04  2.04708234e-03 -2.58326292e-04]
 [ 2.42893024e-03 -6.55428874e-04  3.21892540e-03 -3.17505776e-04]
 [-2.63647354e-04  2.26963974e-04  2.56108938e-03  1.56358034e-05]
 [ 9.67026280e-04  4.14129571e-04  1.73758718e-03 -5.04004580e-05]
 [ 6.70028581e-04  1.49236526e-04 -1.13456641e-03 -8.85283930e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009224189440809305
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.0843736375171957e-06, theta_kick=-2.499242418764675e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-8.191673675869636e-06, theta_kick=9.822124960186005e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.0012096766667050202
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.0329110105434506e-05, theta_kick=-1.238499166317527e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.266466429374902e-06, theta_kick=9.911804285817482e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.582738421938001e-06, theta_kick=-5.494875799644463e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.005944241679226173
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-2.397216353526631e-06, theta_kick=2.874352606390947e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01593096e-01 -6.31938470e+00 -7.95285482e-03 -5.95782583e-02]
 [ 1.80006765e-01  4.56128220e-01 -4.04895977e-04 -7.19841750e-03]
 [-1.29069458e-02 -5.95787295e-02  3.84037410e-01 -5.11956315e+00]
 [-3.09830565e-03 -1.68682885e-02  2.12563593e-01 -2.29836624e-01]]
compute_tune_4x4()/ evals =  [0.08835386+0.99608915j 0.08835386-0.99608915j 0.0660141 +0.99781869j
 0.0660141 -0.99781869j]
compute_tune_4x4()/ angles =  [0.23591968691164886, 0.23948588396147488, 0.7605141160385251, 0.7640803130883511]
compute_tune_4x4()/  0.23591968691164886 0.23948588396147488
compute_tunes()/ 0.23591968691164886 0.23948588396147488

 Running simulation ..
Closed orbit computation: x_co=[-2.51193249e-09 -1.26109912e-09], y_co=[5.42336604e-07 6.72170878e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
Completed benchmarking for noise_level=4e-05 meters.
Running evaluation for noise_level= 5e-05
	-------------[Run 1/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-7.99651052e-05 -9.86220207e-05  6.37619472e-04  3.04261329e-04]
 [ 3.27933151e-04 -3.28722392e-04 -1.38051635e-03 -6.97097522e-05]
 [-3.35328771e-03  1.39770236e-04 -1.41043488e-03  1.73850443e-04]
 [ 4.87538489e-03 -9.08292644e-05 -1.48801832e-03 -2.77536209e-04]
 [-2.47410138e-03  5.83245386e-04  2.83581441e-03 -1.38175898e-04]
 [-3.97008503e-04  1.98043635e-04 -9.20049347e-04 -7.11144243e-05]
 [-1.05017322e-03  2.99202159e-04 -3.40338013e-03 -1.97168319e-04]
 [-1.44143713e-04 -4.13843475e-04  8.21849481e-04  2.00825742e-04]
 [ 2.44731781e-03 -5.06311333e-04  2.76769545e-03 -2.38391627e-04]
 [ 3.74089559e-03 -7.47550277e-04  3.07853800e-03  2.01534496e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004324135701364047
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.48005477194048e-05, theta_kick=-7.769829492395166e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.001521903790159e-05, theta_kick=4.797975325326402e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0024049047021733475
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.743263557084475e-05, theta_kick=-2.0902385975970062e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.5948748759229162e-05, theta_kick=-3.1113526119137424e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.25633278680776e-05, theta_kick=-9.899653667087453e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00739021942608605
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-5.5856676845645884e-05, theta_kick=6.697425722105793e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01638959e-01 -6.31989380e+00 -5.08500737e-03 -5.57713376e-02]
 [ 1.80008130e-01  4.56125053e-01 -9.60552307e-04 -1.25745810e-03]
 [-1.01705152e-02 -5.57731409e-02  3.84068796e-01 -5.11959793e+00]
 [-2.49155771e-03 -9.02460637e-03  2.12576472e-01 -2.29799684e-01]]
compute_tune_4x4()/ evals =  [0.08353808+0.99650459j 0.08353808-0.99650459j 0.07083952+0.99748773j
 0.07083952-0.99748773j]
compute_tune_4x4()/ angles =  [0.23668898900453894, 0.2387160885677319, 0.761283911432268, 0.7633110109954611]
compute_tune_4x4()/  0.23668898900453894 0.2387160885677319
compute_tunes()/ 0.23668898900453894 0.2387160885677319

 Running simulation ..
Closed orbit computation: x_co=[ 3.41425975e-08 -1.89988747e-09], y_co=[5.07238785e-05 1.61093311e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 6.48005477194048e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.001521903790159e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 1.743263557084475e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.5948748759229162e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 8.25633278680776e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -5.5856676845645884e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004324135701364047}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0024049047021733475}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.00739021942608605}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-7.99651052e-05 -9.86220207e-05  6.37619472e-04  3.04261329e-04]
 [ 3.27933151e-04 -3.28722392e-04 -1.38051635e-03 -6.97097522e-05]
 [-3.35328771e-03  1.39770236e-04 -1.41043488e-03  1.73850443e-04]
 [ 4.87538489e-03 -9.08292644e-05 -1.48801832e-03 -2.77536209e-04]
 [-2.47410138e-03  5.83245386e-04  2.83581441e-03 -1.38175898e-04]
 [-3.97008503e-04  1.98043635e-04 -9.20049347e-04 -7.11144243e-05]
 [-1.05017322e-03  2.99202159e-04 -3.40338013e-03 -1.97168319e-04]
 [-1.44143713e-04 -4.13843475e-04  8.21849481e-04  2.00825742e-04]
 [ 2.44731781e-03 -5.06311333e-04  2.76769545e-03 -2.38391627e-04]
 [ 3.74089559e-03 -7.47550277e-04  3.07853800e-03  2.01534496e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004324135701364047
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.4432493234679564e-06, theta_kick=5.327623122112601e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.0183176873236916e-05, theta_kick=-1.2210012226834821e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0024049047021733475
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.3514522367654255e-05, theta_kick=1.6204420821028001e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=8.511752627792263e-06, theta_kick=-1.0205911666945373e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.3365182470719514e-06, theta_kick=2.8015732929033107e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.00739021942608605
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.7412988375198297e-06, theta_kick=-2.0878828249137617e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01638959e-01 -6.31989380e+00 -5.08500737e-03 -5.57713376e-02]
 [ 1.80008130e-01  4.56125053e-01 -9.60552307e-04 -1.25745810e-03]
 [-1.01705152e-02 -5.57731409e-02  3.84068796e-01 -5.11959793e+00]
 [-2.49155771e-03 -9.02460637e-03  2.12576472e-01 -2.29799684e-01]]
compute_tune_4x4()/ evals =  [0.08353808+0.99650459j 0.08353808-0.99650459j 0.07083952+0.99748773j
 0.07083952-0.99748773j]
compute_tune_4x4()/ angles =  [0.23668898900453894, 0.2387160885677319, 0.761283911432268, 0.7633110109954611]
compute_tune_4x4()/  0.23668898900453894 0.2387160885677319
compute_tunes()/ 0.23668898900453894 0.2387160885677319

 Running simulation ..
Closed orbit computation: x_co=[-6.67123233e-09 -7.41261280e-10], y_co=[-5.49695164e-07  2.26119057e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 2/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.61215062e-03  2.64232925e-04 -4.58466272e-03 -6.31403049e-04]
 [-5.92114362e-06 -4.52798206e-04  1.64559255e-03  1.46006482e-04]
 [-3.66939294e-05  2.08351284e-06 -3.61999390e-04 -7.15132928e-04]
 [ 8.71673446e-04  4.13675783e-04  7.98404136e-04  1.44266512e-03]
 [ 4.09010079e-03 -2.45805246e-04  2.28165627e-03 -1.16475734e-04]
 [ 2.02086063e-03 -2.29920635e-04  1.10187313e-03  1.65059224e-04]
 [ 5.82251891e-05  5.87627556e-04 -3.90824461e-03 -5.47152501e-04]
 [-2.55882645e-03 -1.63300016e-04 -1.95009580e-03 -4.47170447e-05]
 [ 5.09410476e-03 -6.85791408e-04 -7.67811860e-04  6.75144378e-04]
 [-5.38346172e-04  9.12288960e-04  2.64781939e-03  6.85390239e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0021397154454809325
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.762316063943934e-06, theta_kick=-1.1705384281034497e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.261997308450762e-05, theta_kick=8.707408015318131e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0030959874090560426
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.3189353724540335e-05, theta_kick=-2.7804907646569527e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.6936349602702035e-05, theta_kick=-2.030732042673514e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.959736078715472e-07, theta_kick=8.344985427877315e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012267096577574044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.54491412162904e-06, theta_kick=-9.046635919447215e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01561066e-01 -6.31907086e+00  1.00201806e-02  5.08964894e-02]
 [ 1.80007247e-01  4.56152714e-01 -1.43299139e-05  7.84602554e-03]
 [ 1.36392456e-02  5.08909963e-02  3.83956392e-01 -5.11952684e+00]
 [ 2.86399803e-03  1.65038196e-02  2.12550916e-01 -2.29816376e-01]]
compute_tune_4x4()/ evals =  [0.08911965+0.99602093j 0.08911965-0.99602093j 0.06524619+0.9978692j
 0.06524619-0.9978692j ]
compute_tune_4x4()/ angles =  [0.23579732490502872, 0.23960836516290412, 0.7603916348370958, 0.7642026750949713]
compute_tune_4x4()/  0.23579732490502872 0.23960836516290412
compute_tunes()/ 0.23579732490502872 0.23960836516290412

 Running simulation ..
Closed orbit computation: x_co=[7.38072428e-09 5.07454700e-08], y_co=[-5.23805191e-06  4.70730429e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.762316063943934e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.261997308450762e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.3189353724540335e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.6936349602702035e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.959736078715472e-07, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.54491412162904e-06, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0021397154454809325}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0030959874090560426}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.012267096577574044}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.61215062e-03  2.64232925e-04 -4.58466272e-03 -6.31403049e-04]
 [-5.92114362e-06 -4.52798206e-04  1.64559255e-03  1.46006482e-04]
 [-3.66939294e-05  2.08351284e-06 -3.61999390e-04 -7.15132928e-04]
 [ 8.71673446e-04  4.13675783e-04  7.98404136e-04  1.44266512e-03]
 [ 4.09010079e-03 -2.45805246e-04  2.28165627e-03 -1.16475734e-04]
 [ 2.02086063e-03 -2.29920635e-04  1.10187313e-03  1.65059224e-04]
 [ 5.82251891e-05  5.87627556e-04 -3.90824461e-03 -5.47152501e-04]
 [-2.55882645e-03 -1.63300016e-04 -1.95009580e-03 -4.47170447e-05]
 [ 5.09410476e-03 -6.85791408e-04 -7.67811860e-04  6.75144378e-04]
 [-5.38346172e-04  9.12288960e-04  2.64781939e-03  6.85390239e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0021397154454809325
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.6829017352672851e-06, theta_kick=-2.0178625020428853e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.668610388320992e-07, theta_kick=3.1997642656775694e-08
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0030959874090560426
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.5045306824066915e-07, theta_kick=-3.0030265245651294e-08
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.603187625594045e-07, theta_kick=-9.11650804332078e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-5.077101799133565e-07, theta_kick=6.087636089993664e-08
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.012267096577574044
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.6370068560943307e-07, theta_kick=-1.962832815057516e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01561066e-01 -6.31907086e+00  1.00201806e-02  5.08964894e-02]
 [ 1.80007247e-01  4.56152714e-01 -1.43299139e-05  7.84602554e-03]
 [ 1.36392456e-02  5.08909963e-02  3.83956392e-01 -5.11952684e+00]
 [ 2.86399803e-03  1.65038196e-02  2.12550916e-01 -2.29816376e-01]]
compute_tune_4x4()/ evals =  [0.08911965+0.99602093j 0.08911965-0.99602093j 0.06524619+0.9978692j
 0.06524619-0.9978692j ]
compute_tune_4x4()/ angles =  [0.23579732490502872, 0.23960836516290412, 0.7603916348370958, 0.7642026750949713]
compute_tune_4x4()/  0.23579732490502872 0.23960836516290412
compute_tunes()/ 0.23579732490502872 0.23960836516290412

 Running simulation ..
Closed orbit computation: x_co=[-1.27767144e-09 -1.90217926e-09], y_co=[ 2.64696697e-07 -1.38545505e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 3/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.53339310e-03 -3.05220339e-04 -2.44971465e-03 -1.47485321e-04]
 [-3.38070275e-03  2.53881685e-04 -1.57457832e-03 -1.25023296e-03]
 [-1.62585992e-03  1.04897311e-04  1.94779932e-03 -1.10171033e-04]
 [ 2.88985803e-03 -7.02109223e-05 -1.75350423e-03  7.84310480e-04]
 [-2.25091018e-03  2.49056311e-04 -3.61336519e-04 -1.18055999e-03]
 [-1.03426874e-03 -8.24465008e-05  4.74528507e-03  3.43126861e-04]
 [ 4.75437664e-03 -6.97074079e-04  1.32855495e-03 -2.17944015e-04]
 [-1.43387955e-03 -1.71168985e-05  7.85995895e-04 -8.56858199e-04]
 [-4.44633957e-03 -1.16159822e-04  4.04891721e-03  3.82098366e-04]
 [ 1.47523686e-03  2.31846919e-04 -3.14597353e-04  3.59310523e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011814361442549564
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.487830290906486e-07, theta_kick=-1.1376265511263574e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.957659786823097e-05, theta_kick=-9.541533502129639e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007079832868193734
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.9547297089849576e-05, theta_kick=2.3437944704260978e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.0270085863933956e-05, theta_kick=1.2314219376749072e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.66213621501621e-05, theta_kick=-5.59007674099475e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006582849818587781
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.019758465889105e-05, theta_kick=-3.620804023103813e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01501767e-01 -6.31955901e+00  4.16861654e-03  1.08319211e-03]
 [ 1.79989723e-01  4.56068160e-01 -1.14516231e-03  1.16201880e-02]
 [ 3.49436006e-03  1.07407668e-03  3.84055146e-01 -5.11991757e+00]
 [ 8.79432275e-04  1.44876646e-02  2.12568298e-01 -2.30127999e-01]]
compute_tune_4x4()/ evals =  [0.08552133+0.99633634j 0.08552133-0.99633634j 0.06872544+0.99763561j
 0.06872544-0.99763561j]
compute_tune_4x4()/ angles =  [0.23637221109576861, 0.23905337765949095, 0.760946622340509, 0.7636277889042313]
compute_tune_4x4()/  0.23637221109576861 0.23905337765949095
compute_tunes()/ 0.23637221109576861 0.23905337765949095

 Running simulation ..
Closed orbit computation: x_co=[-1.76600228e-07  6.91273798e-08], y_co=[1.76681703e-05 1.26987383e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.487830290906486e-07, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.957659786823097e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.9547297089849576e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.0270085863933956e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.66213621501621e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 3.019758465889105e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011814361442549564}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.007079832868193734}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.006582849818587781}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.53339310e-03 -3.05220339e-04 -2.44971465e-03 -1.47485321e-04]
 [-3.38070275e-03  2.53881685e-04 -1.57457832e-03 -1.25023296e-03]
 [-1.62585992e-03  1.04897311e-04  1.94779932e-03 -1.10171033e-04]
 [ 2.88985803e-03 -7.02109223e-05 -1.75350423e-03  7.84310480e-04]
 [-2.25091018e-03  2.49056311e-04 -3.61336519e-04 -1.18055999e-03]
 [-1.03426874e-03 -8.24465008e-05  4.74528507e-03  3.43126861e-04]
 [ 4.75437664e-03 -6.97074079e-04  1.32855495e-03 -2.17944015e-04]
 [-1.43387955e-03 -1.71168985e-05  7.85995895e-04 -8.56858199e-04]
 [-4.44633957e-03 -1.16159822e-04  4.04891721e-03  3.82098366e-04]
 [ 1.47523686e-03  2.31846919e-04 -3.14597353e-04  3.59310523e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011814361442549564
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-3.459700589954352e-06, theta_kick=4.1483111832763975e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=8.4191366613366e-06, theta_kick=-1.009486163836384e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.007079832868193734
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-8.246999133808981e-06, theta_kick=9.888462265950577e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.549463747952076e-06, theta_kick=-9.052091092594389e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.483770874813558e-06, theta_kick=5.376209986854236e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.006582849818587781
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.927733558842068e-06, theta_kick=-2.3114250706380554e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01501767e-01 -6.31955901e+00  4.16861654e-03  1.08319211e-03]
 [ 1.79989723e-01  4.56068160e-01 -1.14516231e-03  1.16201880e-02]
 [ 3.49436006e-03  1.07407668e-03  3.84055146e-01 -5.11991757e+00]
 [ 8.79432275e-04  1.44876646e-02  2.12568298e-01 -2.30127999e-01]]
compute_tune_4x4()/ evals =  [0.08552133+0.99633634j 0.08552133-0.99633634j 0.06872544+0.99763561j
 0.06872544-0.99763561j]
compute_tune_4x4()/ angles =  [0.23637221109576861, 0.23905337765949095, 0.760946622340509, 0.7636277889042313]
compute_tune_4x4()/  0.23637221109576861 0.23905337765949095
compute_tunes()/ 0.23637221109576861 0.23905337765949095

 Running simulation ..
Closed orbit computation: x_co=[-5.25728445e-09  1.91678307e-09], y_co=[ 2.84045348e-07 -1.38115915e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 4/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 3.37585814e-03 -7.09578078e-05  3.59342995e-03  7.53344271e-04]
 [ 2.10576936e-03 -5.54237274e-04  1.30958742e-03  2.83515825e-04]
 [-1.69384793e-03  4.87883209e-04  2.59313654e-03 -1.85201623e-04]
 [ 1.76596735e-03 -8.53881395e-05 -1.00546405e-03 -1.30958708e-04]
 [-1.23902431e-03  3.16076524e-04 -2.98936096e-03 -6.78961580e-04]
 [-2.61243179e-03  1.13708112e-04  1.50707136e-03 -5.89824754e-04]
 [-3.26217945e-04  3.20775584e-04  6.71456559e-04 -3.56451245e-05]
 [ 3.44546672e-03 -2.54880416e-04  1.99762470e-03  4.03956717e-04]
 [-4.18775002e-03  1.48207637e-04  1.18599936e-03 -4.18917484e-04]
 [-1.80487281e-03  6.13424442e-04 -2.73384608e-03 -1.34298486e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004030831237785592
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.661924031060703e-05, theta_kick=1.9927094453846566e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-7.50353892906283e-05, theta_kick=8.997025506762664e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003963512072914238
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.0001108485126800677, theta_kick=-1.3291153752884367e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-0.00012935040166170018, theta_kick=1.5509599857645618e-05
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=4.03744439467701e-05, theta_kick=-4.841047743532116e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0005175387776363684
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.084462427289355e-05, theta_kick=3.6983865073969064e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01684295e-01 -6.31993736e+00 -3.91832070e-03 -7.34245729e-03]
 [ 1.79996336e-01  4.56090123e-01  5.81667405e-04 -6.47868510e-03]
 [-3.97056604e-03 -7.34257893e-03  3.84081911e-01 -5.11915292e+00]
 [-8.18187711e-04 -8.98210521e-03  2.12577890e-01 -2.29764482e-01]]
compute_tune_4x4()/ evals =  [0.08298602+0.99655071j 0.08298602-0.99655071j 0.07137561+0.99744951j
 0.07137561-0.99744951j]
compute_tune_4x4()/ angles =  [0.23677715840182775, 0.23863055131503935, 0.7613694486849607, 0.7632228415981722]
compute_tune_4x4()/  0.23677715840182775 0.23863055131503935
compute_tunes()/ 0.23677715840182775 0.23863055131503935

 Running simulation ..
Closed orbit computation: x_co=[-1.25875662e-07  1.44017859e-08], y_co=[-1.26161996e-05  1.56407472e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.661924031060703e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -7.50353892906283e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.0001108485126800677, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -0.00012935040166170018, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 4.03744439467701e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.084462427289355e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.004030831237785592}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.003963512072914238}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.0005175387776363684}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 3.37585814e-03 -7.09578078e-05  3.59342995e-03  7.53344271e-04]
 [ 2.10576936e-03 -5.54237274e-04  1.30958742e-03  2.83515825e-04]
 [-1.69384793e-03  4.87883209e-04  2.59313654e-03 -1.85201623e-04]
 [ 1.76596735e-03 -8.53881395e-05 -1.00546405e-03 -1.30958708e-04]
 [-1.23902431e-03  3.16076524e-04 -2.98936096e-03 -6.78961580e-04]
 [-2.61243179e-03  1.13708112e-04  1.50707136e-03 -5.89824754e-04]
 [-3.26217945e-04  3.20775584e-04  6.71456559e-04 -3.56451245e-05]
 [ 3.44546672e-03 -2.54880416e-04  1.99762470e-03  4.03956717e-04]
 [-4.18775002e-03  1.48207637e-04  1.18599936e-03 -4.18917484e-04]
 [-1.80487281e-03  6.13424442e-04 -2.73384608e-03 -1.34298486e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.004030831237785592
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.957818282167911e-06, theta_kick=2.3474977858842084e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.3933653030830463e-06, theta_kick=-2.8697350520081e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.003963512072914238
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.0095296783530855e-06, theta_kick=8.404689827394449e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.305810411892218e-05, theta_kick=-1.5657158167443383e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.896085808155416e-06, theta_kick=1.1865779237611892e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.0005175387776363684
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=3.407750189191295e-06, theta_kick=-4.0860206980572927e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01684295e-01 -6.31993736e+00 -3.91832070e-03 -7.34245729e-03]
 [ 1.79996336e-01  4.56090123e-01  5.81667405e-04 -6.47868510e-03]
 [-3.97056604e-03 -7.34257893e-03  3.84081911e-01 -5.11915292e+00]
 [-8.18187711e-04 -8.98210521e-03  2.12577890e-01 -2.29764482e-01]]
compute_tune_4x4()/ evals =  [0.08298602+0.99655071j 0.08298602-0.99655071j 0.07137561+0.99744951j
 0.07137561-0.99744951j]
compute_tune_4x4()/ angles =  [0.23677715840182775, 0.23863055131503935, 0.7613694486849607, 0.7632228415981722]
compute_tune_4x4()/  0.23677715840182775 0.23863055131503935
compute_tunes()/ 0.23677715840182775 0.23863055131503935

 Running simulation ..
Closed orbit computation: x_co=[ 1.76181147e-09 -3.02394160e-10], y_co=[-3.76348574e-07  9.58992242e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 5/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 2.49708466e-03  5.94863842e-04 -6.61657626e-04  1.70714369e-05]
 [-4.88328118e-04 -9.77919216e-05 -3.96849631e-03 -5.90079446e-04]
 [-1.49736178e-03 -2.79307901e-04  1.12304699e-03 -3.45291678e-04]
 [ 5.52446599e-04  3.55959352e-05  2.64322137e-05 -1.65023224e-05]
 [ 1.76649509e-03  5.37036706e-04  1.18017244e-03 -6.58928906e-04]
 [ 2.65308543e-03 -5.14974665e-04  9.39179448e-04 -5.08112928e-04]
 [-2.04418580e-03  3.36937953e-04  1.81449995e-03 -7.25723899e-07]
 [-3.20398358e-03 -7.02329275e-04 -7.50301655e-04  2.99141007e-04]
 [ 1.57644336e-03 -3.11227779e-04 -4.45365091e-04  6.72645049e-04]
 [-2.40358834e-03  6.20449670e-04 -1.33063608e-03 -4.66227545e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009914719446097273
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.3412579188286099e-05, theta_kick=-1.608218711321537e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.6829255152942046e-05, theta_kick=-2.0178910151899174e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.02319122469740653
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.611149154089828e-05, theta_kick=1.931828457423053e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-2.2682603739040895e-05, theta_kick=2.7197295346801062e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.456603550941445e-06, theta_kick=5.343635343324211e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011897832845835881
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.196915260878695e-05, theta_kick=3.8332216860607146e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01333997e-01 -6.31746639e+00 -2.30124286e-02 -2.29600063e-02]
 [ 1.79932938e-01  4.56597396e-01  3.63274135e-03 -3.40956834e-02]
 [-2.11260767e-02 -2.29830486e-02  3.83469706e-01 -5.11607188e+00]
 [-3.76687791e-03 -4.51861741e-02  2.12557638e-01 -2.30339418e-01]]
compute_tune_4x4()/ evals =  [0.10778642+0.99417407j 0.10778642-0.99417407j 0.04641042+0.99892246j
 0.04641042-0.99892246j]
compute_tune_4x4()/ angles =  [0.23281186590885525, 0.2426108980976205, 0.7573891019023795, 0.7671881340911447]
compute_tune_4x4()/  0.23281186590885525 0.2426108980976205
compute_tunes()/ 0.23281186590885525 0.2426108980976205

 Running simulation ..
Closed orbit computation: x_co=[-2.09715107e-07  8.50602567e-08], y_co=[-6.22233363e-06 -6.22129145e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 1.3412579188286099e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 1.6829255152942046e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.611149154089828e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -2.2682603739040895e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -4.456603550941445e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.196915260878695e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.009914719446097273}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.02319122469740653}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.011897832845835881}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 2.49708466e-03  5.94863842e-04 -6.61657626e-04  1.70714369e-05]
 [-4.88328118e-04 -9.77919216e-05 -3.96849631e-03 -5.90079446e-04]
 [-1.49736178e-03 -2.79307901e-04  1.12304699e-03 -3.45291678e-04]
 [ 5.52446599e-04  3.55959352e-05  2.64322137e-05 -1.65023224e-05]
 [ 1.76649509e-03  5.37036706e-04  1.18017244e-03 -6.58928906e-04]
 [ 2.65308543e-03 -5.14974665e-04  9.39179448e-04 -5.08112928e-04]
 [-2.04418580e-03  3.36937953e-04  1.81449995e-03 -7.25723899e-07]
 [-3.20398358e-03 -7.02329275e-04 -7.50301655e-04  2.99141007e-04]
 [ 1.57644336e-03 -3.11227779e-04 -4.45365091e-04  6.72645049e-04]
 [-2.40358834e-03  6.20449670e-04 -1.33063608e-03 -4.66227545e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.009914719446097273
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.232489322033008e-06, theta_kick=5.074913950261552e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.456191931368217e-06, theta_kick=-8.940254675031899e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.02319122469740653
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-7.798758169912911e-06, theta_kick=9.351004484565746e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.580046320495204e-06, theta_kick=-7.889723121429742e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.6294545563104567e-06, theta_kick=4.3518525761602956e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.011897832845835881
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.4778242771110913e-06, theta_kick=-1.7719669133964522e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01333997e-01 -6.31746639e+00 -2.30124286e-02 -2.29600063e-02]
 [ 1.79932938e-01  4.56597396e-01  3.63274135e-03 -3.40956834e-02]
 [-2.11260767e-02 -2.29830486e-02  3.83469706e-01 -5.11607188e+00]
 [-3.76687791e-03 -4.51861741e-02  2.12557638e-01 -2.30339418e-01]]
compute_tune_4x4()/ evals =  [0.10778642+0.99417407j 0.10778642-0.99417407j 0.04641042+0.99892246j
 0.04641042-0.99892246j]
compute_tune_4x4()/ angles =  [0.23281186590885525, 0.2426108980976205, 0.7573891019023795, 0.7671881340911447]
compute_tune_4x4()/  0.23281186590885525 0.2426108980976205
compute_tunes()/ 0.23281186590885525 0.2426108980976205

 Running simulation ..
Closed orbit computation: x_co=[ 1.55359771e-08 -2.06607020e-09], y_co=[8.41580658e-08 1.09983139e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 6/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.02327631e-03 -7.93546127e-05  6.63125932e-04  1.01244770e-04]
 [-3.78866642e-04 -7.99260202e-05 -1.60836019e-03 -3.38050582e-04]
 [-9.68052499e-04 -1.43871789e-04 -2.51450920e-04  2.53562935e-04]
 [-5.02884439e-03  2.88850866e-04  5.84720285e-04 -7.15449664e-04]
 [ 1.16094011e-03 -2.57452414e-04 -2.37656083e-03  6.86384193e-05]
 [ 1.85472674e-03 -1.87187574e-05 -3.53070254e-03 -8.47421258e-05]
 [ 4.28427695e-03  1.63047650e-04  3.01776057e-03 -5.14727946e-04]
 [-3.16701713e-04 -5.79279458e-04 -9.75263359e-04  8.51231011e-05]
 [-2.54992707e-03  9.77743940e-05 -3.25627988e-03  2.90529120e-04]
 [-2.33457274e-03 -3.12192179e-04 -1.72183640e-04  7.52630932e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0038151175501213675
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.5567850030745135e-05, theta_kick=1.8666437948308683e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.9653509324390293e-05, theta_kick=-3.5555673433400267e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005974532814653492
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.563236977921389e-05, theta_kick=3.0734175817911426e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.073676300774869e-05, theta_kick=7.2825664149271494e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.557988332083304e-05, theta_kick=7.86327476336218e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010448821324322517
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.9666993717578834e-05, theta_kick=4.756221799174767e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01629923e-01 -6.31926685e+00  7.98583913e-03  1.01419852e-02]
 [ 1.80011247e-01  4.56226290e-01 -9.11125799e-04  7.90860483e-03]
 [ 7.56962371e-03  1.01406392e-02  3.83924177e-01 -5.11931157e+00]
 [ 1.16233967e-03  1.11213372e-02  2.12555923e-01 -2.29765144e-01]]
compute_tune_4x4()/ evals =  [0.08578821+0.9963134j  0.08578821-0.9963134j  0.06858949+0.99764497j
 0.06858949-0.99764497j]
compute_tune_4x4()/ angles =  [0.23632957935015417, 0.23907506582394214, 0.7609249341760579, 0.7636704206498458]
compute_tune_4x4()/  0.23632957935015417 0.23907506582394214
compute_tunes()/ 0.23632957935015417 0.23907506582394214

 Running simulation ..
Closed orbit computation: x_co=[1.19839991e-07 3.43769428e-08], y_co=[-4.34012848e-05 -1.27655982e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.5567850030745135e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.9653509324390293e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.563236977921389e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -6.073676300774869e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -6.557988332083304e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -3.9666993717578834e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0038151175501213675}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.005974532814653492}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.010448821324322517}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.02327631e-03 -7.93546127e-05  6.63125932e-04  1.01244770e-04]
 [-3.78866642e-04 -7.99260202e-05 -1.60836019e-03 -3.38050582e-04]
 [-9.68052499e-04 -1.43871789e-04 -2.51450920e-04  2.53562935e-04]
 [-5.02884439e-03  2.88850866e-04  5.84720285e-04 -7.15449664e-04]
 [ 1.16094011e-03 -2.57452414e-04 -2.37656083e-03  6.86384193e-05]
 [ 1.85472674e-03 -1.87187574e-05 -3.53070254e-03 -8.47421258e-05]
 [ 4.28427695e-03  1.63047650e-04  3.01776057e-03 -5.14727946e-04]
 [-3.16701713e-04 -5.79279458e-04 -9.75263359e-04  8.51231011e-05]
 [-2.54992707e-03  9.77743940e-05 -3.25627988e-03  2.90529120e-04]
 [-2.33457274e-03 -3.12192179e-04 -1.72183640e-04  7.52630932e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0038151175501213675
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.773688851350332e-07, theta_kick=9.320945428342145e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=3.777564694729485e-06, theta_kick=-4.529442204969296e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.005974532814653492
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.411006888538226e-06, theta_kick=7.68703848217572e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.515073629751986e-06, theta_kick=-9.010856046897701e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.730325835634438e-06, theta_kick=5.67183866184285e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.010448821324322517
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=6.055917479939402e-07, theta_kick=-7.261272920545736e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01629923e-01 -6.31926685e+00  7.98583913e-03  1.01419852e-02]
 [ 1.80011247e-01  4.56226290e-01 -9.11125799e-04  7.90860483e-03]
 [ 7.56962371e-03  1.01406392e-02  3.83924177e-01 -5.11931157e+00]
 [ 1.16233967e-03  1.11213372e-02  2.12555923e-01 -2.29765144e-01]]
compute_tune_4x4()/ evals =  [0.08578821+0.9963134j  0.08578821-0.9963134j  0.06858949+0.99764497j
 0.06858949-0.99764497j]
compute_tune_4x4()/ angles =  [0.23632957935015417, 0.23907506582394214, 0.7609249341760579, 0.7636704206498458]
compute_tune_4x4()/  0.23632957935015417 0.23907506582394214
compute_tunes()/ 0.23632957935015417 0.23907506582394214

 Running simulation ..
Closed orbit computation: x_co=[-3.30309753e-09 -7.62494167e-10], y_co=[ 5.06112588e-08 -1.19334777e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 7/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 1.11425317e-03  5.35523323e-04  2.83788400e-03  1.61087473e-04]
 [-2.03362201e-03  3.61860171e-04  2.03580103e-03  7.35060563e-04]
 [ 3.39149149e-03 -3.66615325e-04 -6.58382563e-03 -1.27141597e-04]
 [-2.97620965e-03 -1.51722233e-04  2.15121555e-03  5.01297515e-04]
 [-2.90146480e-03 -6.59263509e-05  1.21376745e-03 -1.75696454e-05]
 [ 8.81845775e-04 -6.69980380e-05  3.21780245e-03  7.79435881e-04]
 [ 7.43548260e-03 -7.19024973e-04 -1.26002999e-03 -3.59571868e-04]
 [-4.03575712e-04 -5.59319880e-04 -1.20031276e-03 -2.84204173e-04]
 [-2.68690691e-03  9.60667901e-04 -1.39741619e-03  5.31058547e-04]
 [ 5.68276003e-04 -4.84653718e-05  7.30476830e-04 -5.70542016e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016044708760630928
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.528635848423731e-05, theta_kick=1.8328918992545059e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=7.444437675235676e-05, theta_kick=-8.926160879659174e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.018819575581523557
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.251825891530023e-06, theta_kick=-8.695212103716827e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.486703222949542e-06, theta_kick=-6.578763608957429e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.451499700538876e-05, theta_kick=-4.138478008297669e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01585592354268324
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.352833564887217e-05, theta_kick=1.62209834649517e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01006402e-01 -6.32043507e+00  6.00645913e-03 -5.40829762e-02]
 [ 1.79944770e-01  4.56064962e-01 -3.64259219e-03  2.43474392e-02]
 [-1.00286269e-03 -5.42509472e-02  3.84049823e-01 -5.12147185e+00]
 [-5.14546225e-04  2.27804948e-02  2.12615401e-01 -2.31358082e-01]]
compute_tune_4x4()/ evals =  [0.0899178 +0.99594919j 0.0899178 -0.99594919j 0.06395735+0.99795263j
 0.06395735-0.99795263j]
compute_tune_4x4()/ angles =  [0.23566978251788626, 0.23981391935989715, 0.7601860806401028, 0.7643302174821137]
compute_tune_4x4()/  0.23566978251788626 0.23981391935989715
compute_tunes()/ 0.23566978251788626 0.23981391935989715

 Running simulation ..
Closed orbit computation: x_co=[3.22645607e-07 1.02110951e-07], y_co=[ 4.31506291e-05 -1.77363552e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.528635848423731e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 7.444437675235676e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 7.251825891530023e-06, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 5.486703222949542e-06, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.451499700538876e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': -1.352833564887217e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.016044708760630928}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.018819575581523557}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.01585592354268324}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 1.11425317e-03  5.35523323e-04  2.83788400e-03  1.61087473e-04]
 [-2.03362201e-03  3.61860171e-04  2.03580103e-03  7.35060563e-04]
 [ 3.39149149e-03 -3.66615325e-04 -6.58382563e-03 -1.27141597e-04]
 [-2.97620965e-03 -1.51722233e-04  2.15121555e-03  5.01297515e-04]
 [-2.90146480e-03 -6.59263509e-05  1.21376745e-03 -1.75696454e-05]
 [ 8.81845775e-04 -6.69980380e-05  3.21780245e-03  7.79435881e-04]
 [ 7.43548260e-03 -7.19024973e-04 -1.26002999e-03 -3.59571868e-04]
 [-4.03575712e-04 -5.59319880e-04 -1.20031276e-03 -2.84204173e-04]
 [-2.68690691e-03  9.60667901e-04 -1.39741619e-03  5.31058547e-04]
 [ 5.68276003e-04 -4.84653718e-05  7.30476830e-04 -5.70542016e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.016044708760630928
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-4.6723825105539e-06, theta_kick=5.60236243487519e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.80417995538446e-06, theta_kick=-1.1755580662057311e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.018819575581523557
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.4287133770046075e-06, theta_kick=7.708269228077526e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.951330115148053e-07, theta_kick=-9.533943987628791e-08
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=1.3625727115857073e-06, theta_kick=-1.633775949835247e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.01585592354268324
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-1.6022781927997994e-07, theta_kick=1.9211918410543734e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01006402e-01 -6.32043507e+00  6.00645913e-03 -5.40829762e-02]
 [ 1.79944770e-01  4.56064962e-01 -3.64259219e-03  2.43474392e-02]
 [-1.00286269e-03 -5.42509472e-02  3.84049823e-01 -5.12147185e+00]
 [-5.14546225e-04  2.27804948e-02  2.12615401e-01 -2.31358082e-01]]
compute_tune_4x4()/ evals =  [0.0899178 +0.99594919j 0.0899178 -0.99594919j 0.06395735+0.99795263j
 0.06395735-0.99795263j]
compute_tune_4x4()/ angles =  [0.23566978251788626, 0.23981391935989715, 0.7601860806401028, 0.7643302174821137]
compute_tune_4x4()/  0.23566978251788626 0.23981391935989715
compute_tunes()/ 0.23566978251788626 0.23981391935989715

 Running simulation ..
Closed orbit computation: x_co=[-1.00873313e-08  3.22614859e-09], y_co=[6.59616173e-07 4.42973592e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 8/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-8.62993200e-05 -2.91077839e-04  1.79994781e-03  9.60577907e-05]
 [ 1.86930744e-03  4.22039073e-04 -1.72765703e-03 -6.47719153e-04]
 [ 3.09950834e-03 -1.54865953e-04 -1.45476173e-04 -4.73140350e-04]
 [-2.34888355e-03  1.62874140e-04 -1.10514365e-03 -1.88732721e-04]
 [-4.05490695e-03  7.89445336e-04  5.17434615e-03  1.04774422e-03]
 [ 7.01321722e-04 -1.43566157e-04  1.82250286e-03 -4.49375380e-04]
 [-7.80729805e-04  3.25558421e-04 -7.71595534e-04 -4.74749444e-05]
 [-2.26898202e-04 -2.00819660e-04 -1.89613461e-03  5.40543329e-04]
 [ 8.12781991e-05  6.97582021e-04 -4.03494934e-03 -3.39950221e-04]
 [ 3.69034947e-03  3.95921105e-04 -1.88493018e-03 -6.00956061e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004065170057038406
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-1.7909078238191995e-05, theta_kick=2.147365866092015e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=9.581646270320312e-05, theta_kick=-1.1488754400534057e-05
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004865193313752066
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.813509356632551e-05, theta_kick=2.174465954348511e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=2.298545686344837e-05, theta_kick=-2.7560427638224666e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-1.955510691924112e-05, theta_kick=2.3447308983556846e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005797359900578398
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.0410573982200524e-05, theta_kick=-2.4473046180152215e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01651053e-01 -6.31957879e+00  7.66267305e-03  2.68187631e-02]
 [ 1.79997001e-01  4.56117859e-01 -5.41719617e-04  8.96263376e-03]
 [ 9.11686899e-03  2.68182044e-02  3.84031330e-01 -5.11907356e+00]
 [ 1.88034811e-03  1.46578329e-02  2.12568642e-01 -2.29766983e-01]]
compute_tune_4x4()/ evals =  [0.08722713+0.99618845j 0.08722713-0.99618845j 0.06713845+0.99774367j
 0.06713845-0.99774367j]
compute_tune_4x4()/ angles =  [0.23609970599332053, 0.23930654062551154, 0.7606934593744885, 0.7639002940066795]
compute_tune_4x4()/  0.23609970599332053 0.23930654062551154
compute_tunes()/ 0.23609970599332053 0.23930654062551154

 Running simulation ..
Closed orbit computation: x_co=[ 4.21786454e-10 -4.18846681e-08], y_co=[ 2.04470966e-05 -2.95021608e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -1.7909078238191995e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 9.581646270320312e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -1.813509356632551e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 2.298545686344837e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -1.955510691924112e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.0410573982200524e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.004065170057038406}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.004865193313752066}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.005797359900578398}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-8.62993200e-05 -2.91077839e-04  1.79994781e-03  9.60577907e-05]
 [ 1.86930744e-03  4.22039073e-04 -1.72765703e-03 -6.47719153e-04]
 [ 3.09950834e-03 -1.54865953e-04 -1.45476173e-04 -4.73140350e-04]
 [-2.34888355e-03  1.62874140e-04 -1.10514365e-03 -1.88732721e-04]
 [-4.05490695e-03  7.89445336e-04  5.17434615e-03  1.04774422e-03]
 [ 7.01321722e-04 -1.43566157e-04  1.82250286e-03 -4.49375380e-04]
 [-7.80729805e-04  3.25558421e-04 -7.71595534e-04 -4.74749444e-05]
 [-2.26898202e-04 -2.00819660e-04 -1.89613461e-03  5.40543329e-04]
 [ 8.12781991e-05  6.97582021e-04 -4.03494934e-03 -3.39950221e-04]
 [ 3.69034947e-03  3.95921105e-04 -1.88493018e-03 -6.00956061e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.004065170057038406
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=7.259024954308022e-07, theta_kick=-8.703844050862136e-08
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.052521153507095e-06, theta_kick=-2.4610500919437063e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.004865193313752066
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-5.018085400461701e-06, theta_kick=6.016873207414158e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=5.374539879180837e-06, theta_kick=-6.444275539481008e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.2326092333355725e-06, theta_kick=3.876020102070575e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.005797359900578398
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.02904543656384e-06, theta_kick=-1.2338641976685167e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01651053e-01 -6.31957879e+00  7.66267305e-03  2.68187631e-02]
 [ 1.79997001e-01  4.56117859e-01 -5.41719617e-04  8.96263376e-03]
 [ 9.11686899e-03  2.68182044e-02  3.84031330e-01 -5.11907356e+00]
 [ 1.88034811e-03  1.46578329e-02  2.12568642e-01 -2.29766983e-01]]
compute_tune_4x4()/ evals =  [0.08722713+0.99618845j 0.08722713-0.99618845j 0.06713845+0.99774367j
 0.06713845-0.99774367j]
compute_tune_4x4()/ angles =  [0.23609970599332053, 0.23930654062551154, 0.7606934593744885, 0.7639002940066795]
compute_tune_4x4()/  0.23609970599332053 0.23930654062551154
compute_tunes()/ 0.23609970599332053 0.23930654062551154

 Running simulation ..
Closed orbit computation: x_co=[-5.62189186e-09 -3.30000638e-10], y_co=[-4.31269306e-07 -1.14319446e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 9/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.65922559e-04  7.05633783e-05 -1.53679817e-03 -1.49271071e-04]
 [-7.11805679e-04 -1.24861773e-04  1.51563861e-04  1.87373878e-04]
 [ 1.46097926e-03 -2.13046945e-04  4.65514940e-03  5.11753949e-04]
 [-9.94059866e-04  6.85585017e-05 -3.71808162e-04 -1.98943868e-05]
 [ 2.46197246e-03 -4.49945145e-04 -1.29144981e-03  5.22729966e-04]
 [ 1.11471195e-03 -3.47905861e-04  2.09470320e-03  2.76032284e-04]
 [ 7.98201776e-04 -1.30534010e-04 -6.83116367e-05  4.65581907e-04]
 [ 4.53450265e-04  1.45430357e-04  1.96701563e-03 -4.29108950e-04]
 [-7.89461165e-04 -3.85723333e-04  1.62237067e-03  3.72745102e-04]
 [-2.50495590e-03  7.74849966e-04 -3.62421362e-04  7.16997427e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005042417894632361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-0.00011730309069282299, theta_kick=1.4065081942837822e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=2.8236776740543204e-05, theta_kick=-3.385695775888507e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00986882708364801
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=2.5316059319243178e-05, theta_kick=-3.035490767479702e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=7.465226557382751e-05, theta_kick=-8.951087531563369e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-8.959541734924342e-06, theta_kick=1.0742827655068458e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.003348948657943505
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=4.8210453447417026e-05, theta_kick=-5.780614766706877e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01630990e-01 -6.32026113e+00  4.89961763e-03 -2.17883778e-02]
 [ 1.79986095e-01  4.56121598e-01 -1.85383279e-03  1.25892846e-02]
 [ 1.60419015e-03 -2.17964670e-02  3.84076865e-01 -5.11913465e+00]
 [ 4.77821313e-05  1.26226867e-02  2.12594270e-01 -2.29953930e-01]]
compute_tune_4x4()/ evals =  [0.08503932+0.9963776j  0.08503932-0.9963776j  0.06926746+0.99759813j
 0.06926746-0.99759813j]
compute_tune_4x4()/ angles =  [0.2364492064300713, 0.23896690719903987, 0.7610330928009601, 0.7635507935699287]
compute_tune_4x4()/  0.2364492064300713 0.23896690719903987
compute_tunes()/ 0.2364492064300713 0.23896690719903987

 Running simulation ..
Closed orbit computation: x_co=[1.71868770e-07 4.20084551e-08], y_co=[3.76185668e-05 1.63927086e-05]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -0.00011730309069282299, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 2.8236776740543204e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 2.5316059319243178e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 7.465226557382751e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -8.959541734924342e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 4.8210453447417026e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.005042417894632361}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.00986882708364801}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.003348948657943505}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-2.65922559e-04  7.05633783e-05 -1.53679817e-03 -1.49271071e-04]
 [-7.11805679e-04 -1.24861773e-04  1.51563861e-04  1.87373878e-04]
 [ 1.46097926e-03 -2.13046945e-04  4.65514940e-03  5.11753949e-04]
 [-9.94059866e-04  6.85585017e-05 -3.71808162e-04 -1.98943868e-05]
 [ 2.46197246e-03 -4.49945145e-04 -1.29144981e-03  5.22729966e-04]
 [ 1.11471195e-03 -3.47905861e-04  2.09470320e-03  2.76032284e-04]
 [ 7.98201776e-04 -1.30534010e-04 -6.83116367e-05  4.65581907e-04]
 [ 4.53450265e-04  1.45430357e-04  1.96701563e-03 -4.29108950e-04]
 [-7.89461165e-04 -3.85723333e-04  1.62237067e-03  3.72745102e-04]
 [-2.50495590e-03  7.74849966e-04 -3.62421362e-04  7.16997427e-05]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.005042417894632361
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=6.960413710820323e-06, theta_kick=-8.345797934267857e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-1.3850945509018717e-05, theta_kick=1.6607804825900395e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.00986882708364801
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=1.63377167982388e-05, theta_kick=-1.9589537169813555e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.4655595770595632e-05, theta_kick=1.7572610765587173e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=8.62928544202653e-06, theta_kick=-1.03468379335436e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.003348948657943505
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-3.4086859652338123e-06, theta_kick=4.087142728742112e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01630990e-01 -6.32026113e+00  4.89961763e-03 -2.17883778e-02]
 [ 1.79986095e-01  4.56121598e-01 -1.85383279e-03  1.25892846e-02]
 [ 1.60419015e-03 -2.17964670e-02  3.84076865e-01 -5.11913465e+00]
 [ 4.77821313e-05  1.26226867e-02  2.12594270e-01 -2.29953930e-01]]
compute_tune_4x4()/ evals =  [0.08503932+0.9963776j  0.08503932-0.9963776j  0.06926746+0.99759813j
 0.06926746-0.99759813j]
compute_tune_4x4()/ angles =  [0.2364492064300713, 0.23896690719903987, 0.7610330928009601, 0.7635507935699287]
compute_tune_4x4()/  0.2364492064300713 0.23896690719903987
compute_tunes()/ 0.2364492064300713 0.23896690719903987

 Running simulation ..
Closed orbit computation: x_co=[ 1.77682138e-08 -2.60798021e-09], y_co=[ 2.89919599e-07 -1.24727685e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 10/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-3.62173761e-04 -9.61596256e-05 -5.49054045e-04 -7.05239409e-05]
 [ 3.48602424e-03 -1.82102642e-04 -1.77174594e-03 -7.33950930e-04]
 [ 3.38397712e-03 -1.96825228e-04  1.99485159e-04  1.10585704e-04]
 [-5.13052088e-03 -2.11353417e-04 -4.44077657e-04 -4.77108010e-04]
 [ 3.48475212e-03 -8.12908697e-05 -4.14604856e-03  4.13992561e-04]
 [-1.08552049e-04 -2.46137969e-04 -8.62743416e-04 -6.22398500e-04]
 [-2.29041942e-03 -7.03322467e-04 -4.28602143e-04 -2.94539323e-04]
 [-1.08597784e-03  8.97580445e-04 -1.50139128e-03  3.37784640e-04]
 [ 5.80978027e-04 -2.52905903e-04 -1.69530924e-03  7.64544508e-04]
 [ 1.74916720e-03 -2.43358925e-04  2.84124304e-03 -2.93565785e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0049114554067368815
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.007551580595141e-05, theta_kick=-4.805205134690333e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.678553336501898e-05, theta_kick=3.2116862346633694e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0030476255399345805
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=0.00013910860203081215, theta_kick=-1.6679644798452856e-05
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.316558591088316e-05, theta_kick=-7.573791419788149e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-9.455111153155966e-05, theta_kick=1.1337034033998821e-05
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010726590585533321
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.0830566696634202e-05, theta_kick=-1.2986256984007211e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01572168e-01 -6.31974161e+00 -7.06348527e-03 -7.39732906e-02]
 [ 1.80013998e-01  4.56148458e-01 -1.24814993e-03 -1.70696410e-03]
 [-1.37479514e-02 -7.39782708e-02  3.84044101e-01 -5.11995221e+00]
 [-3.31864666e-03 -1.20188889e-02  2.12572775e-01 -2.29875098e-01]]
compute_tune_4x4()/ evals =  [0.08577334+0.99631468j 0.08577334-0.99631468j 0.0685993 +0.99764429j
 0.0685993 -0.99764429j]
compute_tune_4x4()/ angles =  [0.23633195395699944, 0.23907350056175564, 0.7609264994382443, 0.7636680460430005]
compute_tune_4x4()/  0.23633195395699944 0.23907350056175564
compute_tunes()/ 0.23633195395699944 0.23907350056175564

 Running simulation ..
Closed orbit computation: x_co=[2.66211385e-07 1.34302357e-07], y_co=[ 5.80086990e-05 -6.91585729e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 4.007551580595141e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -2.678553336501898e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 0.00013910860203081215, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 6.316558591088316e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -9.455111153155966e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 1.0830566696634202e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0049114554067368815}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.0030476255399345805}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.010726590585533321}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-3.62173761e-04 -9.61596256e-05 -5.49054045e-04 -7.05239409e-05]
 [ 3.48602424e-03 -1.82102642e-04 -1.77174594e-03 -7.33950930e-04]
 [ 3.38397712e-03 -1.96825228e-04  1.99485159e-04  1.10585704e-04]
 [-5.13052088e-03 -2.11353417e-04 -4.44077657e-04 -4.77108010e-04]
 [ 3.48475212e-03 -8.12908697e-05 -4.14604856e-03  4.13992561e-04]
 [-1.08552049e-04 -2.46137969e-04 -8.62743416e-04 -6.22398500e-04]
 [-2.29041942e-03 -7.03322467e-04 -4.28602143e-04 -2.94539323e-04]
 [-1.08597784e-03  8.97580445e-04 -1.50139128e-03  3.37784640e-04]
 [ 5.80978027e-04 -2.52905903e-04 -1.69530924e-03  7.64544508e-04]
 [ 1.74916720e-03 -2.43358925e-04  2.84124304e-03 -2.93565785e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0049114554067368815
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-7.0162026370194775e-06, theta_kick=8.412690955914561e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=1.5857773732004374e-05, theta_kick=-1.9014067374890496e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.0030476255399345805
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-1.764203856824493e-05, theta_kick=2.115346804892431e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.3591267074207204e-05, theta_kick=-1.6296440611808529e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-6.286142295807882e-06, theta_kick=7.537321137292598e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.010726590585533321
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.599189107176068e-06, theta_kick=-1.9174879111604885e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01572168e-01 -6.31974161e+00 -7.06348527e-03 -7.39732906e-02]
 [ 1.80013998e-01  4.56148458e-01 -1.24814993e-03 -1.70696410e-03]
 [-1.37479514e-02 -7.39782708e-02  3.84044101e-01 -5.11995221e+00]
 [-3.31864666e-03 -1.20188889e-02  2.12572775e-01 -2.29875098e-01]]
compute_tune_4x4()/ evals =  [0.08577334+0.99631468j 0.08577334-0.99631468j 0.0685993 +0.99764429j
 0.0685993 -0.99764429j]
compute_tune_4x4()/ angles =  [0.23633195395699944, 0.23907350056175564, 0.7609264994382443, 0.7636680460430005]
compute_tune_4x4()/  0.23633195395699944 0.23907350056175564
compute_tunes()/ 0.23633195395699944 0.23907350056175564

 Running simulation ..
Closed orbit computation: x_co=[-4.30063539e-09  1.62380320e-09], y_co=[3.89568592e-07 5.00894338e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 11/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 9.22503899e-04  1.21961060e-05  1.94060537e-04 -2.67843198e-04]
 [-6.60158409e-04 -6.53174032e-05  2.51939659e-03  2.07664609e-04]
 [ 1.05318985e-03 -4.34068554e-04  2.15777129e-03  6.04286124e-05]
 [-2.29919817e-03  1.42204804e-04  2.60039858e-03  2.06403676e-04]
 [ 3.91389022e-03 -2.90934530e-04 -7.49838641e-04  3.81337201e-04]
 [-3.77418041e-03  2.69035907e-04 -1.33710077e-03 -5.61508825e-04]
 [ 1.68215128e-03  1.89644104e-05 -2.68022964e-03 -6.64427121e-04]
 [ 8.79991935e-04  2.50347219e-04  1.01884546e-03 -3.70471597e-04]
 [-3.15678763e-03  4.09682268e-04  1.53042863e-03 -9.40791445e-05]
 [-2.30222609e-03  3.97018681e-04 -1.93096580e-04  3.43267848e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0036413051581609406
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=9.701025681036081e-05, theta_kick=-1.1631894805794303e-05
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-3.741428683351125e-05, theta_kick=4.486113767660265e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009077213221212757
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.260602087271171e-05, theta_kick=-5.1086222135629835e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.3108873258816957e-05, theta_kick=1.571803227643488e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=3.176477207353689e-05, theta_kick=-3.808715690874784e-06
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0059154278348345695
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.1171420338502362e-05, theta_kick=-2.53853295892329e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01644323e-01 -6.31951125e+00  9.69368168e-03  1.32358528e-02]
 [ 1.79990702e-01  4.56177147e-01 -1.38141713e-03  1.35859765e-02]
 [ 9.28776185e-03  1.32369478e-02  3.83977880e-01 -5.11869404e+00]
 [ 1.68301186e-03  1.85470201e-02  2.12571693e-01 -2.29803442e-01]]
compute_tune_4x4()/ evals =  [0.08988507+0.99595214j 0.08988507-0.99595214j 0.06446856+0.99791974j
 0.06446856-0.99791974j]
compute_tune_4x4()/ angles =  [0.2356750127076198, 0.239732389489799, 0.760267610510201, 0.7643249872923802]
compute_tune_4x4()/  0.2356750127076198 0.239732389489799
compute_tunes()/ 0.2356750127076198 0.239732389489799

 Running simulation ..
Closed orbit computation: x_co=[-2.47641971e-07 -1.18558241e-08], y_co=[ 1.06941676e-05 -3.35461209e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 9.701025681036081e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -3.741428683351125e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.260602087271171e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.3108873258816957e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': 3.176477207353689e-05, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 2.1171420338502362e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.0036413051581609406}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.009077213221212757}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.0059154278348345695}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 9.22503899e-04  1.21961060e-05  1.94060537e-04 -2.67843198e-04]
 [-6.60158409e-04 -6.53174032e-05  2.51939659e-03  2.07664609e-04]
 [ 1.05318985e-03 -4.34068554e-04  2.15777129e-03  6.04286124e-05]
 [-2.29919817e-03  1.42204804e-04  2.60039858e-03  2.06403676e-04]
 [ 3.91389022e-03 -2.90934530e-04 -7.49838641e-04  3.81337201e-04]
 [-3.77418041e-03  2.69035907e-04 -1.33710077e-03 -5.61508825e-04]
 [ 1.68215128e-03  1.89644104e-05 -2.68022964e-03 -6.64427121e-04]
 [ 8.79991935e-04  2.50347219e-04  1.01884546e-03 -3.70471597e-04]
 [-3.15678763e-03  4.09682268e-04  1.53042863e-03 -9.40791445e-05]
 [-2.30222609e-03  3.97018681e-04 -1.93096580e-04  3.43267848e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.0036413051581609406
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=4.311130080860261e-08, theta_kick=-5.169207179060506e-09
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-2.154385054738779e-06, theta_kick=2.5831887422877623e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.009077213221212757
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=7.1989082815102735e-06, theta_kick=-8.631761898206388e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-8.816364311415882e-06, theta_kick=1.0571152537037308e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9492950930108875e-06, theta_kick=-3.5363157877429773e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.0059154278348345695
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=-4.5178527332914674e-07, theta_kick=5.417075417545341e-08
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01644323e-01 -6.31951125e+00  9.69368168e-03  1.32358528e-02]
 [ 1.79990702e-01  4.56177147e-01 -1.38141713e-03  1.35859765e-02]
 [ 9.28776185e-03  1.32369478e-02  3.83977880e-01 -5.11869404e+00]
 [ 1.68301186e-03  1.85470201e-02  2.12571693e-01 -2.29803442e-01]]
compute_tune_4x4()/ evals =  [0.08988507+0.99595214j 0.08988507-0.99595214j 0.06446856+0.99791974j
 0.06446856-0.99791974j]
compute_tune_4x4()/ angles =  [0.2356750127076198, 0.239732389489799, 0.760267610510201, 0.7643249872923802]
compute_tune_4x4()/  0.2356750127076198 0.239732389489799
compute_tunes()/ 0.2356750127076198 0.239732389489799

 Running simulation ..
Closed orbit computation: x_co=[ 1.09162982e-08 -1.66372531e-09], y_co=[-4.13281881e-07 -1.39056521e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 12/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-4.47110170e-03  6.19931623e-04 -1.47075479e-03 -9.91352570e-05]
 [-2.45593998e-03 -9.48102776e-05 -1.07879103e-03 -6.52119889e-04]
 [-6.49966814e-05 -6.71818512e-04  2.11713358e-03 -6.90874278e-04]
 [-1.89590802e-03 -3.67364747e-04  3.86458850e-04 -8.37420344e-04]
 [ 3.08712904e-04 -1.64094229e-04  1.39376811e-03  2.51035362e-04]
 [-4.55437091e-04  3.69112199e-04 -1.17476246e-03 -6.41599021e-04]
 [ 7.09617033e-04  6.81480429e-04 -2.34066099e-03  2.33505351e-04]
 [-2.47380785e-03  2.38721385e-04  2.11855655e-04 -2.85159592e-04]
 [-2.52343532e-03  1.61991933e-04  2.78264493e-04  8.24525898e-05]
 [-3.01418762e-03  5.11229716e-05  3.05975275e-03  2.10740535e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0077157107945735135
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=2.8497621859883434e-05, theta_kick=-3.4169720871624954e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=6.51208181245123e-05, theta_kick=-7.808231119028337e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017364503678318547
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=4.7551851108564335e-05, theta_kick=-5.701645868197927e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-1.8535297582799343e-05, theta_kick=2.222451921745546e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-2.6069260792244576e-06, theta_kick=3.125802458115139e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015005412203475775
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=5.7550831433497696e-05, theta_kick=-6.900561231675348e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01426991e-01 -6.32214937e+00 -3.61739187e-03 -1.45239789e-01]
 [ 1.80050082e-01  4.56586783e-01 -4.35218491e-03  1.21134136e-02]
 [-1.86821357e-02 -1.45334900e-01  3.84034479e-01 -5.12145353e+00]
 [-5.23387383e-03 -4.53562410e-03  2.12671922e-01 -2.30483045e-01]]
compute_tune_4x4()/ evals =  [0.08085604+0.99672579j 0.08085604-0.99672579j 0.07349957+0.99729525j
 0.07349957-0.99729525j]
compute_tune_4x4()/ angles =  [0.23711729754485447, 0.23829162241699192, 0.761708377583008, 0.7628827024551456]
compute_tune_4x4()/  0.23711729754485447 0.23829162241699192
compute_tunes()/ 0.23711729754485447 0.23829162241699192

 Running simulation ..
Closed orbit computation: x_co=[-1.39891253e-07  1.73421676e-07], y_co=[ 2.01107705e-05 -3.80264354e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': 2.8497621859883434e-05, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': 6.51208181245123e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': 4.7551851108564335e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': -1.8535297582799343e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -2.6069260792244576e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 5.7550831433497696e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': 0.0077157107945735135}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': -0.017364503678318547}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': 0.015005412203475775}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[-4.47110170e-03  6.19931623e-04 -1.47075479e-03 -9.91352570e-05]
 [-2.45593998e-03 -9.48102776e-05 -1.07879103e-03 -6.52119889e-04]
 [-6.49966814e-05 -6.71818512e-04  2.11713358e-03 -6.90874278e-04]
 [-1.89590802e-03 -3.67364747e-04  3.86458850e-04 -8.37420344e-04]
 [ 3.08712904e-04 -1.64094229e-04  1.39376811e-03  2.51035362e-04]
 [-4.55437091e-04  3.69112199e-04 -1.17476246e-03 -6.41599021e-04]
 [ 7.09617033e-04  6.81480429e-04 -2.34066099e-03  2.33505351e-04]
 [-2.47380785e-03  2.38721385e-04  2.11855655e-04 -2.85159592e-04]
 [-2.52343532e-03  1.61991933e-04  2.78264493e-04  8.24525898e-05]
 [-3.01418762e-03  5.11229716e-05  3.05975275e-03  2.10740535e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=0.0077157107945735135
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=1.0461650153095932e-06, theta_kick=-1.2543912167320146e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-9.456846435683858e-07, theta_kick=1.1339114703042119e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=-0.017364503678318547
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=5.955023167316142e-06, theta_kick=-7.140296843425265e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=-6.772476096172125e-06, theta_kick=8.12045366289734e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=2.9975394346731364e-06, theta_kick=-3.59416256865472e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=0.015005412203475775
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=1.4724067562449264e-06, theta_kick=-1.7654711020363596e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01426991e-01 -6.32214937e+00 -3.61739187e-03 -1.45239789e-01]
 [ 1.80050082e-01  4.56586783e-01 -4.35218491e-03  1.21134136e-02]
 [-1.86821357e-02 -1.45334900e-01  3.84034479e-01 -5.12145353e+00]
 [-5.23387383e-03 -4.53562410e-03  2.12671922e-01 -2.30483045e-01]]
compute_tune_4x4()/ evals =  [0.08085604+0.99672579j 0.08085604-0.99672579j 0.07349957+0.99729525j
 0.07349957-0.99729525j]
compute_tune_4x4()/ angles =  [0.23711729754485447, 0.23829162241699192, 0.761708377583008, 0.7628827024551456]
compute_tune_4x4()/  0.23711729754485447 0.23829162241699192
compute_tunes()/ 0.23711729754485447 0.23829162241699192

 Running simulation ..
Closed orbit computation: x_co=[-2.10994535e-09  2.38828524e-09], y_co=[-8.20519635e-08 -4.78997242e-08]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 13/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[ 5.37479494e-03 -5.55497606e-04 -3.71435982e-03  2.39767114e-04]
 [-1.17945236e-03  3.34955236e-04 -8.95523758e-04 -1.35625474e-03]
 [ 3.63406918e-03 -8.18381038e-04 -1.83765370e-03 -3.40936563e-04]
 [ 1.21272261e-04 -7.39365491e-04 -2.71122523e-03  2.60287130e-05]
 [ 2.98696438e-03  5.51909033e-05 -2.13653118e-03  4.95001362e-04]
 [-7.18157502e-04 -3.39312300e-04  1.90782309e-03  9.42021611e-05]
 [-3.47357197e-03  2.02043283e-04  7.73787328e-04  9.56025746e-06]
 [ 1.17259284e-03 -4.31829347e-04  1.42462657e-03  2.10408242e-04]
 [-3.22500743e-03 -1.21753930e-04 -2.56152564e-03  5.70132770e-04]
 [-1.11327994e-03 -1.95343650e-04  1.05739906e-04  9.88268404e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011838071099401895
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-8.416618355263422e-06, theta_kick=1.0091842094627422e-06
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=-4.1828840956708804e-05, theta_kick=5.015435417389526e-06
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014152336921778863
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-2.0497385913302403e-05, theta_kick=2.457713695195987e-06
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=1.0166518113447304e-05, theta_kick=-1.2190037747038675e-06
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-3.3884803411945207e-06, theta_kick=4.062915425255027e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.015991301063890268
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=7.391958366197568e-05, theta_kick=-8.863236213517392e-06
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01361865e-01 -6.32116960e+00  7.48074996e-03  1.57128371e-01]
 [ 1.80071873e-01  4.56588377e-01  3.94097793e-03 -6.32103047e-03]
 [ 2.31009816e-02  1.57194031e-01  3.83993594e-01 -5.12203304e+00]
 [ 6.19129440e-03  1.32768832e-02  2.12638172e-01 -2.30402847e-01]]
compute_tune_4x4()/ evals =  [0.08654285+0.99624813j 0.08654285-0.99624813j 0.06786578+0.99769446j
 0.06786578-0.99769446j]
compute_tune_4x4()/ angles =  [0.23620902540538743, 0.23919051783473583, 0.7608094821652642, 0.7637909745946125]
compute_tune_4x4()/  0.23620902540538743 0.23919051783473583
compute_tunes()/ 0.23620902540538743 0.23919051783473583

 Running simulation ..
Closed orbit computation: x_co=[7.30596218e-07 7.43889613e-08], y_co=[-3.81082629e-05  8.64675624e-06]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
{'p': 5.344286e-19, 'G': 1.0, 'q': 1.602e-19, 'n_turns': 6000, 'num_particles': 10, 'window_size': 10, 'use_thin_lens': True, 'x0_mean_std': [0.0, 0.05], 'xp0_mean_std': [0.0, 0.0], 'y0_mean_std': [0.0, 0.05], 'yp0_mean_std': [0.0, 0.0], 'particles_sampling_method': 'from_twiss_params', 'sampling_circle_radius': 0.01, 'mag_field_range': [0.1, 2.0], 'dipole_length_range': [0.2, 14.0], 'horizontal_tune_range': [0.1, 0.8], 'vertical_tune_range': [0.1, 0.8], 'total_dipole_bending_angle_range': [4.71238898038469, 6.283185307179586], 'use_gpu': True, 'verbose': True, 'figs_save_dir': 'exps/exp_LSTM_1000_mix/run_2025-01-17_00-19-35/figs', 'target_data': 'quad_misalign_deltas', 'reject_multiple_error_types': False, 'start_rev': 5500, 'end_rev': 6000, 'apply_avg': True, 'fodo_cell_indices': [0, 1, 2, 3, 4, 5, 6, 7], 'planes': ['x', 'y'], 'random_criterion': 'normal', 'delta_range': [0, 5e-05], 'quad_tilt_angle_range': [0, 0.01], 'dipole_tilt_angle_range': [0, 0.05], 'com_delta_range': [-5e-05, 5e-05], 'config_name': 'Configuration 1', 'design_radius': 20.0, 'n_FODO': 8, 'f': 3.336008739076155, 'L_quad': 0.4, 'quad_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'delta': -8.416618355263422e-06, 'plane': 'vertical'}, {'FODO_index': 2, 'quad_type': 'defocusing', 'delta': -4.1828840956708804e-05, 'plane': 'vertical'}, {'FODO_index': 3, 'quad_type': 'defocusing', 'delta': -2.0497385913302403e-05, 'plane': 'vertical'}, {'FODO_index': 4, 'quad_type': 'defocusing', 'delta': 1.0166518113447304e-05, 'plane': 'vertical'}, {'FODO_index': 5, 'quad_type': 'defocusing', 'delta': -3.3884803411945207e-06, 'plane': 'vertical'}, {'FODO_index': 7, 'quad_type': 'defocusing', 'delta': 7.391958366197568e-05, 'plane': 'vertical'}], 'quad_tilt_errors': [{'FODO_index': 1, 'quad_type': 'defocusing', 'tilt_angle': -0.011838071099401895}, {'FODO_index': 3, 'quad_type': 'defocusing', 'tilt_angle': 0.014152336921778863}, {'FODO_index': 6, 'quad_type': 'defocusing', 'tilt_angle': -0.015991301063890268}], 'dipole_tilt_errors': None, 'L_straight': 3.9269908169872423, 'L_dipole': 5.890486225480862, 'n_Dipoles': 16, 'L_drift': 0.7817477042468106, 'Qx': 0.23770281433892285, 'Qy': 0.2377028143389229, 'B': 0.16680043695380775, 'B_rho': 3.336008739076155, 'total_dipole_bending_angle': 4.71238898038469}
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
initial_states =  [[ 5.37479494e-03 -5.55497606e-04 -3.71435982e-03  2.39767114e-04]
 [-1.17945236e-03  3.34955236e-04 -8.95523758e-04 -1.35625474e-03]
 [ 3.63406918e-03 -8.18381038e-04 -1.83765370e-03 -3.40936563e-04]
 [ 1.21272261e-04 -7.39365491e-04 -2.71122523e-03  2.60287130e-05]
 [ 2.98696438e-03  5.51909033e-05 -2.13653118e-03  4.95001362e-04]
 [-7.18157502e-04 -3.39312300e-04  1.90782309e-03  9.42021611e-05]
 [-3.47357197e-03  2.02043283e-04  7.73787328e-04  9.56025746e-06]
 [ 1.17259284e-03 -4.31829347e-04  1.42462657e-03  2.10408242e-04]
 [-3.22500743e-03 -1.21753930e-04 -2.56152564e-03  5.70132770e-04]
 [-1.11327994e-03 -1.95343650e-04  1.05739906e-04  9.88268404e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
theta [0.2945243112740431]
theta [0.2945243112740431]
	Inserted QuadTiltError @ cell=1, type=defocusing, angle=-0.011838071099401895
Applied old Quad misalignment at cell=1, quad=defocusing, plane=vertical, delta=-2.4492958329256407e-06, theta_kick=2.9367978617513183e-07
Applied old Quad misalignment at cell=2, quad=defocusing, plane=vertical, delta=4.567747047718227e-06, theta_kick=-5.476900577884191e-07
	Inserted QuadTiltError @ cell=3, type=defocusing, angle=0.014152336921778863
Applied old Quad misalignment at cell=3, quad=defocusing, plane=vertical, delta=-6.790425823681269e-06, theta_kick=8.141976061563616e-07
Applied old Quad misalignment at cell=4, quad=defocusing, plane=vertical, delta=6.376896753618561e-06, theta_kick=-7.646139146967011e-07
Applied old Quad misalignment at cell=5, quad=defocusing, plane=vertical, delta=-4.1169234106144025e-06, theta_kick=4.936346074146685e-07
	Inserted QuadTiltError @ cell=6, type=defocusing, angle=-0.015991301063890268
Applied old Quad misalignment at cell=7, quad=defocusing, plane=vertical, delta=2.9204472927659423e-06, theta_kick=-3.501726189811727e-07
build_lattice() completed. Total elements per rev = 70
one turn matrix:
 [[-3.01361865e-01 -6.32116960e+00  7.48074996e-03  1.57128371e-01]
 [ 1.80071873e-01  4.56588377e-01  3.94097793e-03 -6.32103047e-03]
 [ 2.31009816e-02  1.57194031e-01  3.83993594e-01 -5.12203304e+00]
 [ 6.19129440e-03  1.32768832e-02  2.12638172e-01 -2.30402847e-01]]
compute_tune_4x4()/ evals =  [0.08654285+0.99624813j 0.08654285-0.99624813j 0.06786578+0.99769446j
 0.06786578-0.99769446j]
compute_tune_4x4()/ angles =  [0.23620902540538743, 0.23919051783473583, 0.7608094821652642, 0.7637909745946125]
compute_tune_4x4()/  0.23620902540538743 0.23919051783473583
compute_tunes()/ 0.23620902540538743 0.23919051783473583

 Running simulation ..
Closed orbit computation: x_co=[ 2.33933864e-08 -1.32990166e-09], y_co=[-8.85247451e-07  1.48986396e-07]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
	-------------[Run 14/50]
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tunes()/ 0.23770281433892285 0.2377028143389229
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1184: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_hor = np.random.multivariate_normal(mean=[0,0], cov=Sigma_x, size=num_particles)
/home/aribra/jnps/thesis/lattice_error_net/synchrotron_simulator_gpu_Dataset_4D.py:1186: RuntimeWarning: covariance is not symmetric positive-semidefinite.
  X_ver = np.random.multivariate_normal(mean=[0,0], cov=Sigma_y, size=num_particles)
initial_states =  [[-2.54531211e-04  2.21596331e-04 -1.74429267e-03  1.21565575e-05]
 [-4.80244381e-03  5.78507405e-04 -7.25940474e-04 -4.30673551e-04]
 [-2.45598430e-03  4.05463278e-04 -2.23302975e-04  1.15116857e-05]
 [-3.20171619e-03  3.12131753e-04  9.06116404e-04 -7.76840772e-05]
 [-1.84131585e-03  3.60277647e-04  1.34576916e-03 -1.35751863e-05]
 [ 3.67436286e-03 -2.69628539e-04 -1.00469294e-03  1.57817885e-04]
 [-1.40407228e-03 -1.39812429e-04  5.08729515e-04  5.03965254e-04]
 [-3.62742555e-03  6.80723299e-04 -2.35399728e-03 -2.15406584e-04]
 [ 1.97553905e-04 -1.20782701e-04  6.78194144e-04 -1.04243138e-04]
 [-1.56428884e-04  3.17427470e-04 -2.87814366e-03  5.02073997e-04]]

 Running simulation ..
Closed orbit computation: x_co=[0. 0.], y_co=[0. 0.]
/home/aribra/.local/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))
theta [0.2945243112740431]
theta [0.2945243112740431]
build_lattice() completed. Total elements per rev = 64
one turn matrix:
 [[-0.30170954 -6.32003818  0.          0.        ]
 [ 0.17999982  0.45608682  0.          0.        ]
 [ 0.          0.          0.38409391 -5.1191933 ]
 [ 0.          0.          0.21257895 -0.22971663]]
compute_tune_4x4()/ evals =  [0.07718864+0.99701651j 0.07718864-0.99701651j 0.07718864+0.99701651j
 0.07718864-0.99701651j]
compute_tune_4x4()/ angles =  [0.23770281433892285, 0.2377028143389229, 0.7622971856610771, 0.7622971856610772]
compute_tune_4x4()/  0.23770281433892285 0.2377028143389229
compute_tu